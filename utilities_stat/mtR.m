function [rn , varargout] = mtR(n, distrib, Rstream)%Generates the same random numbers produced by R software with Mersenne Twister mt19937ar%%<a href="matlab: docsearchFS('mtR')">Link to the help page for this function</a>%%   This function ensures that uniformly or normally distributed%   pseudorandom numbers, generated in R and MATLAB using the Mersenne%   Twister algorithm mt19937ar, are identical. In the R community the%   problem is discussed (but only partially addressed) in the package%   'randtoolbox', available in CRAN.%%  Required input arguments:%%   n       :     Number of random numbers. Positive integer. The number of%                 random numbers to generate. Default is n=1.%%   distrib :     Distribution. Scalar or 1-by-3 array. Default is distrib=0.%                 If distrib is a scalar, then the value 0 indicates the%                   use of the uniform distribution in [0 1], while any%                   other value stands for the standard normal with 0 mean%                   and standard deviation 1.%                 If distrib is a 1-by-3 array: the first element is the%                   distribution type, chosen with the rule above for the%                   scalar case; the second and the third elements are the%                   two parameters of the chosen distribution, that is%                   [min,max] for the uniform and [mean,std] for the%                   normal.%%   Rstream:     stream received from R. Structure or scalar equal to zero %                or empty. The stream used to initialise the random number%                generation in MATLAB.%                - if Rstream is an empty double, i.e. Rstream = [], then%                  nothing is done: the state and seed are the current%                  MATLAB ones. This is useful to continue a simulation%                  initiated with a certain stream.%                - if Rstream = 0, then Rstream.seed is set to zero and %                  Rstream.state is set to the state array that R generates%                  for that seed.%                - if Rstream is a structure, then it must contain the %                  following fields:%                   Rstream.seed  = seed value. Non negative integer. The %                          seed used to initiate the random stream. Default%                          is 0. The Rstate must be coherent with the%                          chosen Rseed.%                   Rstream.state = state of the random number stream. %                          Array of 626 integers. This is the random%                          stream state of the random stream received from%                          R. See "More About" for additional details.%               Data Types - structure or scalar or empty scalar.%%%  Optional input arguments:%%  Output:%%   rn :        generated random numbers. Vector. Random numbers that%               should be identical with those produced in R.%               Data Types - double array.%%%  Optional Output:%%       state : state of the random number stream in the MATLAB format. %               Vector. Column vector which contains the random stream.%               Data Types - uint32 array.%% More About:%%   In R software, the random stream for the Mersenne Twister algorithm is%   generated by .Random.seed as a 624-dimensional set of 32-bit integers%   preceded by two additional integers: the first is a code for the kind%   of RNG and normal generator and the second is the current position in%   the random stream set. The lowest two decimal digits of the RNG code%   are in 0:(k-1) where k is the number of available RNGs; the hundreds%   represent the type of normal generator, starting at 0.%%   The approach followed in this FSDA function to grant compatibility%   of random numbers generated in MATLAB and R relies on two key steps:%   - The state of the random number stream created in MATLAB is replaced%     with the stream received from R as imput argument. This step requires%     recasting the stream from the signed integers used by R and the%     unsigned counterparts used by MATLAB. The generated random stream%     is indipendent from the global stream.%   - The inverse transformation is used to compute a normal random%     variate (i.e. the standard normal inverse cumulative distribution%     function to a uniform random variate is applied). This replaces the%     MATLAB default, which is the ziggurat algorithm.%%   Our solution grants retrocompatibility up to R2012a. Note the key %   changes in the syntax of MATLAB's RNG start-up:%   - prior to R2008b the setting was:%     rand('seed',0).%   - from R2008b:%     stream = RandStream('mt19937ar','Seed',5489); %     RandStream.setGlobalStream(stream).%   - from R2011a the current setting was adopted:%     rng default.%%% See also: RandStream, rng, rand, randn%%  References:%%    Matsumoto, M. and Nishimura, T. (2000), Mersenne Twister: A%    623-Dimensionally Equidistributed Uniform Pseudorandom Number%    Generator, "ACM Transactions on Modeling and Computer Simulation", %    Vol. 8, pp. 3-30.%    Marsaglia, G. and Tsang, W.W. (2000), The ziggurat method for%    generating random variables, "Journal of Statistical Software", Vol. 5,%    pp. 1-7.%%  Acknowledgements:%%   The function has been written with the key contribution of Dr Peter%   Perkins, statistician at The Mathworks with recognised competence in%   random number generation and Monte-Carlo simulation.%%% Copyright 2008-2018.% Written by FSDA team%%%<a href="matlab: docsearchFS('mtR')">Link to the help page for this function</a>%%$LastChangedDate:: 2018-05-31 10:53:11 #$: Date of the last commit%% Examples:%%{    %% mtR with all the default options.     % Code for both MATLAB and R.    % R SIDE: display in the MATLAB command window      %         the strings to execute in R    Rstring = ['EXECUTE THE FOLLOWING IN R AND COMPARE RESULTS' char(10) char(10) ...    'RNGkind("Mersenne-Twister") # set "Mersenne-Twister" "Inversion"' char(10)...    'set.seed(0)' char(10)...    'state = .Random.seed' char(10) ...    char(10)...    'runif(5)' char(10)...    '# [1] 0.8966972 0.2655087 0.3721239 0.5728534 0.9082078' char(10)'];    disp(Rstring);    % MATLAB SIDE:    clear all; close all;    m = 'MATLAB: ';    r = 'R:      ';    % 5 random numbers from a uniform distribution in [0 1].    rn = mtR(5);    sprintf('%s %0.7f  ',m,rn)    sprintf('%s %0.7f  ',r,[0.8966972 0.2655087 0.3721239 0.5728534 0.9082078])%}%{    % Example where the distributiion is specified (0 for uniform).    rn = mtR(5,0);    sprintf('%s %0.7f  ',m,rn)    sprintf('%s %0.7f  ',r,[0.8966972 0.2655087 0.3721239 0.5728534 0.9082078])%}%{    % Example with the default stream.    % The default stream is associated to a seed equal to 0.    rn = mtR(5,[],0);    sprintf('%s %0.7f  ',m,rn)    sprintf('%s %0.7f  ',r,[0.8966972 0.2655087 0.3721239 0.5728534 0.9082078])%}%{    % Distribution specfied with the triple array.    numRandomNumbers=5;    rn = mtR(numRandomNumbers,[0,0,1]);    sprintf('%s %0.7f  ',m,rn)    sprintf('%s %0.7f  ',r,[0.8966972 0.2655087 0.3721239 0.5728534 0.9082078])%}%{    % Random numbers from a standard normal distribution.    numRandomNumbers=5;    rn = mtR(numRandomNumbers,1);    sprintf('%s %0.7f   ',m,rn)    sprintf('%s %0.7f   ',r,[1.2629543 -0.3262334 1.3297993 1.2724293 0.4146414])%}%{    % Random numbers from a uniform distribution in [3 7].    numRandomNumbers=5;    % (runif(numRandomNumbers,3,7))    rn = mtR(numRandomNumbers,[0,3,7]);    sprintf('%s %0.7f   ',m,rn)    sprintf('%s %0.7f   ',r,[6.586789 4.062035 4.488496 5.291413 6.632831])%}%{    % Random numbers from a normal distribution with mean=2 and std=15.    numRandomNumbers=5;    % rnorm(numRandomNumbers,2,15)    rn = mtR(numRandomNumbers,[1,2,15]);    sprintf('%s %0.7f   ',m,rn)    sprintf('%s %0.7f   ',r,[20.944314 -2.893500 21.946989 21.086440  8.219622])%}%{    %% Generate uniform numbers in R and MATLAB, but with seed <> 0.    % Code for both MATLAB and R.    clear all; close all;    % R SIDE: display in the MATLAB command window the command strings to    %         execute in R    Rstring = ['EXECUTE THE FOLLOWING IN R AND COMPARE RESULTS' char(10) char(10) ...    'RNGkind("Mersenne-Twister")' char(10)...    'set.seed(12345)' char(10)...    'state = .Random.seed   # TO BE PASSED TO mtR (state option) in MATLAB' char(10) ...    char(10)...    'runif(5)' char(10)...    '# [1] 0.7209039 0.8757732 0.7609823 0.8861246 0.4564810' char(10) ...    char(10)...    'set.seed(12345)' char(10)...    'rnorm(5)' char(10)...    '# [1] 0.5855288  0.7094660 -0.1093033 -0.4534972  0.6058875'];    disp(Rstring);    % MATLAB SIDE:    %    m = 'MATLAB: ';    r = 'R:      ';    % 5 random numbers from a [0 1]-uniform distributiion, but seed=12345    % state taken from R    stateR12345 = [403 , 624 , 1638542565 , 108172386 , -1884566405 , -1838154368 , -250773631 , 919185230 , -1001918601 , -1002779316 , -321961507 , 1781331706 , 1166440499 , -117712936 , 58314745 , -938201242 , 1844978351 , -869947100 , 216221141 , 576699538 , 533687019 , 1819381040 , 675905393 , 2110048894 , 2136771815 , 1026265084 , -1037166387 , -285653718 , 1263109283 , -1975616120 , 1576168937 , -123742058 , 244715039 , 1526718932 , -1087137083 , 1442050242 , 676570459 , 800852192 , -823755935 , -566904402 , 1696695895 , 906100396 , 1479781309 , -321511590 , -1503089389 , 1068470072 , 2031323097 , 2053295558 , -749218417 , -2000861564 , 1655319477 , -768462606 , 262110155 , 399143056 , -983338159 , -1865452322 , -202515513 , 1164515676 , 80673453 , 1462142346 , 1143665027 , -1238758168 , 255598025 , 1584402166 , 1601468671 , -748103884 , 1964374181 , -656573150 , 1708781115 , -1898462144 , 469722945 , -888865778 , -807891657 , -53747700 , -1448147555 , -905087046 , -208186893 , 289994392 , -2104807495 , -895837146 , -1276970897 , -1949461532 , -133824107 , -327625390 , 1424620715 , -572587024 , 45700913 , -284602562 , 850959015 , -1739238724 , -1539126131 , -1167198742 , -713765277 , -1419293624 , -857752151 , 695563606 , -1621470241 , -2055832428 , 1623803525 , 4667778 , 276211483 , -593809504 , -1185922271 , -1144033682 , 1545929751 , -1359974036 , -1111928963 , -1511325670 , -867539245 , -979366408 , 1876477849 , 1515428486 , 777096015 , -961638076 , -2006005899 , -1471436366 , 1172761995 , -1584969904 , 2135108369 , 2097830302 , 24430983 , -498582500 , 453086829 , 1122473546 , -329311421 , 936262568 , 1691700617 , -515372106 , 452959935 , 947966452 , -1681554331 , 1229530594 , -1939746821 , 836651776 , -2083451135 , 992809166 , -1111561481 , -1899515188 , 751470941 , -1333348230 , -340137037 , 546100568 , 217337721 , 388352230 , 1029410351 , 1454915236 , 190610773 , 1220718098 , -724677013 , 832256688 , -705106191 , -345336834 , -2116392857 , 2073679228 , -1618788275 , -1498716502 , -1843275741 , -1791567096 , 555011433 , 1501549078 , -82028129 , -538978476 , 2072162885 , 1023099458 , -640456485 , -1820780960 , 1417267937 , -1615469778 , 73286103 , -1968593876 , 1264235325 , -1510432550 , 689823891 , 1374112952 , -1579825319 , 984164166 , -1212612337 , -2059232252 , -1270406347 , 485876338 , -1881661621 , 1223876112 , -1647140143 , -1228800418 , 832665415 , 1755455196 , 608166445 , 668034826 , -336263933 , 1769548392 , -946455223 , -1313552266 , 1147700351 , -1695839052 , -1854353371 , 1886752418 , -1794936389 , -230452800 , 4355777 , 201450894 , -1682241353 , 1022248332 , 702663965 , -833046214 , 2007909747 , -175672296 , -227201223 , 1249228198 , 1344398319 , -945444508 , -223954667 , 2147305170 , -1589878741 , -1905905296 , 1774732977 , 665360574 , -360581593 , 1505302588 , 1471116301 , -1804494998 , 990945763 , -965924408 , -1705927383 , 1434382038 , -677634209 , -1258556908 , -1423974907 , -2066740478 , -165025125 , 722844960 , 1478693537 , 1856575470 , 1267548055 , -336750868 , -1797794051 , -37813862 , -425518509 , 323308408 , 1053460249 , 404976646 , -1790036273 , -1086757180 , 1911766773 , -655303886 , -818736885 , -1798490928 , -925771119 , 1387684638 , -499915513 , -1422474852 , -1538656787 , 1185150922 , -592662845 , 703256872 , 1463741705 , -59357898 , 1903110719 , -1519843468 , -772809755 , 656586594 , -780217477 , 113744000 , 689151617 , -2109506994 , 931980919 , -1979738036 , 347394269 , -1807517190 , -1590403277 , 519623384 , 1120784121 , -1052089754 , -235538001 , 961926180 , 430224597 , -1696030830 , 2079601131 , -620763088 , 1172790897 , 411262334 , -1435548697 , 1702042364 , 814180301 , 612403242 , 1241590691 , 2110404744 , 945171689 , -1439511658 , -1432771297 , 260754644 , 1264634309 , 277189570 , -1757795237 , 976298976 , 1007426145 , -848753490 , -546177705 , -1250145876 , -302990659 , 2113806938 , -291892205 , -126219720 , 913770201 , -1350401850 , -1395577713 , 793964932 , 221452981 , 1157403634 , -1514683701 , -875148400 , 1744884305 , 631736286 , 820777671 , 1019618396 , -555759187 , -1608562550 , 407246979 , 400771048 , -208708407 , -1370717706 , -137129985 , -1028046284 , -1729452123 , 101752866 , 1402205499 , 1714052928 , 1443137089 , -1565405426 , 519341111 , -1195660532 , 553882781 , 856095418 , 839661811 , -341773928 , -843174215 , -1738289370 , -392704145 , -964116764 , -1407815531 , 1648670802 , -424295509 , -1104650512 , -1307167183 , -222633410 , -1084075609 , -1853366852 , 1305156493 , -1214760726 , -122456733 , -1173485752 , -1159562071 , -1537513386 , -1445664033 , -1169397868 , 2013623685 , -656679806 , -1362874853 , 395004576 , 938795553 , 548782446 , 768375575 , -1978286996 , 1785028221 , -1217002726 , -356332077 , -1337620232 , 949700249 , 2105953670 , -1543380401 , 1347370052 , -1849248139 , -1982264142 , 1965438091 , -187817392 , -1558214127 , -1001034594 , -74841977 , 1880114972 , -675193491 , -184329910 , -1199488445 , -1843235160 , 1011321993 , 1945599670 , -313150017 , 496778484 , -500616347 , 1711229154 , -318580997 , -953424384 , -1630196223 , 839705550 , -1615732233 , -874349108 , 1116608605 , -1687995526 , -1275735373 , 1782567000 , 587615865 , -1400767514 , -1178114769 , 1241409956 , -1782846379 , 1590792466 , 591467883 , -1633708624 , -1240150543 , -1425070338 , -417652889 , -1867030404 , -1824878771 , 1853401514 , 1088913187 , 972592648 , -1581872023 , 1354286358 , -888278881 , 1073791572 , 214819141 , -1768757950 , -293081125 , -639356576 , 1134389729 , -1924188626 , 1683798231 , -864424148 , -571096515 , -85548070 , 1155352467 , -1452816456 , -1258863015 , -1091642810 , -526362609 , 1559119620 , -881978827 , -1874442894 , 1597924939 , -696993520 , 1642987985 , -2088758946 , -540168633 , 1473587676 , 1387180333 , -972019190 , -1759630333 , -1217895064 , -1859683255 , -1170785418 , 666213247 , -1596852300 , 1768652581 , 1605284258 , 797669563 , -1601426240 , -616196671 , -1256933234 , -947585097 , -2043408244 , 756309021 , 2115517498 , 1890659443 , 1771400984 , -1838797255 , -1704662874 , -1421559057 , 1584845924 , -2108348395 , -649123374 , 861284139 , -1557820304 , 430122417 , -163566658 , -1621512921 , -708730052 , -1533689075 , 702667370 , -597866269 , 2085217480 , 747789353 , 2081087958 , -1006324129 , -345514732 , -1518727931 , -1033196030 , -934973029 , 1476122656 , 382054817 , -134911250 , 1893906071 , -1620516372 , -597563907 , 1494221978 , 648642899 , 312526456 , -615840231 , 1887184646 , -2006151729 , 1341133252 , 1172909557 , 17055282 , 1170233355 , -141946928 , 1277966737 , 2011657758 , 997661703 , -959132516 , -748174099 , 1409661642 , 1306318275 , 1718948904 , 300887049 , -1379157962 , 1018380607 , -149261708 , -1435399451 , -874587550 , 1827527291 , 688599936 , -1558856319 , 1888046414 , 1680727415 , 1785750348 , 1414946781 , 1273363706 , 1912489523 , 2019675608 , 731762169 , -1093888666 , -1026568017 , 1588723492 , -576576555 , -629308782 , -659228437 , -1300610256 , 1686191473 , 1225650302 , 635304679 , -1821989380 , -442714419 , -1970025686 , 1154798243 , -1077808248 , 1530260457 , -1290682730 , 175717407 , -951994412 , -1647707963 , -1792854334 , 1841083227 , 680672992 , 690862433 , 90726318 , 18773079 , -442329940 , -1184249411 , -1565383334 , 2045213459 , -625965768 , -1688828455 , 1324233670 , -2128182385 , -468411260 , 1291323829 , 1154676466 , -898889269 , -1630656880 , -912641711 , 1984666334 , 742803911 , 1338978140 , -1649633107 , -1616639094 , 914177923 , 1040745192 , -1637966903 , 997520630 , -2112968961 , -1959416524 , -520399195 , 1129300770 , -1226179525 , 1466497600 , 1308992833 , 1764401678 , 57441079 , -1151896052 , -334224483 , 898399674 , -2120409101 , -446370664 , -1100141127 , 913900070 , -970414481 , 1701833188 , -748494955 , 723295058 , -1793226069 , 1935522288 , -563145423 , -667388610 , 2020083879 , -1134139204 , 2047830669 , -246514710 , -1274143645 , 52478536 , -312394839 , 1116560214 , -735346209 , -1639034220 , 293446789 , 125599618 , -793922277 , -1570282080 , -1298824927 , 443028590 , -2100301289 , 1105659756 , -1999803011 , 1754072602 , -396938029 , -1336474632 , -1529231975 , -687538042 , 1888368975 , -1810110652 ];    Rstream=struct;    Rstream.state = stateR12345;    Rstream.seed  = 12345;    rn = mtR(5,0,Rstream);    sprintf('%s %0.7f  ',m,rn)    sprintf('%s %0.7f  ',r,[0.7209039 0.8757732 0.7609823 0.8861246 0.4564810])    % 5 random numbers from a 0-1 normal distribution, but seed=12345    stateR12345 = [403 , 624 , 1638542565 , 108172386 , -1884566405 , -1838154368 , -250773631 , 919185230 , -1001918601 , -1002779316 , -321961507 , 1781331706 , 1166440499 , -117712936 , 58314745 , -938201242 , 1844978351 , -869947100 , 216221141 , 576699538 , 533687019 , 1819381040 , 675905393 , 2110048894 , 2136771815 , 1026265084 , -1037166387 , -285653718 , 1263109283 , -1975616120 , 1576168937 , -123742058 , 244715039 , 1526718932 , -1087137083 , 1442050242 , 676570459 , 800852192 , -823755935 , -566904402 , 1696695895 , 906100396 , 1479781309 , -321511590 , -1503089389 , 1068470072 , 2031323097 , 2053295558 , -749218417 , -2000861564 , 1655319477 , -768462606 , 262110155 , 399143056 , -983338159 , -1865452322 , -202515513 , 1164515676 , 80673453 , 1462142346 , 1143665027 , -1238758168 , 255598025 , 1584402166 , 1601468671 , -748103884 , 1964374181 , -656573150 , 1708781115 , -1898462144 , 469722945 , -888865778 , -807891657 , -53747700 , -1448147555 , -905087046 , -208186893 , 289994392 , -2104807495 , -895837146 , -1276970897 , -1949461532 , -133824107 , -327625390 , 1424620715 , -572587024 , 45700913 , -284602562 , 850959015 , -1739238724 , -1539126131 , -1167198742 , -713765277 , -1419293624 , -857752151 , 695563606 , -1621470241 , -2055832428 , 1623803525 , 4667778 , 276211483 , -593809504 , -1185922271 , -1144033682 , 1545929751 , -1359974036 , -1111928963 , -1511325670 , -867539245 , -979366408 , 1876477849 , 1515428486 , 777096015 , -961638076 , -2006005899 , -1471436366 , 1172761995 , -1584969904 , 2135108369 , 2097830302 , 24430983 , -498582500 , 453086829 , 1122473546 , -329311421 , 936262568 , 1691700617 , -515372106 , 452959935 , 947966452 , -1681554331 , 1229530594 , -1939746821 , 836651776 , -2083451135 , 992809166 , -1111561481 , -1899515188 , 751470941 , -1333348230 , -340137037 , 546100568 , 217337721 , 388352230 , 1029410351 , 1454915236 , 190610773 , 1220718098 , -724677013 , 832256688 , -705106191 , -345336834 , -2116392857 , 2073679228 , -1618788275 , -1498716502 , -1843275741 , -1791567096 , 555011433 , 1501549078 , -82028129 , -538978476 , 2072162885 , 1023099458 , -640456485 , -1820780960 , 1417267937 , -1615469778 , 73286103 , -1968593876 , 1264235325 , -1510432550 , 689823891 , 1374112952 , -1579825319 , 984164166 , -1212612337 , -2059232252 , -1270406347 , 485876338 , -1881661621 , 1223876112 , -1647140143 , -1228800418 , 832665415 , 1755455196 , 608166445 , 668034826 , -336263933 , 1769548392 , -946455223 , -1313552266 , 1147700351 , -1695839052 , -1854353371 , 1886752418 , -1794936389 , -230452800 , 4355777 , 201450894 , -1682241353 , 1022248332 , 702663965 , -833046214 , 2007909747 , -175672296 , -227201223 , 1249228198 , 1344398319 , -945444508 , -223954667 , 2147305170 , -1589878741 , -1905905296 , 1774732977 , 665360574 , -360581593 , 1505302588 , 1471116301 , -1804494998 , 990945763 , -965924408 , -1705927383 , 1434382038 , -677634209 , -1258556908 , -1423974907 , -2066740478 , -165025125 , 722844960 , 1478693537 , 1856575470 , 1267548055 , -336750868 , -1797794051 , -37813862 , -425518509 , 323308408 , 1053460249 , 404976646 , -1790036273 , -1086757180 , 1911766773 , -655303886 , -818736885 , -1798490928 , -925771119 , 1387684638 , -499915513 , -1422474852 , -1538656787 , 1185150922 , -592662845 , 703256872 , 1463741705 , -59357898 , 1903110719 , -1519843468 , -772809755 , 656586594 , -780217477 , 113744000 , 689151617 , -2109506994 , 931980919 , -1979738036 , 347394269 , -1807517190 , -1590403277 , 519623384 , 1120784121 , -1052089754 , -235538001 , 961926180 , 430224597 , -1696030830 , 2079601131 , -620763088 , 1172790897 , 411262334 , -1435548697 , 1702042364 , 814180301 , 612403242 , 1241590691 , 2110404744 , 945171689 , -1439511658 , -1432771297 , 260754644 , 1264634309 , 277189570 , -1757795237 , 976298976 , 1007426145 , -848753490 , -546177705 , -1250145876 , -302990659 , 2113806938 , -291892205 , -126219720 , 913770201 , -1350401850 , -1395577713 , 793964932 , 221452981 , 1157403634 , -1514683701 , -875148400 , 1744884305 , 631736286 , 820777671 , 1019618396 , -555759187 , -1608562550 , 407246979 , 400771048 , -208708407 , -1370717706 , -137129985 , -1028046284 , -1729452123 , 101752866 , 1402205499 , 1714052928 , 1443137089 , -1565405426 , 519341111 , -1195660532 , 553882781 , 856095418 , 839661811 , -341773928 , -843174215 , -1738289370 , -392704145 , -964116764 , -1407815531 , 1648670802 , -424295509 , -1104650512 , -1307167183 , -222633410 , -1084075609 , -1853366852 , 1305156493 , -1214760726 , -122456733 , -1173485752 , -1159562071 , -1537513386 , -1445664033 , -1169397868 , 2013623685 , -656679806 , -1362874853 , 395004576 , 938795553 , 548782446 , 768375575 , -1978286996 , 1785028221 , -1217002726 , -356332077 , -1337620232 , 949700249 , 2105953670 , -1543380401 , 1347370052 , -1849248139 , -1982264142 , 1965438091 , -187817392 , -1558214127 , -1001034594 , -74841977 , 1880114972 , -675193491 , -184329910 , -1199488445 , -1843235160 , 1011321993 , 1945599670 , -313150017 , 496778484 , -500616347 , 1711229154 , -318580997 , -953424384 , -1630196223 , 839705550 , -1615732233 , -874349108 , 1116608605 , -1687995526 , -1275735373 , 1782567000 , 587615865 , -1400767514 , -1178114769 , 1241409956 , -1782846379 , 1590792466 , 591467883 , -1633708624 , -1240150543 , -1425070338 , -417652889 , -1867030404 , -1824878771 , 1853401514 , 1088913187 , 972592648 , -1581872023 , 1354286358 , -888278881 , 1073791572 , 214819141 , -1768757950 , -293081125 , -639356576 , 1134389729 , -1924188626 , 1683798231 , -864424148 , -571096515 , -85548070 , 1155352467 , -1452816456 , -1258863015 , -1091642810 , -526362609 , 1559119620 , -881978827 , -1874442894 , 1597924939 , -696993520 , 1642987985 , -2088758946 , -540168633 , 1473587676 , 1387180333 , -972019190 , -1759630333 , -1217895064 , -1859683255 , -1170785418 , 666213247 , -1596852300 , 1768652581 , 1605284258 , 797669563 , -1601426240 , -616196671 , -1256933234 , -947585097 , -2043408244 , 756309021 , 2115517498 , 1890659443 , 1771400984 , -1838797255 , -1704662874 , -1421559057 , 1584845924 , -2108348395 , -649123374 , 861284139 , -1557820304 , 430122417 , -163566658 , -1621512921 , -708730052 , -1533689075 , 702667370 , -597866269 , 2085217480 , 747789353 , 2081087958 , -1006324129 , -345514732 , -1518727931 , -1033196030 , -934973029 , 1476122656 , 382054817 , -134911250 , 1893906071 , -1620516372 , -597563907 , 1494221978 , 648642899 , 312526456 , -615840231 , 1887184646 , -2006151729 , 1341133252 , 1172909557 , 17055282 , 1170233355 , -141946928 , 1277966737 , 2011657758 , 997661703 , -959132516 , -748174099 , 1409661642 , 1306318275 , 1718948904 , 300887049 , -1379157962 , 1018380607 , -149261708 , -1435399451 , -874587550 , 1827527291 , 688599936 , -1558856319 , 1888046414 , 1680727415 , 1785750348 , 1414946781 , 1273363706 , 1912489523 , 2019675608 , 731762169 , -1093888666 , -1026568017 , 1588723492 , -576576555 , -629308782 , -659228437 , -1300610256 , 1686191473 , 1225650302 , 635304679 , -1821989380 , -442714419 , -1970025686 , 1154798243 , -1077808248 , 1530260457 , -1290682730 , 175717407 , -951994412 , -1647707963 , -1792854334 , 1841083227 , 680672992 , 690862433 , 90726318 , 18773079 , -442329940 , -1184249411 , -1565383334 , 2045213459 , -625965768 , -1688828455 , 1324233670 , -2128182385 , -468411260 , 1291323829 , 1154676466 , -898889269 , -1630656880 , -912641711 , 1984666334 , 742803911 , 1338978140 , -1649633107 , -1616639094 , 914177923 , 1040745192 , -1637966903 , 997520630 , -2112968961 , -1959416524 , -520399195 , 1129300770 , -1226179525 , 1466497600 , 1308992833 , 1764401678 , 57441079 , -1151896052 , -334224483 , 898399674 , -2120409101 , -446370664 , -1100141127 , 913900070 , -970414481 , 1701833188 , -748494955 , 723295058 , -1793226069 , 1935522288 , -563145423 , -667388610 , 2020083879 , -1134139204 , 2047830669 , -246514710 , -1274143645 , 52478536 , -312394839 , 1116560214 , -735346209 , -1639034220 , 293446789 , 125599618 , -793922277 , -1570282080 , -1298824927 , 443028590 , -2100301289 , 1105659756 , -1999803011 , 1754072602 , -396938029 , -1336474632 , -1529231975 , -687538042 , 1888368975 , -1810110652 ];    Rstream=struct;    Rstream.state = stateR12345;    Rstream.seed  = 12345;    rn = mtR(5,1,Rstream);    sprintf('%s %0.7f  ',m,rn)    sprintf('%s %0.7f  ',r,[0.5855288  0.7094660 -0.1093033 -0.4534972  0.6058875])%}%{    % The random stream in MATLAB format is returned as optional output.    [rn , streamM] = mtR(5,1,Rstream);%}%{    %% Simulation of multiple arrays of uniform random numbers.    % Both MATLAB and R code.    clear all; close all;    Rstring = ['EXECUTE THE FOLLOWING IN R TO INITIATE THE SIMULATION' char(10) char(10) ...    'RNGkind("Mersenne-Twister") # set "Mersenne-Twister" "Inversion"' char(10)...    'set.seed(12345)' char(10)...    'state = .Random.seed' char(10) ...    char(10)...    'runif(5)' char(10)...    'for (i in 1:1000) {' char(10)...    '    rn=runif(5) ' char(10)...    '    if (i==1000){print(rn)}' char(10)...    '}' char(10) ...    ];    disp(Rstring);    % MATLAB SIDE:    %    m = 'MATLAB: ';    r = 'R:      ';    % 5 random numbers from a uniform distribution in [0 1], seed 12345.    stateR12345 = [403 , 624 , 1638542565 , 108172386 , -1884566405 , -1838154368 , -250773631 , 919185230 , -1001918601 , -1002779316 , -321961507 , 1781331706 , 1166440499 , -117712936 , 58314745 , -938201242 , 1844978351 , -869947100 , 216221141 , 576699538 , 533687019 , 1819381040 , 675905393 , 2110048894 , 2136771815 , 1026265084 , -1037166387 , -285653718 , 1263109283 , -1975616120 , 1576168937 , -123742058 , 244715039 , 1526718932 , -1087137083 , 1442050242 , 676570459 , 800852192 , -823755935 , -566904402 , 1696695895 , 906100396 , 1479781309 , -321511590 , -1503089389 , 1068470072 , 2031323097 , 2053295558 , -749218417 , -2000861564 , 1655319477 , -768462606 , 262110155 , 399143056 , -983338159 , -1865452322 , -202515513 , 1164515676 , 80673453 , 1462142346 , 1143665027 , -1238758168 , 255598025 , 1584402166 , 1601468671 , -748103884 , 1964374181 , -656573150 , 1708781115 , -1898462144 , 469722945 , -888865778 , -807891657 , -53747700 , -1448147555 , -905087046 , -208186893 , 289994392 , -2104807495 , -895837146 , -1276970897 , -1949461532 , -133824107 , -327625390 , 1424620715 , -572587024 , 45700913 , -284602562 , 850959015 , -1739238724 , -1539126131 , -1167198742 , -713765277 , -1419293624 , -857752151 , 695563606 , -1621470241 , -2055832428 , 1623803525 , 4667778 , 276211483 , -593809504 , -1185922271 , -1144033682 , 1545929751 , -1359974036 , -1111928963 , -1511325670 , -867539245 , -979366408 , 1876477849 , 1515428486 , 777096015 , -961638076 , -2006005899 , -1471436366 , 1172761995 , -1584969904 , 2135108369 , 2097830302 , 24430983 , -498582500 , 453086829 , 1122473546 , -329311421 , 936262568 , 1691700617 , -515372106 , 452959935 , 947966452 , -1681554331 , 1229530594 , -1939746821 , 836651776 , -2083451135 , 992809166 , -1111561481 , -1899515188 , 751470941 , -1333348230 , -340137037 , 546100568 , 217337721 , 388352230 , 1029410351 , 1454915236 , 190610773 , 1220718098 , -724677013 , 832256688 , -705106191 , -345336834 , -2116392857 , 2073679228 , -1618788275 , -1498716502 , -1843275741 , -1791567096 , 555011433 , 1501549078 , -82028129 , -538978476 , 2072162885 , 1023099458 , -640456485 , -1820780960 , 1417267937 , -1615469778 , 73286103 , -1968593876 , 1264235325 , -1510432550 , 689823891 , 1374112952 , -1579825319 , 984164166 , -1212612337 , -2059232252 , -1270406347 , 485876338 , -1881661621 , 1223876112 , -1647140143 , -1228800418 , 832665415 , 1755455196 , 608166445 , 668034826 , -336263933 , 1769548392 , -946455223 , -1313552266 , 1147700351 , -1695839052 , -1854353371 , 1886752418 , -1794936389 , -230452800 , 4355777 , 201450894 , -1682241353 , 1022248332 , 702663965 , -833046214 , 2007909747 , -175672296 , -227201223 , 1249228198 , 1344398319 , -945444508 , -223954667 , 2147305170 , -1589878741 , -1905905296 , 1774732977 , 665360574 , -360581593 , 1505302588 , 1471116301 , -1804494998 , 990945763 , -965924408 , -1705927383 , 1434382038 , -677634209 , -1258556908 , -1423974907 , -2066740478 , -165025125 , 722844960 , 1478693537 , 1856575470 , 1267548055 , -336750868 , -1797794051 , -37813862 , -425518509 , 323308408 , 1053460249 , 404976646 , -1790036273 , -1086757180 , 1911766773 , -655303886 , -818736885 , -1798490928 , -925771119 , 1387684638 , -499915513 , -1422474852 , -1538656787 , 1185150922 , -592662845 , 703256872 , 1463741705 , -59357898 , 1903110719 , -1519843468 , -772809755 , 656586594 , -780217477 , 113744000 , 689151617 , -2109506994 , 931980919 , -1979738036 , 347394269 , -1807517190 , -1590403277 , 519623384 , 1120784121 , -1052089754 , -235538001 , 961926180 , 430224597 , -1696030830 , 2079601131 , -620763088 , 1172790897 , 411262334 , -1435548697 , 1702042364 , 814180301 , 612403242 , 1241590691 , 2110404744 , 945171689 , -1439511658 , -1432771297 , 260754644 , 1264634309 , 277189570 , -1757795237 , 976298976 , 1007426145 , -848753490 , -546177705 , -1250145876 , -302990659 , 2113806938 , -291892205 , -126219720 , 913770201 , -1350401850 , -1395577713 , 793964932 , 221452981 , 1157403634 , -1514683701 , -875148400 , 1744884305 , 631736286 , 820777671 , 1019618396 , -555759187 , -1608562550 , 407246979 , 400771048 , -208708407 , -1370717706 , -137129985 , -1028046284 , -1729452123 , 101752866 , 1402205499 , 1714052928 , 1443137089 , -1565405426 , 519341111 , -1195660532 , 553882781 , 856095418 , 839661811 , -341773928 , -843174215 , -1738289370 , -392704145 , -964116764 , -1407815531 , 1648670802 , -424295509 , -1104650512 , -1307167183 , -222633410 , -1084075609 , -1853366852 , 1305156493 , -1214760726 , -122456733 , -1173485752 , -1159562071 , -1537513386 , -1445664033 , -1169397868 , 2013623685 , -656679806 , -1362874853 , 395004576 , 938795553 , 548782446 , 768375575 , -1978286996 , 1785028221 , -1217002726 , -356332077 , -1337620232 , 949700249 , 2105953670 , -1543380401 , 1347370052 , -1849248139 , -1982264142 , 1965438091 , -187817392 , -1558214127 , -1001034594 , -74841977 , 1880114972 , -675193491 , -184329910 , -1199488445 , -1843235160 , 1011321993 , 1945599670 , -313150017 , 496778484 , -500616347 , 1711229154 , -318580997 , -953424384 , -1630196223 , 839705550 , -1615732233 , -874349108 , 1116608605 , -1687995526 , -1275735373 , 1782567000 , 587615865 , -1400767514 , -1178114769 , 1241409956 , -1782846379 , 1590792466 , 591467883 , -1633708624 , -1240150543 , -1425070338 , -417652889 , -1867030404 , -1824878771 , 1853401514 , 1088913187 , 972592648 , -1581872023 , 1354286358 , -888278881 , 1073791572 , 214819141 , -1768757950 , -293081125 , -639356576 , 1134389729 , -1924188626 , 1683798231 , -864424148 , -571096515 , -85548070 , 1155352467 , -1452816456 , -1258863015 , -1091642810 , -526362609 , 1559119620 , -881978827 , -1874442894 , 1597924939 , -696993520 , 1642987985 , -2088758946 , -540168633 , 1473587676 , 1387180333 , -972019190 , -1759630333 , -1217895064 , -1859683255 , -1170785418 , 666213247 , -1596852300 , 1768652581 , 1605284258 , 797669563 , -1601426240 , -616196671 , -1256933234 , -947585097 , -2043408244 , 756309021 , 2115517498 , 1890659443 , 1771400984 , -1838797255 , -1704662874 , -1421559057 , 1584845924 , -2108348395 , -649123374 , 861284139 , -1557820304 , 430122417 , -163566658 , -1621512921 , -708730052 , -1533689075 , 702667370 , -597866269 , 2085217480 , 747789353 , 2081087958 , -1006324129 , -345514732 , -1518727931 , -1033196030 , -934973029 , 1476122656 , 382054817 , -134911250 , 1893906071 , -1620516372 , -597563907 , 1494221978 , 648642899 , 312526456 , -615840231 , 1887184646 , -2006151729 , 1341133252 , 1172909557 , 17055282 , 1170233355 , -141946928 , 1277966737 , 2011657758 , 997661703 , -959132516 , -748174099 , 1409661642 , 1306318275 , 1718948904 , 300887049 , -1379157962 , 1018380607 , -149261708 , -1435399451 , -874587550 , 1827527291 , 688599936 , -1558856319 , 1888046414 , 1680727415 , 1785750348 , 1414946781 , 1273363706 , 1912489523 , 2019675608 , 731762169 , -1093888666 , -1026568017 , 1588723492 , -576576555 , -629308782 , -659228437 , -1300610256 , 1686191473 , 1225650302 , 635304679 , -1821989380 , -442714419 , -1970025686 , 1154798243 , -1077808248 , 1530260457 , -1290682730 , 175717407 , -951994412 , -1647707963 , -1792854334 , 1841083227 , 680672992 , 690862433 , 90726318 , 18773079 , -442329940 , -1184249411 , -1565383334 , 2045213459 , -625965768 , -1688828455 , 1324233670 , -2128182385 , -468411260 , 1291323829 , 1154676466 , -898889269 , -1630656880 , -912641711 , 1984666334 , 742803911 , 1338978140 , -1649633107 , -1616639094 , 914177923 , 1040745192 , -1637966903 , 997520630 , -2112968961 , -1959416524 , -520399195 , 1129300770 , -1226179525 , 1466497600 , 1308992833 , 1764401678 , 57441079 , -1151896052 , -334224483 , 898399674 , -2120409101 , -446370664 , -1100141127 , 913900070 , -970414481 , 1701833188 , -748494955 , 723295058 , -1793226069 , 1935522288 , -563145423 , -667388610 , 2020083879 , -1134139204 , 2047830669 , -246514710 , -1274143645 , 52478536 , -312394839 , 1116560214 , -735346209 , -1639034220 , 293446789 , 125599618 , -793922277 , -1570282080 , -1298824927 , 443028590 , -2100301289 , 1105659756 , -1999803011 , 1754072602 , -396938029 , -1336474632 , -1529231975 , -687538042 , 1888368975 , -1810110652 ];    Rstream=struct;    Rstream.state = stateR12345;    Rstream.seed  = 12345;    rn1 = mtR(5, 0, Rstream);    disp('Five random numbers generated in the first simulation step: ');    sprintf('%s %0.7f  ',m,rn1)    sprintf('%s %0.7f  ',r,[0.7209039 0.8757732 0.7609823 0.8861246 0.4564810])    % 1000 arrays of 5 random numbers from a uniform distribution in [0 1], seed 12345    for i=1:1000        rn2=mtR(5, 0, []);    end    disp('Five random numbers generated in the last of the 1000 simulation steps: ');    sprintf('%s %0.7f  ',m,rn2)    sprintf('%s %0.7f  ',r,[0.18089266 0.18878981 0.72700354 0.03062528 0.58466682])%}%{    %% Simulation of multiple arrays of normal random numbers.    % Both MATLAB and R code.    clear all; close all;    Rstring = ['EXECUTE THE FOLLOWING IN R TO INITIATE THE SIMULATION' char(10) char(10) ...    'RNGkind("Mersenne-Twister") # set "Mersenne-Twister" "Inversion"' char(10)...    'set.seed(12345)' char(10)...    'state = .Random.seed' char(10) ...    char(10)...    'rnorm(5)' char(10)...    'for (i in 1:1000) {' char(10)...    '    rn=rnorm(5) ' char(10)...    '    if (i==1000){print(rn)}' char(10)...    '}' char(10) ...    ];    disp(Rstring);    % MATLAB SIDE:    %    m = 'MATLAB: ';    r = 'R:      ';    % 5 random numbers from a normal distribution in [0 1], seed 12345.    stateR12345 = [403 , 624 , 1638542565 , 108172386 , -1884566405 , -1838154368 , -250773631 , 919185230 , -1001918601 , -1002779316 , -321961507 , 1781331706 , 1166440499 , -117712936 , 58314745 , -938201242 , 1844978351 , -869947100 , 216221141 , 576699538 , 533687019 , 1819381040 , 675905393 , 2110048894 , 2136771815 , 1026265084 , -1037166387 , -285653718 , 1263109283 , -1975616120 , 1576168937 , -123742058 , 244715039 , 1526718932 , -1087137083 , 1442050242 , 676570459 , 800852192 , -823755935 , -566904402 , 1696695895 , 906100396 , 1479781309 , -321511590 , -1503089389 , 1068470072 , 2031323097 , 2053295558 , -749218417 , -2000861564 , 1655319477 , -768462606 , 262110155 , 399143056 , -983338159 , -1865452322 , -202515513 , 1164515676 , 80673453 , 1462142346 , 1143665027 , -1238758168 , 255598025 , 1584402166 , 1601468671 , -748103884 , 1964374181 , -656573150 , 1708781115 , -1898462144 , 469722945 , -888865778 , -807891657 , -53747700 , -1448147555 , -905087046 , -208186893 , 289994392 , -2104807495 , -895837146 , -1276970897 , -1949461532 , -133824107 , -327625390 , 1424620715 , -572587024 , 45700913 , -284602562 , 850959015 , -1739238724 , -1539126131 , -1167198742 , -713765277 , -1419293624 , -857752151 , 695563606 , -1621470241 , -2055832428 , 1623803525 , 4667778 , 276211483 , -593809504 , -1185922271 , -1144033682 , 1545929751 , -1359974036 , -1111928963 , -1511325670 , -867539245 , -979366408 , 1876477849 , 1515428486 , 777096015 , -961638076 , -2006005899 , -1471436366 , 1172761995 , -1584969904 , 2135108369 , 2097830302 , 24430983 , -498582500 , 453086829 , 1122473546 , -329311421 , 936262568 , 1691700617 , -515372106 , 452959935 , 947966452 , -1681554331 , 1229530594 , -1939746821 , 836651776 , -2083451135 , 992809166 , -1111561481 , -1899515188 , 751470941 , -1333348230 , -340137037 , 546100568 , 217337721 , 388352230 , 1029410351 , 1454915236 , 190610773 , 1220718098 , -724677013 , 832256688 , -705106191 , -345336834 , -2116392857 , 2073679228 , -1618788275 , -1498716502 , -1843275741 , -1791567096 , 555011433 , 1501549078 , -82028129 , -538978476 , 2072162885 , 1023099458 , -640456485 , -1820780960 , 1417267937 , -1615469778 , 73286103 , -1968593876 , 1264235325 , -1510432550 , 689823891 , 1374112952 , -1579825319 , 984164166 , -1212612337 , -2059232252 , -1270406347 , 485876338 , -1881661621 , 1223876112 , -1647140143 , -1228800418 , 832665415 , 1755455196 , 608166445 , 668034826 , -336263933 , 1769548392 , -946455223 , -1313552266 , 1147700351 , -1695839052 , -1854353371 , 1886752418 , -1794936389 , -230452800 , 4355777 , 201450894 , -1682241353 , 1022248332 , 702663965 , -833046214 , 2007909747 , -175672296 , -227201223 , 1249228198 , 1344398319 , -945444508 , -223954667 , 2147305170 , -1589878741 , -1905905296 , 1774732977 , 665360574 , -360581593 , 1505302588 , 1471116301 , -1804494998 , 990945763 , -965924408 , -1705927383 , 1434382038 , -677634209 , -1258556908 , -1423974907 , -2066740478 , -165025125 , 722844960 , 1478693537 , 1856575470 , 1267548055 , -336750868 , -1797794051 , -37813862 , -425518509 , 323308408 , 1053460249 , 404976646 , -1790036273 , -1086757180 , 1911766773 , -655303886 , -818736885 , -1798490928 , -925771119 , 1387684638 , -499915513 , -1422474852 , -1538656787 , 1185150922 , -592662845 , 703256872 , 1463741705 , -59357898 , 1903110719 , -1519843468 , -772809755 , 656586594 , -780217477 , 113744000 , 689151617 , -2109506994 , 931980919 , -1979738036 , 347394269 , -1807517190 , -1590403277 , 519623384 , 1120784121 , -1052089754 , -235538001 , 961926180 , 430224597 , -1696030830 , 2079601131 , -620763088 , 1172790897 , 411262334 , -1435548697 , 1702042364 , 814180301 , 612403242 , 1241590691 , 2110404744 , 945171689 , -1439511658 , -1432771297 , 260754644 , 1264634309 , 277189570 , -1757795237 , 976298976 , 1007426145 , -848753490 , -546177705 , -1250145876 , -302990659 , 2113806938 , -291892205 , -126219720 , 913770201 , -1350401850 , -1395577713 , 793964932 , 221452981 , 1157403634 , -1514683701 , -875148400 , 1744884305 , 631736286 , 820777671 , 1019618396 , -555759187 , -1608562550 , 407246979 , 400771048 , -208708407 , -1370717706 , -137129985 , -1028046284 , -1729452123 , 101752866 , 1402205499 , 1714052928 , 1443137089 , -1565405426 , 519341111 , -1195660532 , 553882781 , 856095418 , 839661811 , -341773928 , -843174215 , -1738289370 , -392704145 , -964116764 , -1407815531 , 1648670802 , -424295509 , -1104650512 , -1307167183 , -222633410 , -1084075609 , -1853366852 , 1305156493 , -1214760726 , -122456733 , -1173485752 , -1159562071 , -1537513386 , -1445664033 , -1169397868 , 2013623685 , -656679806 , -1362874853 , 395004576 , 938795553 , 548782446 , 768375575 , -1978286996 , 1785028221 , -1217002726 , -356332077 , -1337620232 , 949700249 , 2105953670 , -1543380401 , 1347370052 , -1849248139 , -1982264142 , 1965438091 , -187817392 , -1558214127 , -1001034594 , -74841977 , 1880114972 , -675193491 , -184329910 , -1199488445 , -1843235160 , 1011321993 , 1945599670 , -313150017 , 496778484 , -500616347 , 1711229154 , -318580997 , -953424384 , -1630196223 , 839705550 , -1615732233 , -874349108 , 1116608605 , -1687995526 , -1275735373 , 1782567000 , 587615865 , -1400767514 , -1178114769 , 1241409956 , -1782846379 , 1590792466 , 591467883 , -1633708624 , -1240150543 , -1425070338 , -417652889 , -1867030404 , -1824878771 , 1853401514 , 1088913187 , 972592648 , -1581872023 , 1354286358 , -888278881 , 1073791572 , 214819141 , -1768757950 , -293081125 , -639356576 , 1134389729 , -1924188626 , 1683798231 , -864424148 , -571096515 , -85548070 , 1155352467 , -1452816456 , -1258863015 , -1091642810 , -526362609 , 1559119620 , -881978827 , -1874442894 , 1597924939 , -696993520 , 1642987985 , -2088758946 , -540168633 , 1473587676 , 1387180333 , -972019190 , -1759630333 , -1217895064 , -1859683255 , -1170785418 , 666213247 , -1596852300 , 1768652581 , 1605284258 , 797669563 , -1601426240 , -616196671 , -1256933234 , -947585097 , -2043408244 , 756309021 , 2115517498 , 1890659443 , 1771400984 , -1838797255 , -1704662874 , -1421559057 , 1584845924 , -2108348395 , -649123374 , 861284139 , -1557820304 , 430122417 , -163566658 , -1621512921 , -708730052 , -1533689075 , 702667370 , -597866269 , 2085217480 , 747789353 , 2081087958 , -1006324129 , -345514732 , -1518727931 , -1033196030 , -934973029 , 1476122656 , 382054817 , -134911250 , 1893906071 , -1620516372 , -597563907 , 1494221978 , 648642899 , 312526456 , -615840231 , 1887184646 , -2006151729 , 1341133252 , 1172909557 , 17055282 , 1170233355 , -141946928 , 1277966737 , 2011657758 , 997661703 , -959132516 , -748174099 , 1409661642 , 1306318275 , 1718948904 , 300887049 , -1379157962 , 1018380607 , -149261708 , -1435399451 , -874587550 , 1827527291 , 688599936 , -1558856319 , 1888046414 , 1680727415 , 1785750348 , 1414946781 , 1273363706 , 1912489523 , 2019675608 , 731762169 , -1093888666 , -1026568017 , 1588723492 , -576576555 , -629308782 , -659228437 , -1300610256 , 1686191473 , 1225650302 , 635304679 , -1821989380 , -442714419 , -1970025686 , 1154798243 , -1077808248 , 1530260457 , -1290682730 , 175717407 , -951994412 , -1647707963 , -1792854334 , 1841083227 , 680672992 , 690862433 , 90726318 , 18773079 , -442329940 , -1184249411 , -1565383334 , 2045213459 , -625965768 , -1688828455 , 1324233670 , -2128182385 , -468411260 , 1291323829 , 1154676466 , -898889269 , -1630656880 , -912641711 , 1984666334 , 742803911 , 1338978140 , -1649633107 , -1616639094 , 914177923 , 1040745192 , -1637966903 , 997520630 , -2112968961 , -1959416524 , -520399195 , 1129300770 , -1226179525 , 1466497600 , 1308992833 , 1764401678 , 57441079 , -1151896052 , -334224483 , 898399674 , -2120409101 , -446370664 , -1100141127 , 913900070 , -970414481 , 1701833188 , -748494955 , 723295058 , -1793226069 , 1935522288 , -563145423 , -667388610 , 2020083879 , -1134139204 , 2047830669 , -246514710 , -1274143645 , 52478536 , -312394839 , 1116560214 , -735346209 , -1639034220 , 293446789 , 125599618 , -793922277 , -1570282080 , -1298824927 , 443028590 , -2100301289 , 1105659756 , -1999803011 , 1754072602 , -396938029 , -1336474632 , -1529231975 , -687538042 , 1888368975 , -1810110652 ];    Rstream=struct;    Rstream.state = stateR12345;    Rstream.seed  = 12345;    disp('Five random numbers generated in the first simulation step: ');    rn1 = mtR(5, 1, Rstream);    sprintf('%s %0.7f  ',m,rn1)    sprintf('%s %0.7f  ',r,[0.5855288  0.7094660 -0.1093033 -0.4534972  0.6058875])    % 1000 arrays of 5 random numbers from a normal distribution in [0 1], seed 12345    for i=1:1000        rn2=mtR(5, 1, []);    end    disp('Five random numbers generated in the last of the 1000 simulation steps: ');    sprintf('%s %0.7f  ',m,rn2)    sprintf('%s %0.7f  ',r,[-0.6924722  1.1246956  0.1745351 -1.9678067 -1.6442717])%}%{    %% Simulation of multiple arrays of normal and uniform random numbers, using mtR, randn and rand.    % Both MATLAB and R code.    clear all; close all;    Rstring = ['EXECUTE THE FOLLOWING IN R TO INITIATE THE SIMULATION' char(10) char(10) ...    'RNGkind("Mersenne-Twister") # set "Mersenne-Twister" "Inversion"' char(10)...    'set.seed(12345)' char(10)...    'state = .Random.seed' char(10) ...    char(10)...    'rnorm(5)' char(10)...    'for (i in 1:1000) {' char(10)...    '    rn=rnorm(5) ' char(10)...    '    if (i==1000){print(rn)}' char(10)...    '}' char(10) ...    ];    disp(Rstring);    % MATLAB SIDE:    %    m = 'MATLAB: ';    r = 'R:      ';    % 5 random numbers from a normal distribution in [0 1], seed 12345.    stateR12345 = [403 , 624 , 1638542565 , 108172386 , -1884566405 , -1838154368 , -250773631 , 919185230 , -1001918601 , -1002779316 , -321961507 , 1781331706 , 1166440499 , -117712936 , 58314745 , -938201242 , 1844978351 , -869947100 , 216221141 , 576699538 , 533687019 , 1819381040 , 675905393 , 2110048894 , 2136771815 , 1026265084 , -1037166387 , -285653718 , 1263109283 , -1975616120 , 1576168937 , -123742058 , 244715039 , 1526718932 , -1087137083 , 1442050242 , 676570459 , 800852192 , -823755935 , -566904402 , 1696695895 , 906100396 , 1479781309 , -321511590 , -1503089389 , 1068470072 , 2031323097 , 2053295558 , -749218417 , -2000861564 , 1655319477 , -768462606 , 262110155 , 399143056 , -983338159 , -1865452322 , -202515513 , 1164515676 , 80673453 , 1462142346 , 1143665027 , -1238758168 , 255598025 , 1584402166 , 1601468671 , -748103884 , 1964374181 , -656573150 , 1708781115 , -1898462144 , 469722945 , -888865778 , -807891657 , -53747700 , -1448147555 , -905087046 , -208186893 , 289994392 , -2104807495 , -895837146 , -1276970897 , -1949461532 , -133824107 , -327625390 , 1424620715 , -572587024 , 45700913 , -284602562 , 850959015 , -1739238724 , -1539126131 , -1167198742 , -713765277 , -1419293624 , -857752151 , 695563606 , -1621470241 , -2055832428 , 1623803525 , 4667778 , 276211483 , -593809504 , -1185922271 , -1144033682 , 1545929751 , -1359974036 , -1111928963 , -1511325670 , -867539245 , -979366408 , 1876477849 , 1515428486 , 777096015 , -961638076 , -2006005899 , -1471436366 , 1172761995 , -1584969904 , 2135108369 , 2097830302 , 24430983 , -498582500 , 453086829 , 1122473546 , -329311421 , 936262568 , 1691700617 , -515372106 , 452959935 , 947966452 , -1681554331 , 1229530594 , -1939746821 , 836651776 , -2083451135 , 992809166 , -1111561481 , -1899515188 , 751470941 , -1333348230 , -340137037 , 546100568 , 217337721 , 388352230 , 1029410351 , 1454915236 , 190610773 , 1220718098 , -724677013 , 832256688 , -705106191 , -345336834 , -2116392857 , 2073679228 , -1618788275 , -1498716502 , -1843275741 , -1791567096 , 555011433 , 1501549078 , -82028129 , -538978476 , 2072162885 , 1023099458 , -640456485 , -1820780960 , 1417267937 , -1615469778 , 73286103 , -1968593876 , 1264235325 , -1510432550 , 689823891 , 1374112952 , -1579825319 , 984164166 , -1212612337 , -2059232252 , -1270406347 , 485876338 , -1881661621 , 1223876112 , -1647140143 , -1228800418 , 832665415 , 1755455196 , 608166445 , 668034826 , -336263933 , 1769548392 , -946455223 , -1313552266 , 1147700351 , -1695839052 , -1854353371 , 1886752418 , -1794936389 , -230452800 , 4355777 , 201450894 , -1682241353 , 1022248332 , 702663965 , -833046214 , 2007909747 , -175672296 , -227201223 , 1249228198 , 1344398319 , -945444508 , -223954667 , 2147305170 , -1589878741 , -1905905296 , 1774732977 , 665360574 , -360581593 , 1505302588 , 1471116301 , -1804494998 , 990945763 , -965924408 , -1705927383 , 1434382038 , -677634209 , -1258556908 , -1423974907 , -2066740478 , -165025125 , 722844960 , 1478693537 , 1856575470 , 1267548055 , -336750868 , -1797794051 , -37813862 , -425518509 , 323308408 , 1053460249 , 404976646 , -1790036273 , -1086757180 , 1911766773 , -655303886 , -818736885 , -1798490928 , -925771119 , 1387684638 , -499915513 , -1422474852 , -1538656787 , 1185150922 , -592662845 , 703256872 , 1463741705 , -59357898 , 1903110719 , -1519843468 , -772809755 , 656586594 , -780217477 , 113744000 , 689151617 , -2109506994 , 931980919 , -1979738036 , 347394269 , -1807517190 , -1590403277 , 519623384 , 1120784121 , -1052089754 , -235538001 , 961926180 , 430224597 , -1696030830 , 2079601131 , -620763088 , 1172790897 , 411262334 , -1435548697 , 1702042364 , 814180301 , 612403242 , 1241590691 , 2110404744 , 945171689 , -1439511658 , -1432771297 , 260754644 , 1264634309 , 277189570 , -1757795237 , 976298976 , 1007426145 , -848753490 , -546177705 , -1250145876 , -302990659 , 2113806938 , -291892205 , -126219720 , 913770201 , -1350401850 , -1395577713 , 793964932 , 221452981 , 1157403634 , -1514683701 , -875148400 , 1744884305 , 631736286 , 820777671 , 1019618396 , -555759187 , -1608562550 , 407246979 , 400771048 , -208708407 , -1370717706 , -137129985 , -1028046284 , -1729452123 , 101752866 , 1402205499 , 1714052928 , 1443137089 , -1565405426 , 519341111 , -1195660532 , 553882781 , 856095418 , 839661811 , -341773928 , -843174215 , -1738289370 , -392704145 , -964116764 , -1407815531 , 1648670802 , -424295509 , -1104650512 , -1307167183 , -222633410 , -1084075609 , -1853366852 , 1305156493 , -1214760726 , -122456733 , -1173485752 , -1159562071 , -1537513386 , -1445664033 , -1169397868 , 2013623685 , -656679806 , -1362874853 , 395004576 , 938795553 , 548782446 , 768375575 , -1978286996 , 1785028221 , -1217002726 , -356332077 , -1337620232 , 949700249 , 2105953670 , -1543380401 , 1347370052 , -1849248139 , -1982264142 , 1965438091 , -187817392 , -1558214127 , -1001034594 , -74841977 , 1880114972 , -675193491 , -184329910 , -1199488445 , -1843235160 , 1011321993 , 1945599670 , -313150017 , 496778484 , -500616347 , 1711229154 , -318580997 , -953424384 , -1630196223 , 839705550 , -1615732233 , -874349108 , 1116608605 , -1687995526 , -1275735373 , 1782567000 , 587615865 , -1400767514 , -1178114769 , 1241409956 , -1782846379 , 1590792466 , 591467883 , -1633708624 , -1240150543 , -1425070338 , -417652889 , -1867030404 , -1824878771 , 1853401514 , 1088913187 , 972592648 , -1581872023 , 1354286358 , -888278881 , 1073791572 , 214819141 , -1768757950 , -293081125 , -639356576 , 1134389729 , -1924188626 , 1683798231 , -864424148 , -571096515 , -85548070 , 1155352467 , -1452816456 , -1258863015 , -1091642810 , -526362609 , 1559119620 , -881978827 , -1874442894 , 1597924939 , -696993520 , 1642987985 , -2088758946 , -540168633 , 1473587676 , 1387180333 , -972019190 , -1759630333 , -1217895064 , -1859683255 , -1170785418 , 666213247 , -1596852300 , 1768652581 , 1605284258 , 797669563 , -1601426240 , -616196671 , -1256933234 , -947585097 , -2043408244 , 756309021 , 2115517498 , 1890659443 , 1771400984 , -1838797255 , -1704662874 , -1421559057 , 1584845924 , -2108348395 , -649123374 , 861284139 , -1557820304 , 430122417 , -163566658 , -1621512921 , -708730052 , -1533689075 , 702667370 , -597866269 , 2085217480 , 747789353 , 2081087958 , -1006324129 , -345514732 , -1518727931 , -1033196030 , -934973029 , 1476122656 , 382054817 , -134911250 , 1893906071 , -1620516372 , -597563907 , 1494221978 , 648642899 , 312526456 , -615840231 , 1887184646 , -2006151729 , 1341133252 , 1172909557 , 17055282 , 1170233355 , -141946928 , 1277966737 , 2011657758 , 997661703 , -959132516 , -748174099 , 1409661642 , 1306318275 , 1718948904 , 300887049 , -1379157962 , 1018380607 , -149261708 , -1435399451 , -874587550 , 1827527291 , 688599936 , -1558856319 , 1888046414 , 1680727415 , 1785750348 , 1414946781 , 1273363706 , 1912489523 , 2019675608 , 731762169 , -1093888666 , -1026568017 , 1588723492 , -576576555 , -629308782 , -659228437 , -1300610256 , 1686191473 , 1225650302 , 635304679 , -1821989380 , -442714419 , -1970025686 , 1154798243 , -1077808248 , 1530260457 , -1290682730 , 175717407 , -951994412 , -1647707963 , -1792854334 , 1841083227 , 680672992 , 690862433 , 90726318 , 18773079 , -442329940 , -1184249411 , -1565383334 , 2045213459 , -625965768 , -1688828455 , 1324233670 , -2128182385 , -468411260 , 1291323829 , 1154676466 , -898889269 , -1630656880 , -912641711 , 1984666334 , 742803911 , 1338978140 , -1649633107 , -1616639094 , 914177923 , 1040745192 , -1637966903 , 997520630 , -2112968961 , -1959416524 , -520399195 , 1129300770 , -1226179525 , 1466497600 , 1308992833 , 1764401678 , 57441079 , -1151896052 , -334224483 , 898399674 , -2120409101 , -446370664 , -1100141127 , 913900070 , -970414481 , 1701833188 , -748494955 , 723295058 , -1793226069 , 1935522288 , -563145423 , -667388610 , 2020083879 , -1134139204 , 2047830669 , -246514710 , -1274143645 , 52478536 , -312394839 , 1116560214 , -735346209 , -1639034220 , 293446789 , 125599618 , -793922277 , -1570282080 , -1298824927 , 443028590 , -2100301289 , 1105659756 , -1999803011 , 1754072602 , -396938029 , -1336474632 , -1529231975 , -687538042 , 1888368975 , -1810110652 ];    Rstream=struct;    Rstream.state = stateR12345;    Rstream.seed  = 12345;    disp('Five random numbers generated in the first simulation step: ');    disp('This is done with mtR to ensure same stream ');    rn1 = mtR(5, 1, Rstream);    sprintf('%s %0.7f  ',m,rn1)    sprintf('%s %0.7f  ',r,[0.5855288  0.7094660 -0.1093033 -0.4534972  0.6058875])%}    % 1000 arrays of 5 uniform random numbers generated using rand function    disp('Now 1000 arrays of 5 uniform random numbers generated using rand function');    disp('REMARK: for uniform numbers FullPrecision must be false ');    current_stream = RandStream.getGlobalStream();    set(current_stream, 'FullPrecision' , false);    for i=1:1000        rn2=rand(5, 1);    end    disp('The five random numbers generated in the last of the 1000 simulation steps: ');    sprintf('%s %0.7f  ',m,rn2)    sprintf('%s %0.7f  ',r,[0.7500169  8.368954e-02 0.7349870  2.120063e-01 0.3928435])    disp('Now, another five random numbers generated now with randn function. ');    disp('REMARK: for normal numbers FullPrecision must be true ');    set(current_stream, 'FullPrecision' , true);    rn3=randn(5, 1);    sprintf('%s %0.7f  ',m,rn3)    sprintf('%s %0.7f  ',r,[0.5170759  0.0359742 -0.3792091 -0.5749569  0.7409261])%}%% Beginning of code% Defaults for optional arguments%   To reach best performance in benchmarks and simulation experiment, the%   function does not use optional arguments in the Name,Value pair form.if nargin<3 || (nargin==3 && isscalar(Rstream) && ~isstruct(Rstream) && Rstream == 0)    % We take as default the random stream generated in R with a seed equal    % to 0 (which is the default also in R). In R this is achieved with:    % set.seed(0)    % statedef = .Random.seed    Rstatedef = [403, 624 , 1280795612 , -169270483 , -442010614 , -603558397 , -222347416 , 1489374793 , 865871222 , 1734802815 , 98005428 , 268448037 , 63650722 , -1754793285 , -2135275840 , -779982911 , -864886130 , 1880007095 , 463784588 , 1271615005 , 1390544442 , -544608653 , -251475688 , -326549447 , -1570483546 , 1965989103 , -784675228 , 1458985493 , 2146317266 , -1103943381 , 289023600 , -436963407 , 109630910 , 69979943 , 1606475068 , 1441346829 , -662821782 , -381252893 , -311574840 , 1918496297 , 289721302 , 507975775 , -209037548 , 1665646341 , -466864126 , 776139675 , 1704391200 , -162823263 , -1815571218 , 471685271 , 1503042540 , -9316355 , 773770906 , 1304642387 , 1931157624 , -1378412519 , 965775622 , 19361743 , 1561398212 , 1879269365 , 1049118770 , 1191074315 , 508275152 , -1006204015 , -639295458 , 1060781575 , -724498788 , 257177325 , -1004075830 , 323426243 , 602271272 , 1516224009 , -111500746 , -368663745 , 1624894580 , -1946665755 , -305830814 , -779330437 , 1251167616 , -2140893311 , 2068936526 , 1520009079 , -673505972 , 406802909 , -205928710 , 1641613363 , 1751721944 , 454221817 , -2089418906 , 1121694383 , 1689254180 , -1984604715 , -781808494 , 1892940523 , 409525552 , -1134260367 , -2025809282 , 823270631 , 1407180796 , 1755457741 , 783947050 , -213904221 , 536857992 , 1791983081 , -1888114538 , -2091016673 , -1860292140 , -276190523 , 2041495746 , 293352795 , -2071504672 , 1489341281 , -1448769106 , -885320105 , -724939092 , -89408579 , 801828698 , -2096939757 , 1355079480 , -1942710311 , -1985176122 , -1593612913 , -2123393404 , -410764363 , 1470169330 , 1508641739 , 174702736 , 1980138321 , 1530086622 , -412390457 , 826632540 , 1682639533 , 709842314 , 1047101827 , -678208280 , 2040606153 , -1020403978 , 2130970879 , -206624972 , 796133541 , -318747358 , 441089595 , 1414206528 , 1684436801 , 291294222 , 1773804855 , 985411596 , -953215587 , -93698118 , 880402931 , 403064472 , -717996103 , -1580438490 , 1582729327 , 2024268772 , 149426581 , -61889198 , -1132557141 , -349809680 , -1813747919 , 1851072318 , -872535385 , 1834590908 , -1060709235 , 1425982954 , -973382045 , -1401381816 , -657666647 , -803519146 , 1303503839 , 602197140 , 690968197 , -1194194558 , -1271974117 , -424247392 , -2076224735 , 1896824430 , -1915841513 , -1610038932 , 1514233725 , -139472870 , 359986899 , 369450488 , 1175050137 , 1835887238 , -1718805681 , 1001447748 , -1453795467 , -158697038 , -289178229 , -1653172400 , -1258931439 , -1522652770 , -1534961273 , -1267430372 , -124936595 , -656382390 , 1999481667 , 1820822440 , 1447714185 , 1037425590 , 1008676543 , -384359948 , -164391835 , 1513879010 , 1130520571 , 1419877120 , -1790435583 , 1398071502 , -349144329 , 1191707340 , 1281005917 , 1471383674 , -517178445 , 244983128 , -1431478407 , -634939162 , 1298079279 , -404582748 , -1068593835 , -1989575150 , -487399829 , -265123152 , 1949564657 , -1333369858 , -1833961369 , 1592665468 , 1108824141 , 1812739754 , 1530423331 , 1368926984 , 1007803753 , -537550314 , 1929636255 , 916334420 , -336018875 , 1515590210 , -937690917 , -1562089888 , 1886968545 , 247837486 , -1852321321 , 504493100 , -235748547 , -695373606 , 1859678355 , 832347320 , 1259788121 , 563279686 , 1350865167 , -963318780 , -2126433483 , 67416690 , 658812747 , -1640878576 , 1754641105 , 214290014 , 339674951 , 1897819868 , -1881411027 , 1352283914 , -1756130045 , 25328232 , 1343966537 , -703424394 , -149416833 , 735173812 , -1678319579 , 1312317090 , -560725573 , -1034493504 , -355891519 , -973490802 , -323184457 , -1082223220 , 1535237405 , -1135244998 , -1313811085 , 451200024 , -348242119 , -918059610 , 1437955055 , 1293941092 , 1537788181 , -1049356590 , -437194709 , 1313702256 , 622024369 , 43280574 , 48727591 , -1688377284 , -1873574899 , 1419929450 , 1823945187 , -1910605368 , -731992791 , -1950040362 , -1458327713 , 336216596 , -744100347 , -688203006 , -1090356581 , -1882125024 , -718134623 , 1737025518 , -1000943721 , 1906697964 , 1434445565 , -584855142 , -1192383917 , -766862472 , -887384295 , -1562557434 , -341195057 , 484161220 , -84062475 , 684698418 , -449863413 , -1822653232 , 950332049 , -1500892386 , -1805552377 , 973279644 , -1376385555 , -767768630 , 949698243 , 1967401256 , -2032927479 , -1197206218 , 1169078847 , 1721718644 , -1669469211 , -1581938846 , 1033855867 , -735385472 , -55923071 , -1374991794 , 1008629367 , 652208204 , 1751441629 , -1726985734 , -1345917133 , -878304552 , -1499013383 , -873713050 , 2098825647 , 52438052 , 1186383061 , -1389400174 , -2026323477 , -331925456 , 776105585 , -650171010 , 1516557287 , 1432840956 , 255555533 , -1350477782 , 1949809571 , -1597273976 , -1586283287 , 1615371158 , 1705063711 , -957801260 , 1006033349 , 1736467394 , -895304613 , 1144812512 , 707471969 , 538500270 , -741634729 , 2105842092 , -660026691 , -600640934 , -579558381 , -422618568 , -1244129575 , -1374924602 , 1354546319 , -112901756 , 1649224373 , -844405774 , -901492021 , -1011508336 , -1931222447 , 1196120030 , 1118413511 , -1578994596 , -1768171091 , 1585977482 , -1262180221 , 1720489960 , -634098487 , -766881290 , 2107842559 , 71275060 , 864597925 , -311201758 , 1917093179 , -2132955328 , 581670465 , 273260302 , 1729500215 , -1075053812 , -1497127779 , 514050746 , -1523660557 , 1872642456 , -1398325575 , -19554522 , -1991549073 , 614665956 , -1388805995 , 358320210 , 1217024939 , 1890561776 , -679393743 , 1766240830 , -1763188313 , 2144087484 , -493933683 , -580318998 , -1418066589 , -2007017656 , 1661963433 , -1438566314 , -563316001 , 435861396 , 1084982661 , 78032002 , -591610341 , 384211616 , -1490816479 , -1657433746 , 766905111 , -462549908 , -1892848003 , 1685771034 , -2043847213 , 501930232 , -1156819303 , -1075831418 , 628978255 , -695104444 , -1024407947 , 458742962 , 943899787 , 905802320 , -1928160751 , -2083963746 , -52981625 , -75720932 , 1301114221 , -1237571254 , 630182467 , 874235560 , -369320823 , -809152842 , -1263188545 , 796036340 , 1557611365 , -1976428318 , 1313040123 , 2133800448 , 1955347969 , -1317751858 , -1151110665 , -1922904628 , 173942877 , 1037044602 , 464020147 , 361570392 , -1929421191 , 1053019110 , 718127 , -1939293788 , 2062416981 , -2101845742 , 1806017899 , 1115088304 , 680517105 , -1486162178 , 1982902119 , -850677636 , -301031603 , -15107670 , 205393699 , 60417544 , -1728865175 , 1986958614 , 154501279 , -1744891308 , -1115426491 , 1731048770 , -1492090917 , 512721248 , 1138522593 , 60753454 , -2733865 , 153239340 , 1288557117 , -960793638 , 483907475 , -430106696 , 1249400409 , 353937990 , -810817521 , -276785404 , -391634379 , -90892942 , 1357575755 , -1326184176 , 552669649 , -1329340066 , 1621835335 , 1502706140 , -1769291475 , 1511586314 , 1690090499 , -55462552 , 367823945 , 500501366 , -1062917249 , -755480652 , -735473883 , -1867415134 , 1666975931 , 1172274368 , -905140799 , 374114446 , 1187418039 , 1376018572 , 1190423581 , -1487598534 , 1559477363 , -1942831336 , -1754317255 , 678869158 , 655903471 , -718199708 , 1536636949 , 1040579026 , -229984469 , -2008228752 , -382847567 , 1215036350 , 1979661607 , -1331301572 , -713436403 , -179131798 , 1346623715 , -1858390840 , -2099286999 , -1852788266 , -1682160033 , -1950995180 , 1312824581 , 131431938 , -1688338021 , 838281248 , -1206599263 , 940915438 , 938231447 , 241250796 , -1521879555 , 330618010 , -885780141 , 1860572792 , -1814292967 , -1435109626 , 1963466191 , 1053974980 , 1597193717 , 337841714 , -167974901 , -1151770672 , -264287855 , -486848994 , -874206201 , -1897849700 , -179055379 , -1965126966 , 202073539 , -1626446808 , 2110012425 , -382105546 , 926077247 , -1718566284 , 356489957 , -642667934 , 55470715 , 195986304 , -1158886015 , -2087641778 , -687903369 , -1869565108 , -800690211 , -873280262 , 1926288947 , 1649352152 , -608772615 , 414082406 , 70475951 , 1505513252 , -1158401067 , 1342460562 , -1640396565 , 686920496 , -1591980687 , -1056325506 , -736916761 , 1553659388 , -57620787 , 1624546090 , -246717789 , 1879262088 , 546503657 , -2006479210 , 197184543 , -2095148 , 1319110853 , 526255810 , -345685157 , -404910368 , 2072824161 , -547868754 , -2085092265];    Rstatedef = int32(Rstatedef(:));    Rstream=struct;    Rstream.state = Rstatedef;    Rstream.seed = 0;endif nargin<3 || isempty(Rstream)    % Empty seed and empty state mean that we keep the current MATLAB status     seed = [];endif ~isempty(Rstream) && isstruct(Rstream)    state = Rstream.state ; state = state(:);    seed  = Rstream.seed ;    if isempty(Rstream.seed) || Rstream.seed<0 || ~(floor(Rstream.seed)==Rstream.seed)        error('FSDA:mtR:WrongSeed','seed must be a positive scalar');    endendif nargin<2 || isempty(distrib)    % the default distribution is the uniform, i.e.     distrib=0;endif nargin<1 || isempty(n)    % the default is to return a single random number    n=1;endif length(distrib)==3    % set the parameters of the uniform/normal distribution, a and b    % reset distrib to be the distribution type    a = distrib(2);    b = distrib(3);    distrib = distrib(1);    drescale = true;else    % in this case distrib contains only the distribution type scalar    drescale = false;end%% state of the random streamif ~isempty(seed)    % get rid of the first code, which stands for the RNG algorithm    state = state(2:end);    % reshuffle the state in the standard MATLAB form    state = [state(2:end) ; state(1)];    % recast the state to unsigned integers, as in the MATLAB generator    state = typecast(int32(state),'uint32');    % Set the random number generator type and its seed. Note that line below,    % with seed = 0, is equivalent to "rng default".    rng(seed,'twister');    % returns in st the current global random number stream    Mstream                  = RandStream.getGlobalStream();    % set the state to that received from R    Mstream.State            = state;    % set the transformation type    Mstream.NormalTransform  = 'inversion';else    Mstream                  = RandStream.getGlobalStream();    Mstream.NormalTransform  = 'inversion';end%% return uniform/normal random numbersif distrib == 0    % FullPrecision must be FALSE for uniformely distributed numbers.    Mstream.FullPrecision = false;    rn = rand(n,1);        if drescale        % we generate n random numbers in the interval (a,b) with:        % r = a + (b-a).*rand(n,1).        rn = a + (b-a).*rn;    end    else    % FullPrecision must be TRUE for normally distributed numbers.    Mstream.FullPrecision = true;    rn = randn(n,1);        if drescale        % we generate n random numbers with mean a and variance b with:        % r = b.*randn(n,1) + a        rn = b.*rn + a;    endend%% optional output% the random stream in MATLAB formif nargout == 2    varargout = {state};endend