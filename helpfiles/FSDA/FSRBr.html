<!DOCTYPE HTML> <html itemscope="" xmlns="http://www.w3.org/1999/xhtml"><head><title>FSRBr</title><meta content="refpage" name="chunktype"><meta content="function:FSRBr" itemprop="refentity" name="refentity"><link href="includesFS/bootstrap.min.css" rel="stylesheet" type="text/css"><meta content="text/javascript" http-equiv="Content-Script-Type"><meta content="fcn" itemprop="pagetype" name="toctype"><meta content="ref/function" itemprop="infotype" name="infotype" /><meta content="Bayesian forward search in linear regression reweighted." itemprop="description" name="description" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" /><script type="text/x-mathjax-config">MathJax.Hub.Config({extensions: ["tex2jax.js"],jax: ["input/TeX","output/HTML-CSS"],menuSettings: {zoom: "Double-Click", zscale: "300"},tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},MathMenu: {showRenderer: false},"HTML-CSS": {availableFonts: ["TeX"],preferredFont: "TeX",imageFont: null}});</script><script type="text/javascript" src="includesFS/Mathjax/MathJax.js"></script><script src="includesFS/matlab-highlighter.min.js"></script><link href="includesFS/matlab-highlighter.css" rel="stylesheet" type="text/css"><script type="text/javascript" src="includesFS/jquery-latest.js"></script><script>$(document).ready(function(){      $("#div002").load("includesFS/top.html");      $("#div001").load("includesFS/bottom.html");});</script><script src="includesFS/jquery-latest.js" type="text/javascript"></script><link href="includesFS/site6.css?201505100807" rel="stylesheet" type="text/css"><link href="includesFS/site6_lg.css?201505100807" media="screen and (min-width: 1200px)" rel="stylesheet"><link href="includesFS/site6_md.css?201505100807" media="screen and (min-width: 992px) and (max-width: 1199px)" rel="stylesheet"><link href="includesFS/site6_sm+xs.css?201505100807" media="screen and (max-width: 991px)" rel="stylesheet"><link href="includesFS/site6_sm.css?201505100807" media="screen and (min-width: 768px) and (max-width: 991px)" rel="stylesheet"><link href="includesFS/site6_xs.css?201505100807" media="screen and (max-width: 767px)" rel="stylesheet"><link href="includesFS/site6_offcanvas.css?201505100807" rel="stylesheet" type="text/css"><script src="includesFS/l10n.js" type="text/javascript"></script><script src="includesFS/SHAREDdocscripts.js"></script><script src="includesFS/PRODUCTdocscripts.js"></script><script src="includesFS/mw.toc.js" type="text/javascript"></script><script src="includesFS/mw.imagescaling.js" type="text/javascript"></script><script src="includesFS/mw.imageanimation.js" type="text/javascript"></script><script src="includesFS/jquery.highlight.js"></script><script src="includesFS/bootstrap.min.js" type="text/javascript"></script><script src="includesFS/global.js"></script><script src="includesFS/bottom.js" type="text/javascript"></script><script src="includesFS/suggest.js" type="text/javascript"></script><script src="includesFS/underscore-min.js"></script><link href="includesFS/reset.css" rel="stylesheet" type="text/css"><link href="includesFS/960.css" rel="stylesheet" type="text/css"><link href="includesFS/doc_center.css" rel="stylesheet" type="text/css"><link href="includesFS/doc_center_installed.css" rel="stylesheet" type="text/css"><link href="includesFS/doc_center.css" rel="stylesheet" type="text/css"><link href="includesFS/doc_center_installed.css" rel="stylesheet" type="text/css"><link href="includes/product/css/doc_center_print.css" media="print" rel="stylesheet" type="text/css"></head><body  onload="highlightMATLABCode();" id="responsive_offcanvas"><div class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-xs-12 col-sm-6 col-sm-push-6 col-md-5 col-md-push-7" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2016a" data-language="en" action="../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="sr-only">Search Documentation</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Documentation" id="docsearch"><div class="input-group-btn"><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search pull-right icon_32 visible-xs" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="col-sm-6 col-sm-pull-6 col-md-7 col-md-pull-5" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../documentation-center.html">Documentation</a></h1></div></div></div><div class="visible-xs" id="search_actuator"><button class="btn icon-search btn_search pull-right icon_16" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div><!--END.CLASS row--></div><!--END.CLASS container-fluid--></div><!--START.CLASS sticky_header_container--><div class="sticky_header_container includes_subnav"><div class="horizontal_nav_container"><div id="nav_toggle" class="offcanvas_actuator" data-target="#sidebar" data-toggle="offcanvas"><button class="btn" type="button"><span class="sr-only">Toggle navigation</span><span class="icon-menu icon_32"></span></button><span class="offcanvas_actuator_label"></span><span class="offcanvas_actuator_close"></span></div><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"></div></div></div></div></div><div class="row-offcanvas row-offcanvas-left"><div id="sidebar" class="sidebar-offcanvas" role="navigation"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" xmlns:atict="http://www.arbortext.com/namespace/atict"><li itemprop="breadcrumb" itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb"><a href="../documentation-center.html" itemprop="url"><span itemprop="title">All Products</span></a></li></ul><ul class="nav_disambiguation" xmlns:atict="http://www.arbortext.com/namespace/atict"><li class="product"><a href="index.html">Flexible Statistics and Data Analysis (FSDA)</a><div class="dropdown"><span id="dropdownMenu1" class="icon-arrow-down icon_16" data-toggle="dropdown"></span><ul aria-labelledby="dropdownMenu1" class="dropdown-menu dropdown-menu-right" role="menu"><li role="presentation"><a href="examples.html" role="menuitem" tabindex="-1">Examples</a></li><li role="presentation"><a href="functionlist.html" role="menuitem" tabindex="-1">Functions and Other Reference</a></li><li role="presentation"><a href="release-notes.html" role="menuitem" tabindex="-1">Release Notes</a></li><li role="presentation"><a href="tutorials.html" role="menuitem" tabindex="-1">Tutorials</a></li></ul></div></li></ul><ul xmlns:atict="http://www.arbortext.com/namespace/atict" class="nav_disambiguation"><li><a href="index.html">Flexible Statistics and Data Analysis Toolbox</a></li><li><a href="function-cate.html" itemprop="url">Functions</a></li></ul><!-- --><ul class="nav_scrollspy nav" xmlns:atict="http://www.arbortext.com/namespace/atict"><li class="nav_scrollspy_function"><a href="#responsive_offcanvas">FSRBr</a></li><li id="SSPY810-refentry" class="nav_scrollspy_title">On this page</li><li><a class="intrnllnk" href="#syntax">Syntax</a></li><li><a class="intrnllnk" href="#Description">Description</a></li><li><a class="intrnllnk" href="#Examples">Examples</a><ul><li><a class="intrnllnk" href="#Example_1">Example of FSRBr for international trade data.</a></li><li><a class="intrnllnk" href="#Example_2">Example of FSRBr for international trade data (explore options).</a></li><li><a class="intrnllnk" href="#Example_3"></a></li></ul></li><li><a class="intrnllnk" href="#Inputs">Input Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_y">y</a></li><li><a class="intrnllnk" href="#input_argument_X">X</a></li></ul></li><li><a class="intrnllnk" href="#NameValuePairs">Name-Value Pair Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_namevalue_alpha">alpha</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_R2th">R2th</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_fullreweight">fullreweight</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_plotsPI">plotsPI</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_intercept">intercept</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_bayes">bayes</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_plots">plots</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_init">init</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_nocheck">nocheck</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_bivarfit">bivarfit</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_multivarfit">multivarfit</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_labeladd">labeladd</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_nameX">nameX</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_namey">namey</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_ylim">ylim</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_xlim">xlim</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_bonflev">bonflev</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_msg">msg</a></li></ul></li><li><a class="intrnllnk" href="#OutputArgs">Output Arguments</a><ul><li><a class="intrnllnk" href="#output_argument_out">out</a></li><li><a class="intrnllnk" href="#output_argument_varargout">varargout</a></li></ul></li><li><a class="intrnllnk" href="#References">References</a></li><li><a class="intrnllnk" href="#SeeAlso">See Also</a></li></ul></nav><script src="includesFS/offcanvas.js"></script></div><div id="div002"></div><div class="site_container site_toc_closed"><div class="page_container"><div class="content_frame"><div id="content_container" class="content_container"><section id="doc_center_content"><div class="function_ref"><div itemprop="content"><h1 itemprop="title">FSRBr</h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose">Bayesian forward search in linear regression reweighted</p><div class="switch"><a id="expandAllPage" href="javascript:void(0);">expand all in page</a></div></div></div></div><div class="ref_sect"><h2 id="syntax">Syntax</h2><div class="syntax_signature"><div class="syntax_signature_module"><ul><li><code class="synopsis">out =FSRBr(y, X)</code><span class="syntax_example"><a class="intrnllnk" href="FSRBr.html#Example_1">example</a></span></li><li><code class="synopsis">out =FSRBr(y, X,Name,Value)</code><span class="syntax_example"><a class="intrnllnk" href="FSRBr.html#Example_2">example</a></span></li><li><code class="synopsis">[out , varargout]=FSRBr(___)</code><span class="syntax_example"><a class="intrnllnk" href="FSRBr.html#Example_3">example</a></span></li></ul></div></div></div>	<div class="ref_sect" itemprop="content">							<h2 id="Description">Description</h2>							<div class="descriptions">								<div class="description_module"><p><p>FSRBr uses the units not declared as outliers by  FSRB to produce a robust fit.</p> <p>
   The units whose residuals exceeds the threshold determined by option
   alpha are declared as outliers. Moreover, it is possible in option
   R2th to modify the estimate of sigma2 which is used to declare
   the outliers. This is useful when there is almost a perfect fit in the
   data, the estimate of the error variance is very small and therefore
   there is the risk of declaring as outliers very small deviations from
   the robust fit. In this case the estimate of sigma2 is corrected in
   order to achieve a value of R2 equal to R2th.</p></p><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="FSRBr.html#Example_1">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_out"><code>out</code></a>=FSRBr(<a class="intrnllnk" href="#inputarg_y"><code>y</code></a>,<a class="intrnllnk" href="#inputarg_X"><code> X</code></a>)</code></span>Example of FSRBr for international trade data.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="FSRBr.html#Example_2">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_out"><code>out</code></a>=FSRBr(<a class="intrnllnk" href="#inputarg_y"><code>y</code></a>,<a class="intrnllnk" href="#inputarg_X"><code>X</code></a>,<a class="intrnllnk" href="#namevaluepairarguments"><code>Name, Value</code></a>)</code></span>Example of FSRBr for international trade data (explore options).</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="FSRBr.html#Example_3">	example</a></p>	<p><span itemprop="syntax"><code>[<a class="intrnllnk" href="#outputarg_out"><code>out </code></a>,<a class="intrnllnk" href="#outputarg_varargout"><code> varargout</code></a>]=FSRBr(___)</code></span></p></div>								</div>							</div>							<div class="clear">							</div>						</div><div class="ref_sect" itemprop="content"><div class="examples"><h2 id="Examples">Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="example_1" class="example_module expandableContent"><div id="Example_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Example of FSRBr for international trade data.</li></span></a></span></h3><div class="collapse"><p>
         Bayesian FS to fit the group of undervalued flows.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">
        load('fishery');
        X = fishery.data(:,1);
        y = fishery.data(:,2);
        [n,p] = size(X);
        X = X + 0.000001*randn(n,1);

        % id = undervalued flows
        id = (y./X &lt; 9.5);
        
        % my prior on beta
        mybeta = median(y(id)./X(id));
        bmad   = mad(y(id)./X(id));
        ListIn = find(y./X &lt;= mybeta + bmad);
        % gscatter(X,y,id)


        rr          = y(ListIn)-(X(ListIn,:) * mybeta);
        numS2cl     = rr'*rr;
        dfe         = length(ListIn)-p;
        S2cl        = numS2cl/dfe;
        bayes       = struct;
        bayes.R     = X(ListIn,:)'*X(ListIn,:);
        bayes.tau0  = 1/S2cl;
        bayes.n0    = length(ListIn);
        bayes.beta0 = mybeta;

        % fit based on Bayesian FS with prior on the underdeclared flows
        [out_B, xnew1 , ypred1, yci1]   = FSRBr(y,X,'bayes',bayes,'intercept',0,'alpha',0.01,'bonflev',0.999,'fullreweight',false,'plotsPI',1,'plots',0);
         
        h1 = allchild(gca); a1 = gca; f1 = gcf;

        % fit based on traditional FS
        [out, xnew2 , ypred2, yci2]   = FSRr(y,X,'intercept',0,'alpha',0.01,'bonflev',0.999,'fullreweight',false,'plotsPI',1,'plots',0);

        h2 = allchild(gca); a2 = gca; f2 = gcf;

        % move the figure above into a single one with two panels
        hh = figure; ax1 = subplot(2,1,1); ax2 = subplot(2,1,2);
        copyobj(h1,ax1); title(ax1,get(get(a1,'title'),'string'));
        copyobj(h2,ax2); title(ax2,get(get(a2,'title'),'string'));
        figsize = get(hh, 'Position'); 
        set(hh,'Position',figsize);
        close(f1); close(f2);

        disp(['Bayesian FS fit    = ' num2str(out_B.betar) ' using a prior based on undervalued flows']);
        disp(['Traditional FS fit = ' num2str(out.betar)]);
</pre></div></div><pre class="codeoutput">Bayesian FS fit    = 8.4442 using a prior based on undervalued flows
Traditional FS fit = 13.0939
</pre><img vspace="5" hspace="5" src="images\FSRBr_01.png" alt=""> </p></div></div><div id="example_2" class="example_module expandableContent"><div id="Example_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>Example of FSRBr for international trade data (explore options).</li></span></a></span></h3><div class="collapse"><p>
         Bayesian FS to fit the group of undervalued flows.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">
        load('fishery');
        X = fishery.data(:,1);
        y = fishery.data(:,2);
        [n,p] = size(X);
        X = X + 0.000001*randn(n,1);

        % id = undervalued flows
        id = (y./X &lt; 9.5);
        
        % my prior on beta
        mybeta = median(y(id)./X(id));
        bmad   = mad(y(id)./X(id));
        ListIn = find(y./X &lt;= mybeta + bmad);
        % gscatter(X,y,id)


        rr          = y(ListIn)-(X(ListIn,:) * mybeta);
        numS2cl     = rr'*rr;
        dfe         = length(ListIn)-p;
        S2cl        = numS2cl/dfe;
        bayes       = struct;
        bayes.R     = X(ListIn,:)'*X(ListIn,:);
        bayes.tau0  = 1/S2cl;
        bayes.n0    = length(ListIn);
        bayes.beta0 = mybeta;
        alpha=0.0001;
        bonflev=0.99999;
        % fit based on Bayesian FS with prior on the underdeclared flows
        [out_B, xnew1 , ypred1, yci1]   = FSRBr(y,X,'bayes',bayes,'intercept',0,'alpha',alpha,'bonflev',bonflev,'fullreweight',false,'plotsPI',1,'plots',0);
         
        h1 = allchild(gca); a1 = gca; f1 = gcf;

        % fit based on traditional FS
        [out, xnew2 , ypred2, yci2]   = FSRr(y,X,'intercept',0,'alpha',alpha,'bonflev',bonflev,'fullreweight',false,'plotsPI',1,'plots',0);

        h2 = allchild(gca); a2 = gca; f2 = gcf;

        % move the figure above into a single one with two panels
        hh = figure; ax1 = subplot(2,1,1); ax2 = subplot(2,1,2);
        copyobj(h1,ax1); title(ax1,get(get(a1,'title'),'string'));
        copyobj(h2,ax2); title(ax2,get(get(a2,'title'),'string'));
        figsize = get(hh, 'Position'); 
        set(hh,'Position',figsize);
        close(f1); close(f2);

        disp(['Bayesian FS fit    = ' num2str(out_B.betar) ' using a prior based on undervalued flows']);
        disp(['Traditional FS fit = ' num2str(out.betar)]);
</pre></div></div></p></div></div><div id="example_3" class="example_module expandableContent"><div id="Example_3"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li></li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code"></pre></div></div></p></div></div></div><p> </p></div></div><div class="ref_sect" itemprop="content"><h2 id="Inputs">Input Arguments</h2><div class="expandableContent"><div class="arguments"><div class="input_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"> <div id="inputarg_y" class="clearfix"> </div> <h3 id="input_argument_y" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>y</code> &#8212; Response variable. </span>  </a><span class="example_desc">Vector.</span></span></h3> <div class="collapse"> <p><p>Response variable, specified as
               a vector of length n, where n is the number of
               observations. Each entry in y is the response for the
               corresponding row of X.</p> <p>
               Missing values (NaN's) and infinite values (Inf's) are
               allowed, since observations (rows) with missing or infinite
               values will automatically be excluded from the
               computations.</p></p> <p class="datatypelist"><strong> Data Types: </strong><code>single| double</code></p> </div> </div><div class="expandableContent"> <div id="inputarg_X" class="clearfix"> </div> <h3 id="input_argument_X" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>X</code> &#8212; Predictor variables. </span>  </a><span class="example_desc">Matrix.</span></span></h3> <div class="collapse"> <p><p>Matrix of explanatory
               variables (also called 'regressors') of dimension n x (p-1)
               where p denotes the number of explanatory variables
               including the intercept.</p> <p>
               Rows of X represent observations, and columns represent
               variables. By default, there is a constant term in the
               model, unless you explicitly remove it using input option
               intercept, so do not include a column of 1s in X. Missing
               values (NaN's) and infinite values (Inf's) are allowed,
               since observations (rows) with missing or infinite values
               will automatically be excluded from the computations.</p></p> <p class="datatypelist"><strong> Data Types: </strong><code>single| double</code></p> </div> </div><div id="namevaluepairarguments" class="clearfix"></div><h3 id="NameValuePairs" class="bottom_ruled">Name-Value Pair Arguments</h3><div class="namevaluecontainer"><p>Specify optional comma-separated pairs of <code>Name,Value</code> arguments. <code>Name</code> is the argument name and <code>Value</code> is the corresponding value. <code>Name</code> must appear  inside single quotes (<code>' '</code>).  You can specify several name and value pair arguments in any order as <code>  Name1,Value1,...,NameN,ValueN</code>.</p>  <span class="example_desc"><strong>Example:</strong><code><code> 'alpha',0.01
</code>,<code> 'R2th',0.95
</code>,<code> 'fullreweight',true
</code>,<code> 'plotsPI',1
</code>,<code> 'intercept',1
</code>,<code> bayes=struct;bayes.R=R;bayes.n0=n0;bayes.beta0=beta0;bayes.tau0=tau0;
</code>,<code> 'plots',1
</code>,<code> 'init',100 starts monitoring from step m=100
</code>,<code> 'nocheck',1
</code>,<code> 'bivarfit',2
</code>,<code> 'multivarfit','1'
</code>,<code> 'labeladd','1'
</code>,<code> 'nameX',{'NameVar1','NameVar2'}
</code>,<code> 'namey','NameOfResponse'
</code>,<code> 'bonflev',0.99
</code>,<code> 'msg',1
</code></code></span></div><div class="expandableContent"><div id="inputarg_alpha" class="clearfix"></div><h3 id="input_argument_namevalue_alpha" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>alpha</code> &#8212;test size.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p>Number between 0 and 1 which
              defines test size to declare the outliers
                 </p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'alpha',0.01
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_R2th" class="clearfix"></div><h3 id="input_argument_namevalue_R2th" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>R2th</code> &#8212;R2 threshold.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>Scalar which defines the value R2 does
              have to exceed. For example if R2 based on good observations
              is 0.92 and R2th is 0.90 the estimate of the variance of the
              residuals which is used to declare the outliers is adjusted
              in order to have a value of R2 which is equal to 0.90.</p> <p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'R2th',0.95
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_fullreweight" class="clearfix"></div><h3 id="input_argument_namevalue_fullreweight" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>fullreweight</code> &#8212;Option to declare outliers.</span></a><span class="example_desc">boolean.</span></span></h3><div class="collapse">	<p>If fullreweight is true
              (default option), the list of outliers refers to all the
              units whose residuals is above the threshold else if it is
              false the outliers are the observations which by procedure
              FSR had been declared outliers and have a residual greater
              than threshold
                 </p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'fullreweight',true
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>boolean</code></p></div></div><div class="expandableContent"><div id="inputarg_plotsPI" class="clearfix"></div><h3 id="input_argument_namevalue_plotsPI" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>plotsPI</code> &#8212;Plot of prediction intervals.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p>If plotsPI =1 and
               the number of regressors (excluding the constant term) is
               equal 1, it is possible to see on the screen the yX scatter
               with superimposed the prediction intervals using a
               confidence level 1-alpha, else no plot is shown on the
               screen
                 </p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'plotsPI',1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_intercept" class="clearfix"></div><h3 id="input_argument_namevalue_intercept" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>intercept</code> &#8212;Indicator for constant term.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>If 1, a model with constant term will be fitted
                       (default), else no constant term will be included.</p> <p>
                        </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'intercept',1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_bayes" class="clearfix"></div><h3 id="input_argument_namevalue_bayes" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>bayes</code> &#8212;Prior information.</span></a><span class="example_desc">structure.</span></span></h3><div class="collapse">	<p>It contains the following fields
       <table border="2" cellpadding="4" cellspacing="0" class="body"><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr valign="top"><th valign="top">Value</th><th valign="top">Description</th></tr></thead><tr valign="top"><td><code>beta0</code></td><td><p>p-times-1 vector containing prior mean of \beta</p></td></tr><tr valign="top"><td><code>R</code></td><td><p><p>p-times-p positive definite matrix which can be
                       interpreted as X0'X0 where X0 is a n0 x p matrix
                       coming from previous experiments (assuming that the
                       intercept is included in the model.</p> <p>

               The prior distribution of $\tau_0$ is a gamma distribution with
               parameters $a_0$ and $b_0$, that is
               </p>\[
                     p(\tau_0) \propto \tau^{a_0-1} \exp (-b_0 \tau)
                       \qquad E(\tau_0) = a_0/b_0
               \]</p></td></tr><tr valign="top"><td><code>tau0</code></td><td><p>scalar. Prior estimate of
                       \[ \tau=1/ \sigma^2 =a_0/b_0 \]</p></td></tr><tr valign="top"><td><code>n0</code></td><td><p><p>scalar. Sometimes it helps to think of the prior
                      information as coming from n0 previous experiments.</p> <p>
                      Therefore we assume that matrix X0 (which defines
                      R), was made up of n0 observations.</p> <p>
              REMARK if structure bayes is not supplied the default
                      values which are used are.</p> <p>
                      beta0= zeros(p,1):  Vector of zeros.</p> <p>
                      R=eye(p):           Identity matrix.</p> <p>
                      tau0=1/1e+6:        Very large value for the
                                          prior variance, that is a very
                                          small value for tau0.</p> <p>
                      n0=1:               just one prior observation.</p> <p>

               $\beta$ is assumed to have a normal distribution with
               mean $\beta_0$ and (conditional on $\tau_0$) covariance
               $(1/\tau_0) (X_0'X_0)^{-1}$.</p><p>
               $\beta \sim N(    \beta_0, (1/\tau_0) (X_0'X_0)^{-1}    )$</p></p></td></tr></table></p>	<p class="description_valueexample">       <strong>Example: </strong><code> bayes=struct;bayes.R=R;bayes.n0=n0;bayes.beta0=beta0;bayes.tau0=tau0;
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_plots" class="clearfix"></div><h3 id="input_argument_namevalue_plots" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>plots</code> &#8212;Plot on the screen.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>If plots=1 (default) the plot of minimum deletion
                 residual with envelopes based on n observations and the
                 scatterplot matrix with the outliers highlighted is
                 produced.</p> <p>
                 If plots=2 the user can also monitor the intermediate
                 plots based on envelope superimposition.</p> <p>
                 Else no plot is produced.</p><p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'plots',1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_init" class="clearfix"></div><h3 id="input_argument_namevalue_init" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>init</code> &#8212;Search initialization.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>scalar which specifies the initial subset size to start
                   monitoring exceedances of minimum deletion residual, if
                   init is not specified it set equal to:</p> <p>
                   p+1, if the sample size is smaller than 40;</p> <p>
                   min(3*p+1,floor(0.5*(n+p+1))), otherwise.</p><p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'init',100 starts monitoring from step m=100
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_nocheck" class="clearfix"></div><h3 id="input_argument_namevalue_nocheck" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>nocheck</code> &#8212;Check input arguments.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>If nocheck is equal to 1 no check is performed on
                    matrix y and matrix X. Notice that y and X are left
                    unchanged. In other words the additional column of ones
                     for the intercept is not added. As default nocheck=0.</p> <p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'nocheck',1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_bivarfit" class="clearfix"></div><h3 id="input_argument_namevalue_bivarfit" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>bivarfit</code> &#8212;Superimpose bivariate least square lines.</span></a><span class="example_desc">character.</span></span></h3><div class="collapse">	<p><p>This option adds one or more least square lines, based on
                   SIMPLE REGRESSION of y on Xi, to the plots of y|Xi.</p> <p>
                  bivarfit = ''
                   is the default: no line is fitted.</p> <p>
                  bivarfit = '1'
                   fits a single ols line to all points of each bivariate
                   plot in the scatter matrix y|X.</p> <p>
                  bivarfit = '2'
                   fits two ols lines: one to all points and another to
                   the group of the genuine observations. The group of the
                   potential outliers is not fitted.</p> <p>
                  bivarfit = '0'
                   fits one ols line to each group. This is useful for the
                   purpose of fitting mixtures of regression lines.</p> <p>
                  bivarfit = 'i1' or 'i2' or 'i3' etc.</p> <p>
                   fits an ols line to a specific group, the one with
                   index 'i' equal to 1, 2, 3 etc. Again, useful in case
                   of mixtures.</p><p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'bivarfit',2
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>char</code></p></div></div><div class="expandableContent"><div id="inputarg_multivarfit" class="clearfix"></div><h3 id="input_argument_namevalue_multivarfit" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>multivarfit</code> &#8212;Superimpose multivariate least square lines.</span></a><span class="example_desc">character.</span></span></h3><div class="collapse">	<p><p>This option adds one or more least square lines, based on
                   MULTIVARIATE REGRESSION of y on X, to the plots of y|Xi.</p> <p>
                 multivarfit = ''
                   is the default: no line is fitted.</p> <p>
                 multivarfit = '1'
                   fits a single ols line to all points of each bivariate
                   plot in the scatter matrix y|X. The line added to the
                   scatter plot y|Xi is avconst + Ci*Xi, where Ci is the
                   coefficient of Xi in the multivariate regression and
                   avconst is the effect of all the other explanatory
                   variables different from Xi evaluated at their centroid
                   (that is overline{y}'C))
                 multivarfit = '2'
                   equal to multivarfit ='1' but this time we also add the
                   line based on the group of unselected observations
                   (i.e. the normal units).</p><p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'multivarfit','1'
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>char</code></p></div></div><div class="expandableContent"><div id="inputarg_labeladd" class="clearfix"></div><h3 id="input_argument_namevalue_labeladd" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>labeladd</code> &#8212;Add outlier labels in plot.</span></a><span class="example_desc">character.</span></span></h3><div class="collapse">	<p><p>If this option is '1',  we label the outliers with the
                 unit row index in matrices X and y. The default value is
                 labeladd='', i.e. no label is added.</p> <p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'labeladd','1'
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>char</code></p></div></div><div class="expandableContent"><div id="inputarg_nameX" class="clearfix"></div><h3 id="input_argument_namevalue_nameX" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>nameX</code> &#8212;Add variable labels in plot.</span></a><span class="example_desc">cell array of strings.</span></span></h3><div class="collapse">	<p>cell array of strings of length p containing the labels of
                 the variables of the regression dataset. If it is empty
                 (default) the sequence X1, ..., Xp will be created
                 automatically
                 </p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'nameX',{'NameVar1','NameVar2'}
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>cell</code></p></div></div><div class="expandableContent"><div id="inputarg_namey" class="clearfix"></div><h3 id="input_argument_namevalue_namey" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>namey</code> &#8212;Add response label.</span></a><span class="example_desc">character.</span></span></h3><div class="collapse">	<p>character containing the label of the response
               </p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'namey','NameOfResponse'
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>char</code></p></div></div><div class="expandableContent"><div id="inputarg_ylim" class="clearfix"></div><h3 id="input_argument_namevalue_ylim" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>ylim</code> &#8212;Control y scale in plot.</span></a><span class="example_desc">vector.</span></span></h3><div class="collapse">	<p>vector with two elements controlling minimum and maximum
                 on the y axis. Default value is '' (automatic scale)
               </p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'ylim','[0,10]' sets the minim value to 0 and the
</code>               max to 10 on the y axis</p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_xlim" class="clearfix"></div><h3 id="input_argument_namevalue_xlim" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>xlim</code> &#8212;Control x scale in plot.</span></a><span class="example_desc">vector.</span></span></h3><div class="collapse">	<p>vector with two elements controlling minimum and maximum
                 on the x axis. Default value is '' (automatic scale)
               </p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'xlim','[0,10]' sets the minim value to 0 and the
</code>               max to 10 on the x axis</p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_bonflev" class="clearfix"></div><h3 id="input_argument_namevalue_bonflev" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>bonflev</code> &#8212;Signal to use to identify outliers.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>option to be used if the distribution of the data is
                 strongly non normal and, thus, the general signal
                 detection rule based on consecutive exceedances cannot be
                 used. In this case bonflev can be:</p> <p>
                 - a scalar smaller than 1 which specifies the confidence
                   level for a signal and a stopping rule based on the
                   comparison of the minimum MD with a
                   Bonferroni bound. For example if bonflev=0.99 the
                   procedure stops when the trajectory exceeds for the
                   first time the 99% bonferroni bound.</p> <p>
                 - A scalar value greater than 1. In this case the
                   procedure stops when the residual trajectory exceeds
                   for the first time this value.</p> <p>
                 Default value is '', which means to rely on general rules
                 based on consecutive exceedances.</p><p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'bonflev',0.99
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_msg" class="clearfix"></div><h3 id="input_argument_namevalue_msg" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>msg</code> &#8212;Level of output to display.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>scalar which controls whether to display or not messages
                 on the screen
                 If msg==1 (default) messages are displayed on the screen about
                   step in which signal took place and ....</p> <p>
                 else no message is displayed on the screen
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'msg',1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="OutputArgs" >Output Arguments</h2><div class="expandableContent"><div class="arguments"><div class="output_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"><div id="outputarg_out" class="clearfix"></div><h3 id="output_argument_out" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>out</code> &#8212; description</span></a><span class="example_desc">Structure</span></span></h3><div class="collapse"><p>Structure which contains the following fields<table border="2" cellpadding="4" cellspacing="0" class="body"><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr valign="top"><th valign="top">Value</th><th valign="top">Description</th></tr></thead><tr valign="top"><td><code>outliers</code></td><td><p>k x 1 vector containing the list of the units declared
               outliers by procedure FSR or NaN if the sample is
               homogeneous</p></td></tr><tr valign="top"><td><code>beta</code></td><td><p>p-by-1 vector containing the estimated regression parameter
               by procedure FSR</p></td></tr><tr valign="top"><td><code>outliersr</code></td><td><p>k1 x 1 vector containing the list of the units declared
               outliers after the reweighting step or NaN if the sample is
               homogeneous</p></td></tr><tr valign="top"><td><code>betar</code></td><td><p>p-by-1 vector containing the estimated regression parameter
               after the reweighting step</p></td></tr><tr valign="top"><td><code>rstud</code></td><td><p><p>n-by-2 matrix.</p> <p>
              First column = studentized residuals
              Second column = p-values (computed using as reference
              distribution the Student t)</p></p></td></tr><tr valign="top"><td><code>class</code></td><td><p>'FSRBr'.</p></td></tr></table></p></div></div><div class="expandableContent"><div id="outputarg_varargout" class="clearfix"></div><h3 id="output_argument_varargout" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>varargout</code> &#8212;xnew : new points.</span></a><span class="example_desc"><code> </code>Vector</span></span></h3><div class="collapse"><p><p> Vector with a number of new points where to evaluate the
                  prediction interval. xnew is a vector.</p> <p>
          ypred : values predicted by the fitted model on xnew. Vector of
                  length(xnew)
           yci  : Confidence intervals. A two-column matrix with each row providing
                  one interval.</p></p></div></div></div></div></div></div><div class="ref_sect" itemprop="content"><div class="bibliography"><h2 id="References">References</h2> <div><p>Atkinson A.C., Corbellini A., Riani M., (2016) Robust Bayesian
 Regression, submitted</p></div></div></div><div class="ref_sect"><h2 id="SeeAlso">See Also</h2><p><span itemprop="seealso"><a href="FSRB.html" itemprop="url"><span itemprop="name"><code>FSRB</code></span></a></span> | <span itemprop="seealso"><a href="FSR.html" itemprop="url"><span itemprop="name"><code>FSR</code></span></a></span></div><i>This page has been automatically generated by our routine <a href="publishFS.html">publishFS</a></i></div></section></div></div></div></div><div id="div001"></div></body></html>