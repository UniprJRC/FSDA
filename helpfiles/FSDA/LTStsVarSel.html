<!DOCTYPE HTML> <html itemscope="" xmlns="http://www.w3.org/1999/xhtml"><head><title>LTStsVarSel</title><meta content="refpage" name="chunktype"><meta content="function:LTStsVarSel" itemprop="refentity" name="refentity"><meta content="text/javascript" http-equiv="Content-Script-Type"><meta content="fcn" itemprop="pagetype" name="toctype"><meta content="ref/function" itemprop="infotype" name="infotype" /><meta content="LTStsVarSel does variable selection in the robust time series model LTSts." itemprop="description" name="description" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" /><script type="text/x-mathjax-config">MathJax.Hub.Config({extensions: ["tex2jax.js"],jax: ["input/TeX","output/HTML-CSS"],menuSettings: {zoom: "Double-Click", zscale: "300"},tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},MathMenu: {showRenderer: false},"HTML-CSS": {availableFonts: ["TeX"],preferredFont: "TeX",imageFont: null}});</script><script type="text/javascript" src="includesFS/Mathjax/MathJax.js"></script><script src="includesFS/matlab-highlighter.min.js"></script><link href="includesFS/matlab-highlighter.css" rel="stylesheet" type="text/css"><script type="text/javascript" src="includesFS/jquery-latest.js"></script><script>$(document).ready(function(){      $("#divtop").load("includesFS/top.html");      $("#divbottom").load("includesFS/bottom.html");});</script><link href="../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)"></link><link href="../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)"></link><link href="../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)"></link><link href="../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)"></link><link href="../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)"></link><link href="../includes/product/css/site6_offcanvas.css" rel="stylesheet" type="text/css"></link><script src="../includes/shared/scripts/l10n.js" type="text/javascript"></script><script src="../includes/product/scripts/docscripts.js"></script><script src="../includes/shared/scripts/docscripts_rn.js"></script><script src="../includes/shared/scripts/mw.imageanimation.js" type="text/javascript"></script><script src="../includes/shared/scripts/jquery.highlight.js"></script><script src="../includes/product/scripts/bootstrap.min.js" type="text/javascript"></script><script src="../includes/product/scripts/global.js"></script><script src="includesFS/bottom.js" type="text/javascript"></script><script src="../includes/product/scripts/underscore-min.js"></script><script src="../includes/shared/scripts/f1help.js" type="text/javascript"></script><script src="../includes/product/scripts/suggest.js" type="text/javascript"></script><script src="../includes/shared/scripts/helpservices.js" type="text/javascript"></script><script src="../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script><!-- the following line should be kept this way only --><link href="includesFS/doc_center.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css"><link href="../includes/product/css/doc_center_print.css" media="print" rel="stylesheet" type="text/css"></head><body  onload="highlightMATLABCode();" id="responsive_offcanvas">  <div id="doc_header_spacer" class="header"></div><div class="sticky_header_container includes_subnav"><div class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-xs-12 col-sm-6 col-sm-push-6 col-md-5 col-md-push-7" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2017a" data-language="en" action="../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="sr-only">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"><div class="input-group-btn"><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search pull-right icon_32 visible-xs" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="col-sm-6 col-sm-pull-6 col-md-7 col-md-pull-5" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../documentation-center.html">Documentation</a></h1></div></div></div><div class="visible-xs" id="search_actuator"><button class="btn icon-search btn_search pull-right icon_16" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div><!--END.CLASS row--> </div><!--END.CLASS container-fluid--> </div><!--END.CLASS section_header level_3--><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_actuator" data-toggle="offcanvas" data-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="sr-only">Toggle navigation</span><span class="icon-menu icon_24"></span></button><span class="offcanvas_actuator_label"></span><span class="offcanvas_actuator_close"></span> </div><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-md-12 hidden-xs hidden-sm"></div></div></div></div></div></div></div><!--END.CLASS sticky_header_container--><div class="row-offcanvas row-offcanvas-left"><div id="sidebar" class="sidebar-offcanvas" role="navigation"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" xmlns:atict="http://www.arbortext.com/namespace/atict"><li itemprop="breadcrumb" itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb"> <a href="../documentation-center.html" itemprop="url"> <span itemprop="title">All Products</span></a></li></ul><ul class="nav_disambiguation" xmlns:atict="http://www.arbortext.com/namespace/atict"><li class="product"><a href="index.html">Flexible Statistics and Data Analysis (FSDA)</a><div class="dropdown"> <span id="dropdownMenu1" class="icon-arrow-down icon_16" data-toggle="dropdown"> </span><ul aria-labelledby="dropdownMenu1" class="dropdown-menu dropdown-menu-right" role="menu"><li role="presentation"> <a href="examples.html" role="menuitem" tabindex="-1">Examples</a></li><li role="presentation"> <a href="function-alpha.html" role="menuitem" tabindex="-1"> Functions and Other Reference</a></li><li role="presentation"> <a href="release_notes.html?s_cid=doc_flyout" role="menuitem" tabindex="-1"> Release Notes</a></li><li role="presentation"> <a href="tutorials.html" role="menuitem" tabindex="-1"> Tutorials</a></li></ul></div></li></ul><ul xmlns:atict="http://www.arbortext.com/namespace/atict" class="nav_disambiguation"> <li><a href="index.html">Flexible Statistics and Data Analysis Toolbox</a> </li> <li><a href="function-cate.html" itemprop="url">Functions</a></li></ul><!-- --><ul class="nav_scrollspy nav" xmlns:atict="http://www.arbortext.com/namespace/atict">  <li class="nav_scrollspy_function"> <a href="#responsive_offcanvas">LTStsVarSel</a></li> <li id="SSPY810-refentry" class="nav_scrollspy_title">On this page</li><li><a class="intrnllnk" href="#syntax">Syntax</a></li><li><a class="intrnllnk" href="#Description">Description</a></li><li><a class="intrnllnk" href="#Examples">Examples</a><ul><li><a class="intrnllnk" href="#Example_1">run LTStsVarSel with all default options.</a></li><li><a class="intrnllnk" href="#Example_2">run LTStsVarSel starting from a specific over-parametrized model.</a></li><li><a class="intrnllnk" href="#Example_3">run LTStsVarSel starting from over-parametrized model with autoregressive components.</a></li><li><a class="intrnllnk" href="#Example_4">run LTStsVarSel with default options and return warning messages.</a></li></ul></li><li><a class="intrnllnk" href="#Inputs">Input Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_y">y</a></li></ul></li><li><a class="intrnllnk" href="#NameValuePairs">Name-Value Pair Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_namevalue_model">model</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_thPval">thPval</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_plots">plots</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_msg">msg</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_dispresults">dispresults</a></li></ul></li><li><a class="intrnllnk" href="#OutputArgs">Output Arguments</a><ul><li><a class="intrnllnk" href="#output_argument_reduced_est">reduced_est</a></li><li><a class="intrnllnk" href="#output_argument_reduced_model">reduced_model</a></li><li><a class="intrnllnk" href="#output_argument_msgstr">msgstr</a></li></ul></li><li><a class="intrnllnk" href="#References">References</a></li><li><a class="intrnllnk" href="#SeeAlso">See Also</a></li></ul></nav><script src="../includes/product/scripts/offcanvas.js"></script></div><div id="divtop"></div><div class="site_container site_toc_closed"><div class="page_container"><div class="content_frame"><div id="content_container" class="content_container"><section id="doc_center_content"><div class="function_ref"><div itemprop="content"><h1 itemprop="title">LTStsVarSel</h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose">LTStsVarSel does variable selection in the robust time series model LTSts</p><div class="switch"><a id="expandAllPage" href="javascript:void(0);">expand all in page</a></div></div></div></div><div class="ref_sect"><h2 id="syntax">Syntax</h2><div class="syntax_signature"><div class="syntax_signature_module"><ul><li><code class="synopsis">reduced_est=LTStsVarSel(y)</code><span class="syntax_example"><a class="intrnllnk" href="LTStsVarSel.html#Example_1">example</a></span></li><li><code class="synopsis">reduced_est=LTStsVarSel(y,Name,Value)</code><span class="syntax_example"><a class="intrnllnk" href="LTStsVarSel.html#Example_2">example</a></span></li><li><code class="synopsis">[reduced_est, reduced_model]=LTStsVarSel(___)</code><span class="syntax_example"><a class="intrnllnk" href="LTStsVarSel.html#Example_3">example</a></span></li><li><code class="synopsis">[reduced_est, reduced_model, msgstr]=LTStsVarSel(___)</code><span class="syntax_example"><a class="intrnllnk" href="LTStsVarSel.html#Example_4">example</a></span></li></ul></div></div></div>	<div class="ref_sect" itemprop="content">							<h2 id="Description">Description</h2>							<div class="descriptions">								<div class="description_module"><p><p>LTSts requires variable selection when the optimal model parameters are
 not known in advance. This happens in particular when the function has to
 be applied to many heterogeneous datasets in an automatic way, possibly
 on a regular basis (that is the model parameters are expected to change
 over time even for datasets associated to the same phenomenon).</p> <p>

 The approach consists in iteratively eliminating the less significant
 estimated model parameter, starting from an over-parametrized model. The
 model parameters are re-estimated with LTSts at each step, until all the
 p-values are below a given threshold. Then, the output is a reduced time
 series model with significant parameters only.</p></p><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="LTStsVarSel.html#Example_1">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_reduced_est"><code>reduced_est</code></a>=LTStsVarSel(<a class="intrnllnk" href="#inputarg_y"><code>y</code></a>)</code></span>run LTStsVarSel with all default options.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="LTStsVarSel.html#Example_2">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_reduced_est"><code>reduced_est</code></a>=LTStsVarSel(<a class="intrnllnk" href="#inputarg_y"><code>y</code></a>,<a class="intrnllnk" href="#namevaluepairarguments"><code>Name, Value</code></a>)</code></span>run LTStsVarSel starting from a specific over-parametrized model.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="LTStsVarSel.html#Example_3">	example</a></p>	<p><span itemprop="syntax"><code>[<a class="intrnllnk" href="#outputarg_reduced_est"><code>reduced_est</code></a>,<a class="intrnllnk" href="#outputarg_reduced_model"><code> reduced_model</code></a>]=LTStsVarSel(___)</code></span>run LTStsVarSel starting from over-parametrized model with autoregressive components.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="LTStsVarSel.html#Example_4">	example</a></p>	<p><span itemprop="syntax"><code>[<a class="intrnllnk" href="#outputarg_reduced_est"><code>reduced_est</code></a>,<a class="intrnllnk" href="#outputarg_reduced_model"><code> reduced_model</code></a>,<a class="intrnllnk" href="#outputarg_msgstr"><code> msgstr</code></a>]=LTStsVarSel(___)</code></span>run LTStsVarSel with default options and return warning messages.</p></div>								</div>							</div>							<div class="clear">							</div>						</div><div class="ref_sect" itemprop="content"><div class="examples"><h2 id="Examples">Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="example_1" class="example_module expandableContent"><div id="Example_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>run LTStsVarSel with all default options.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">% data model
model=struct;
model.trend=1;                  % linear trend
model.trendb=[0 1];             % parameters of the linear trend
model.s=12;                     % monthly time series
model.seasonal=1;               % 1 harmonic with linear trend
model.seasonalb=[10 10];        % parameter for one harmonic with linear trend
model.lshiftb=100;              % level shift amplitude
model.lshift= 30;               % level shift amplitude
model.signal2noiseratio = 100;  % signal to noise
n = 100;                        % sample size
tmp = rand(n,1);
model.X = tmp.*[1:n]';          % a extra covariate
model.Xb = 1;                   % beta coefficient of the covariate
% generate data
out_sim=simulateTS(n,'plots',1,'model',model);
%run LTStsVarSel with all default options
rng(1);
[out_model_0, out_reduced_0] = LTStsVarSel(out_sim.y);
% optional: add a FS step to the LTSts estimator
% outFS = FSRts(out_sim.y,'model',out_model_0);
% To be fixed: 'Non existent user option found-&gt; '    'ARp'</pre></div></div></p></div></div><div id="example_2" class="example_module expandableContent"><div id="Example_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>run LTStsVarSel starting from a specific over-parametrized model.</li></span></a></span></h3><div class="collapse"><p>
    n = 100;                         sample size<div class="programlisting"><div class="codeinput"><pre class="matlab-code">tmp = rand(n,1);
model.X = tmp.*[1:n]';          % a extra covariate
model.Xb = 1;                   % beta coefficient of the covariate
out_sim=simulateTS(n,'plots',1,'model',model);
% complete model to be tested.
overmodel=struct;
overmodel.trend=2;              % quadratic trend
overmodel.s=12;                 % monthly time series
overmodel.seasonal=303;         % number of harmonics
overmodel.lshift=4;             % position where to start monitoring level shift
overmodel.X=tmp.*[1:n]';
% pval threshold
thPval=0.01;
[out_model_1, out_reduced_1] = LTStsVarSel(out_sim.y,'model',overmodel,'thPval',thPval,'plots',1);</pre></div></div></p></div></div><div id="example_3" class="example_module expandableContent"><div id="Example_3"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>run LTStsVarSel starting from over-parametrized model with autoregressive components.</li></span></a></span></h3><div class="collapse"><p>
     add three autoregressive components to the complete model.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">n = 100;                        % sample size
tmp = rand(n,1);
model.X = tmp.*[1:n]';          % a extra covariate
model.Xb = 1;                   % beta coefficient of the covariate
out_sim=simulateTS(n,'plots',1,'model',model);
% complete model to be tested.
overmodel=struct;
overmodel.trend=2;              % quadratic trend
overmodel.s=12;                 % monthly time series
overmodel.seasonal=303;         % number of harmonics
overmodel.lshift=4;             % position where to start monitoring level shift
overmodel.X=tmp.*[1:n]';
overmodel.ARp=3;
% pval threshold
thPval=0.01;
[out_model_2, out_reduced_2] = LTStsVarSel(out_sim.y,'model',overmodel,'thPval',thPval);</pre></div></div></p></div></div><div id="example_4" class="example_module expandableContent"><div id="Example_4"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>run LTStsVarSel with default options and return warning messages.</li></span></a></span></h3><div class="collapse"><p>
         data model<div class="programlisting"><div class="codeinput"><pre class="matlab-code">model=struct;
model.trend=1;                  % linear trend
model.trendb=[0 1];             % parameters of the linear trend
model.s=12;                     % monthly time series
model.seasonal=1;               % 1 harmonic with linear trend
model.seasonalb=[10 10];        % parameter for one harmonic with linear trend
model.lshiftb=100;              % level shift amplitude
model.lshift= 30;               % level shift amplitude
model.signal2noiseratio = 100;  % signal to noise
n = 100;                        % sample size
tmp = rand(n,1);
model.X = tmp.*[1:n]';          % a extra covariate
model.Xb = 1;                   % beta coefficient of the covariate
% generate data
out_sim=simulateTS(n,'plots',1,'model',model);
[out_model_3, out_reduced_3, messages] = LTStsVarSel(out_sim.y);</pre></div></div></p></div></div></div><p> </p></div></div></div><div class="ref_sect" itemprop="content"><h2 id="Inputs">Input Arguments</h2><div class="expandableContent"><div class="arguments"><div class="input_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"> <div id="inputarg_y" class="clearfix"> </div> <h3 id="input_argument_y" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>y</code> &#8212; Time series to analyze. </span>  </a><span class="example_desc">Vector.</span></span></h3> <div class="collapse"> <p>A row or a column vector
               with T elements, which contains the time series.</p> <p class="datatypelist"><strong> Data Types: </strong><code>single| double</code></p> </div> </div><div id="namevaluepairarguments" class="clearfix"></div><h3 id="NameValuePairs" class="bottom_ruled">Name-Value Pair Arguments</h3><div class="namevaluecontainer"><p>Specify optional comma-separated pairs of <code>Name,Value</code> arguments. <code>Name</code> is the argument name and <code>Value</code> is the corresponding value. <code>Name</code> must appear  inside single quotes (<code>' '</code>).  You can specify several name and value pair arguments in any order as <code>  Name1,Value1,...,NameN,ValueN</code>.</p>  <span class="example_desc"><strong>Example:</strong><code><code> 'model', model
</code>,<code> 'thPval',0.05
</code>,<code> 'plots',1
</code>,<code> 'msg',1
</code>,<code> 'dispresults',true
</code></code></span></div><div class="expandableContent"><div id="inputarg_model" class="clearfix"></div><h3 id="input_argument_namevalue_model" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>model</code> &#8212;model type.</span></a><span class="example_desc">structure.</span></span></h3><div class="collapse">	<p><p>A structure which specifies the
               (over-parametrized) model which will be used to initialise
               the variable selection process. The model structure is
               identical to the one defined for function LTSts: for
               convenience, we list the fields also here:</p> <p>

       </p><table border="2" cellpadding="4" cellspacing="0" class="body"><colgroup><col width="20%"><col width="80%"></colgroup><thead><tr valign="top"><th valign="top">Value</th><th valign="top">Description</th></tr></thead><tr valign="top"><td><code>s</code></td><td><p>scalar (length of seasonal period). For monthly
                         data s=12 (default), for quartely data s=4, ...</p></td></tr><tr valign="top"><td><code>trend</code></td><td><p><p>scalar (order of the trend component).</p> <p>
                       trend = 0 implies no trend
                       trend = 1 implies linear trend with intercept (default),
                       trend = 2 implies quadratic trend
                       trend = 3 implies cubic trend
                       Admissible values for trend are, 0, 1, 2 and 3.</p><p>
                       In the paper RPRH to denote the order of the trend
                       symbol A is used. If this field is not present into
                       input structure model, model.trend=2 is used.</p></p></td></tr><tr valign="top"><td><code>seasonal</code></td><td><p><p>scalar (integer specifying number of
                        frequencies, i.e. harmonics, in the seasonal
                        component. Possible values for seasonal are
                        $1, 2, ..., [s/2]$, where $[s/2]=floor(s/2)$.</p> <p>
                        For example:</p> <p>
                        if seasonal =1 (default) we have:</p> <p>
                        $\beta_1 \cos( 2 \pi t/s) + \beta_2 sin ( 2 \pi t/s)$;</p> <p>
                        if seasonal =2 we have:</p> <p>
                        $\beta_1 \cos( 2 \pi t/s) + \beta_2 \sin ( 2 \pi t/s)
                        + \beta_3 \cos(4 \pi t/s) + \beta_4 \sin (4 \pi t/s)$.</p> <p>
                        Note that when $s$ is even the sine term disappears
                        for $j=s/2$ and so the maximum number of
                        trigonometric parameters is $s-1$.</p> <p>
                        If seasonal is a number greater than 100 then it
                        is possible to specify how the seasonal component
                        grows over time.</p> <p>
                        For example, seasonal = 101 implies a seasonal
                        component which just uses one frequency
                        which grows linearly over time as follows:</p> <p>
                        $(1+\beta_3 t)\times ( \beta_1 cos( 2 \pi t/s) +
                        \beta_2 \sin ( 2 \pi t/s))$.</p> <p>
                        For example, seasonal =201 implies a seasonal
                        component which just uses one frequency
                        which grows in a quadratic way over time as
                        follows:</p> <p>
                        $(1+\beta_3 t + \beta_4  t^2)\times( \beta_1 \cos(
                        2 \pi t/s) + \beta_2 \sin ( 2 \pi t/s))$.</p> <p>
                        seasonal =0 implies a non seasonal model.</p> <p>
                       In the paper RPRH to denote the number of
                       frequencies of the seasonal component
                       symbol B is used, while symbol G is used to denote
                       the order of the trend of the seasonal component.</p><p>
                       Therefore, for example, model.seasonal=201
                       corresponds to B=1 and G=2, while model.seasonal=3
                       corresponds to B=3 and G=0;</p></p></td></tr><tr valign="top"><td><code>X</code></td><td><p>matrix of size T-by-nexpl containing the
                         values of nexpl extra covariates which are likely
                         to affect y.</p></td></tr><tr valign="top"><td><code>lshift</code></td><td><p><p>scalar greater or equal than 0 which
                         specifies whether it is necessary to include a
                         level shift component. lshift = 0 (default)
                         implies no level shift component. If lshift is an
                         interger greater then 0 then it is possible to
                         specify the moment to start considering level
                         shifts. For example if lshift =13 then the
                         following additional parameters are estimated
                          $\beta_{LS1}* I(t \geq beta_{LS2})$ where $\beta_{LS1}$
                          is a real number and $\beta_{LS2}$ is an integer
                          which assumes values 14, 14, ..., T-13.</p> <p>
                         In general, the level shift which are considered
                         are referred to times (lshift+1):(T-lshift).</p><p>
                       In the paper RPRH $\beta_{LS1}$ is denoted with
                       symbol $\delta_1$, while, $\beta_{LS2}$ is denoted
                       with symbol $\delta_2$.</p></p></td></tr><tr valign="top"><td><code>ARp</code></td><td><p><p>scalar greater or equal than 0 which
                         specifies the length of the autoregressive
                         component. The default value of model.ARp is 0,
                         that is there is no autoregressive component.</p> <p>
                                Remark: the default overparametrized model is for monthly
               data with a quadratic
               trend (3 parameters) + seasonal component with just one
               harmonic (2 parameters), no additional explanatory
               variables, no level shift and no AR component that is
                               model=struct;</p> <p>
                               model.s=12;</p> <p>
                               model.trend=1;</p> <p>
                               model.seasonal=1;</p> <p>
                               model.X='';</p> <p>
                               model.lshift=0;</p> <p>
                               model.ARp=0;</p><p>
               Using the notation of the paper RPRH we have A=1, B=1; and
               $\delta_1=0$.</p></p></td></tr></table></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'model', model
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>struct</code></p></div></div><div class="expandableContent"><div id="inputarg_thPval" class="clearfix"></div><h3 id="input_argument_namevalue_thPval" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>thPval</code> &#8212;threshold for pvalues.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>A value between 0 and 1.</p> <p>
               An estimated parameter/variable is eliminated if the
               associated pvalue is below thPval. Default is thPval=0.01.</p><p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'thPval',0.05
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_plots" class="clearfix"></div><h3 id="input_argument_namevalue_plots" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>plots</code> &#8212;Plots on the screen.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>If plots = 1, the typical LTSts plots will be shown on the
               screen. The default value of plot is 0 i.e. no plot is
               shown on the screen.</p> <p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'plots',1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_msg" class="clearfix"></div><h3 id="input_argument_namevalue_msg" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>msg</code> &#8212;Messages on the screen.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>Scalar which controls whether LTSts will display or not
               messages on the screen. Deafault is msg=0, that is no
               messages are displayed on the screen. If msg==1 messages
               displayed on the screen are about estimated time to compute
               the estimator and the warnings about
               'MATLAB:rankDeficientMatrix', 'MATLAB:singularMatrix' and
               'MATLAB:nearlySingularMatrix'.</p> <p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'msg',1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_dispresults" class="clearfix"></div><h3 id="input_argument_namevalue_dispresults" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>dispresults</code> &#8212;Display results of final fit.</span></a><span class="example_desc">boolean.</span></span></h3><div class="collapse">	<p><p>If dispresults is
               true, labels of coefficients, estimated coefficients,
               standard errors, tstat and p-values are shown on the
               screen in a fully formatted way. The default value of
               dispresults is false.</p> <p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'dispresults',true
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>logical</code></p></div></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="OutputArgs" >Output Arguments</h2><div class="expandableContent"><div class="arguments"><div class="output_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"><div id="outputarg_reduced_est" class="clearfix"></div><h3 id="output_argument_reduced_est" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>reduced_est</code> &#8212;A reduced model structure obtained by eliminating
                    parameters that are non-significant.</span></a><span class="example_desc">It is a structure
                    containing the typical input model fields for function
                    LTSts (refer to LTSts for details):
                    model.s = the optimal length of seasonal period</span></span></h3><div class="collapse"><p><p>
                    model.trend = the optimal order of the trend.</p> <p>
                    model.seasonal = the optimal number of frequencies in
                      the seasonal component.</p> <p>
                    model.lshift = the optimal level shift position.</p><p>
                    model.X = a matrix containing the values of the extra
                      covariates which are likely to affect y. If the
                      imput model specifies autoregressive components
                      in model.ARp, then the selected ones will be also
                      included in model.X.</p></p></div></div><div class="expandableContent"><div id="outputarg_reduced_model" class="clearfix"></div><h3 id="output_argument_reduced_model" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>reduced_model</code> &#8212;Output fields of the optimal model.</span></a><span class="example_desc">Structure</span></span></h3><div class="collapse"><p><p>
                    The fields are those of function LTSts (refer to
                    LTSts for details):</p> <p>
                    out.B = matrix of estimated beta coefficients.</p> <p>
                    out.h = number of observations that have determined
                      the initial LTS estimator.</p> <p>
                    out.bs = vector of the units with the smallest
                      squared residuals before the reweighting step.</p> <p>
                    out.Hsubset = matrix of the units forming best H
                      subset for each tentative level shift considered.</p> <p>
                    out.numscale2 = matrix of the values of the lts.bestr
                      smallest values of the target function.</p> <p>
                    out.BestIndexes = matrix of indexes associated with
                      the best nbestindexes solutions.</p> <p>
                    out.Likloc = matrix containing local sum of squares
                      of residuals determining the best position of level
                      shift.</p> <p>
                    out.RES = matrix containing scaled residuals for all
                      the units of the original time series monitored in
                      steps lshift+1, lshift+2, ....</p> <p>
                    out.yhat = vector of fitted values after final step.</p> <p>
                    out.residuals = vector of scaled residuals from
                      after final NLS step.</p> <p>
                    out.weights = vector of weights after adaptive
                      reweighting.</p> <p>
                    out.scale = final scale estimate of the residuals
                      using final weights.</p> <p>
                    out.conflev = confidence level used to declare outliers.</p> <p>
                    out.outliers = vector of the units declared outliers.</p> <p>
                    out.singsub = number of subsets wihtout full rank.</p> <p>
                    out.y = response vector y.</p> <p>
                    out.X = data matrix X containing trend, seasonal, expl
                       (with autoregressive component) and lshift.</p> <p>
                    out.class = 'LTSts'.</p><p>


  Optional Output:</p></p></div></div><div class="expandableContent"><div id="outputarg_msgstr" class="clearfix"></div><h3 id="output_argument_msgstr" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>msgstr</code> &#8212;Last warning message.</span></a><span class="example_desc">String</span></span></h3><div class="collapse"><p>
                      This relates to the execution of the LTS.</p></div></div></div></div></div></div><div class="ref_sect" itemprop="content"><div class="bibliography"><h2 id="References">References</h2> <div><p>Rousseeuw, P.J., Perrotta D., Riani M. and Hubert, M. (2018), Robust
 Monitoring of Many Time Series with Application to Fraud Detection,
 "Econometrics and Statistics". [RPRH]</p></div></div></div><div class="ref_sect"><h2 id="SeeAlso">See Also</h2><p><span itemprop="seealso"><a href="LTSts.html" itemprop="url"><span itemprop="name"><code>LTSts</code></span></a></span></div><i>This page has been automatically generated by our routine <a href="publishFS.html">publishFS</a></i></div></section></div></div></div></div><div id="divbottom"></div></body></html>