<!DOCTYPE HTML> <html itemscope="" xmlns="http://www.w3.org/1999/xhtml"><head><title>FSRtsmdr</title><meta content="refpage" name="chunktype"><meta content="function:FSRtsmdr" itemprop="refentity" name="refentity"><link href="includesFS/bootstrap.min.css" rel="stylesheet" type="text/css"><meta content="text/javascript" http-equiv="Content-Script-Type"><meta content="fcn" itemprop="pagetype" name="toctype"><meta content="ref/function" itemprop="infotype" name="infotype" /><meta content="FSRtsmdr computes minimum deletion residual for time series models in each step of the search." itemprop="description" name="description" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" /><script type="text/x-mathjax-config">MathJax.Hub.Config({extensions: ["tex2jax.js"],jax: ["input/TeX","output/HTML-CSS"],menuSettings: {zoom: "Double-Click", zscale: "300"},tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},MathMenu: {showRenderer: false},"HTML-CSS": {availableFonts: ["TeX"],preferredFont: "TeX",imageFont: null}});</script><script type="text/javascript" src="includesFS/Mathjax/MathJax.js"></script><script src="includesFS/matlab-highlighter.min.js"></script><link href="includesFS/matlab-highlighter.css" rel="stylesheet" type="text/css"><script type="text/javascript" src="includesFS/jquery-latest.js"></script><script>$(document).ready(function(){      $("#divtop").load("includesFS/top.html");      $("#divbottom").load("includesFS/bottom.html");});</script><script src="includesFS/jquery-latest.js" type="text/javascript"></script><link href="includesFS/site6.css?201505100807" rel="stylesheet" type="text/css"><link href="includesFS/site6_lg.css?201505100807" media="screen and (min-width: 1200px)" rel="stylesheet"><link href="includesFS/site6_md.css?201505100807" media="screen and (min-width: 992px) and (max-width: 1199px)" rel="stylesheet"><link href="includesFS/site6_sm+xs.css?201505100807" media="screen and (max-width: 991px)" rel="stylesheet"><link href="includesFS/site6_sm.css?201505100807" media="screen and (min-width: 768px) and (max-width: 991px)" rel="stylesheet"><link href="includesFS/site6_xs.css?201505100807" media="screen and (max-width: 767px)" rel="stylesheet"><link href="includesFS/site6_offcanvas.css?201505100807" rel="stylesheet" type="text/css"><script src="includesFS/l10n.js" type="text/javascript"></script><script src="includesFS/SHAREDdocscripts.js"></script><script src="includesFS/PRODUCTdocscripts.js"></script><script src="includesFS/mw.toc.js" type="text/javascript"></script><script src="includesFS/mw.imagescaling.js" type="text/javascript"></script><script src="includesFS/mw.imageanimation.js" type="text/javascript"></script><script src="includesFS/jquery.highlight.js"></script><script src="includesFS/bootstrap.min.js" type="text/javascript"></script><script src="includesFS/global.js"></script><script src="includesFS/bottom.js" type="text/javascript"></script><script src="includesFS/suggest.js" type="text/javascript"></script><script src="includesFS/underscore-min.js"></script><link href="includesFS/reset.css" rel="stylesheet" type="text/css"><link href="includesFS/960.css" rel="stylesheet" type="text/css"><link href="includesFS/doc_center.css" rel="stylesheet" type="text/css"><link href="includesFS/doc_center_installed.css" rel="stylesheet" type="text/css"><link href="includesFS/doc_center.css" rel="stylesheet" type="text/css"><link href="includesFS/doc_center_installed.css" rel="stylesheet" type="text/css"><link href="includes/product/css/doc_center_print.css" media="print" rel="stylesheet" type="text/css"></head><body  onload="highlightMATLABCode();" id="responsive_offcanvas">  <div id="doc_header_spacer" class="header"></div><div class="sticky_header_container includes_subnav"><div class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-xs-12 col-sm-6 col-sm-push-6 col-md-5 col-md-push-7" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2017a" data-language="en" action="../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="sr-only">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"><div class="input-group-btn"><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search pull-right icon_32 visible-xs" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="col-sm-6 col-sm-pull-6 col-md-7 col-md-pull-5" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../documentation-center.html">Documentation</a></h1></div></div></div><div class="visible-xs" id="search_actuator"><button class="btn icon-search btn_search pull-right icon_16" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div><!--END.CLASS row--> </div><!--END.CLASS container-fluid--> </div><!--END.CLASS section_header level_3--><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_actuator" data-toggle="offcanvas" data-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="sr-only">Toggle navigation</span><span class="icon-menu icon_24"></span></button><span class="offcanvas_actuator_label"></span><span class="offcanvas_actuator_close"></span> </div><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-md-12 hidden-xs hidden-sm"></div></div></div></div></div></div></div><!--END.CLASS sticky_header_container--><div class="row-offcanvas row-offcanvas-left"><div id="sidebar" class="sidebar-offcanvas" role="navigation"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" xmlns:atict="http://www.arbortext.com/namespace/atict"><li itemprop="breadcrumb" itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb"> <a href="../documentation-center.html" itemprop="url"> <span itemprop="title">All Products</span></a></li></ul><ul class="nav_disambiguation" xmlns:atict="http://www.arbortext.com/namespace/atict"><li class="product"><a href="index.html">Flexible Statistics and Data Analysis (FSDA)</a><div class="dropdown"> <span id="dropdownMenu1" class="icon-arrow-down icon_16" data-toggle="dropdown"> </span><ul aria-labelledby="dropdownMenu1" class="dropdown-menu dropdown-menu-right" role="menu"><li role="presentation"> <a href="examples.html" role="menuitem" tabindex="-1">Examples</a></li><li role="presentation"> <a href="function-alpha.html" role="menuitem" tabindex="-1"> Functions and Other Reference</a></li><li role="presentation"> <a href="release_notes.html?s_cid=doc_flyout" role="menuitem" tabindex="-1"> Release Notes</a></li><li role="presentation"> <a href="tutorials.html" role="menuitem" tabindex="-1"> Tutorials</a></li></ul></div></li></ul><ul xmlns:atict="http://www.arbortext.com/namespace/atict" class="nav_disambiguation"> <li><a href="index.html">Flexible Statistics and Data Analysis Toolbox</a> </li> <li><a href="function-cate.html" itemprop="url">Functions</a></li></ul><!-- --><ul class="nav_scrollspy nav" xmlns:atict="http://www.arbortext.com/namespace/atict">  <li class="nav_scrollspy_function"> <a href="#responsive_offcanvas">FSRtsmdr</a></li> <li id="SSPY810-refentry" class="nav_scrollspy_title">On this page</li><li><a class="intrnllnk" href="#syntax">Syntax</a></li><li><a class="intrnllnk" href="#Description">Description</a></li><li><a class="intrnllnk" href="#Examples">Examples</a><ul><li><a class="intrnllnk" href="#Example_1">FSRtsmdr with all default options.</a></li><li><a class="intrnllnk" href="#Example_2">FSRtsmdr with optional arguments.</a></li><li><a class="intrnllnk" href="#Example_3">Analyze units entering the search in the final steps.</a></li><li><a class="intrnllnk" href="#Example_4">Store units forming subsets in selected steps.</a></li><li><a class="intrnllnk" href="#Example_5">Example where initial subset comes from LTSts..</a></li><li><a class="intrnllnk" href="#Example_6"></a></li><li><a class="intrnllnk" href="#Example_7"></a></li></ul></li><li><a class="intrnllnk" href="#Inputs">Input Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_y">y</a></li><li><a class="intrnllnk" href="#input_argument_bsb">bsb</a></li></ul></li><li><a class="intrnllnk" href="#NameValuePairs">Name-Value Pair Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_namevalue_init">init</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_model">model</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_plots">plots</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_nocheck">nocheck</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_msg">msg</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_constr">constr</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_bsbmfullrank">bsbmfullrank</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_bsbsteps">bsbsteps</a></li></ul></li><li><a class="intrnllnk" href="#OutputArgs">Output Arguments</a><ul><li><a class="intrnllnk" href="#output_argument_mdr">mdr</a></li><li><a class="intrnllnk" href="#output_argument_Un">Un</a></li><li><a class="intrnllnk" href="#output_argument_BB">BB</a></li><li><a class="intrnllnk" href="#output_argument_Bols">Bols</a></li><li><a class="intrnllnk" href="#output_argument_S2">S2</a></li><li><a class="intrnllnk" href="#output_argument_Exflag">Exflag</a></li></ul></li><li><a class="intrnllnk" href="#References">References</a></li><li><a class="intrnllnk" href="#SeeAlso">See Also</a></li></ul></nav><script src="includesFS/offcanvas.js"></script></div><div id="divtop"></div><div class="site_container site_toc_closed"><div class="page_container"><div class="content_frame"><div id="content_container" class="content_container"><section id="doc_center_content"><div class="function_ref"><div itemprop="content"><h1 itemprop="title">FSRtsmdr</h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose">FSRtsmdr computes minimum deletion residual for time series models in each step of the search</p><div class="switch"><a id="expandAllPage" href="javascript:void(0);">expand all in page</a></div></div></div></div><div class="ref_sect"><h2 id="syntax">Syntax</h2><div class="syntax_signature"><div class="syntax_signature_module"><ul><li><code class="synopsis">mdr=FSRtsmdr(y,bsb)</code><span class="syntax_example"><a class="intrnllnk" href="FSRtsmdr.html#Example_1">example</a></span></li><li><code class="synopsis">mdr=FSRtsmdr(y,bsb,Name,Value)</code><span class="syntax_example"><a class="intrnllnk" href="FSRtsmdr.html#Example_2">example</a></span></li><li><code class="synopsis">[mdr,Un]=FSRtsmdr(___)</code><span class="syntax_example"><a class="intrnllnk" href="FSRtsmdr.html#Example_3">example</a></span></li><li><code class="synopsis">[mdr,Un,BB]=FSRtsmdr(___)</code><span class="syntax_example"><a class="intrnllnk" href="FSRtsmdr.html#Example_4">example</a></span></li><li><code class="synopsis">[mdr,Un,BB,Bols]=FSRtsmdr(___)</code><span class="syntax_example"><a class="intrnllnk" href="FSRtsmdr.html#Example_5">example</a></span></li><li><code class="synopsis">[mdr,Un,BB,Bols,S2]=FSRtsmdr(___)</code><span class="syntax_example"><a class="intrnllnk" href="FSRtsmdr.html#Example_6">example</a></span></li><li><code class="synopsis">[mdr,Un,BB,Bols,S2,Exflag]=FSRtsmdr(___)</code><span class="syntax_example"><a class="intrnllnk" href="FSRtsmdr.html#Example_7">example</a></span></li></ul></div></div></div>	<div class="ref_sect" itemprop="content">							<h2 id="Description">Description</h2>							<div class="descriptions">								<div class="description_module"><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="FSRtsmdr.html#Example_1">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_mdr"><code>mdr</code></a>=FSRtsmdr(<a class="intrnllnk" href="#inputarg_y"><code>y</code></a>,<a class="intrnllnk" href="#inputarg_bsb"><code>bsb</code></a>)</code></span>FSRtsmdr with all default options.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="FSRtsmdr.html#Example_2">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_mdr"><code>mdr</code></a>=FSRtsmdr(<a class="intrnllnk" href="#inputarg_y"><code>y</code></a>,<a class="intrnllnk" href="#inputarg_bsb"><code>bsb</code></a>,<a class="intrnllnk" href="#namevaluepairarguments"><code>Name, Value</code></a>)</code></span>FSRtsmdr with optional arguments.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="FSRtsmdr.html#Example_3">	example</a></p>	<p><span itemprop="syntax"><code>[<a class="intrnllnk" href="#outputarg_mdr"><code>mdr</code></a>,<a class="intrnllnk" href="#outputarg_Un"><code>Un</code></a>]=FSRtsmdr(___)</code></span>Analyze units entering the search in the final steps.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="FSRtsmdr.html#Example_4">	example</a></p>	<p><span itemprop="syntax"><code>[<a class="intrnllnk" href="#outputarg_mdr"><code>mdr</code></a>,<a class="intrnllnk" href="#outputarg_Un"><code>Un</code></a>,<a class="intrnllnk" href="#outputarg_BB"><code>BB</code></a>]=FSRtsmdr(___)</code></span>Store units forming subsets in selected steps.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="FSRtsmdr.html#Example_5">	example</a></p>	<p><span itemprop="syntax"><code>[<a class="intrnllnk" href="#outputarg_mdr"><code>mdr</code></a>,<a class="intrnllnk" href="#outputarg_Un"><code>Un</code></a>,<a class="intrnllnk" href="#outputarg_BB"><code>BB</code></a>,<a class="intrnllnk" href="#outputarg_Bols"><code>Bols</code></a>]=FSRtsmdr(___)</code></span>Example where initial subset comes from LTSts..</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="FSRtsmdr.html#Example_6">	example</a></p>	<p><span itemprop="syntax"><code>[<a class="intrnllnk" href="#outputarg_mdr"><code>mdr</code></a>,<a class="intrnllnk" href="#outputarg_Un"><code>Un</code></a>,<a class="intrnllnk" href="#outputarg_BB"><code>BB</code></a>,<a class="intrnllnk" href="#outputarg_Bols"><code>Bols</code></a>,<a class="intrnllnk" href="#outputarg_S2"><code>S2</code></a>]=FSRtsmdr(___)</code></span></p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="FSRtsmdr.html#Example_7">	example</a></p>	<p><span itemprop="syntax"><code>[<a class="intrnllnk" href="#outputarg_mdr"><code>mdr</code></a>,<a class="intrnllnk" href="#outputarg_Un"><code>Un</code></a>,<a class="intrnllnk" href="#outputarg_BB"><code>BB</code></a>,<a class="intrnllnk" href="#outputarg_Bols"><code>Bols</code></a>,<a class="intrnllnk" href="#outputarg_S2"><code>S2</code></a>,<a class="intrnllnk" href="#outputarg_Exflag"><code>Exflag</code></a>]=FSRtsmdr(___)</code></span></p></div>								</div>							</div>							<div class="clear">							</div>						</div><div class="ref_sect" itemprop="content"><div class="examples"><h2 id="Examples">Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="example_1" class="example_module expandableContent"><div id="Example_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>FSRtsmdr with all default options.</li></span></a></span></h3><div class="collapse"><p>
     linear trend + just one harmonic for seasonal
     Common part to all examples: load airline dataset.
       1949 1950 1951 1952 1953 1954 1955 1956 1957 1958 1959 1960
    y = [112  115  145  171  196  204  242  284  315  340  360  417     Jan
         118  126  150  180  196  188  233  277  301  318  342  391     Feb
         132  141  178  193  236  235  267  317  356  362  406  419     Mar
         129  135  163  181  235  227  269  313  348  348  396  461     Apr
         121  125  172  183  229  234  270  318  355  363  420  472     May
         135  149  178  218  243  264  315  374  422  435  472  535     Jun
         148  170  199  230  264  302  364  413  465  491  548  622     Jul
         148  170  199  242  272  293  347  405  467  505  559  606     Aug
         136  158  184  209  237  259  312  355  404  404  463  508     Sep
         119  133  162  191  211  229  274  306  347  359  407  461     Oct
         104  114  146  172  180  203  237  271  305  310  362  390     Nov
         118  140  166  194  201  229  278  306  336  337  405  432 ];  Dec
     Source:
     http://datamarket.com/data/list/?q=provider:tsdl<div class="programlisting"><div class="codeinput"><pre class="matlab-code">
    y=(y(:));
    % Monitor minimum deletion residual in each step of the forward search.
    % Start from a random subset. The final part of the trajectory is
    % completely unaffected by the starting point.
    % Plot the trajectory of mdr.
    mdr=FSRtsmdr(y,0,'plots',1);</pre></div></div></p></div></div><div id="example_2" class="example_module expandableContent"><div id="Example_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>FSRtsmdr with optional arguments.</li></span></a></span></h3><div class="collapse"><p>
     Compute minimum deletion residual and start monitoring it from step
     m=80.
     Set up a personalized model.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">
    model=struct;
    model.trend=1;              % linear trend
    model.s=12;                 % monthly time series
    model.seasonal=104;         % four harmonics with time varying seasonality
    % Choose step to start monitoring.
    init=80;             
    out1=FSRtsmdr(y,0,'model',model,'init',80,'plots',1);</pre></div></div></p></div></div><div id="example_3" class="example_module expandableContent"><div id="Example_3"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Analyze units entering the search in the final steps.</li></span></a></span></h3><div class="collapse"><p>
     Common part to all examples: load airline dataset.
       1949 1950 1951 1952 1953 1954 1955 1956 1957 1958 1959 1960
    y = [112  115  145  171  196  204  242  284  315  340  360  417     Jan
         118  126  150  180  196  188  233  277  301  318  342  391     Feb
         132  141  178  193  236  235  267  317  356  362  406  419     Mar
         129  135  163  181  235  227  269  313  348  348  396  461     Apr
         121  125  172  183  229  234  270  318  355  363  420  472     May
         135  149  178  218  243  264  315  374  422  435  472  535     Jun
         148  170  199  230  264  302  364  413  465  491  548  622     Jul
         148  170  199  242  272  293  347  405  467  505  559  606     Aug
         136  158  184  209  237  259  312  355  404  404  463  508     Sep
         119  133  162  191  211  229  274  306  347  359  407  461     Oct
         104  114  146  172  180  203  237  271  305  310  362  390     Nov
         118  140  166  194  201  229  278  306  336  337  405  432 ];  Dec<div class="programlisting"><div class="codeinput"><pre class="matlab-code">
    y=(y(:));
    % Compute minimum deletion residual and analyze the units entering
    % subset in each step of the fwd search (matrix Un).  As is well known,
    % the FS provides an ordering of the data from those most in agreement
    % with a suggested model (which enter the first steps) to those least in
    % agreement with it (which are included in the final steps).
    % Set up a personalized model.
    model=struct;
    model.trend=1;              % linear trend
    model.s=12;                 % monthly time series
    model.seasonal=104;         % four harmonics with time varying seasonality
    % Choose step to start monitoring.
    init=80;             
    [mdr,Un,BB,Bols,S2,Exflag]=FSRtsmdr(y,0,'model',model,'init',80,'plots',1);
    % Check if there was convergence in all step which were monitored.
    if min(Exflag(:,2))&lt;1
        disp('Warning: in some steps there was not convergence')
    else
        disp('Convergence obtained in all steps')
    end
    % Check the last two units which are included in the last two steps.
    disp(Un(end-1:end,:))</pre></div></div><pre class="codeoutput">Convergence obtained in all steps
   143   139   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
   144   142   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN

</pre><img vspace="5" hspace="5" src="images\FSRtsmdr_01.png" alt=""> </p></div></div><div id="example_4" class="example_module expandableContent"><div id="Example_4"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Store units forming subsets in selected steps.</li></span></a></span></h3><div class="collapse"><p>
     In this example the units forming subset are stored just for
     selected steps.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">
    model=struct;
    model.trend=1;              % linear trend
    model.s=12;                 % monthly time series
    model.seasonal=104;         % four harmonics with time varying seasonality
    init=80;             
    [mdr,Un,BB,Bols,S2] =FSRtsmdr(y,0,'model',model,'init',80,'bsbsteps',[90 120]);
    % BB has just two columns
    % First column contains information about units forming subset at step m=90
    % sum(~isnan(BB(:,1))) is 90
    % Second column contains information about units forming subset at step m=120
    % sum(~isnan(BB(:,2))) is 120
    disp(sum(~isnan(BB(:,1))))
    disp(sum(~isnan(BB(:,2))))</pre></div></div><pre class="codeoutput">    90

   120

</pre></p></div></div><div id="example_5" class="example_module expandableContent"><div id="Example_5"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Example where initial subset comes from LTSts..</li></span></a></span></h3><div class="collapse"><p>
     Set up the model.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">
    model=struct;
    model.trend=1;              % linear trend
    model.s=12;                 % monthly time series
    model.seasonal=104;         % four harmonics with time varying seasonality
    % Call LTSts
    out=LTSts(y,'model',model');
    % Extract best initial subset from LTSts.
    [~,indres]=sort(abs(out.residuals));
    bs=indres(1:50);
    [mdr,Un,BB,Bols,S2,Exflag] =FSRtsmdr(y,bs,'model',model,'init',length(bs)+1,'plots',1);</pre></div></div><img vspace="5" hspace="5" src="images\FSRtsmdr_02.png" alt=""> </p></div></div><div id="example_6" class="example_module expandableContent"><div id="Example_6"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li></li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code"></pre></div></div></p></div></div><div id="example_7" class="example_module expandableContent"><div id="Example_7"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li></li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code"></pre></div></div></p></div></div></div><p> </p></div></div><div class="ref_sect" itemprop="content"><h2 id="Inputs">Input Arguments</h2><div class="expandableContent"><div class="arguments"><div class="input_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"> <div id="inputarg_y" class="clearfix"> </div> <h3 id="input_argument_y" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>y</code> &#8212; Time series to analyze. </span>  </a><span class="example_desc">Vector.</span></span></h3> <div class="collapse"> <p>A row or a column vector
               with T elements, which contains the time series.</p> <p class="datatypelist"><strong> Data Types: </strong><code>single| double</code></p> </div> </div><div class="expandableContent"> <div id="inputarg_bsb" class="clearfix"> </div> <h3 id="input_argument_bsb" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>bsb</code> &#8212; list of units forming the initial subset. </span>  </a><span class="example_desc">Vector.</span></span></h3> <div class="collapse"> <p>If bsb=0
               (default) then the procedure starts with p units randomly
               chosen else if bsb is not 0 the search will start with
               m0=length(bsb). p is the total number of regression
               parameters which have to be estimated.</p> <p class="datatypelist"><strong> Data Types: </strong><code>single| double</code></p> </div> </div><div id="namevaluepairarguments" class="clearfix"></div><h3 id="NameValuePairs" class="bottom_ruled">Name-Value Pair Arguments</h3><div class="namevaluecontainer"><p>Specify optional comma-separated pairs of <code>Name,Value</code> arguments. <code>Name</code> is the argument name and <code>Value</code> is the corresponding value. <code>Name</code> must appear  inside single quotes (<code>' '</code>).  You can specify several name and value pair arguments in any order as <code>  Name1,Value1,...,NameN,ValueN</code>.</p>  <span class="example_desc"><strong>Example:</strong><code><code> 'init',100 starts monitoring from step m=100
</code>,<code> 'model', model
</code>,<code> 'plots',1
</code>,<code> 'nocheck',1
</code>,<code> 'msg',1
</code>,<code> 'bsbmfullrank',1
</code>,</code></span></div><div class="expandableContent"><div id="inputarg_init" class="clearfix"></div><h3 id="input_argument_namevalue_init" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>init</code> &#8212;Start of monitoring point.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p>It specifies the point where to initialize the search and
               start monitoring required diagnostics. If it is not
               specified it is set equal floor(0.5*(T+1))
               </p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'init',100 starts monitoring from step m=100
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_model" class="clearfix"></div><h3 id="input_argument_namevalue_model" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>model</code> &#8212;model type.</span></a><span class="example_desc">structure.</span></span></h3><div class="collapse">	<p><p>A structure which specifies the model
               which will be used. The model structure contains the following
               fields:</p> <p>
       </p><table border="2" cellpadding="4" cellspacing="0" class="body"><colgroup><col width="20%"><col width="80%"></colgroup><thead><tr valign="top"><th valign="top">Value</th><th valign="top">Description</th></tr></thead><tr valign="top"><td><code>s</code></td><td><p>scalar (length of seasonal period). For monthly
                         data s=12 (default), for quartely data s=4, ...</p></td></tr><tr valign="top"><td><code>trend</code></td><td><p><p>scalar (order of the trend component).</p> <p>
                       trend = 1 implies linear trend with intercept (default),
                       trend = 2 implies quadratic trend ...</p><p>
                       Admissible values for trend are, 0, 1, 2 and 3.</p></p></td></tr><tr valign="top"><td><code>seasonal</code></td><td><p><p>scalar (integer specifying number of
                        frequencies, i.e. harmonics, in the seasonal
                        component. Possible values for seasonal are
                        $1, 2, ..., [s/2]$, where $[s/2]=floor(s/2)$.</p> <p>
                        For example:</p> <p>
                        if seasonal =1 (default) we have:</p> <p>
                        $\beta_1 \cos( 2 \pi t/s) + \beta_2 sin ( 2 \pi t/s)$;</p> <p>
                        if seasonal =2 we have:</p> <p>
                        $\beta_1 \cos( 2 \pi t/s) + \beta_2 \sin ( 2 \pi t/s)
                        + \beta_3 \cos(4 \pi t/s) + \beta_4 \sin (4 \pi t/s)$.</p> <p>
                        Note that when $s$ is even the sine term disappears
                        for $j=s/2$ and so the maximum number of
                        trigonometric parameters is $s-1$.</p> <p>
                        If seasonal is a number greater than 100 then it
                        is possible to specify how the seasonal component
                        grows over time.</p> <p>
                        For example, seasonal =101 implies a seasonal
                        component which just uses one frequency
                        which grows linearly over time as follows:</p> <p>
                        $(1+\beta_3 t)\times ( \beta_1 cos( 2 \pi t/s) +
                        \beta_2 \sin ( 2 \pi t/s))$.</p> <p>
                        For example, seasonal =201 implies a seasonal
                        component which just uses one frequency
                        which grows in a quadratic way over time as
                        follows:</p> <p>
                        $(1+\beta_3 t + \beta_4  t^2)\times( \beta_1 \cos(
                        2 \pi t/s) + \beta_2 \sin ( 2 \pi t/s))$.</p><p>
                        seasonal =0 implies a non seasonal model.</p></p></td></tr><tr valign="top"><td><code>X</code></td><td><p>matrix of size T-by-nexpl containing the
                         values of nexpl extra covariates which are likely
                         to affect y.</p></td></tr><tr valign="top"><td><code>posLS</code></td><td><p><p>positive integer which specifies to position
                         to include the level shift component.</p> <p>
                         For example if model.posLS =13 then the
                         explanatory variable $I(t \geq 13})$ is created.</p><p>
                         If this field is not present or if it is empty,
                         the level shift component is not included.</p></p></td></tr><tr valign="top"><td><code>B</code></td><td><p><p>column vector or matrix containing the initial
                         values of parameter estimates which have to be used in the
                         maximization procedure. If model.B is a matrix,
                         then initial estimates are extracted from the
                         first colum of this matrix. If this field is
                         empty or if this field is not present, the
                         initial values to be used in the maximization
                         procedure are referred to the OLS parameter
                         estimates of the linear part of the model. The
                         parameters associated to time varying amplitude
                         are initially set to 0.</p> <p>
                                Remark: the default model is for monthly data with a linear
               trend (2 parameters) + seasonal component with just one
               harmonic (2 parameters), no additional explanatory
               variables and no level shift that is
                               model=struct;</p> <p>
                               model.s=12;</p> <p>
                               model.trend=1;</p> <p>
                               model.seasonal=1;</p> <p>
                               model.X='';</p><p>
                               model.posLS='';</p></p></td></tr></table></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'model', model
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>struct</code></p></div></div><div class="expandableContent"><div id="inputarg_plots" class="clearfix"></div><h3 id="input_argument_namevalue_plots" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>plots</code> &#8212;Plot on the screen.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>If equal to one a plot of
               minimum deletion residual appears  on the screen with 1%,
               50% and 99% confidence bands else (default) no plot is
               shown.</p> <p>
                              Remark: the plot which is produced is very simple. In order
               to control a series of options in this plot and in order to
               connect it dynamically to the other forward plots it is
               necessary to use function mdrplot.</p><p>
</p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'plots',1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_nocheck" class="clearfix"></div><h3 id="input_argument_namevalue_nocheck" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>nocheck</code> &#8212;Check input arguments.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p>If nocheck is equal to 1 no check is performed on
               matrix y and matrix X. Notice that y and X are left
               unchanged. In other words the additioanl column of ones for
               the intercept is not added. As default nocheck=0. The
               controls on h, alpha and nsamp still remain
               </p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'nocheck',1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_msg" class="clearfix"></div><h3 id="input_argument_namevalue_msg" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>msg</code> &#8212;Level of output to display.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p>It controls whether to
               display or not messages about great interchange on the
               screen If msg==1 (default)
               messages are displayed on the screen
               else no message is displayed on the screen
               </p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'msg',1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_constr" class="clearfix"></div><h3 id="input_argument_namevalue_constr" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>constr</code> &#8212;Constrained search.</span></a><span class="example_desc">vector.</span></span></h3><div class="collapse">	<p>r x 1 vector which contains the list of units which are
               forced to join the search in the last r steps. The default
               is constr=''.  No constraint is imposed
               </p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'constr',[1:10] forces the first 10 units to join
</code>               the subset in the last 10 steps</p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_bsbmfullrank" class="clearfix"></div><h3 id="input_argument_namevalue_bsbmfullrank" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>bsbmfullrank</code> &#8212;What to do in case subset at step m (say bsbm) produces a
               non singular X.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>This options controls what to do when rank(X(bsbm,:)) is
               smaller then number of explanatory variables.</p> <p>
               If bsbmfullrank = 1 (default is 1) these units (whose number
               is say mnofullrank) are constrained to enter the search in
               the final n-mnofullrank steps else the search continues
               using as estimate of beta at step m the estimate of beta
               found in the previous step.</p><p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'bsbmfullrank',1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_bsbsteps" class="clearfix"></div><h3 id="input_argument_namevalue_bsbsteps" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>bsbsteps</code> &#8212;Save the units forming subsets.</span></a><span class="example_desc">vector.</span></span></h3><div class="collapse">	<p><p>It specifies for
               which steps of the fwd search it
               is necessary to save the units forming subsets. If bsbsteps
               is 0 we store the units forming subset in all steps. The
               default is store the units forming subset in all steps if
               n&lt;=5000, else to store the units forming subset at steps
               init and steps which are multiple of 100. For example, as
               default, if T=753 and init=6,
               units forming subset are stored for
               m=init, 100, 200, 300, 400, 500 and 600.</p> <p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'bsbsteps',[100 200] stores the unis forming
</code>               subset in steps 100 and 200.</p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="OutputArgs" >Output Arguments</h2><div class="expandableContent"><div class="arguments"><div class="output_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"><div id="outputarg_mdr" class="clearfix"></div><h3 id="output_argument_mdr" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>mdr</code> &#8212;Monitoring of minimum
               deletion residual at each step of the forward search.</span></a><span class="example_desc"><code>T -init -by- 2 </code>matrix</span></span></h3><div class="collapse"><p><p>
               1st col = fwd search index (from init to T-1).</p> <p>
               2nd col = minimum deletion residual.</p><p>
               REMARK: if in a certain step of the search matrix is
               singular, this procedure checks how many observations
               produce a singular matrix. In this case mdr is a column
               vector which contains the list of units for which matrix X
               is non singular.</p></p></div></div><div class="expandableContent"><div id="outputarg_Un" class="clearfix"></div><h3 id="output_argument_Un" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>Un</code> &#8212;Units included in each step.</span></a><span class="example_desc"><code> </code>Matrix</span></span></h3><div class="collapse"><p><p>
               (n-init) x 11 Matrix which contains the unit(s) included
               in the subset at each step of the search.</p> <p>
               REMARK: in every step the new subset is compared with the
               old subset. Un contains the unit(s) present in the new
               subset but not in the old one.</p> <p>
               Un(1,2) for example contains the unit included in step
               init+1.</p><p>
               Un(end,2) contains the units included in the final step
               of the search.</p></p></div></div><div class="expandableContent"><div id="outputarg_BB" class="clearfix"></div><h3 id="output_argument_BB" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>BB</code> &#8212;Units belonging to subset in each step.</span></a><span class="example_desc"><code> </code>Matrix</span></span></h3><div class="collapse"><p><p>
               n x (n-init+1) or n-by-length(bsbsteps) matrix (depending on input
               option bsbsteps) which contains information about the units
               belonging to the subset at each step of the forward search.</p> <p>
               BB has the following structure
               1-st row has number 1 in correspondence of the steps in
                   which unit 1 is included inside subset and a missing
                   value for the other steps
               ......</p><p>
               (n-1)-th row has number n-1 in correspondence of the steps in
                   which unit n-1 is included inside subset and a missing
                   value for the other steps
               n-th row has number n in correspondence of the steps in
                   which unit n is included inside subset and a missing
                   value for the other steps
               The size of matrix BB is n x (n-init+1) if option input
               bsbsteps is 0 else the size is n-by-length(bsbsteps).</p></p></div></div><div class="expandableContent"><div id="outputarg_Bols" class="clearfix"></div><h3 id="output_argument_Bols" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>Bols</code> &#8212;OLS coefficents.</span></a><span class="example_desc"><code> </code>Matrix</span></span></h3><div class="collapse"><p>
               (n-init+1) x (p+1) matrix containing the monitoring of
               estimated beta coefficients in each step of the forward
               search.</p></div></div><div class="expandableContent"><div id="outputarg_S2" class="clearfix"></div><h3 id="output_argument_S2" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>S2</code> &#8212;S2 and R2.</span></a><span class="example_desc"><code> </code>Matrix</span></span></h3><div class="collapse"><p>
               (n-init+1) x 3 matrix containing the monitoring of S2 (2nd
               column)and R2 (third column) in each step of the forward
               search.</p></div></div><div class="expandableContent"><div id="outputarg_Exflag" class="clearfix"></div><h3 id="output_argument_Exflag" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>Exflag</code> &#8212;Reason nlinfit stopped.</span></a><span class="example_desc"><code> Integer </code>matrix</span></span></h3><div class="collapse"><p><p>
               (n-init+1) x 2 matrix containing information about the
               result  of the maximization procedure.</p> <p>
               If the model is non linear out.Exflag(i,2) is equal to 1
               if at step out.Exflag(i,1) the maximization procedure did not produce
               warnings or the warning was different from
               "ILL Conditiioned Jacobian". For any other warning
               which is produced (for example,
               "Overparameterized", "IterationLimitExceeded",
               'MATLAB:rankDeficientMatrix") out.Exflag(i,2) is equal
               to -1;</p></p></div></div></div></div></div></div><div class="ref_sect" itemprop="content"><div class="bibliography"><h2 id="References">References</h2> <div><p>Atkinson, A.C. and Riani, M. (2006), Distribution theory and
 simulations for tests of outliers in regression, "Journal of
 Computational and Graphical Statistics", Vol. 15, pp. 460-476.</p></div><div><p>Riani, M. and Atkinson, A.C. (2007), Fast calibrations of the forward
 search for testing multiple outliers in regression, "Advances in Data
 Analysis and Classification", Vol. 1, pp. 123-141.</p></div><div><p>Rousseeuw, P.J., Perrotta D., Riani M. and Hubert, M. (2018), Robust
 Monitoring of Many Time Series with Application to Fraud Detection,
 "Econmetrics and Statistics". [RPRH]</p></div></div></div><div class="ref_sect"><h2 id="SeeAlso">See Also</h2><p><span itemprop="seealso"><a href="LTSts.html" itemprop="url"><span itemprop="name"><code>LTSts</code></span></a></span> | <span itemprop="seealso"><a href="FSRtsmdr.html" itemprop="url"><span itemprop="name"><code>FSRtsmdr</code></span></a></span> | <span itemprop="seealso"><a href="FSRts.html" itemprop="url"><span itemprop="name"><code>FSRts</code></span></a></span></div><i>This page has been automatically generated by our routine <a href="publishFS.html">publishFS</a></i></div></section></div></div></div></div><div id="divbottom"></div></body></html>