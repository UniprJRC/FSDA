<!DOCTYPE HTML> <html itemscope="" xmlns="http://www.w3.org/1999/xhtml"><head><title>forecastTS</title><meta content="refpage" name="chunktype"><meta content="function:forecastTS" itemprop="refentity" name="refentity"><link href="includesFS/bootstrap.min.css" rel="stylesheet" type="text/css"><meta content="text/javascript" http-equiv="Content-Script-Type"><meta content="fcn" itemprop="pagetype" name="toctype"><meta content="ref/function" itemprop="infotype" name="infotype" /><meta content="Forecast for a time series with trend, time varying seasonal, level shift and irregular component." itemprop="description" name="description" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" /><script type="text/x-mathjax-config">MathJax.Hub.Config({extensions: ["tex2jax.js"],jax: ["input/TeX","output/HTML-CSS"],menuSettings: {zoom: "Double-Click", zscale: "300"},tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},MathMenu: {showRenderer: false},"HTML-CSS": {availableFonts: ["TeX"],preferredFont: "TeX",imageFont: null}});</script><script type="text/javascript" src="includesFS/Mathjax/MathJax.js"></script><script src="includesFS/matlab-highlighter.min.js"></script><link href="includesFS/matlab-highlighter.css" rel="stylesheet" type="text/css"><script type="text/javascript" src="includesFS/jquery-latest.js"></script><script>$(document).ready(function(){      $("#divtop").load("includesFS/top.html");      $("#divbottom").load("includesFS/bottom.html");});</script><script src="includesFS/jquery-latest.js" type="text/javascript"></script><link href="includesFS/site6.css?201505100807" rel="stylesheet" type="text/css"><link href="includesFS/site6_lg.css?201505100807" media="screen and (min-width: 1200px)" rel="stylesheet"><link href="includesFS/site6_md.css?201505100807" media="screen and (min-width: 992px) and (max-width: 1199px)" rel="stylesheet"><link href="includesFS/site6_sm+xs.css?201505100807" media="screen and (max-width: 991px)" rel="stylesheet"><link href="includesFS/site6_sm.css?201505100807" media="screen and (min-width: 768px) and (max-width: 991px)" rel="stylesheet"><link href="includesFS/site6_xs.css?201505100807" media="screen and (max-width: 767px)" rel="stylesheet"><link href="includesFS/site6_offcanvas.css?201505100807" rel="stylesheet" type="text/css"><script src="includesFS/l10n.js" type="text/javascript"></script><script src="includesFS/SHAREDdocscripts.js"></script><script src="includesFS/PRODUCTdocscripts.js"></script><script src="includesFS/mw.toc.js" type="text/javascript"></script><script src="includesFS/mw.imagescaling.js" type="text/javascript"></script><script src="includesFS/mw.imageanimation.js" type="text/javascript"></script><script src="includesFS/jquery.highlight.js"></script><script src="includesFS/bootstrap.min.js" type="text/javascript"></script><script src="includesFS/global.js"></script><script src="includesFS/bottom.js" type="text/javascript"></script><script src="includesFS/underscore-min.js"></script><script src="../includes/shared/scripts/F1help.js" type="text/javascript"></script><script src="../includes/product/scripts/suggest.js" type="text/javascript"></script><script src="../includes/shared/scripts/helpservices.js" type="text/javascript"></script><link href="includesFS/reset.css" rel="stylesheet" type="text/css"><link href="includesFS/960.css" rel="stylesheet" type="text/css"><link href="includesFS/doc_center.css" rel="stylesheet" type="text/css"><link href="includesFS/doc_center_installed.css" rel="stylesheet" type="text/css"><link href="includesFS/doc_center.css" rel="stylesheet" type="text/css"><link href="includesFS/doc_center_installed.css" rel="stylesheet" type="text/css"><link href="includes/product/css/doc_center_print.css" media="print" rel="stylesheet" type="text/css"></head><body  onload="highlightMATLABCode();" id="responsive_offcanvas">  <div id="doc_header_spacer" class="header"></div><div class="sticky_header_container includes_subnav"><div class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-xs-12 col-sm-6 col-sm-push-6 col-md-5 col-md-push-7" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2017a" data-language="en" action="../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="sr-only">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"><div class="input-group-btn"><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search pull-right icon_32 visible-xs" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="col-sm-6 col-sm-pull-6 col-md-7 col-md-pull-5" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../documentation-center.html">Documentation</a></h1></div></div></div><div class="visible-xs" id="search_actuator"><button class="btn icon-search btn_search pull-right icon_16" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div><!--END.CLASS row--> </div><!--END.CLASS container-fluid--> </div><!--END.CLASS section_header level_3--><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_actuator" data-toggle="offcanvas" data-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="sr-only">Toggle navigation</span><span class="icon-menu icon_24"></span></button><span class="offcanvas_actuator_label"></span><span class="offcanvas_actuator_close"></span> </div><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-md-12 hidden-xs hidden-sm"></div></div></div></div></div></div></div><!--END.CLASS sticky_header_container--><div class="row-offcanvas row-offcanvas-left"><div id="sidebar" class="sidebar-offcanvas" role="navigation"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" xmlns:atict="http://www.arbortext.com/namespace/atict"><li itemprop="breadcrumb" itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb"> <a href="../documentation-center.html" itemprop="url"> <span itemprop="title">All Products</span></a></li></ul><ul class="nav_disambiguation" xmlns:atict="http://www.arbortext.com/namespace/atict"><li class="product"><a href="index.html">Flexible Statistics and Data Analysis (FSDA)</a><div class="dropdown"> <span id="dropdownMenu1" class="icon-arrow-down icon_16" data-toggle="dropdown"> </span><ul aria-labelledby="dropdownMenu1" class="dropdown-menu dropdown-menu-right" role="menu"><li role="presentation"> <a href="examples.html" role="menuitem" tabindex="-1">Examples</a></li><li role="presentation"> <a href="function-alpha.html" role="menuitem" tabindex="-1"> Functions and Other Reference</a></li><li role="presentation"> <a href="release_notes.html?s_cid=doc_flyout" role="menuitem" tabindex="-1"> Release Notes</a></li><li role="presentation"> <a href="tutorials.html" role="menuitem" tabindex="-1"> Tutorials</a></li></ul></div></li></ul><ul xmlns:atict="http://www.arbortext.com/namespace/atict" class="nav_disambiguation"> <li><a href="index.html">Flexible Statistics and Data Analysis Toolbox</a> </li> <li><a href="function-cate.html" itemprop="url">Functions</a></li></ul><!-- --><ul class="nav_scrollspy nav" xmlns:atict="http://www.arbortext.com/namespace/atict">  <li class="nav_scrollspy_function"> <a href="#responsive_offcanvas">forecastTS</a></li> <li id="SSPY810-refentry" class="nav_scrollspy_title">On this page</li><li><a class="intrnllnk" href="#syntax">Syntax</a></li><li><a class="intrnllnk" href="#Description">Description</a></li><li><a class="intrnllnk" href="#Examples">Examples</a><ul><li><a class="intrnllnk" href="#Example_1">Linear time varying seasonal component.</a></li><li><a class="intrnllnk" href="#Example_2">Quadratic trend and constant seasonal.</a></li></ul></li><li><a class="intrnllnk" href="#ExtraExamples">Extra Examples</a><ul><li><a class="intrnllnk" href="#ExtraExample_1">Simulated time series with quadratic trend, fixed seasonal and level shift.</a></li><li><a class="intrnllnk" href="#ExtraExample_2">Contaminated airline data (1).</a></li><li><a class="intrnllnk" href="#ExtraExample_3">Contaminated airline data (2).</a></li><li><a class="intrnllnk" href="#ExtraExample_4">Example with simulated data.</a></li><li><a class="intrnllnk" href="#ExtraExample_5">Example of foreasting in a model with explanatory variables.</a></li><li><a class="intrnllnk" href="#ExtraExample_6">Forecast with autoregressive components and expl var.</a></li><li><a class="intrnllnk" href="#ExtraExample_7">Check accuracy of forecasts.</a></li></ul></li><li><a class="intrnllnk" href="#Inputs">Input Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_outEST">outEST</a></li></ul></li><li><a class="intrnllnk" href="#NameValuePairs">Name-Value Pair Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_namevalue_model">model</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_nfore">nfore</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_conflev">conflev</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_plots">plots</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_titl">titl</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_StartDate">StartDate</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_FileNameOutput">FileNameOutput</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_dispresults">dispresults</a></li></ul></li><li><a class="intrnllnk" href="#OutputArgs">Output Arguments</a><ul><li><a class="intrnllnk" href="#output_argument_outFORE">outFORE</a></li></ul></li><li><a class="intrnllnk" href="#References">References</a></li><li><a class="intrnllnk" href="#SeeAlso">See Also</a></li></ul></nav><script src="includesFS/offcanvas.js"></script></div><div id="divtop"></div><div class="site_container site_toc_closed"><div class="page_container"><div class="content_frame"><div id="content_container" class="content_container"><section id="doc_center_content"><div class="function_ref"><div itemprop="content"><h1 itemprop="title">forecastTS</h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose">Forecast for a time series with trend, time varying seasonal, level shift and irregular component</p><div class="switch"><a id="expandAllPage" href="javascript:void(0);">expand all in page</a></div></div></div></div><div class="ref_sect"><h2 id="syntax">Syntax</h2><div class="syntax_signature"><div class="syntax_signature_module"><ul><li><code class="synopsis">outFORE=forecastTS(outEST)</code><span class="syntax_example"><a class="intrnllnk" href="forecastTS.html#Example_1">example</a></span></li><li><code class="synopsis">outFORE=forecastTS(outEST,Name,Value)</code><span class="syntax_example"><a class="intrnllnk" href="forecastTS.html#Example_2">example</a></span></li></ul></div></div></div>	<div class="ref_sect" itemprop="content">							<h2 id="Description">Description</h2>							<div class="descriptions">								<div class="description_module"><p>forecastTS produces forecasts with confidence bands for a time series
 with trend (up to third order), seasonality (constant or of varying
 amplitude) with a different number of harmonics, level shift and
 explanatory variables.</p><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="forecastTS.html#Example_1">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_outFORE"><code>outFORE</code></a>=forecastTS(<a class="intrnllnk" href="#inputarg_outEST"><code>outEST</code></a>)</code></span>Linear time varying seasonal component.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="forecastTS.html#Example_2">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_outFORE"><code>outFORE</code></a>=forecastTS(<a class="intrnllnk" href="#inputarg_outEST"><code>outEST</code></a>,<a class="intrnllnk" href="#namevaluepairarguments"><code>Name, Value</code></a>)</code></span>Quadratic trend and constant seasonal.</p></div>								</div>							</div>							<div class="clear">							</div>						</div><div class="ref_sect" itemprop="content"><div class="examples"><h2 id="Examples">Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="example_1" class="example_module expandableContent"><div id="Example_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Linear time varying seasonal component.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">close all
rng(1)
model=struct;
model.trend=1;
model.seasonal=103;
modelSIM=model;
modelSIM.trendb=[0 0];
modelSIM.seasonalb=40*[0.1 -0.5 0.2 -0.3 0.3 -0.1 0.222];
modelSIM.signal2noiseratio=20;
T=100;
% Simulate
outSIM=simulateTS(T,'model',modelSIM,'plots',1);
ySIM=outSIM.y;
% Estimate
outEST=LTSts(ySIM,'model',model,'plots',1);
% Forecast
outFORE=forecastTS(outEST,'model',model,'plots',1);</pre></div></div><img vspace="5" hspace="5" src="images/forecastTS_01.png" alt=""> <img vspace="5" hspace="5" src="images/forecastTS_02.png" alt=""> <img vspace="5" hspace="5" src="images/forecastTS_03.png" alt=""> </p></div></div><div id="example_2" class="example_module expandableContent"><div id="Example_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Quadratic trend and constant seasonal.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">close all
rng(1)
model=struct;
model.trend=2;
model.seasonal=3;
modelSIM=model;
modelSIM.trendb=[100 10 -0.05];
modelSIM.seasonalb=400*[0.1 -0.5 0.2 -0.3 0.3 -0.1];
modelSIM.signal2noiseratio=1;
T=100;
% Simulate
outSIM=simulateTS(T,'model',modelSIM,'plots',1);
ySIM=outSIM.y;
% Estimate
outEST=LTSts(ySIM,'model',model,'plots',1);
% Forecast
outFORE=forecastTS(outEST,'model',model,'plots',1);</pre></div></div><img vspace="5" hspace="5" src="images/forecastTS_04.png" alt=""> <img vspace="5" hspace="5" src="images/forecastTS_05.png" alt=""> <img vspace="5" hspace="5" src="images/forecastTS_06.png" alt=""> </p></div></div></div><p> </p><h3 id="ExtraExamples" class="bottom_ruled">Related Examples</h3><div id="ExtraExample_1" class="example_module expandableContent"><div id="ExtraExample_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Simulated time series with quadratic trend, fixed seasonal and level shift.</li></span></a></span></h3><div class="collapse"><p>
     A time series of 100 observations is simulated from a model which
     contains a quadratic trend, a seasonal component with two harmonics
     no explanatory variables and a level shift in position 30 with size
     5000 and a signal to noise ratio egual to 20<div class="programlisting"><div class="codeinput"><pre class="matlab-code">close all
rng(1)
model=struct;
model.trend=2;
model.seasonal=2;
model.lshift=30;
modelSIM=model;
modelSIM.trendb=[5,10,-3];
modelSIM.seasonalb=100*[2 4 0.1 8];
modelSIM.signal2noiseratio=20;
modelSIM.lshiftb=10000;
T=100;
% Simulate
outSIM=simulateTS(T,'model',modelSIM,'plots',1);
ySIM=outSIM.y;
% Estimate
%  model.lshift=5 implies that LS is investigated from position 5
model.lshift=5;
outEST=LTSts(ySIM,'model',model,'plots',1,'msg',0);
% Forecast
outFORE=forecastTS(outEST,'model',model,'plots',1);</pre></div></div><img vspace="5" hspace="5" src="images/forecastTS_07.png" alt=""> <img vspace="5" hspace="5" src="images/forecastTS_08.png" alt=""> <img vspace="5" hspace="5" src="images/forecastTS_09.png" alt=""> </p></div></div><div id="ExtraExample_2" class="example_module expandableContent"><div id="ExtraExample_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Contaminated airline data (1).</li></span></a></span></h3><div class="collapse"><p>
     Load the data.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">%   1949 1950 1951 1952 1953 1954 1955 1956 1957 1958 1959 1960
y = [112  115  145  171  196  204  242  284  315  340  360  417   % Jan
118  126  150  180  196  188  233  277  301  318  342  391    % Feb
132  141  178  193  236  235  267  317  356  362  406  419    % Mar
129  135  163  181  235  227  269  313  348  348  396  461    % Apr
121  125  172  183  229  234  270  318  355  363  420  472    % May
135  149  178  218  243  264  315  374  422  435  472  535    % Jun
148  170  199  230  264  302  364  413  465  491  548  622    % Jul
148  170  199  242  272  293  347  405  467  505  559  606    % Aug
136  158  184  209  237  259  312  355  404  404  463  508    % Sep
119  133  162  191  211  229  274  306  347  359  407  461    % Oct
104  114  146  172  180  203  237  271  305  310  362  390    % Nov
118  140  166  194  201  229  278  306  336  337  405  432 ]; % Dec
y=y(:);
% Contaminate the first 20 observations
y(1:20)=y(1:20)+200;
close all
% Model with linear trend, three harmonics for seasonal component and
% varying amplitude using a linear trend. Search for a level shift
model=struct;
model.trend=1;              % linear trend
model.s=12;                 % monthly time series
model.seasonal=103;         % three harmonics with linear time varying seasonality
model.lshift=10;            % search for level shift
out=LTSts(y,'model',model,'plots',1,'dispresults',true,'msg',0);
% 3 years forecasts
nfore=36;
StartDate=[1949 1];
conflev=0.999; % Wide confidence level for the forecast
outFORE=forecastTS(out,'model',model,'nfore',nfore,'StartDate',StartDate,'conflev',conflev);</pre></div></div><pre class="codeoutput">        lab          bhat          se        tstat         pval    
    ___________    _________    ________    ________    ___________

    'b_trend1'        301.92      3.3892      89.083    3.9559e-121
    'b_trend2'        2.7612    0.038653      71.435    1.5165e-108
    'b_cos1'         -2.1239      2.8813    -0.73715        0.46232
    'b_sin1'         -1.0546      1.4327    -0.73612        0.46295
    'b_cos2'       -0.094731     0.15537    -0.60971        0.54309
    'b_sin2'           1.216      1.6514     0.73635         0.4628
    'b_cos3'         0.52291     0.71389     0.73248        0.46516
    'b_sin3'        -0.17542     0.24875    -0.70518        0.48192
    'b_varampl'      0.24992     0.35327     0.70743        0.48053
    'b_lshift'        -225.8      4.5708     -49.402     7.0551e-88

Level shift position t=21
</pre><img vspace="5" hspace="5" src="images/forecastTS_10.png" alt=""> <img vspace="5" hspace="5" src="images/forecastTS_11.png" alt=""> </p></div></div><div id="ExtraExample_3" class="example_module expandableContent"><div id="ExtraExample_3"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Contaminated airline data (2).</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">close all
% In this example we estimate a model without the seasonal component
%   1949 1950 1951 1952 1953 1954 1955 1956 1957 1958 1959 1960
y = [112  115  145  171  196  204  242  284  315  340  360  417   % Jan
118  126  150  180  196  188  233  277  301  318  342  391    % Feb
132  141  178  193  236  235  267  317  356  362  406  419    % Mar
129  135  163  181  235  227  269  313  348  348  396  461    % Apr
121  125  172  183  229  234  270  318  355  363  420  472    % May
135  149  178  218  243  264  315  374  422  435  472  535    % Jun
148  170  199  230  264  302  364  413  465  491  548  622    % Jul
148  170  199  242  272  293  347  405  467  505  559  606    % Aug
136  158  184  209  237  259  312  355  404  404  463  508    % Sep
119  133  162  191  211  229  274  306  347  359  407  461    % Oct
104  114  146  172  180  203  237  271  305  310  362  390    % Nov
118  140  166  194  201  229  278  306  336  337  405  432 ]; % Dec
y=y(:);
% Contaminate the first 20 observations
y(1:20)=y(1:20)+200;
% Model with linear trend and no seasonal component. Search for a level shift
model=struct;
model.trend=1;              % linear trend
model.s=12;                 % monthly time series
model.seasonal=[];          % no seasonal component
model.lshift=10;            % search for level shift
out=LTSts(y,'model',model,'plots',1,'dispresults',true,'msg',0);
% 3 years forecasts
nfore=36;
StartDate=[1949 1];
conflev=0.999; % Wide confidence level for the forecast
outFORE=forecastTS(out,'model',model,'nfore',nfore,'StartDate',StartDate,'conflev',conflev);</pre></div></div><pre class="codeoutput">       lab         bhat         se        tstat        pval   
    __________    _______    ________    _______    __________

    'b_trend1'     307.43      7.2337       42.5    2.8696e-82
    'b_trend2'     2.3919    0.087445     27.354    3.0083e-58
    'b_lshift'    -214.71      9.7761    -21.963    2.3563e-47

Level shift position t=21
</pre><img vspace="5" hspace="5" src="images/forecastTS_12.png" alt=""> <img vspace="5" hspace="5" src="images/forecastTS_13.png" alt=""> </p></div></div><div id="ExtraExample_4" class="example_module expandableContent"><div id="ExtraExample_4"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Example with simulated data.</li></span></a></span></h3><div class="collapse"><p>
     Simulate data with linear trend, time varying seasonal component, and
     level shift<div class="programlisting"><div class="codeinput"><pre class="matlab-code">rng(1)
model=struct;
model.trend=1;
model.trendb=[1 1];
model.seasonal=103;
model.seasonalb=40*[0.5 -0.5 0.3 -0.3 0.1 -0.1 0.222];
model.lshift=40;
model.lshiftb=13000;
model.signal2noiseratio=20;
T=150;
FileNameOutput=[pwd filesep 'ysimout.txt'];
outSIM=simulateTS(T,'model',model,'FileNameOutput',FileNameOutput,...
'plots',true,'samescale',true);
y=outSIM.y;
% Data contamination
y(131:140)=y(131:140)-29000;
% Estimation
modelEST=struct;
modelEST.trend=1;
modelEST.seasonal=103;
modelEST.lshift=30;
outEST=LTSts(y,'model',modelEST,'dispresults',true,'plots',0);
% Forecasting
% nfore= number of forecasts;
nfore=36;
% Forecasts with a 99.9 per cent confidence level
OUTfore=forecastTS(outEST,'model',modelEST,'nfore',nfore,'conflev',0.999);</pre></div></div></p></div></div><div id="ExtraExample_5" class="example_module expandableContent"><div id="ExtraExample_5"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Example of foreasting in a model with explanatory variables.</li></span></a></span></h3><div class="collapse"><p>
     Simulated data with linear trend, varying seasonal and 1
     explanatory variable.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">rng(1000)
model=struct;
model.trend=1;
model.trendb=[5,1000];
model.seasonal=102;
model.seasonalb=100*[2 4 0.1 8 0.001];
model.signal2noiseratio=10;
T=120;
Xall=1e+2*randn(T,1);
model.X=Xall;
model.Xb=100;
out=simulateTS(T,'model',model,'plots',1);
% Fit a model using just the first 100 obs
yall=out.y;
Tred=100;
y=yall(1:Tred);
X=Xall(1:Tred,:);
model=struct;
model.trend=1;
model.seasonal=102;
% Potential level shift position is investigated in positions:
% t=10, t=11, ..., t=T-10.
model.lshift=0;
model.X=X;
out=LTSts(y,'model',model,'plots',1,'dispresults',true);
% Note that in this case all the 120 values of Xall are supplied and
% the number of forecasts is 20
model.X=Xall;
forecastTS(out,'model',model,'nfore',20)</pre></div></div></p></div></div><div id="ExtraExample_6" class="example_module expandableContent"><div id="ExtraExample_6"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Forecast with autoregressive components and expl var.</li></span></a></span></h3><div class="collapse"><p>
     Simulated data with linear trend, varying seasonal and AR(2)<div class="programlisting"><div class="codeinput"><pre class="matlab-code">rng(1000)
model=struct;
model.trend=1;
model.trendb=[5,1000];
model.seasonal=102;
model.seasonalb=100*[2 4 0.1 8 0.001];
model.signal2noiseratio=10;
model.ARb=[0.2 0.7];
T=100;
out=simulateTS(T,'model',model,'plots',1);
% Fit a model imposing linear trend, sesonal component and AR(2)
y=out.y;
nfore=20;
Xall=1e+2*randn(T+nfore,1);
X=Xall(1:T,:);
model=struct;
model.trend=1;
model.seasonal=102;
% No level shift
model.lshift=0;
% Add a nonn important expl. variable
model.X=X;
model.ARp=2;
out=LTSts(y,'model',model,'plots',1,'dispresults',true);
% Note that in this case all the 120 values of Xall are supplied and
% the number of forecasts is 20
model.X=Xall;
forecastTS(out,'model',model,'nfore',20)</pre></div></div></p></div></div><div id="ExtraExample_7" class="example_module expandableContent"><div id="ExtraExample_7"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Check accuracy of forecasts.</li></span></a></span></h3><div class="collapse"><p>
     AR(2) model with fixed seasonal<div class="programlisting"><div class="codeinput"><pre class="matlab-code">rng(1000)
model=struct;
model.trend=1;
model.trendb=[5,0.01];
model.seasonal=2;
model.seasonalb=0.1*[2 4 0.1 2];
model.signal2noiseratio=10;
model.ARb=[0.2 0.3];
T=150;
out=simulateTS(T,'model',model,'plots',1);
yall=out.y;
% Fit a model imposing linear trend, sesonal component and AR(2)
y=out.y(1:100);
nfore=50;
model=struct;
model.trend=1;
model.seasonal=2;
% No level shift
model.lshift=0;
model.ARp=2;
out=LTSts(y,'model',model,'plots',1,'dispresults',true);
% Note that in this case all the 120 values of Xall are supplied and
% the number of forecasts is 20
forecastTS(out,'model',model,'nfore',50,'conflev',0.75)
hold('on')
plot(1:length(yall),yall)</pre></div></div></p></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="Inputs">Input Arguments</h2><div class="expandableContent"><div class="arguments"><div class="input_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"> <div id="inputarg_outEST" class="clearfix"> </div> <h3 id="input_argument_outEST" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>outEST</code> &#8212; A structure containing the output of routine LTSts. </span>  </a><span class="example_desc">Structure.</span></span></h3> <div class="collapse"> <p><p>Structure containing the following fields.</p> <p>
  </p><table border="2" cellpadding="4" cellspacing="0" class="body"><colgroup><col width="20%"><col width="80%"></colgroup><thead><tr valign="top"><th valign="top">Value</th><th valign="top">Description</th></tr></thead><tr valign="top"><td><code>B</code></td><td><p><p>Matrix containing estimated beta coefficients,
                       (including the intercept when options.intercept=1)
                       standard errors, t-stat and p-values
                       The content of matrix B is as follows:</p> <p>
                       1st col = beta coefficients
                        The order of the beta coefficients is as follows:</p> <p>
                        1) trend elements (if present). If the trend is
                        of order two there are r+1 coefficients if the
                        intercept is present otherwise there are just r
                        components;</p> <p>
                        2) linear part of seasonal component 2, 4, 6, ...,
                        s-2, s-1 coefficients (if present);</p> <p>
                        3) coefficients associated with the matrix of
                        explanatory variables and/or autoregressive part
                        which have a potential effect on the time series
                        under study (X);</p> <p>
                        4) non linear part of seasonal component, that is
                        varying amplitude. If varying amplitude is of order
                        k there are k coefficients (if present);</p> <p>
                        5) level shift component (if present). In this case
                        there are two coefficients, the second (which is
                        also the last element of vector beta) is an integer
                        which specifies the time in which level shift takes
                        place and the first (which is also the penultime
                        element of vector beta) is a real number which
                        identifies the magnitude of the upward (downward)
                        level shift;</p> <p>
                       2nd col = standard errors;</p> <p>
                       3rd col = t-statistics;</p><p>
                       4th col = p values.</p></p></td></tr><tr valign="top"><td><code>posLS</code></td><td><p>scalar associated with best tentative level shift
                       position. If this field does not exist, forecasts
                       are done assuming no level shift.</p></td></tr><tr valign="top"><td><code>invXX</code></td><td><p><p>$cov(\beta)/\hat \sigma^2$. p-by-p, square matrix.</p> <p>
                       If the model is linear out.invXX  is equal to
                       $(X'X)^{-1}$, else out.invXX is equal to $(A'A)^{-1}$
                       where $A$ is the matrix of partial derivatives. More
                       precisely:</p><p>
                       </p>\[
                       a_{i,j}=\frac{\partial \eta_i(x_i, \hat \beta)}{\partial \hat \beta_j}
                       \]
                       where
                       \begin{eqnarray}
                       y_i & = & \eta(x_i,\beta)+ \epsilon_i  \\
                           & = & \eta_i +\epsilon_i \\
                           & = & \eta(x_i,\hat \beta)+ e_i  \\
                           & = & \hat \eta_i + e_i
                       \end{eqnarray}</p></td></tr><tr valign="top"><td><code>yhat</code></td><td><p><p>vector of fitted values after final (NLS=non linear
                       least squares) step:</p> <p>
                       $ (\hat \eta_1, \hat \eta_2, \ldots, \hat \eta_T)'$</p></p></td></tr><tr valign="top"><td><code>scale</code></td><td><p>Final scale estimate of the residuals
                     \[
                     \hat \sigma = cor \times \sum_{i \in S_m} [y_i- \eta(x_i,\hat \beta)]^2/(m-p)
                     \]<p>
                     where $S_m$ is a set of cardinality $m$ which
                     contains the units not declared as outliers and $p$
                     is the total number of estimated parameters and cor
                     is a correction factor to make the estimator
                     consistent.</p> <p>
                     REMARK: structure outEST can be conveniently created
                     by function LTSts.</p></p></td></tr></table></p> <p class="datatypelist"><strong> Data Types: </strong><code>struct</code></p> </div> </div><div id="namevaluepairarguments" class="clearfix"></div><h3 id="NameValuePairs" class="bottom_ruled">Name-Value Pair Arguments</h3><div class="namevaluecontainer"><p>Specify optional comma-separated pairs of <code>Name,Value</code> arguments. <code>Name</code> is the argument name and <code>Value</code> is the corresponding value. <code>Name</code> must appear  inside single quotes (<code>' '</code>).  You can specify several name and value pair arguments in any order as <code>  Name1,Value1,...,NameN,ValueN</code>.</p>  <span class="example_desc"><strong>Example:</strong><code><code> 'model', model
</code>,<code> 'nfore',12
</code>,<code> 'conflev',0.999
</code>,<code> 'plots',1
</code>,<code> 'titl','Plot with two wedges'
</code>,<code> 'StartDate',[2016,3]
</code>,<code> 'FileNameOutput',['C:' filesep 'myoutput' fielsep 'savesimdata.txt']
</code>,<code> 'dispresults',true
</code></code></span></div><div class="expandableContent"><div id="inputarg_model" class="clearfix"></div><h3 id="input_argument_namevalue_model" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>model</code> &#8212;model type.</span></a><span class="example_desc">structure.</span></span></h3><div class="collapse">	<p><p>A structure which specifies the model
               used to simulate the time series. The structure contains
               the following fields:</p> <p>
       </p><table border="2" cellpadding="4" cellspacing="0" class="body"><colgroup><col width="20%"><col width="80%"></colgroup><thead><tr valign="top"><th valign="top">Value</th><th valign="top">Description</th></tr></thead><tr valign="top"><td><code>trend</code></td><td><p><p>scalar (order of the trend component).</p> <p>
                       trend = 1 implies linear trend with intercept,
                       trend = 2 implies quadratic trend, etc.</p><p>
                       If this field is empty the simulated time series
                       will not contain a trend. The default value
                       of model.trend is 1.</p></p></td></tr><tr valign="top"><td><code>s</code></td><td><p><p>scalar greater than zero which specifies the
                       length of the seasonal period. For monthly
                       data (default) s=12, for quartely data s=4, ...</p> <p>
                       The default value of model.s is 12 (that is monthly
                       data are assumed)</p></p></td></tr><tr valign="top"><td><code>seasonal</code></td><td><p><p>scalar (integer specifying number of
                        frequencies, i.e. harmonics, in the seasonal
                        component. Possible values for seasonal are
                        $1, 2, ..., [s/2]$, where $[s/2]=floor(s/2)$.</p> <p>
                        For example:</p> <p>
                        if seasonal = 1 (default) we have:</p> <p>
                        $\beta_1 \cos( 2 \pi t/s) + \beta_2 sin ( 2 \pi t/s)$;</p> <p>
                        if seasonal = 2 we have:</p> <p>
                        $\beta_1 \cos( 2 \pi t/s) + \beta_2 \sin ( 2 \pi t/s)
                        + \beta_3 \cos(4 \pi t/s) + \beta_4 \sin (4 \pi t/s)$.</p> <p>
                        Note that when $s$ is even the sine term disappears
                        for $j=s/2$ and so the maximum number of
                        trigonometric parameters is $s-1$.</p> <p>
                        If seasonal is a number greater than 100 then it
                        is possible to specify how the seasonal component
                        grows over time.</p> <p>
                        For example, seasonal = 101 implies a seasonal
                        component which just uses one frequency
                        which grows linearly over time as follows:</p> <p>
                        $(1+\beta_3 t)\times ( \beta_1 cos( 2 \pi t/s) +
                        \beta_2 \sin ( 2 \pi t/s))$.</p> <p>
                        For example, seasonal = 201 implies a seasonal
                        component which just uses one frequency
                        which grows in a quadratic way over time as
                        follows:</p> <p>
                        $(1+\beta_3 t + \beta_4  t^2)\times( \beta_1 \cos(
                        2 \pi t/s) + \beta_2 \sin ( 2 \pi t/s))$.</p><p>
                       If this field is an empty double (default) the
                       simulated time series will not contain a seasonal
                       component.</p></p></td></tr><tr valign="top"><td><code>X</code></td><td><p><p>explanatory variabels. Matrix of size
                       (length(y)+nfore)-by-nexpl.</p> <p>
                       If model.X is a matrix of size (length(y)+nfore)-by-nexpl, it
                       contains the values of nexpl extra covariates which
                       affect y for periods 1:(length(y)+nfore) where
                       nfore is the requested number of forecasts. If this
                       field is an empty double (default) there is no
                       effect of explanatory variables.</p></p></td></tr><tr valign="top"><td><code>ARp</code></td><td><p>scalar greater or equal than 0 which
                         specifies the length of the autoregressive
                         component. The default value of model.ARp is 0,
                         that is there is no autoregressive component.</p></td></tr></table></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'model', model
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>struct</code></p></div></div><div class="expandableContent"><div id="inputarg_nfore" class="clearfix"></div><h3 id="input_argument_namevalue_nfore" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>nfore</code> &#8212;number of forecasts.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>Positive integer which defines the number of forecasts. The
               default value of nfore is 24.</p> <p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'nfore',12
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_conflev" class="clearfix"></div><h3 id="input_argument_namevalue_conflev" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>conflev</code> &#8212;confidence level for the confidence bands.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>A number between 0 and 1 which defines the confidence
                level which is used to produce the bands. The default
                value of conflev is 0.99.</p> <p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'conflev',0.999
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_plots" class="clearfix"></div><h3 id="input_argument_namevalue_plots" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>plots</code> &#8212;Plots on the screen.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>If plots == 1 a plot with the real time series  with fitted
               values and forecasts (with confidence bands) will appear on
               the screen.</p> <p>
               The default value of plot is 0, that is no plot is shown on
               the screen.</p><p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'plots',1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_titl" class="clearfix"></div><h3 id="input_argument_namevalue_titl" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>titl</code> &#8212;Title.</span></a><span class="example_desc">string.</span></span></h3><div class="collapse">	<p><p>A label for the title (default: 'Double wedge
                plot').</p> <p>
                </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'titl','Plot with two wedges'
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>char</code></p></div></div><div class="expandableContent"><div id="inputarg_StartDate" class="clearfix"></div><h3 id="input_argument_namevalue_StartDate" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>StartDate</code> &#8212;The time of the first observation.</span></a><span class="example_desc">numeric vector of length 2.</span></span></h3><div class="collapse">	<p><p>Vector with two integers, which
               specify a natural time unit and a (1-based) number of
               samples into the time unit. For example, if model.s=12
               (that is the data are monthly) and the first observation
               starts in March 2016, then StartDate=[2016,3]; Similarly,
               if models.s=4 (that is the data are quarterly) and the first
               observation starts in the second quarter or year 2014, then
               StartData=[2014,2]. The information in option StartDate
               will be used to create in the output the dates inside the
               time series object.</p> <p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'StartDate',[2016,3]
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_FileNameOutput" class="clearfix"></div><h3 id="input_argument_namevalue_FileNameOutput" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>FileNameOutput</code> &#8212;save simulated time series to txt file.</span></a><span class="example_desc">character.</span></span></h3><div class="collapse">	<p><p>If FileNameOutput is empty (default) nothing is saved on
               the disk, else FileNameOutput will contain the path where
               to save the file on the disk.</p> <p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'FileNameOutput',['C:' filesep 'myoutput' fielsep 'savesimdata.txt']
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>Character</code></p></div></div><div class="expandableContent"><div id="inputarg_dispresults" class="clearfix"></div><h3 id="input_argument_namevalue_dispresults" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>dispresults</code> &#8212;Display results of final fit.</span></a><span class="example_desc">boolean.</span></span></h3><div class="collapse">	<p><p>If dispresults is
               true,  labels of coefficients, estimated coefficients,
               standard errors, tstat and p-values are shown on the
               screen in a fully formatted way. The default value of
               dispresults is false.</p> <p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'dispresults',true
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>logical</code></p></div></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="OutputArgs" >Output Arguments</h2><div class="expandableContent"><div class="arguments"><div class="output_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"><div id="outputarg_outFORE" class="clearfix"></div><h3 id="output_argument_outFORE" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>outFORE</code> &#8212; description</span></a><span class="example_desc">Structure</span></span></h3><div class="collapse"><p><p>structure which contains the following fields:</p> <p>

        </p><table border="2" cellpadding="4" cellspacing="0" class="body"><colgroup><col width="20%"><col width="80%"></colgroup><thead><tr valign="top"><th valign="top">Value</th><th valign="top">Description</th></tr></thead><tr valign="top"><td><code>signal</code></td><td><p><p>vector of length (length(y)+nfore) containing
                   predictive values in sample and out of sample.</p> <p>
                   Predictive values = TR+SE+X+LS.</p></p></td></tr><tr valign="top"><td><code>trend</code></td><td><p><p>vector of length (length(y)+nfore) containing
                   estimated trend (TR) in sample and out of sample.</p> <p>
                   If this component is not present, it is equal to 0.</p></p></td></tr><tr valign="top"><td><code>seasonal</code></td><td><p><p>vector of length (length(y)+nfore) containing
                   estimated seasonal component (SE) in sample and out of sample.</p> <p>
                   If this component is not present, it is equal to 0.</p></p></td></tr><tr valign="top"><td><code>lshift</code></td><td><p><p>vector of length (length(y)+nfore) containing
                   level shift (LS) in sample and out of sample.</p> <p>
                   If this component is not present, it is equal to 0.</p></p></td></tr><tr valign="top"><td><code>X</code></td><td><p><p>vector of length (length(y)+nfore)
                   containing the effecf of the explanatory variables.</p> <p>
                   If this component is not present, it is equal to 0.</p></p></td></tr><tr valign="top"><td><code>confband</code></td><td><p>matrix of size (length(y)+nfore)-by-2
                   containing lower and upper confidence bands of the
                   forecasts. The confidence level of the bands is
                   splecified is input parameter conflev. Note that the
                   first length(y) rows of this matrix are equal to NaN.</p></td></tr><tr valign="top"><td><code>datesnumeric</code></td><td><p><p>vector of length (length(y)+nfore)
                   containing the dates in numeric format.</p> <p>
               outFORE.X= data matrix X containing trend, seasonal, expl and
                       lshift, if the model is linear or linearized
                       version of $\eta(x_i, \beta)$ if the model is non
                       linear containing in the columns partial
                       derivatives evaluated in correspondence of
                       outEST.B(:,1) with respect to each parameter. In other
                       words, the $i,j$-th element of outFORE.X is
                       </p>\[
                       \frac{\partial \eta_i(x_i, \hat \beta)}{\partial \hat \beta_j}
                       \]<p>
                       $j=1, 2, \ldots, p$, $i=1, 2, \ldots, T$.</p> <p>
                       The size of this matrix is:</p><p>
                       T-by-p
                       The field is present only if option
                       yxsave is set to 1.</p></p></td></tr></table></p></div></div></div></div></div></div><div class="ref_sect" itemprop="content"><div class="bibliography"><h2 id="References">References</h2> <div><p>Rousseeuw, P.J., Perrotta D., Riani M. and Hubert, M. (2018), Robust
 Monitoring of Many Time Series with Application to Fraud Detection,
 "Econometrics and Statistics". [RPRH]</p></div></div></div><div class="ref_sect"><h2 id="SeeAlso">See Also</h2><p><span itemprop="seealso"><a href="LTSts.html" itemprop="url"><span itemprop="name"><code>LTSts</code></span></a></span> | <span itemprop="seealso"><a href="wedgeplot.html" itemprop="url"><span itemprop="name"><code>wedgeplot</code></span></a></span> | <span itemprop="seealso"><a href="simulateTS.html" itemprop="url"><span itemprop="name"><code>simulateTS</code></span></a></span></div><i>This page has been automatically generated by our routine <a href="publishFS.html">publishFS</a></i></div></section></div></div></div></div><div id="divbottom"></div></body></html>