<!DOCTYPE HTML> <html itemscope="" xmlns="http://www.w3.org/1999/xhtml"><head><title>LTSts</title><meta content="refpage" name="chunktype"><meta content="function:LTSts" itemprop="refentity" name="refentity"><meta content="text/javascript" http-equiv="Content-Script-Type"><meta content="fcn" itemprop="pagetype" name="toctype"><meta content="ref/function" itemprop="infotype" name="infotype" /><meta content="LTSts extends LTS estimator to time series." itemprop="description" name="description" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" /><script type="text/x-mathjax-config">MathJax.Hub.Config({extensions: ["tex2jax.js"],jax: ["input/TeX","output/HTML-CSS"],menuSettings: {zoom: "Double-Click", zscale: "300"},tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},MathMenu: {showRenderer: false},"HTML-CSS": {availableFonts: ["TeX"],preferredFont: "TeX",imageFont: null}});</script><script type="text/javascript" src="includesFS/Mathjax/MathJax.js"></script><script src="includesFS/matlab-highlighter.min.js"></script><link href="includesFS/matlab-highlighter.css" rel="stylesheet" type="text/css"><script type="text/javascript" src="includesFS/jquery-latest.js"></script><script>$(document).ready(function(){      $("#divtop").load("includesFS/top.html");      $("#divbottom").load("includesFS/bottom.html");});</script><link href="../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)"></link><link href="../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)"></link><link href="../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)"></link><link href="../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)"></link><link href="../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)"></link><link href="../includes/product/css/site6_offcanvas.css" rel="stylesheet" type="text/css"></link><script src="../includes/shared/scripts/l10n.js" type="text/javascript"></script><script src="../includes/product/scripts/docscripts.js"></script><script src="../includes/shared/scripts/docscripts_rn.js"></script><script src="../includes/shared/scripts/mw.imageanimation.js" type="text/javascript"></script><script src="../includes/shared/scripts/jquery.highlight.js"></script><script src="../includes/product/scripts/bootstrap.min.js" type="text/javascript"></script><script src="../includes/product/scripts/global.js"></script><script src="includesFS/bottom.js" type="text/javascript"></script><script src="../includes/product/scripts/underscore-min.js"></script><script src="../includes/shared/scripts/f1help.js" type="text/javascript"></script><script src="../includes/product/scripts/suggest.js" type="text/javascript"></script><script src="../includes/shared/scripts/helpservices.js" type="text/javascript"></script><script src="../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script><!-- the following line should be kept this way only --><link href="includesFS/doc_center.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css"><link href="../includes/product/css/doc_center_print.css" media="print" rel="stylesheet" type="text/css"></head><body  onload="highlightMATLABCode();" id="responsive_offcanvas">  <div id="doc_header_spacer" class="header"></div><div class="sticky_header_container includes_subnav"><div class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-xs-12 col-sm-6 col-sm-push-6 col-md-5 col-md-push-7" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2017a" data-language="en" action="../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="sr-only">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"><div class="input-group-btn"><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search pull-right icon_32 visible-xs" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="col-sm-6 col-sm-pull-6 col-md-7 col-md-pull-5" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../documentation-center.html">Documentation</a></h1></div></div></div><div class="visible-xs" id="search_actuator"><button class="btn icon-search btn_search pull-right icon_16" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div><!--END.CLASS row--> </div><!--END.CLASS container-fluid--> </div><!--END.CLASS section_header level_3--><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_actuator" data-toggle="offcanvas" data-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="sr-only">Toggle navigation</span><span class="icon-menu icon_24"></span></button><span class="offcanvas_actuator_label"></span><span class="offcanvas_actuator_close"></span> </div><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-md-12 hidden-xs hidden-sm"></div></div></div></div></div></div></div><!--END.CLASS sticky_header_container--><div class="row-offcanvas row-offcanvas-left"><div id="sidebar" class="sidebar-offcanvas" role="navigation"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" xmlns:atict="http://www.arbortext.com/namespace/atict"><li itemprop="breadcrumb" itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb"> <a href="../documentation-center.html" itemprop="url"> <span itemprop="title">All Products</span></a></li></ul><ul class="nav_disambiguation" xmlns:atict="http://www.arbortext.com/namespace/atict"><li class="product"><a href="index.html">Flexible Statistics and Data Analysis (FSDA)</a><div class="dropdown"> <span id="dropdownMenu1" class="icon-arrow-down icon_16" data-toggle="dropdown"> </span><ul aria-labelledby="dropdownMenu1" class="dropdown-menu dropdown-menu-right" role="menu"><li role="presentation"> <a href="examples.html" role="menuitem" tabindex="-1">Examples</a></li><li role="presentation"> <a href="function-alpha.html" role="menuitem" tabindex="-1"> Functions and Other Reference</a></li><li role="presentation"> <a href="release_notes.html?s_cid=doc_flyout" role="menuitem" tabindex="-1"> Release Notes</a></li><li role="presentation"> <a href="tutorials.html" role="menuitem" tabindex="-1"> Tutorials</a></li></ul></div></li></ul><ul xmlns:atict="http://www.arbortext.com/namespace/atict" class="nav_disambiguation"> <li><a href="index.html">Flexible Statistics and Data Analysis Toolbox</a> </li> <li><a href="function-cate.html" itemprop="url">Functions</a></li></ul><!-- --><ul class="nav_scrollspy nav" xmlns:atict="http://www.arbortext.com/namespace/atict">  <li class="nav_scrollspy_function"> <a href="#responsive_offcanvas">LTSts</a></li> <li id="SSPY810-refentry" class="nav_scrollspy_title">On this page</li><li><a class="intrnllnk" href="#syntax">Syntax</a></li><li><a class="intrnllnk" href="#Description">Description</a></li><li><a class="intrnllnk" href="#Examples">Examples</a><ul><li><a class="intrnllnk" href="#Example_1">Simulated data with linear trend and level shift.</a></li><li><a class="intrnllnk" href="#Example_2">Airline data: linear trend + just one harmonic for seasonal component.</a></li><li><a class="intrnllnk" href="#Example_3">Model with linear trend and six harmonics for seasonal component.</a></li></ul></li><li><a class="intrnllnk" href="#ExtraExamples">Extra Examples</a><ul><li><a class="intrnllnk" href="#ExtraExample_1">Model with linear trend, two harmonics for seasonal component and
     varying amplitude using a linear trend (1).</a></li><li><a class="intrnllnk" href="#ExtraExample_2">Model with linear trend, six harmonics for seasonal component and
     varying amplitude using a linear trend (2).</a></li><li><a class="intrnllnk" href="#ExtraExample_3">Contaminated time series with upward level shift.</a></li><li><a class="intrnllnk" href="#ExtraExample_4">Contaminated time series with downward level shift.</a></li><li><a class="intrnllnk" href="#ExtraExample_5">Model with an explanatory variable using log-transformed series.</a></li><li><a class="intrnllnk" href="#ExtraExample_6">Example 1 used in the paper RPRH.</a></li><li><a class="intrnllnk" href="#ExtraExample_7">Example 2 used in the paper RPRH.</a></li><li><a class="intrnllnk" href="#ExtraExample_8">Example 3 used in the paper RPRH.</a></li><li><a class="intrnllnk" href="#ExtraExample_9">Examples 4 and 5 used in the paper RPRH: trade data.</a></li></ul></li><li><a class="intrnllnk" href="#Inputs">Input Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_y">y</a></li></ul></li><li><a class="intrnllnk" href="#NameValuePairs">Name-Value Pair Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_namevalue_bdp">bdp</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_conflev">conflev</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_dispresults">dispresults</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_h">h</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_intercept">intercept</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_lshiftlocref">lshiftlocref</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_lts">lts</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_model">model</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_msg">msg</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_nbestindexes">nbestindexes</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_nocheck">nocheck</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_nsamp">nsamp</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_refstepsALS">refstepsALS</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_reftolALS">reftolALS</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_SmallSampleCor">SmallSampleCor</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_yxsave">yxsave</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_plots">plots</a></li></ul></li><li><a class="intrnllnk" href="#OutputArgs">Output Arguments</a><ul><li><a class="intrnllnk" href="#output_argument_out">out</a></li><li><a class="intrnllnk" href="#output_argument_varargout">varargout</a></li></ul></li><li><a class="intrnllnk" href="#References">References</a></li><li><a class="intrnllnk" href="#SeeAlso">See Also</a></li></ul></nav><script src="../includes/product/scripts/offcanvas.js"></script></div><div id="divtop"></div><div class="site_container site_toc_closed"><div class="page_container"><div class="content_frame"><div id="content_container" class="content_container"><section id="doc_center_content"><div class="function_ref"><div itemprop="content"><h1 itemprop="title">LTSts</h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose">LTSts extends LTS estimator to time series</p><div class="switch"><a id="expandAllPage" href="javascript:void(0);">expand all in page</a></div></div></div></div><div class="ref_sect"><h2 id="syntax">Syntax</h2><div class="syntax_signature"><div class="syntax_signature_module"><ul><li><code class="synopsis">out=LTSts(y)</code><span class="syntax_example"><a class="intrnllnk" href="LTSts.html#Example_1">example</a></span></li><li><code class="synopsis">out=LTSts(y,Name,Value)</code><span class="syntax_example"><a class="intrnllnk" href="LTSts.html#Example_2">example</a></span></li><li><code class="synopsis">[out, varargout]=LTSts(___)</code><span class="syntax_example"><a class="intrnllnk" href="LTSts.html#Example_3">example</a></span></li></ul></div></div></div>	<div class="ref_sect" itemprop="content">							<h2 id="Description">Description</h2>							<div class="descriptions">								<div class="description_module"><p>It is possible to set a model with a trend (up to third order), a
 seasonality (constant or of varying amplitude and with a different number
 of harmonics) and a level shift (in this last case it is possible to
 specify the window in which level shift has to be searched for).</p><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="LTSts.html#Example_1">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_out"><code>out</code></a>=LTSts(<a class="intrnllnk" href="#inputarg_y"><code>y</code></a>)</code></span>Simulated data with linear trend and level shift.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="LTSts.html#Example_2">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_out"><code>out</code></a>=LTSts(<a class="intrnllnk" href="#inputarg_y"><code>y</code></a>,<a class="intrnllnk" href="#namevaluepairarguments"><code>Name, Value</code></a>)</code></span>Airline data: linear trend + just one harmonic for seasonal component.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="LTSts.html#Example_3">	example</a></p>	<p><span itemprop="syntax"><code>[<a class="intrnllnk" href="#outputarg_out"><code>out</code></a>,<a class="intrnllnk" href="#outputarg_varargout"><code> varargout</code></a>]=LTSts(___)</code></span>Model with linear trend and six harmonics for seasonal component.</p></div>								</div>							</div>							<div class="clear">							</div>						</div><div class="ref_sect" itemprop="content"><div class="examples"><h2 id="Examples">Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="example_1" class="example_module expandableContent"><div id="Example_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>Simulated data with linear trend and level shift.</li></span></a></span></h3><div class="collapse"><p>
     No seasonal component.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">rng('default')
T=45;
a=1;
b=0.8;
sig=1;
seq=(1:T)';
y=a+b*seq+sig*randn(T,1);
% Add a level shift in the simulated series
y(round(T/2):end)=y(round(T/2):end)+10;
% model with a linear trend, non seasonal and level shift
model=struct;
model.trend=1;
model.seasonal=0;
% Potential level shift position is investigated in positions:
% t=11, t=12, ..., t=T-10.
model.lshift=11:T-10;
out=LTSts(y,'model',model,'plots',1);
% Using the notation of the paper RPRH: A=1, B=1, G=0 and $\delta_1&gt;0$.
str=strcat('A=1, B=0, G=0, $\delta_2=',num2str(out.posLS),'$');
title(findobj(gcf,'-regexp','Tag','LTSts:ts'),str,'interpreter','latex');</pre></div></div></p></div></div><div id="example_2" class="example_module expandableContent"><div id="Example_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>Airline data: linear trend + just one harmonic for seasonal component.</li></span></a></span></h3><div class="collapse"><p>
     Load airline data.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">%   1949 1950 1951 1952 1953 1954 1955 1956 1957 1958 1959 1960
y = [112  115  145  171  196  204  242  284  315  340  360  417    % Jan
118  126  150  180  196  188  233  277  301  318  342  391    % Feb
132  141  178  193  236  235  267  317  356  362  406  419    % Mar
129  135  163  181  235  227  269  313  348  348  396  461    % Apr
121  125  172  183  229  234  270  318  355  363  420  472    % May
135  149  178  218  243  264  315  374  422  435  472  535    % Jun
148  170  199  230  264  302  364  413  465  491  548  622    % Jul
148  170  199  242  272  293  347  405  467  505  559  606    % Aug
136  158  184  209  237  259  312  355  404  404  463  508    % Sep
119  133  162  191  211  229  274  306  347  359  407  461    % Oct
104  114  146  172  180  203  237  271  305  310  362  390    % Nov
118  140  166  194  201  229  278  306  336  337  405  432 ]; % Dec
% Source:
% http://datamarket.com/data/list/?q=provider:tsdl
y=(y(:));
yr = repmat((1949:1960),12,1);
mo = repmat((1:12)',1,12);
time = datestr(datenum(yr(:),mo(:),1));
ts = timeseries(y(:),time,'name','AirlinePassengers');
ts.TimeInfo.Format = 'dd-mmm-yyyy';
tscol = tscollection(ts);
% plot airline data
plot(ts)
% linear trend + just one harmonic for seasonal component
model=struct;
model.trend=1;              % linear trend
model.s=12;                 % monthly time series
model.seasonal=1;           % just one harmonic
model.lshift=0;             % no level shift
out=LTSts(y,'model',model,'dispresults',true);
close all
% Plot real and fitted values
plot(y,'Linewidth',1.5);
hold('on')
plot(out.yhat,'r--','Linewidth',1.5)
legend({'Real values','Fitted values'},'Location','SouthEast','interpreter','LaTeX','FontSize',14)
numpar = {'model parameters:' , 'A=1, B=1, G=0, $\delta_1=0$'};
title(gca,numpar,'interpreter','LaTeX','FontSize',16);</pre></div></div></p></div></div><div id="example_3" class="example_module expandableContent"><div id="Example_3"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>Model with linear trend and six harmonics for seasonal component.</li></span></a></span></h3><div class="collapse"><p>
     Load airline data.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">%   1949 1950 1951 1952 1953 1954 1955 1956 1957 1958 1959 1960
y = [112  115  145  171  196  204  242  284  315  340  360  417    % Jan
118  126  150  180  196  188  233  277  301  318  342  391    % Feb
132  141  178  193  236  235  267  317  356  362  406  419    % Mar
129  135  163  181  235  227  269  313  348  348  396  461    % Apr
121  125  172  183  229  234  270  318  355  363  420  472    % May
135  149  178  218  243  264  315  374  422  435  472  535    % Jun
148  170  199  230  264  302  364  413  465  491  548  622    % Jul
148  170  199  242  272  293  347  405  467  505  559  606    % Aug
136  158  184  209  237  259  312  355  404  404  463  508    % Sep
119  133  162  191  211  229  274  306  347  359  407  461    % Oct
104  114  146  172  180  203  237  271  305  310  362  390    % Nov
118  140  166  194  201  229  278  306  336  337  405  432 ]; % Dec
% Source:
% http://datamarket.com/data/list/?q=provider:tsdl
y=(y(:));
model=struct;
model.trend=1;              % linear trend
model.s=12;                 % monthly time series
model.seasonal=6;           % six harmonics
model.lshift=0;             % no level shift
out=LTSts(y,'model',model);
close all
% Plot real and fitted values
plot(y,'Linewidth',1.5);
hold('on')
plot(out.yhat,'r--','Linewidth',1.5)
legend({'Real values','Fitted values'},'Location','SouthEast','interpreter','LaTeX','FontSize',14)
numpar = {'model parameters:' , 'A=1, B=6, G=0, $\delta_1=0$'};
title(gca,numpar,'interpreter','LaTeX','FontSize',16);</pre></div></div></p></div></div></div><p> </p><div class="examples"><h2 id="ExtraExamples" class="bottom_ruled">Related Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="Extraexample_1" class="example_module expandableContent"><div id="ExtraExample_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Model with linear trend, two harmonics for seasonal component and
     varying amplitude using a linear trend (1).</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">% Load airline data.
%   1949 1950 1951 1952 1953 1954 1955 1956 1957 1958 1959 1960
y = [112  115  145  171  196  204  242  284  315  340  360  417    % Jan
118  126  150  180  196  188  233  277  301  318  342  391    % Feb
132  141  178  193  236  235  267  317  356  362  406  419    % Mar
129  135  163  181  235  227  269  313  348  348  396  461    % Apr
121  125  172  183  229  234  270  318  355  363  420  472    % May
135  149  178  218  243  264  315  374  422  435  472  535    % Jun
148  170  199  230  264  302  364  413  465  491  548  622    % Jul
148  170  199  242  272  293  347  405  467  505  559  606    % Aug
136  158  184  209  237  259  312  355  404  404  463  508    % Sep
119  133  162  191  211  229  274  306  347  359  407  461    % Oct
104  114  146  172  180  203  237  271  305  310  362  390    % Nov
118  140  166  194  201  229  278  306  336  337  405  432 ]; % Dec
% Source:
% http://datamarket.com/data/list/?q=provider:tsdl
y=(y(:));
model=struct;
model.trend=1;              % linear trend
model.s=12;                 % monthly time series
model.seasonal=102;         % two harmonics with time varying seasonality
model.lshift=0;             % no level shift
out=LTSts(y,'model',model);
close all
% Plot real and fitted values
plot(y,'Linewidth',1.5);
hold('on')
plot(out.yhat,'r--','Linewidth',1.5)
legend({'Real values','Fitted values'},'Location','SouthEast','interpreter','LaTeX','FontSize',14)
numpar = {'model parameters:' , 'A=1, B=2, G=1, $\delta_1=0$'};
title(gca,numpar,'interpreter','LaTeX','FontSize',16);</pre></div></div></p></div></div><div id="Extraexample_2" class="example_module expandableContent"><div id="ExtraExample_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Model with linear trend, six harmonics for seasonal component and
     varying amplitude using a linear trend (2).</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">% Load airline data.
%   1949 1950 1951 1952 1953 1954 1955 1956 1957 1958 1959 1960
y = [112  115  145  171  196  204  242  284  315  340  360  417    % Jan
118  126  150  180  196  188  233  277  301  318  342  391    % Feb
132  141  178  193  236  235  267  317  356  362  406  419    % Mar
129  135  163  181  235  227  269  313  348  348  396  461    % Apr
121  125  172  183  229  234  270  318  355  363  420  472    % May
135  149  178  218  243  264  315  374  422  435  472  535    % Jun
148  170  199  230  264  302  364  413  465  491  548  622    % Jul
148  170  199  242  272  293  347  405  467  505  559  606    % Aug
136  158  184  209  237  259  312  355  404  404  463  508    % Sep
119  133  162  191  211  229  274  306  347  359  407  461    % Oct
104  114  146  172  180  203  237  271  305  310  362  390    % Nov
118  140  166  194  201  229  278  306  336  337  405  432 ]; % Dec
% Source:
% http://datamarket.com/data/list/?q=provider:tsdl
y=(y(:));
model=struct;
model.trend=1;              % linear trend
model.s=12;                 % monthly time series
model.seasonal=106;         % six harmonics with linear time varying seasonality
model.lshift=0;             % no level shift
% out=fitTSLS(y,'model',model);
out=LTSts(y,'model',model);
close all
% Plot real and fitted values
plot(y,'Linewidth',1.5);
hold('on')
plot(out.yhat,'r--','Linewidth',1.5)
legend({'Real values','Fitted values'},'Location','SouthEast','interpreter','LaTeX','FontSize',14)
numpar = {'model parameters:' , 'A=1, B=6, G=1, $\delta_1=0$'};
title(gca,numpar,'interpreter','LaTeX','FontSize',16);</pre></div></div></p></div></div><div id="Extraexample_3" class="example_module expandableContent"><div id="ExtraExample_3"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Contaminated time series with upward level shift.</li></span></a></span></h3><div class="collapse"><p>
     Model with linear trend, six harmonics for seasonal component and
     varying amplitude using a linear trend).<div class="programlisting"><div class="codeinput"><pre class="matlab-code">% Load airline data.
%   1949 1950 1951 1952 1953 1954 1955 1956 1957 1958 1959 1960
y = [112  115  145  171  196  204  242  284  315  340  360  417    % Jan
118  126  150  180  196  188  233  277  301  318  342  391    % Feb
132  141  178  193  236  235  267  317  356  362  406  419    % Mar
129  135  163  181  235  227  269  313  348  348  396  461    % Apr
121  125  172  183  229  234  270  318  355  363  420  472    % May
135  149  178  218  243  264  315  374  422  435  472  535    % Jun
148  170  199  230  264  302  364  413  465  491  548  622    % Jul
148  170  199  242  272  293  347  405  467  505  559  606    % Aug
136  158  184  209  237  259  312  355  404  404  463  508    % Sep
119  133  162  191  211  229  274  306  347  359  407  461    % Oct
104  114  146  172  180  203  237  271  305  310  362  390    % Nov
118  140  166  194  201  229  278  306  336  337  405  432 ]; % Dec
% Source:
% http://datamarket.com/data/list/?q=provider:tsdl
y=(y(:));
yLS=y;
yLS(55:end)=yLS(55:end)+130;
model=struct;
model.trend=1;                          % linear trend
model.s=12;                             % monthly time series
model.seasonal=1;
model.lshift=14:length(yLS)-13;         % impose level shift
out=LTSts(yLS,'model',model);
close all
% Plot real and fitted values
plot(yLS,'Linewidth',1.5);
hold('on')
plot(out.yhat,'r--','Linewidth',1.5)
legend({'Real values','Fitted values'},'Location','SouthEast','interpreter','LaTeX','FontSize',14)
% Using the notation of the paper RPRH: A=1, B=1, G=0 and $\delta_1&gt;0$.
str=strcat('A=1, B=1, G=0, $\delta_2=',num2str(out.posLS),'$');
numpar = {'model parameters:' , str};
title(gca,numpar,'interpreter','LaTeX','FontSize',16);</pre></div></div></p></div></div><div id="Extraexample_4" class="example_module expandableContent"><div id="ExtraExample_4"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Contaminated time series with downward level shift.</li></span></a></span></h3><div class="collapse"><p>
     Model with linear trend, three harmonics for seasonal component and
     varying amplitude using a linear trend).<div class="programlisting"><div class="codeinput"><pre class="matlab-code">% Load airline data.
%   1949 1950 1951 1952 1953 1954 1955 1956 1957 1958 1959 1960
y = [112  115  145  171  196  204  242  284  315  340  360  417    % Jan
118  126  150  180  196  188  233  277  301  318  342  391    % Feb
132  141  178  193  236  235  267  317  356  362  406  419    % Mar
129  135  163  181  235  227  269  313  348  348  396  461    % Apr
121  125  172  183  229  234  270  318  355  363  420  472    % May
135  149  178  218  243  264  315  374  422  435  472  535    % Jun
148  170  199  230  264  302  364  413  465  491  548  622    % Jul
148  170  199  242  272  293  347  405  467  505  559  606    % Aug
136  158  184  209  237  259  312  355  404  404  463  508    % Sep
119  133  162  191  211  229  274  306  347  359  407  461    % Oct
104  114  146  172  180  203  237  271  305  310  362  390    % Nov
118  140  166  194  201  229  278  306  336  337  405  432 ]; % Dec
% Source:
% http://datamarket.com/data/list/?q=provider:tsdl
y=(y(:));
yLS=y;
yLS(35:end)=yLS(35:end)-300;
model=struct;
model.trend=1;              % linear trend
model.s=12;                 % monthly time series
model.seasonal=103;
model.lshift=26:length(yLS)-25;
out=LTSts(yLS,'model',model,'msg',0);
close all
% Plot real and fitted values
plot(yLS,'Linewidth',1.5);
hold('on')
plot(out.yhat,'r--','Linewidth',1.5)
legend({'Real values','Fitted values'},'Location','SouthEast','interpreter','LaTeX','FontSize',14)
% Using the notation of the paper RPRH: A=1, B=3, G=1 and $\delta_1&gt;0$.
str=strcat('A=1, B=3, G=1, $\delta_2=',num2str(out.posLS),'$');
numpar = {'model parameters:' , str};
title(gca,numpar,'interpreter','LaTeX','FontSize',16);</pre></div></div></p></div></div><div id="Extraexample_5" class="example_module expandableContent"><div id="ExtraExample_5"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Model with an explanatory variable using log-transformed series.</li></span></a></span></h3><div class="collapse"><p>
     Load airline data.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">%   1949 1950 1951 1952 1953 1954 1955 1956 1957 1958 1959 1960
y = [112  115  145  171  196  204  242  284  315  340  360  417    % Jan
118  126  150  180  196  188  233  277  301  318  342  391    % Feb
132  141  178  193  236  235  267  317  356  362  406  419    % Mar
129  135  163  181  235  227  269  313  348  348  396  461    % Apr
121  125  172  183  229  234  270  318  355  363  420  472    % May
135  149  178  218  243  264  315  374  422  435  472  535    % Jun
148  170  199  230  264  302  364  413  465  491  548  622    % Jul
148  170  199  242  272  293  347  405  467  505  559  606    % Aug
136  158  184  209  237  259  312  355  404  404  463  508    % Sep
119  133  162  191  211  229  274  306  347  359  407  461    % Oct
104  114  146  172  180  203  237  271  305  310  362  390    % Nov
118  140  166  194  201  229  278  306  336  337  405  432 ]; % Dec
% Source:
% http://datamarket.com/data/list/?q=provider:tsdl
y=(y(:));
y1=log(y);
% Model with linear trend, two harmonics for seasonal component and
% varying amplitude using a linear trend).
model=struct;
model.trend=1;              % linear trend
model.s=12;                 % monthly time series
model.seasonal=106;
model.lshift=0;
model.X=randn(length(y),1);
out=LTSts(y1,'model',model);
close all
% Plot real and fitted values
plot(y1,'Linewidth',1.5);
hold('on')
plot(out.yhat,'r--','Linewidth',1.5)
legend({'Real values','Fitted values'},'Location','SouthEast','interpreter','LaTeX','FontSize',14)
% Using the notation of the paper RPRH: A=1, B=6, G=1 and $\delta_1&gt;0$.
str=strcat('A=1, B=6, G=1, $\delta_1=0$');
numpar = {'model parameters:' , str};
title(gca,numpar,'interpreter','LaTeX','FontSize',16);</pre></div></div></p></div></div><div id="Extraexample_6" class="example_module expandableContent"><div id="ExtraExample_6"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Example 1 used in the paper RPRH.</li></span></a></span></h3><div class="collapse"><p>
     Load airline data.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">%   1949 1950 1951 1952 1953 1954 1955 1956 1957 1958 1959 1960
y = [112  115  145  171  196  204  242  284  315  340  360  417    % Jan
118  126  150  180  196  188  233  277  301  318  342  391    % Feb
132  141  178  193  236  235  267  317  356  362  406  419    % Mar
129  135  163  181  235  227  269  313  348  348  396  461    % Apr
121  125  172  183  229  234  270  318  355  363  420  472    % May
135  149  178  218  243  264  315  374  422  435  472  535    % Jun
148  170  199  230  264  302  364  413  465  491  548  622    % Jul
148  170  199  242  272  293  347  405  467  505  559  606    % Aug
136  158  184  209  237  259  312  355  404  404  463  508    % Sep
119  133  162  191  211  229  274  306  347  359  407  461    % Oct
104  114  146  172  180  203  237  271  305  310  362  390    % Nov
118  140  166  194  201  229  278  306  336  337  405  432 ]; % Dec
% Two short level shifts in opposite directions and an isolated outlier.
% Add a level shift contamination plus some outliers.
y1=y(:);
y1(50:55)=y1(50:55)-300;
y1(70:75)=y1(70:75)+300;
y1(90:90)=y1(90:90)+300;
% Create structure specifying model
model=struct;
model.trend=2;                  % quadratic trend
model.s=12;                     % monthly time series
model.seasonal=204;             % number of harmonics
model.lshift=41:length(y1)-40;  % position where monitoring level shift
model.X='';
% Create structure lts specifying lts options
lshiftlocref=struct;
% Set window length for local refinement.
lshiftlocref.wlength=10;
% Set tuning constant to use insde Huber rho function
lshiftlocref.huberc=1.5;
% Estimate the parameters
[out]=LTSts(y1,'model',model,'nsamp',500,...
'plots',1,'lshiftlocref',lshiftlocref,'msg',0);
% Using the notation of the paper RPRH: A=2, B=4, G=2 and $\delta_1&gt;0$.
str=strcat('A=2, B=4, G=2, $\delta_2=',num2str(out.posLS),'$');
numpar = {'model parameters:' , str};
axeslast=findobj('-regexp','Tag','LTSts:ts');
title(axeslast(end),numpar,'interpreter','LaTeX','FontSize',16);
% generate the wedgeplot
% wedgeplot(out,'transpose',true,'extradata',[y1 out.yhat]);</pre></div></div><a href='http://rosa.unipr.it/fsda/LTSts.html#ExtraExample_6'><img vspace="5" hspace="5" src="images\LTSts_01.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website)"> </a></p></div></div><div id="Extraexample_7" class="example_module expandableContent"><div id="ExtraExample_7"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Example 2 used in the paper RPRH.</li></span></a></span></h3><div class="collapse"><p>
     A persisting level shift and three isolated outliers, two of which in
     proximity of the level shift.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">% Load airline data.
%   1949 1950 1951 1952 1953 1954 1955 1956 1957 1958 1959 1960
y = [112  115  145  171  196  204  242  284  315  340  360  417    % Jan
118  126  150  180  196  188  233  277  301  318  342  391    % Feb
132  141  178  193  236  235  267  317  356  362  406  419    % Mar
129  135  163  181  235  227  269  313  348  348  396  461    % Apr
121  125  172  183  229  234  270  318  355  363  420  472    % May
135  149  178  218  243  264  315  374  422  435  472  535    % Jun
148  170  199  230  264  302  364  413  465  491  548  622    % Jul
148  170  199  242  272  293  347  405  467  505  559  606    % Aug
136  158  184  209  237  259  312  355  404  404  463  508    % Sep
119  133  162  191  211  229  274  306  347  359  407  461    % Oct
104  114  146  172  180  203  237  271  305  310  362  390    % Nov
118  140  166  194  201  229  278  306  336  337  405  432 ]; % Dec
close all
y1=y(:);
y1(68:end)=y1(68:end)+1300;
y1(67)=y1(67)-600;
y1(45)=y1(45)-800;
y1(68:69)=y1(68:69)+800;
% Create structure specifying model
model=struct;
model.trend=2;                  % quadratic trend
model.s=12;                     % monthly time series
model.seasonal=204;             % number of harmonics
model.lshift=41:length(y1)-40;  % position where monitoring level shift
model.X='';
% Create structure lts specifying lts options
lshiftlocref=struct;
% Set window length for local refinement.
lshiftlocref.wlength=10;
% Set tuning constant to use insde Huber rho function
lshiftlocref.huberc=1.5;
% Estimate the parameters
[out, varargout]=LTSts(y1,'model',model,'nsamp',500,...
'plots',1,'lshiftlocref',lshiftlocref,'msg',0);
% Using the notation of the paper RPRH: A=2, B=4, G=2 and $\delta_1&gt;0$.
str=strcat('A=2, B=4, G=2, $\delta_2=',num2str(out.posLS),'$');
numpar = {'model parameters:' , str};
title(findobj('-regexp','Tag','LTSts:ts'),numpar,'interpreter','LaTeX','FontSize',16);
% generate the wedgeplot
% wedgeplot(out,'transpose',true,'extradata',[y1 out.yhat]);</pre></div></div><a href='http://rosa.unipr.it/fsda/LTSts.html#ExtraExample_7'><img vspace="5" hspace="5" src="images\LTSts_02.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website)"> </a></p></div></div><div id="Extraexample_8" class="example_module expandableContent"><div id="ExtraExample_8"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Example 3 used in the paper RPRH.</li></span></a></span></h3><div class="collapse"><p>
     A persisting level shift preceded and followed in the proximity by
     other two short level shifts, and an isolated outlier.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">% Load airline data.
%   1949 1950 1951 1952 1953 1954 1955 1956 1957 1958 1959 1960
y = [112  115  145  171  196  204  242  284  315  340  360  417    % Jan
118  126  150  180  196  188  233  277  301  318  342  391    % Feb
132  141  178  193  236  235  267  317  356  362  406  419    % Mar
129  135  163  181  235  227  269  313  348  348  396  461    % Apr
121  125  172  183  229  234  270  318  355  363  420  472    % May
135  149  178  218  243  264  315  374  422  435  472  535    % Jun
148  170  199  230  264  302  364  413  465  491  548  622    % Jul
148  170  199  242  272  293  347  405  467  505  559  606    % Aug
136  158  184  209  237  259  312  355  404  404  463  508    % Sep
119  133  162  191  211  229  274  306  347  359  407  461    % Oct
104  114  146  172  180  203  237  271  305  310  362  390    % Nov
118  140  166  194  201  229  278  306  336  337  405  432 ]; % Dec
y1=y(:);
y1(50:55)=y1(50:55)-300;
y1(68:end)=y1(68:end)-700;
y1(70:75)=y1(70:75)+300;
y1(90:90)=y1(90:90)+300;
% Create structure specifying model
model=struct;
model.trend=2;                  % quadratic trend
model.s=12;                     % monthly time series
model.seasonal=204;             % number of harmonics
model.lshift=41:length(y1)-40;  % position where monitoring level shift
model.X='';
% Create structure lts specifying lts options
lshiftlocref=struct;
% Set window length for local refinement.
lshiftlocref.wlength=10;
% Set tuning constant to use insde Huber rho function
lshiftlocref.huberc=1.5;
close all
% Estimate the parameters
[out, varargout]=LTSts(y1,'model',model,'nsamp',500,...
'plots',2,'lshiftlocref',lshiftlocref,'msg',0);
% Using the notation of the paper RPRH: A=2, B=4, G=2 and $\delta_1&gt;0$.
str=strcat('A=2, B=4, G=2, $\delta_2=',num2str(out.posLS),'$');
numpar = {'model parameters:' , str};
title(findobj('-regexp','Tag','LTSts:ts'),numpar,'interpreter','LaTeX','FontSize',16);
% generate the wedgeplot
% wedgeplot(out,'transpose',true,'extradata',[y1 out.yhat]);</pre></div></div><a href='http://rosa.unipr.it/fsda/LTSts.html#ExtraExample_8'><img vspace="5" hspace="5" src="images\LTSts_03.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website)"> <img vspace="5" hspace="5" src="images\LTSts_04.png" alt=""> <img vspace="5" hspace="5" src="images\LTSts_05.png" alt=""> <img vspace="5" hspace="5" src="images\LTSts_06.png" alt=""> <img vspace="5" hspace="5" src="images\LTSts_07.png" alt=""> <img vspace="5" hspace="5" src="images\LTSts_08.png" alt=""> </a></p></div></div><div id="Extraexample_9" class="example_module expandableContent"><div id="ExtraExample_9"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Examples 4 and 5 used in the paper RPRH: trade data.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">%% Examples 4 and 5 used in the paper RPRH: trade data.
close all; clear all;
% the datasets
load('P12119085');
load('P17049075');
Y4 = P12119085{:,1};
Y5 = P17049075{:,1};
% the model
model           = struct;
model.trend     = 1;
model.seasonal  = 102;
model.s         = 12;
model.lshift    = 14:length(Y4)-13;
% LTSts
out4 = LTSts(Y4,'model',model,'plots',0,'dispresults',true,'msg',0);
out5 = LTSts(Y5,'model',model,'plots',0,'dispresults',true,'msg',0);
% the wedgeplot with the time series and the detected outliers and
% level shift
wedgeplot(out4,'extradata',Y4,'titl','P12119085, imports of plants from KN to UK');
wedgeplot(out5,'extradata',Y5,'titl','P17049075, imports of sugars from UA to LT');
% Forecasts with a 99.9 per cent confidence level
nfore=10;
outfore4 = forecastTS(out4,'model',model,'nfore',nfore,'conflev',0.999,'titl','LTSts forecast for P12119085, imports of plants from KN to UK');
outfore5 = forecastTS(out5,'model',model,'nfore',nfore,'conflev',0.999,'titl','LTSts forecast for P17049075, imports of sugars from UA to LT');
% Comparing with FS (needs conflev option)
outLTS4 = LTSts(Y4,'model',model,'plots',1,'conflev',0.99,'msg',0);
title(findobj(gcf,'Tag','LTSts:ts'),'P12119085, LTS with conflev=0.99');
outFRS4 = FSRts(Y4,'model',model,'plots',1);
title(findobj(gcf,'Tag','FSRts:ts'),'P12119085, FS with default conflev');
outLTS5 = LTSts(Y5,'model',model,'plots',1,'conflev',0.99,'msg',0);
title(findobj(gcf,'Tag','LTSts:ts'),'P17049075, LTS with conflev=0.99');
outFRS5 = FSRts(Y5,'model',model,'plots',1);
title(findobj(gcf,'Tag','FSRts:ts'),'P17049075, FS with default conflev');</pre></div></div><pre class="codeoutput">                  Coeff         SE           t           pval   
                _________    _________    ________    __________

    b_trend1       115.27       4.5051      25.586    2.0728e-26
    b_trend2        1.592      0.27465      5.7965    9.1325e-07
    b_cos1        -2.8294       3.9154    -0.72265        0.4741
    b_sin1        -12.419       4.6909     -2.6475      0.011544
    b_cos2        -9.0708       4.6584     -1.9472      0.058559
    b_sin2        -22.604       4.7099     -4.7992    2.2402e-05
    b_varaml    -0.015796    0.0042445     -3.7215    0.00060891
    b_lshift      -112.62       7.6319     -14.756    8.9212e-18

Level shift position t=27
                  Coeff         SE           t          pval   
                _________    _________    _______    __________

    b_trend1        55.14       3.8549     14.304    2.5537e-17
    b_trend2      0.89673      0.19848     4.5181    5.4202e-05
    b_cos1         15.545       4.1497     3.7461    0.00056646
    b_sin1          3.612       4.2659    0.84671        0.4022
    b_cos2        -32.496       4.2541    -7.6387    2.4573e-09
    b_sin2        -16.057        4.313    -3.7229    0.00060638
    b_varaml    -0.022594    0.0018596     -12.15    5.2846e-15
    b_lshift      -79.413       5.6981    -13.937    6.0952e-17

Level shift position t=34
Level shift for t=14
Level shift for t=15
Level shift for t=16
Level shift for t=17
Level shift for t=18
Level shift for t=19
Level shift for t=20
Level shift for t=21
Level shift for t=22
Level shift for t=23
Level shift for t=24
Level shift for t=25
Level shift for t=26
Level shift for t=27
Level shift for t=28
Level shift for t=29
Level shift for t=30
Level shift for t=31
Level shift for t=32
Level shift for t=33
Level shift for t=34
Level shift for t=35
-------------------------
Signal detection loop
Sample seems homogeneous, no outlier has been found
Summary of the exceedances
           1          99         999        9999       99999
           1           2           0           0           0

Level shift for t=14
Level shift for t=15
Level shift for t=16
Level shift for t=17
Level shift for t=18
Level shift for t=19
Level shift for t=20
Level shift for t=21
Level shift for t=22
Level shift for t=23
Level shift for t=24
Level shift for t=25
Level shift for t=26
Level shift for t=27
Level shift for t=28
Level shift for t=29
Level shift for t=30
Level shift for t=31
Level shift for t=32
Level shift for t=33
Level shift for t=34
Level shift for t=35
-------------------------
Signal detection loop
Sample seems homogeneous, no outlier has been found
Summary of the exceedances
           1          99         999        9999       99999
           0           5           1           0           0

</pre><a href='http://rosa.unipr.it/fsda/LTSts.html#ExtraExample_9'><img vspace="5" hspace="5" src="images\LTSts_09.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website)"> <img vspace="5" hspace="5" src="images\LTSts_10.png" alt=""> <img vspace="5" hspace="5" src="images\LTSts_11.png" alt=""> <img vspace="5" hspace="5" src="images\LTSts_12.png" alt=""> <img vspace="5" hspace="5" src="images\LTSts_13.png" alt=""> <img vspace="5" hspace="5" src="images\LTSts_14.png" alt=""> <img vspace="5" hspace="5" src="images\LTSts_15.png" alt=""> <img vspace="5" hspace="5" src="images\LTSts_16.png" alt=""> <img vspace="5" hspace="5" src="images\LTSts_17.png" alt=""> <img vspace="5" hspace="5" src="images\LTSts_18.png" alt=""> <img vspace="5" hspace="5" src="images\LTSts_19.png" alt=""> <img vspace="5" hspace="5" src="images\LTSts_20.png" alt=""> </a></p></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="Inputs">Input Arguments</h2><div class="expandableContent"><div class="arguments"><div class="input_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"> <div id="inputarg_y" class="clearfix"> </div> <h3 id="input_argument_y" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>y</code> &#8212; Time series to analyze. </span>  </a><span class="example_desc">Vector.</span></span></h3> <div class="collapse"> <p>A row or a column vector
               with T elements, which contains the time series.</p> <p class="datatypelist"><strong> Data Types: </strong><code>single| double</code></p> </div> </div><div id="namevaluepairarguments" class="clearfix"></div><h3 id="NameValuePairs" class="bottom_ruled">Name-Value Pair Arguments</h3><div class="namevaluecontainer"><p>Specify optional comma-separated pairs of <code>Name,Value</code> arguments. <code>Name</code> is the argument name and <code>Value</code> is the corresponding value. <code>Name</code> must appear  inside single quotes (<code>' '</code>).  You can specify several name and value pair arguments in any order as <code>  Name1,Value1,...,NameN,ValueN</code>.</p>  <span class="example_desc"><strong>Example:</strong><code><code> 'bdp',0.4
</code>,<code> 'conflev',0.99
</code>,<code> 'dispresults',true
</code>,<code> 'h',round(n*0.75)
</code>,<code> 'intercept',false
</code>,<code> 'lshiftlocref',lshiftlocref.typeres=2
</code>,<code> 'lts',lts
</code>,<code> 'model', model
</code>,<code> 'msg',true
</code>,<code> 'nbestindexes',5
</code>,<code> 'nocheck',true
</code>,<code> 'nsamp',500
</code>,<code> 'refstepsALS',20
</code>,<code> 'reftolALS',1e-05
</code>,<code> 'SmallSampleCor',3
</code>,<code> 'yxsave',1
</code>,<code> 'plots',1
</code></code></span></div><div class="expandableContent"><div id="inputarg_bdp" class="clearfix"></div><h3 id="input_argument_namevalue_bdp" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>bdp</code> &#8212;breakdown point.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>It measures the fraction of outliers
               the algorithm should resist. In this case any value greater
               than 0 but smaller or equal than 0.5 will do fine. Please
               specify h or bdp, but not both.</p> <p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'bdp',0.4
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_conflev" class="clearfix"></div><h3 id="input_argument_namevalue_conflev" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>conflev</code> &#8212;Confidence level.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>Scalar between 0 and 1 containing
               Confidence level which is used to declare units as
               outliers. Usually conflev=0.95, 0.975 0.99 (individual
               alpha) or 1-0.05/n, 1-0.025/n, 1-0.01/n (simultaneous
               alpha). Default value is 0.975.</p> <p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'conflev',0.99
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_dispresults" class="clearfix"></div><h3 id="input_argument_namevalue_dispresults" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>dispresults</code> &#8212;Display results of final fit.</span></a><span class="example_desc">boolean.</span></span></h3><div class="collapse">	<p><p>If dispresults is
               true,  labels of coefficients, estimated coefficients,
               standard errors, tstat and p-values are shown on the
               screen in a fully formatted way. The default value of
               dispresults is false.</p> <p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'dispresults',true
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>logical</code></p></div></div><div class="expandableContent"><div id="inputarg_h" class="clearfix"></div><h3 id="input_argument_namevalue_h" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>h</code> &#8212;The number of observations that determined the least
               trimmed squares estimator.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>h is an integer greater
               than p (number of columns of matrix X including the
               intercept but smaller then n. If the purpose is outlier
               detection than h does not have to be smaller than
               [0.5*(T+p+1)]. The default value of h is [0.75*T]. Note
               that if h is supplied input argument bdp is ignored.</p> <p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'h',round(n*0.75)
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_intercept" class="clearfix"></div><h3 id="input_argument_namevalue_intercept" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>intercept</code> &#8212;Indicator for constant term.</span></a><span class="example_desc">true (default) | false.</span></span></h3><div class="collapse">	<p><p>Indicator for the constant term (intercept) in the fit,
                 specified as the comma-separated pair consisting of
                 'Intercept' and either true to include or false to remove
                 the constant term from the model.</p> <p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'intercept',false
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>boolean</code></p></div></div><div class="expandableContent"><div id="inputarg_lshiftlocref" class="clearfix"></div><h3 id="input_argument_namevalue_lshiftlocref" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>lshiftlocref</code> &#8212;Parameters for local shift refinement.</span></a><span class="example_desc">structure.</span></span></h3><div class="collapse">	<p><p>This option is used just if model.lshift is greater then 0.</p> <p>
               In order to precisely identify level shift position it is
               necessary to consider a local sum of squares varying the
               position of the level shift around the first tentative
               position keeping all the other parameters fixed. This
               structure contains the following fields:</p><p>
       </p><table border="2" cellpadding="4" cellspacing="0" class="body"><colgroup><col width="20%"><col width="80%"></colgroup><thead><tr valign="top"><th valign="top">Value</th><th valign="top">Description</th></tr></thead><tr valign="top"><td><code>wlength</code></td><td><p>scalar greater than 0 which
                   identifies the length of the window. The default value
                   is 15, that is the tentative level shift position
                   varies from tl-15, tl-15, ..., tl+14, tl+15, where tl is
                   the best preliminary tentative level shift position.</p></td></tr><tr valign="top"><td><code>typeres</code></td><td><p>scalar which identifies the type of
                   residuals to consider. If typerres =1, the local
                   residuals sum of squares is based on huberized (scaled)
                   residuals (this is the default
                   choice) else raw residuals are used.</p></td></tr><tr valign="top"><td><code>huberc</code></td><td><p>tuning constant for Huber estimator just
                   in case lshiftlocref.typeres=1. The default value is 2.</p></td></tr></table></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'lshiftlocref',lshiftlocref.typeres=2
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>struct</code></p></div></div><div class="expandableContent"><div id="inputarg_lts" class="clearfix"></div><h3 id="input_argument_namevalue_lts" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>lts</code> &#8212;structure which controls a set of options of the
               maximization procedure.</span></a><span class="example_desc">structure.</span></span></h3><div class="collapse">	<p><p>Structure with the
               following fields:</p> <p>
           </p><table border="2" cellpadding="4" cellspacing="0" class="body"><colgroup><col width="20%"><col width="80%"></colgroup><thead><tr valign="top"><th valign="top">Value</th><th valign="top">Description</th></tr></thead><tr valign="top"><td><code>bestr</code></td><td><p><p>scalar defining number of "best betas" to
                               remember from the subsamples. These will be
                               later iterated until convergence.</p> <p>
                               The default is 20 (10 of them are the best
                               from previous iteration in case a level
                               shift is present).</p></p></td></tr><tr valign="top"><td><code>refsteps</code></td><td><p>scalar defining number of concentration
                               steps (default = 2). refsteps = 0 means
                               "raw-subsampling" without iterations.</p></td></tr><tr valign="top"><td><code>refstepsbestr</code></td><td><p>scalar defining maximum number of refining
                               steps for each best subset (default=50).</p></td></tr><tr valign="top"><td><code>reftol</code></td><td><p>scalar. Default value of tolerance for
                               the refining steps
                               The default value is 1e-6;</p></td></tr><tr valign="top"><td><code>reftolbestr</code></td><td><p><p>scalar. Default value of tolerance for
                               the refining steps for each of the best
                               subsets The default value is 1e-8.</p> <p>
                              Remark: if lts is an empty value all default values of
              structure lts will be used.</p></p></td></tr></table></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'lts',lts
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>struct</code></p></div></div><div class="expandableContent"><div id="inputarg_model" class="clearfix"></div><h3 id="input_argument_namevalue_model" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>model</code> &#8212;model type.</span></a><span class="example_desc">structure.</span></span></h3><div class="collapse">	<p><p>A structure which specifies the model
               which will be used. The model structure contains the following
               fields:</p> <p>
       </p><table border="2" cellpadding="4" cellspacing="0" class="body"><colgroup><col width="20%"><col width="80%"></colgroup><thead><tr valign="top"><th valign="top">Value</th><th valign="top">Description</th></tr></thead><tr valign="top"><td><code>s</code></td><td><p>scalar (length of seasonal period). For monthly
                         data s=12 (default), for quartely data s=4, ...</p></td></tr><tr valign="top"><td><code>trend</code></td><td><p><p>scalar (order of the trend component).</p> <p>
                       trend = 0 implies no trend;</p> <p>
                       trend = 1 implies linear trend with intercept (default);</p> <p>
                       trend = 2 implies quadratic trend;</p> <p>
                       trend = 3 implies cubic trend.</p> <p>
                       Admissible values for trend are, 0, 1, 2 and 3.</p><p>
                       In the paper RPRH to denote the order of the trend
                       symbol A is used.</p></p></td></tr><tr valign="top"><td><code>seasonal</code></td><td><p><p>scalar (integer specifying number of
                        frequencies, i.e. harmonics, in the seasonal
                        component. Possible values for seasonal are
                        $0,1, 2, ..., [s/2]$, where $[s/2]=floor(s/2)$.</p> <p>
                        If seasonal =0 we assume there is no seasonal
                        component.</p> <p>
                        If seasonal =1 (default) we have:</p> <p>
                        $\beta_1 \cos( 2 \pi t/s) + \beta_2 sin ( 2 \pi t/s)$;</p> <p>
                        if seasonal =2 we have:</p> <p>
                        $\beta_1 \cos( 2 \pi t/s) + \beta_2 \sin ( 2 \pi t/s)
                        + \beta_3 \cos(4 \pi t/s) + \beta_4 \sin (4 \pi t/s)$.</p> <p>
                        Note that when $s$ is even the sine term disappears
                        for $j=s/2$ and so the maximum number of
                        trigonometric parameters is $s-1$.</p> <p>
                        If seasonal is a number greater than 100 then it
                        is possible to specify how the seasonal component
                        grows over time.</p> <p>
                        For example, seasonal = 101 implies a seasonal
                        component which just uses one frequency
                        which grows linearly over time as follows:</p> <p>
                        $(1+\beta_3 t)\times ( \beta_1 cos( 2 \pi t/s) +
                        \beta_2 \sin ( 2 \pi t/s))$.</p> <p>
                        For example, seasonal =201 implies a seasonal
                        component which just uses one frequency
                        which grows in a quadratic way over time as
                        follows:</p> <p>
                        $(1+\beta_3 t + \beta_4  t^2)\times( \beta_1 \cos(
                        2 \pi t/s) + \beta_2 \sin ( 2 \pi t/s))$.</p> <p>
                        seasonal =0 implies a non seasonal model.</p> <p>
                       In the paper RPRH to denote the number of
                       frequencies of the seasonal component
                       symbol B is used, while symbol G is used to denote
                       the order of the trend of the seasonal component.</p><p>
                       Therefore, for example, model.seasonal=201
                       corresponds to B=1 and G=2, while model.seasonal=3
                       corresponds to B=3 and G=0;</p></p></td></tr><tr valign="top"><td><code>X</code></td><td><p>matrix of size T-by-nexpl containing the
                         values of nexpl extra covariates which are likely
                         to affect y.</p></td></tr><tr valign="top"><td><code>lshift</code></td><td><p><p>scalar or vector associated to level shift
                       component. lshift=0 (default) implies no level
                       shift component.</p> <p>
                       If model.lshift is vector of positive integers,
                         then it is associated to the positions of level
                         shifts which have to be considered. The most
                         significant one is included in the fitted model.</p> <p>
                         For example if model.lshift =[13 20 36] a
                         tentative level shift is imposed in position
                         $t=13$, $t=20$ and $t=36$. The most significant
                         among these positions in included in the final
                         model. In other words, the following extra
                         parameters are added to the final model:</p> <p>
                         $\beta_{LS1}* I(t \geq \beta_{LS2})$ where
                         $\beta_{LS1}$ is a real number (associated with
                         the magnitude of the level shift) and
                         $\beta_{LS2}$ is an integer which assumes values
                         13, 20 or 36 and and $I$ denotes the indicator
                         function.</p> <p>
                         As a particular case, if model.lshift =13 then a
                         level shift in position $t=13$ is added to the
                         model. In other words the following additional
                         parameters are added: $\beta_{LS1}* I(t \geq 13)$
                         where $\beta_{LS1}$ is a real number and $I$
                         denotes the indicator function.</p> <p>
                       If lshift = -1 tentative level shifts are
                         considered for positions $p+1,p+2, ..., T-p$ and
                         the most significant one is included in the final
                         model ($p$ is the total number of parameters in
                         the fitted model). Note that lshift=-1 is not
                         supported for C-coder translation.</p><p>
                       In the paper RPRH $\beta_{LS1}$ is denoted with
                       symbol $\delta_1$, while, $\beta_{LS2}$ is denoted
                       with symbol $\delta_2$.</p></p></td></tr><tr valign="top"><td><code>ARp</code></td><td><p><p>scalar greater or equal than 0 which
                         specifies the length of the autoregressive
                         component. The default value of model.ARp is 0,
                         that is there is no autoregressive component.</p> <p>
                                Remark: the default model is for monthly data with a linear
               trend (2 parameters) + seasonal component with just one
               harmonic (2 parameters), no additional explanatory
               variables and no level shift that is
                               model=struct;</p> <p>
                               model.s=12;</p> <p>
                               model.trend=1;</p> <p>
                               model.seasonal=1;</p> <p>
                               model.X='';</p> <p>
                               model.lshift=0;</p><p>
               Using the notation of the paper RPRH we have A=1, B=1; and
               $\delta_1=0$.</p></p></td></tr></table></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'model', model
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>struct</code></p></div></div><div class="expandableContent"><div id="inputarg_msg" class="clearfix"></div><h3 id="input_argument_namevalue_msg" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>msg</code> &#8212;Messages on the screen.</span></a><span class="example_desc">boolean.</span></span></h3><div class="collapse">	<p>Scalar which controls whether to display or not messages
               on the screen. If msg==true (default) messages are displayed on
               the screen about estimated time to compute the estimator
               and the warnings about 'MATLAB:rankDeficientMatrix',
               'MATLAB:singularMatrix' and 'MATLAB:nearlySingularMatrix'
               are set to off else no message is displayed on the screen
               </p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'msg',true
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>logical</code></p></div></div><div class="expandableContent"><div id="inputarg_nbestindexes" class="clearfix"></div><h3 id="input_argument_namevalue_nbestindexes" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>nbestindexes</code> &#8212;position of the best solutions.</span></a><span class="example_desc">positive integer.</span></span></h3><div class="collapse">	<p><p>For each
               tentative level shift solution, it is interesenting to
               understand whether best solutions of target function come
               from subsets associated with current level shift solution
               or from best solutions from previous tentative level shift
               position.  The indexes from 1 to lts.bestr/2 are associated
               with subsets just extracted. The indexes from lts.bestr/2+1
               to lts.bestr are associated with best solutions from
               previous tentative level shift. More precisely:</p> <p>
               index lts.bestr/2+1 is associated with best solution from
               previous tentative level shift;</p> <p>
               index lts.bestr/2+2 is associated with second best solution
               from previous tentative level shift;</p> <p>
               ...</p> <p>
               nbestindexes is an integer which specifies how many indexes
               we want to store. The default value of nbestindexes  is 3.</p><p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'nbestindexes',5
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_nocheck" class="clearfix"></div><h3 id="input_argument_namevalue_nocheck" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>nocheck</code> &#8212;Check input arguments.</span></a><span class="example_desc">boolean.</span></span></h3><div class="collapse">	<p><p>If nocheck is equal to true no
               check is performed on matrix y and matrix X. Notice that y
               and X are left unchanged. In other words the additioanl
               column of ones for the intercept is not added. As default
               nocheck=false. The controls on h, bdp and nsamp still remain.</p> <p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'nocheck',true
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>boolean</code></p></div></div><div class="expandableContent"><div id="inputarg_nsamp" class="clearfix"></div><h3 id="input_argument_namevalue_nsamp" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>nsamp</code> &#8212;number of subsamples to extract.</span></a><span class="example_desc">scalar | vector of length 2.</span></span></h3><div class="collapse">	<p><p>Vector of length 1 or 2 which controls the number of
               subsamples which will be extracted to find the robust
               estimator. If lshift is not equal to 0 then nsamp(1)
               controls the number of subsets which have to be extracted
               to find the solution for t=lshift(1). nsamp(2) controls the
               number of subsets which have to be extracted to find the
               solution for t=lshift(2), lshift(3), ..., lshift(end).</p> <p>
               Note that nsamp(2) is generally smaller than nsamp(1)
               because in order to compute the best solution for
               t=lshift(2), lshift(3), ..., lshift(end), we use the lts.bestr/2
               best solutions from previous t (after shifting the
               position of the level shift in the estimator of beta). If
               lshift is a vector of positive integers the default value
               of nsamp is (500 250). If
               lshift is a vector of positive integers and nsamp is supplied as a scalar the default
               is to extract [nsamp/2] subsamples for t=lshift(1),
               lshift(2), ... Therefore, for example, in order to extract
               600 subsamples for t=lshift(1) and 300 subsamples for t=
               lshift(2) ... you can use nsamp =600 or nsamp=[600 300].</p> <p>
               The default value of nsamp is 1000;</p> <p>
                                Remark: if nsamp=0 all subsets will be extracted.</p> <p>
               They will be (n choose p).</p><p>

</p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'nsamp',500
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_refstepsALS" class="clearfix"></div><h3 id="input_argument_namevalue_refstepsALS" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>refstepsALS</code> &#8212;Maximum iterations inside ALS.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>Maximum number
                 of iterations inside ALS routine. Default value of
                 tolerance for the refining steps inside ALS routine. The
                 default value is 50.</p> <p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'refstepsALS',20
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_reftolALS" class="clearfix"></div><h3 id="input_argument_namevalue_reftolALS" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>reftolALS</code> &#8212;Tolerance inside ALS.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>Tolerance value of tolerance
                 for the refining steps inside ALS routine. The default
                 value is 1e-03.</p> <p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'reftolALS',1e-05
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_SmallSampleCor" class="clearfix"></div><h3 id="input_argument_namevalue_SmallSampleCor" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>SmallSampleCor</code> &#8212;Small sample correction factor to control empirical size of
               the test.</span></a><span class="example_desc">scalar equal to 1 | 2 (default) | 3 | 4.</span></span></h3><div class="collapse">	<p><p>- If SmallSampleCor=1 in the reweighting step the nominal
                 threshold based on $\chi^2_{0.99}$ is multiplied by the
                 small sample correction factor which guarrantees that the
                 empirical size of the test is equal to the nominal size.</p> <p>
                 Given that the correction factors were obtained through
                 simulation for a linear model, the number of explanatory
                 which is used to compute the correction factor refers to
                 all explanatory variables except the non linear components
                 in the seasonal part of the model. For example, in a model
                 with linear trend 4 seasonal harmonics + level shift and
                 second order trend in the seasonal component the number of
                 explanatory variables used is 11 = total number of
                 variables -2 = 2 (linear trend) + 8 (4 seasonal harmonics)
                 +1 (level shift).</p> <p>
               - If SmallSampleCor =2 Gervini and Yohai procedure is called
                 with 'iterating' false and 'alpha' 0.99 is invoked, that is:</p> <p>
                 weights=GYfilt(stdres,'iterating',false,'alpha',0.99);</p> <p>
               - If SmallSampleCor =3 Gervini and Yohai procedure  called
                 with 'iterating' true and 'alpha' 0.99 is invoked, that is:</p> <p>
                 weights=GYfilt(stdres,'iterating',true,'alpha',0.99);</p> <p>
               - If SmallSampleCor =4  $\chi^2_{0.99}$ threshold is used that is:</p> <p>
                 weights = abs(stdres)&lt;=sqrt(chi2inv(0.99,1));</p><p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'SmallSampleCor',3
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_yxsave" class="clearfix"></div><h3 id="input_argument_namevalue_yxsave" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>yxsave</code> &#8212;store X and y.</span></a><span class="example_desc">boolean.</span></span></h3><div class="collapse">	<p><p>Scalar that is set to 1 to request
                that the response vector y and data matrix X are saved
                into the output structure out.</p> <p>
                Default is 0, i.e. no saving is done.</p><p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'yxsave',1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>logical</code></p></div></div><div class="expandableContent"><div id="inputarg_plots" class="clearfix"></div><h3 id="input_argument_namevalue_plots" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>plots</code> &#8212;Plots on the screen.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>If plots = 1, a two panel plot will be shown on the screen.</p> <p>
               The upper panel contains the orginal time series with
               fitted values. The bottom panel will contain the plot
               of robust residuals against index number. The confidence
               level which is used to draw the horizontal lines associated
               with the bands for the residuals is specified in input
               option conflev. If conflev is missing a nominal 0.975
               confidence interval will be used. If plots =2 the following
               additional plots will be shown on the screen.</p> <p>
               1) Boxplot of the distribution of the lts.bestr values of
               the target function for each tentative level shift position;</p> <p>
               2) A two panel plot which shows the values of the local sum
               of squares varying the position of the level shift around
               the first tentative position keeping all the other
               parameters fixed. Top panel refers to Huberized residuals
               sum of squares and bottom panel refers to residual sum of
               squares.</p> <p>
               3) A plot which shows the indexes of the best nbestindexes
               solutions for each tentative level shift position.</p> <p>
               4) A plot which shows the relative frequency of inclusion
               of each unit in the best h-subset after lts.refsteps
               refining steps.</p> <p>
               5) A plot which shows the relative frequency of inclusion
               of each unit inside the best nbestindexes subsets which are
               brought to full convergence.</p> <p>
               The default value of plot is 0 i.e. no plot is shown on the
               screen.</p><p>
                        </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'plots',1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="OutputArgs" >Output Arguments</h2><div class="expandableContent"><div class="arguments"><div class="output_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"><div id="outputarg_out" class="clearfix"></div><h3 id="output_argument_out" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>out</code> &#8212; description</span></a><span class="example_desc">Structure</span></span></h3><div class="collapse"><p>A structure containing the following fields

     <table border="2" cellpadding="4" cellspacing="0" class="body"><colgroup><col width="20%"><col width="80%"></colgroup><thead><tr valign="top"><th valign="top">Value</th><th valign="top">Description</th></tr></thead><tr valign="top"><td><code>B</code></td><td><p><p>Matrix containing estimated beta coefficients,
                       (including the intercept when options.intercept=true)
                       standard errors, t-stat and p-values
                       The content of matrix B is as follows:</p> <p>
                       1st col = beta coefficients
                        The order of the beta coefficients is as follows:</p> <p>
                        1) trend elements (if present). If the trend is
                        of order two there are r+1 coefficients if the
                        intercept is present otherwise there are just r
                        components;</p> <p>
                        2) linear part of seasonal component 2, 4, 6, ...,
                        s-2, s-1 coefficients (if present);</p> <p>
                        3) coefficients associated with the matrix of
                        explanatory variables which have a potential effect
                        on the time series under study (X or
                        autoregressive part); If model.ARp&gt;0 the first
                        model.ARp elements refer to the autoregressive
                        component.</p> <p>
                        4) non linear part of seasonal component, that is
                        varying amplitude. If varying amplitude is of order
                        k there are k coefficients (if present);</p> <p>
                        5) level shift component (if present). In out.B it
                        is shown just the real number which identifies the
                        magnitude of the upward (downward) level shift.</p> <p>
                        The integer which specifies the time in which
                        level shift takes place is given in output
                        out.posLS.</p> <p>
                       2nd col = standard errors;</p> <p>
                       3rd col = t-statistics;</p><p>
                       4th col = p values.</p></p></td></tr><tr valign="top"><td><code>Btable</code></td><td><p>same thing as out.B but in table format.</p></td></tr><tr valign="top"><td><code>h</code></td><td><p>The number of observations that have determined the
                       initial LTS estimator, i.e. the value of h.</p></td></tr><tr valign="top"><td><code>bs</code></td><td><p><p>Vector containing the units with the smallest p+k
                       squared residuals before the reweighting step,
                       where p is the total number of the parameters in
                       the model and p+k is smallest number of units such
                       that the design matrix is full rank.</p> <p>
                       out.bs can be used to initialize the forward
                       search.</p></p></td></tr><tr valign="top"><td><code>Hsubset</code></td><td><p>matrix of size T-by-r
                       containing units forming best H subset for each
                       tentative level shift which is considered. r is
                       number of tentative level shift positions whicha re
                       considered. For example if model.lshift=[13 21 40]
                       r is equal to 3. Units belonging to subset are
                       given with their row number, units not belonging to
                       subset have missing values
                       This output is present just if input option
                       model.lshift is not equal to 0.</p></td></tr><tr valign="top"><td><code>posLS</code></td><td><p>scalar associated with best tentative level shift
                       position. This output is present just if input
                       option model.lshift is not equal to 0.</p></td></tr><tr valign="top"><td><code>numscale2</code></td><td><p>matrix of size lts.bestr-by-(T-2*lshift) containing
                       (in the columns) the values of the lts.bestr smallest
                       values of the target function. Target function = truncated
                       residuals sum of squares.</p></td></tr><tr valign="top"><td><code>BestIndexes</code></td><td><p><p>matrix of size nbestindexes-by-(T-2*lshift)
                       containing in each column the indexes
                       associated with the best nbestindexes solutions.</p> <p>
                       The indexes from lts.bestr/2+1 to lts.bestr are
                       associated with best solutions from previous
                       tentative level shift.</p> <p>
                       More precisely:</p> <p>
                       index lts.bestr/2+1 is associated with best solution
                       from previous tentative level shift;</p> <p>
                       index lts.bestr/2+2 is associated with best solution
                       from previous tentative level shift.</p><p>
                       This output is present just if input option
                       model.lshift is not equal to 0.</p></p></td></tr><tr valign="top"><td><code>Likloc</code></td><td><p><p>matrix of size (2*lshiftlocref.wlength+1)-by-3
                       containing local sum of squares of residuals in
                       order to decide best position of level shift:</p> <p>
                       1st col = position of level shift;</p> <p>
                       2nd col = local sum of squares of huberized residuals;</p> <p>
                       3rd col = local sum of squares of raw residuals.</p><p>
                       This output is present just if input option
                       model.lshift is not equal to 0.</p></p></td></tr><tr valign="top"><td><code>RES</code></td><td><p>Matrix of size T-by-(T-lshift) containing scaled
                       residuals for all the T units of the original time
                       series monitored in steps lshift+1, lshift+2, ...,
                       T-lshift, where lshift+1 is the first tentative
                       level shift position, lshift +2 is the second level
                       shift position, and so on. This output is present
                       just if input option model.lshift is not equal to 0.</p></td></tr><tr valign="top"><td><code>yhat</code></td><td><p><p>vector of fitted values after final (NLS=non linear
                       least squares) step.</p> <p>
                       $ (\hat \eta_1, \hat \eta_2, \ldots, \hat \eta_T)'$</p></p></td></tr><tr valign="top"><td><code>residuals</code></td><td><p>Vector T-by-1 containing the scaled residuals from
                       after final NLS step.</p></td></tr><tr valign="top"><td><code>weights</code></td><td><p>Vector containing weights after adaptive
                       reweighting. The elements of
                       this vector are 0 or 1. These weights identify the
                       observations which are used to compute the final
                       NLS estimate.</p></td></tr><tr valign="top"><td><code>scale</code></td><td><p><p>Final scale estimate of the residuals using final weights.</p> <p>
                     </p>\[
                     \hat \sigma = cor \times \sum_{i \in S_m} [y_i- \eta(x_i,\hat \beta)]^2/(m-p)
                     \]
                     where $S_m$ is a set of cardinality $m$ which
                     contains the units not declared as outliers, $p$
                     is the total number of estimated parameters and $cor$
                     is a correction factor to make the estimator
                     consistent.</p></td></tr><tr valign="top"><td><code>conflev</code></td><td><p><p>confidence level which is used to declare outliers.</p> <p>
                       Remark: scalar out.conflev will be used to draw the
                       horizontal lines (confidence bands) in the plots</p></p></td></tr><tr valign="top"><td><code>outliers</code></td><td><p>vector containing the list of the units declared
                       as outliers using confidence level specified in
                       input scalar conflev.</p></td></tr><tr valign="top"><td><code>outliersPval</code></td><td><p>p-value of the units declared as outliers.</p></td></tr><tr valign="top"><td><code>singsub</code></td><td><p>Number of subsets wihtout full rank. Notice that if
                       this number is greater than 0.1*(number of
                       subsamples) a warning is produced on the screen</p></td></tr><tr valign="top"><td><code>invXX</code></td><td><p><p>$cov(\beta)/\hat \sigma^2$. p-by-p, square matrix.</p> <p>
                       If the model is linear out.invXX  is equal to
                       $(X'X)^{-1}$, else out.invXX is equal to $(A'A)^{-1}$
                       where $A$ is the matrix of partial derivatives. More
                       precisely:</p><p>
                       </p>\[
                       a_{i,j}=\frac{\partial \eta_i(x_i, \hat \beta)}{\partial \hat \beta_j}
                       \]
                       where
                       \begin{eqnarray}
                       y_i & = & \eta(x_i,\beta)+ \epsilon_i  \\
                           & = & \eta_i +\epsilon_i \\
                           & = & \eta(x_i,\hat \beta)+ e_i  \\
                           & = & \hat \eta_i + e_i
                       \end{eqnarray}</p></td></tr><tr valign="top"><td><code>LastHarmonicPval</code></td><td><p>combined p value for the two coefficients of the
                        last harmonic (this p value comes from an F test).</p></td></tr><tr valign="top"><td><code>LevelShiftPval</code></td><td><p>p value of the level shift which takes into
                       account (this pvalue comes from Bonferronization to
                       take it account that if you impose a level shift,
                       this component is always found).</p></td></tr><tr valign="top"><td><code>y</code></td><td><p>response vector y.</p></td></tr><tr valign="top"><td><code>X</code></td><td><p>data matrix X containing trend, seasonal, expl
                       (with autoregressive component) and
                       lshift, if the model is linear or linearized
                       version of $\eta(x_i, \beta)$ if the model is non
                       linear containing in the columns partial
                       derivatives evaluated in correspondence of
                       out.B(:,1) with respect to each parameter. In other
                       words, the $i,j$-th element of out.X is
                       \[
                       \frac{\partial \eta_i(x_i, \hat \beta)}{\partial \hat \beta_j}
                       \]<p>
                       $j=1, 2, \ldots, p$, $i \in S_m$.</p> <p>
                       The size of this matrix is:</p><p>
                       n-length(out.outliers)-by-p
                       The field is present only if option
                       yxsave is set to 1.</p></p></td></tr><tr valign="top"><td><code>class</code></td><td><p>'LTSts'.</p></td></tr></table></p></div></div><div class="expandableContent"><div id="outputarg_varargout" class="clearfix"></div><h3 id="output_argument_varargout" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>varargout</code> &#8212;Indices of the subsamples
                       extracted for computing the estimate (the so called
                       elemental sets) for each tentative level shift
                       position.</span></a><span class="example_desc">C        : cell</span></span></h3><div class="collapse"><p><p>
                       C{1} is associated with the subsamples for
                       first tentative level shift position;</p> <p>
                       C{2} is associated with the subsamples for
                       second tentative level shift position;</p> <p>
                       ...</p><p>
                       C{end} is associated with the subsamples for
                       last tentative level shift position;</p></p></div></div></div></div></div></div><div class="ref_sect" itemprop="content"><div class="bibliography"><h2 id="References">References</h2> <div><p>Rousseeuw, P.J., Perrotta D., Riani M. and Hubert, M. (2018), Robust
 Monitoring of Many Time Series with Application to Fraud Detection,
 "Econometrics and Statistics". [RPRH]</p></div></div></div><div class="ref_sect"><h2 id="SeeAlso">See Also</h2><p><span itemprop="seealso"><a href="LXS.html" itemprop="url"><span itemprop="name"><code>LXS</code></span></a></span> | <span itemprop="seealso"><a href="wedgeplot.html" itemprop="url"><span itemprop="name"><code>wedgeplot</code></span></a></span></div><i>This page has been automatically generated by our routine <a href="publishFS.html">publishFS</a></i></div></section></div></div></div></div><div id="divbottom"></div></body></html>