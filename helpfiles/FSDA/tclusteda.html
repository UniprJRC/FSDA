<!DOCTYPE HTML> <html itemscope="" xmlns="http://www.w3.org/1999/xhtml"><head><title>tclusteda</title><meta content="refpage" name="chunktype"><meta content="function:tclusteda" itemprop="refentity" name="refentity"><meta content="text/javascript" http-equiv="Content-Script-Type"><meta content="fcn" itemprop="pagetype" name="toctype"><meta content="ref/function" itemprop="infotype" name="infotype" /><meta content="tclusteda computes tclust for a series of values of the trimming factor." itemprop="description" name="description" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" /><script type="text/x-mathjax-config">MathJax.Hub.Config({extensions: ["tex2jax.js"],jax: ["input/TeX","output/HTML-CSS"],menuSettings: {zoom: "Double-Click", zscale: "300"},tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},MathMenu: {showRenderer: false},"HTML-CSS": {availableFonts: ["TeX"],preferredFont: "TeX",imageFont: null}});</script><script type="text/javascript" src="includesFS/Mathjax/MathJax.js"></script><script src="includesFS/matlab-highlighter.min.js"></script><link href="includesFS/matlab-highlighter.css" rel="stylesheet" type="text/css"><script type="text/javascript" src="includesFS/jquery-latest.js"></script><script>$(document).ready(function(){      $("#divtop").load("includesFS/top.html");      $("#divbottom").load("includesFS/bottom.html");});</script><link href="../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)"></link><link href="../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)"></link><link href="../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)"></link><link href="../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)"></link><link href="../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)"></link><link href="../includes/product/css/site6_offcanvas.css" rel="stylesheet" type="text/css"></link><script src="../includes/shared/scripts/l10n.js" type="text/javascript"></script><script src="../includes/product/scripts/docscripts.js"></script><script src="../includes/shared/scripts/docscripts_rn.js"></script><script src="../includes/shared/scripts/mw.imageanimation.js" type="text/javascript"></script><script src="../includes/shared/scripts/jquery.highlight.js"></script><script src="../includes/product/scripts/bootstrap.min.js" type="text/javascript"></script><script src="../includes/product/scripts/global.js"></script><script src="includesFS/bottom.js" type="text/javascript"></script><script src="../includes/product/scripts/underscore-min.js"></script><script src="../includes/shared/scripts/f1help.js" type="text/javascript"></script><script src="../includes/product/scripts/suggest.js" type="text/javascript"></script><script src="../includes/shared/scripts/helpservices.js" type="text/javascript"></script><script src="../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script><!-- the following line should be kept this way only --><link href="includesFS/doc_center.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css"><link href="../includes/product/css/doc_center_print.css" media="print" rel="stylesheet" type="text/css"></head><body  onload="highlightMATLABCode();" id="responsive_offcanvas">  <div id="doc_header_spacer" class="header"></div><div class="sticky_header_container includes_subnav"><div class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-xs-12 col-sm-6 col-sm-push-6 col-md-5 col-md-push-7" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2017a" data-language="en" action="../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="sr-only">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"><div class="input-group-btn"><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search pull-right icon_32 visible-xs" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="col-sm-6 col-sm-pull-6 col-md-7 col-md-pull-5" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../documentation-center.html">Documentation</a></h1></div></div></div><div class="visible-xs" id="search_actuator"><button class="btn icon-search btn_search pull-right icon_16" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div><!--END.CLASS row--> </div><!--END.CLASS container-fluid--> </div><!--END.CLASS section_header level_3--><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_actuator" data-toggle="offcanvas" data-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="sr-only">Toggle navigation</span><span class="icon-menu icon_24"></span></button><span class="offcanvas_actuator_label"></span><span class="offcanvas_actuator_close"></span> </div><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-md-12 hidden-xs hidden-sm"></div></div></div></div></div></div></div><!--END.CLASS sticky_header_container--><div class="row-offcanvas row-offcanvas-left"><div id="sidebar" class="sidebar-offcanvas" role="navigation"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" xmlns:atict="http://www.arbortext.com/namespace/atict"><li itemprop="breadcrumb" itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb"> <a href="../documentation-center.html" itemprop="url"> <span itemprop="title">All Products</span></a></li></ul><ul class="nav_disambiguation" xmlns:atict="http://www.arbortext.com/namespace/atict"><li class="product"><a href="index.html">Flexible Statistics and Data Analysis (FSDA)</a><div class="dropdown"> <span id="dropdownMenu1" class="icon-arrow-down icon_16" data-toggle="dropdown"> </span><ul aria-labelledby="dropdownMenu1" class="dropdown-menu dropdown-menu-right" role="menu"><li role="presentation"> <a href="examples.html" role="menuitem" tabindex="-1">Examples</a></li><li role="presentation"> <a href="function-alpha.html" role="menuitem" tabindex="-1"> Functions and Other Reference</a></li><li role="presentation"> <a href="release_notes.html?s_cid=doc_flyout" role="menuitem" tabindex="-1"> Release Notes</a></li><li role="presentation"> <a href="tutorials.html" role="menuitem" tabindex="-1"> Tutorials</a></li></ul></div></li></ul><ul xmlns:atict="http://www.arbortext.com/namespace/atict" class="nav_disambiguation"> <li><a href="index.html">Flexible Statistics and Data Analysis Toolbox</a> </li> <li><a href="function-cate.html" itemprop="url">Functions</a></li></ul><!-- --><ul class="nav_scrollspy nav" xmlns:atict="http://www.arbortext.com/namespace/atict">  <li class="nav_scrollspy_function"> <a href="#responsive_offcanvas">tclusteda</a></li> <li id="SSPY810-refentry" class="nav_scrollspy_title">On this page</li><li><a class="intrnllnk" href="#syntax">Syntax</a></li><li><a class="intrnllnk" href="#Description">Description</a></li><li><a class="intrnllnk" href="#Examples">Examples</a><ul><li><a class="intrnllnk" href="#Example_1">Monitoring using geyser data (all default options).</a></li><li><a class="intrnllnk" href="#Example_2">Monitoring using geyser data with alpha and c specified.</a></li><li><a class="intrnllnk" href="#Example_3">Monitoring using geyser data with option plots supplied as structure.</a></li></ul></li><li><a class="intrnllnk" href="#ExtraExamples">Extra Examples</a><ul><li><a class="intrnllnk" href="#ExtraExample_1">Monitoring geyser data with option UnitsSameGroup.</a></li><li><a class="intrnllnk" href="#ExtraExample_2">tclusteda with M5 data.</a></li><li><a class="intrnllnk" href="#ExtraExample_3">Structured noise data ex1.</a></li><li><a class="intrnllnk" href="#ExtraExample_4">Structured noise data ex2.</a></li><li><a class="intrnllnk" href="#ExtraExample_5">mixture100 data.</a></li><li><a class="intrnllnk" href="#ExtraExample_6">tclusteda using simulated data.</a></li><li><a class="intrnllnk" href="#ExtraExample_7">tclusteda using determinant constraint.</a></li><li><a class="intrnllnk" href="#ExtraExample_8">An example of use of plots as a structure with field ylimy.</a></li></ul></li><li><a class="intrnllnk" href="#Inputs">Input Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_Y">Y</a></li><li><a class="intrnllnk" href="#input_argument_k">k</a></li><li><a class="intrnllnk" href="#input_argument_alpha">alpha</a></li><li><a class="intrnllnk" href="#input_argument_restrfactor">restrfactor</a></li></ul></li><li><a class="intrnllnk" href="#NameValuePairs">Name-Value Pair Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_namevalue_nsamp">nsamp</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_refsteps">refsteps</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_reftol">reftol</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_equalweights">equalweights</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_mixt">mixt</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_plots">plots</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_msg">msg</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_nocheck">nocheck</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_startv1">startv1</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_RandNumbForNini">RandNumbForNini</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_restrtype">restrtype</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_cshape">cshape</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_UnitsSameGroup">UnitsSameGroup</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_numpool">numpool</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_cleanpool">cleanpool</a></li></ul></li><li><a class="intrnllnk" href="#OutputArgs">Output Arguments</a><ul><li><a class="intrnllnk" href="#output_argument_out">out</a></li><li><a class="intrnllnk" href="#output_argument_varargout">varargout</a></li></ul></li><li><a class="intrnllnk" href="#MoreAbout">More About</a></li><li><a class="intrnllnk" href="#References">References</a></li><li><a class="intrnllnk" href="#SeeAlso">See Also</a></li></ul></nav><script src="../includes/product/scripts/offcanvas.js"></script></div><div id="divtop"></div><div class="site_container site_toc_closed"><div class="page_container"><div class="content_frame"><div id="content_container" class="content_container"><section id="doc_center_content"><div class="function_ref"><div itemprop="content"><h1 itemprop="title">tclusteda</h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose">tclusteda computes tclust for a series of values of the trimming factor</p><div class="switch"><a id="expandAllPage" href="javascript:void(0);">expand all in page</a></div></div></div></div><div class="ref_sect"><h2 id="syntax">Syntax</h2><div class="syntax_signature"><div class="syntax_signature_module"><ul><li><code class="synopsis">out=tclusteda(Y,k,alpha,restrfactor)</code><span class="syntax_example"><a class="intrnllnk" href="tclusteda.html#Example_1">example</a></span></li><li><code class="synopsis">out=tclusteda(Y,k,alpha,restrfactor,Name,Value)</code><span class="syntax_example"><a class="intrnllnk" href="tclusteda.html#Example_2">example</a></span></li><li><code class="synopsis">[out,varargout]=tclusteda(___)</code><span class="syntax_example"><a class="intrnllnk" href="tclusteda.html#Example_3">example</a></span></li></ul></div></div></div>	<div class="ref_sect" itemprop="content">							<h2 id="Description">Description</h2>							<div class="descriptions">								<div class="description_module"><p>tclusteda performs tclust for a series of values of the trimming factor
   alpha given k (number of groups) and given c (restriction factor). In
   order to increase the speed of the computations, parfor is used.</p><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="tclusteda.html#Example_1">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_out"><code>out</code></a>=tclusteda(<a class="intrnllnk" href="#inputarg_Y"><code>Y</code></a>,<a class="intrnllnk" href="#inputarg_k"><code>k</code></a>,<a class="intrnllnk" href="#inputarg_alpha"><code>alpha</code></a>,<a class="intrnllnk" href="#inputarg_restrfactor"><code>restrfactor</code></a>)</code></span>Monitoring using geyser data (all default options).</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="tclusteda.html#Example_2">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_out"><code>out</code></a>=tclusteda(<a class="intrnllnk" href="#inputarg_Y"><code>Y</code></a>,<a class="intrnllnk" href="#inputarg_k"><code>k</code></a>,<a class="intrnllnk" href="#inputarg_alpha"><code>alpha</code></a>,<a class="intrnllnk" href="#inputarg_restrfactor"><code>restrfactor</code></a>,<a class="intrnllnk" href="#namevaluepairarguments"><code>Name, Value</code></a>)</code></span>Monitoring using geyser data with alpha and c specified.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="tclusteda.html#Example_3">	example</a></p>	<p><span itemprop="syntax"><code>[<a class="intrnllnk" href="#outputarg_out"><code>out</code></a>,<a class="intrnllnk" href="#outputarg_varargout"><code>varargout</code></a>]=tclusteda(___)</code></span>Monitoring using geyser data with option plots supplied as structure.</p></div>								</div>							</div>							<div class="clear">							</div>						</div><div class="ref_sect" itemprop="content"><div class="examples"><h2 id="Examples">Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="example_1" class="example_module expandableContent"><div id="Example_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Monitoring using geyser data (all default options).</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">close all
Y=load('geyser2.txt');
% alpha and restriction factor are not specified therefore for alpha
% vector [0.10 0.05 0] is used while for the restriction factor, value c=12
% is used
k=3;
[out]=tclusteda(Y,k);</pre></div></div><a href='http://rosa.unipr.it/fsda/tclusteda.html#Example_1'><img vspace="5" hspace="5" src="images\tclusteda_01.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website). Graphical output could not be included in the installation file because toolboxes cannot be greater than 20MB. To load locally the image files, download zip file http://rosa.unipr.it/fsda/images.zip and unzip it to <tt>(docroot)/FSDA/images</tt> or simply run routine <tt>downloadGraphicalOutput.m</tt>"> <img vspace="5" hspace="5" src="images\tclusteda_02.png" alt=""> </a></p></div></div><div id="example_2" class="example_module expandableContent"><div id="Example_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>Monitoring using geyser data with alpha and c specified.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">Y=load('geyser2.txt');
close all
% alphavec= vector which contains the trimming levels to consider
alphavec=0.10:-0.01:0;
% c = restriction factor to use
c=100;
% k= number of groups
k=3;
[out]=tclusteda(Y,k,alphavec,c);</pre></div></div></p></div></div><div id="example_3" class="example_module expandableContent"><div id="Example_3"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Monitoring using geyser data with option plots supplied as structure.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">Y=load('geyser2.txt');
close all
% alphavec= vector which contains the trimming levels to consider
% in this case 31 values of alpha are considered
alphavec=0.30:-0.01:0;
% c = restriction factor to use
c=100;
% k= number of groups
k=3;
% The monitoring plot of allocation will shows just these four values of
% alpha
plots=struct;
plots.alphasel=[0.2 0.10 0.05 0.01];
[out]=tclusteda(Y,k,alphavec,c,'plots',plots);</pre></div></div><pre class="codeoutput">ClaLik with untrimmed units selected using crisp criterion
100%[===================================================]
</pre><a href='http://rosa.unipr.it/fsda/tclusteda.html#Example_3'><img vspace="5" hspace="5" src="images\tclusteda_03.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website). Graphical output could not be included in the installation file because toolboxes cannot be greater than 20MB. To load locally the image files, download zip file http://rosa.unipr.it/fsda/images.zip and unzip it to <tt>(docroot)/FSDA/images</tt> or simply run routine <tt>downloadGraphicalOutput.m</tt>"> <img vspace="5" hspace="5" src="images\tclusteda_04.png" alt=""> <img vspace="5" hspace="5" src="images\tclusteda_05.png" alt=""> </a></p></div></div></div><p> </p><div class="examples"><h2 id="ExtraExamples" class="bottom_ruled">Related Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="Extraexample_1" class="example_module expandableContent"><div id="ExtraExample_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Monitoring geyser data with option UnitsSameGroup.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">Y=load('geyser2.txt');
close all
% alphavec= vector which contains the trimming levels to consider
alphavec=0.30:-0.10:0;
% c = restriction factor to use
c=100;
% k= number of groups
k=3;
% Make sure that group containing unit 10 is in a group which is labelled
% group 1 and group containing unit 12 is in group which is labelled group 2
UnitsSameGroup=[10 12];
% Mixture model is used
mixt=2;
[out]=tclusteda(Y,k,alphavec,1000,'mixt',2,'UnitsSameGroup',UnitsSameGroup);</pre></div></div><pre class="codeoutput">MixLik with untrimmed units selected using h largest likelihood contributions
100%[===================================================]
</pre><a href='http://rosa.unipr.it/fsda/tclusteda.html#ExtraExample_1'><img vspace="5" hspace="5" src="images\tclusteda_06.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website)"> <img vspace="5" hspace="5" src="images\tclusteda_07.png" alt=""> </a></p></div></div><div id="Extraexample_2" class="example_module expandableContent"><div id="ExtraExample_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> tclusteda with M5 data.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">close all
Y=load('M5data.txt');
% alphavec= vector which contains the trimming levels to consider
alphavec=0.10:-0.02:0;
out=tclusteda(Y(:,1:2),3,alphavec,1000,'nsamp',1000,'plots',1);</pre></div></div><pre class="codeoutput">ClaLik with untrimmed units selected using crisp criterion
100%[===================================================]
</pre><a href='http://rosa.unipr.it/fsda/tclusteda.html#ExtraExample_2'><img vspace="5" hspace="5" src="images\tclusteda_08.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website)"> <img vspace="5" hspace="5" src="images\tclusteda_09.png" alt=""> </a></p></div></div><div id="Extraexample_3" class="example_module expandableContent"><div id="ExtraExample_3"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Structured noise data ex1.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">close all
Y=load('structurednoise.txt');
alphavec=0.20:-0.01:0;
out=tclusteda(Y,2,alphavec,100,'plots',1);</pre></div></div></p></div></div><div id="Extraexample_4" class="example_module expandableContent"><div id="ExtraExample_4"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Structured noise data ex2.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">close all
Y=load('structurednoise.txt');
alphavec=0.20:-0.01:0;
% just show the monitoring plot
plots=struct;
plots.name = {'monitor'};
out=tclusteda(Y,2,alphavec,100,'plots',plots);</pre></div></div></p></div></div><div id="Extraexample_5" class="example_module expandableContent"><div id="ExtraExample_5"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>mixture100 data.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">close all
Y=load('mixture100.txt');
% Traditional tclust
alphavec=0.20:-0.01:0;
% just show the allocation plot
plots=struct;
plots.name = {'gscatter'};
out=tclusteda(Y,2,alphavec,100,'plots',plots);</pre></div></div></p></div></div><div id="Extraexample_6" class="example_module expandableContent"><div id="ExtraExample_6"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> tclusteda using simulated data.</li></span></a></span></h3><div class="collapse"><p>
     5 groups and 5 variables<div class="programlisting"><div class="codeinput"><pre class="matlab-code">rng(100,'twister')
n1=100;
n2=80;
n3=50;
n4=80;
n5=70;
v=5;
Y1=randn(n1,v)+5;
Y2=randn(n2,v)+3;
Y3=rand(n3,v)-2;
Y4=rand(n4,v)+2;
Y5=rand(n5,v);
group=ones(n1+n2+n3+n4+n5,1);
group(n1+1:n1+n2)=2;
group(n1+n2+1:n1+n2+n3)=3;
group(n1+n2+n3+1:n1+n2+n3+n4)=4;
group(n1+n2+n3+n4+1:n1+n2+n3+n4+n5)=5;
close all
Y=[Y1;Y2;Y3;Y4;Y5];
n=size(Y,1);
% Set number of groups
k=5;
% Example of the subsets precalculated
nsamp=2000;
nsampscalar=nsamp;
nsamp=subsets(nsamp,n,(v+1)*k);
% Random numbers to compute proportions computed once and for all
RandNumbForNini=rand(k,nsampscalar);
% The allocation is shown on the space of the first two principal
% components
out=tclusteda(Y,k,[],6,'plots',1,'RandNumbForNini',RandNumbForNini,'nsamp',nsamp);</pre></div></div><pre class="codeoutput">ClaLik with untrimmed units selected using crisp criterion
100%[===================================================]
</pre><a href='http://rosa.unipr.it/fsda/tclusteda.html#ExtraExample_6'><img vspace="5" hspace="5" src="images\tclusteda_10.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website)"> <img vspace="5" hspace="5" src="images\tclusteda_11.png" alt=""> </a></p></div></div><div id="Extraexample_7" class="example_module expandableContent"><div id="ExtraExample_7"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>tclusteda using determinant constraint.</li></span></a></span></h3><div class="collapse"><p>
     Search for spherical clusters.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">cshape=1
out=tclusteda(Y,k,[],1000,'plots',1,'restrtype','deter','cshape',cshape);</pre></div></div></p></div></div><div id="Extraexample_8" class="example_module expandableContent"><div id="ExtraExample_8"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>An example of use of plots as a structure with field ylimy.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">load('swiss_banknotes');
Y=swiss_banknotes.data;
[n,v]=size(Y);
alphavec=0.15:-0.01:0;
% alphavec=0.12:-0.005:0;
% c = restriction factor to use
c=100;
% k= number of groups
k=2;
% restriction on the determinants is imposed
restrtype='deter';
% Specify lower and upper limits for the monitoring plot
plots=struct;
% ylimits for monitoring of ARI index
ylimARI=[0.95 1];
% ylimits for change in centroids
ylimCENT=[0 0.02];
% ylimits for change in cov matrices
ylimCOV=[0 0.01];
ylimy=[ylimARI;ylimCENT;ylimCOV];
plots.ylimy=ylimy;
[outDet]=tclusteda(Y,k,alphavec,c,'restrtype',restrtype,'plots',plots,'nsamp',10000);</pre></div></div></p></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="Inputs">Input Arguments</h2><div class="expandableContent"><div class="arguments"><div class="input_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"> <div id="inputarg_Y" class="clearfix"> </div> <h3 id="input_argument_Y" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>Y</code> &#8212; Input data. </span>  </a><span class="example_desc">Matrix.</span></span></h3> <div class="collapse"> <p><p>Data matrix containing n observations on v variables.</p> <p>
               Rows of Y represent observations, and columns
               represent variables.</p><p>
               Missing values (NaN's) and infinite values (Inf's) are allowed,
               since observations (rows) with missing or infinite values will
               automatically be excluded from the computations.</p></p> <p class="datatypelist"><strong> Data Types: </strong><code>single| double</code></p> </div> </div><div class="expandableContent"> <div id="inputarg_k" class="clearfix"> </div> <h3 id="input_argument_k" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>k</code> &#8212; Number of groups. </span>  </a><span class="example_desc">Scalar.</span></span></h3> <div class="collapse"> <p>Scalar which specifies the number of groups.</p> <p class="datatypelist"><strong> Data Types: </strong><code>single| double</code></p> </div> </div><div class="expandableContent"> <div id="inputarg_alpha" class="clearfix"> </div> <h3 id="input_argument_alpha" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>alpha</code> &#8212; trimming level to monitor. </span>  </a><span class="example_desc">Vector.</span></span></h3> <div class="collapse"> <p><p>Vector which specifies the
               values of trimming levels which have to be considered.</p> <p>
               alpha is a vector which contains decresing elements which
               lie in the interval 0 and 0.5.</p> <p>
               For example is alpha=[0.1 0.05 0] tclusteda considers these 3
               values of trimming level.</p><p>
               If alpha=0 tclusteda reduces to traditional model
               based or mixture clustering (mclust): see Matlab function
               gmdistribution. The default for alpha is vector [0.1 0.05
               0]. The sequence is forced to be monotonically decreasing.</p></p> <p class="datatypelist"><strong> Data Types: </strong><code>single| double</code></p> </div> </div><div class="expandableContent"> <div id="inputarg_restrfactor" class="clearfix"> </div> <h3 id="input_argument_restrfactor" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>restrfactor</code> &#8212; Restriction factor. </span>  </a><span class="example_desc">Scalar.</span></span></h3> <div class="collapse"> <p>Positive scalar which
               constrains the allowed differences
               among group scatters. Larger values imply larger differences of
               group scatters. On the other hand a value of 1 specifies the
               strongest restriction forcing all eigenvalues/determinants
               to be equal and so the method looks for similarly scattered
               (respectively spherical) clusters. The default is to apply
               restrfactor to eigenvalues. In order to apply restrfactor
               to determinants it is is necessary to use optional input
               argument cshape.</p> <p class="datatypelist"><strong> Data Types: </strong><code>single| double</code></p> </div> </div><div id="namevaluepairarguments" class="clearfix"></div><h3 id="NameValuePairs" class="bottom_ruled">Name-Value Pair Arguments</h3><div class="namevaluecontainer"><p>Specify optional comma-separated pairs of <code>Name,Value</code> arguments. <code>Name</code> is the argument name and <code>Value</code> is the corresponding value. <code>Name</code> must appear  inside single quotes (<code>' '</code>).  You can specify several name and value pair arguments in any order as <code>  Name1,Value1,...,NameN,ValueN</code>.</p>  <span class="example_desc"><strong>Example:</strong><code><code> 'nsamp',1000
</code>,<code> 'refsteps',10
</code>,<code> 'reftol',1e-05
</code>,<code> 'equalweights',true
</code>,<code> 'mixt',1
</code>,<code> 'plots', 1
</code>,<code> 'msg',1
</code>,<code> 'nocheck',1
</code>,<code> 'startv1',1
</code>,<code> 'RandNumbForNini',''
</code>,<code> 'restrtype','deter'
</code>,<code> 'cshape',10
</code>,<code> 'UnitsSameGroup',[20 34]
</code>,<code> 'numpool',4
</code>,<code> 'cleanpool',true
</code></code></span></div><div class="expandableContent"><div id="inputarg_nsamp" class="clearfix"></div><h3 id="input_argument_namevalue_nsamp" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>nsamp</code> &#8212;Number of subsamples to extract.</span></a><span class="example_desc">scalar | matrix.</span></span></h3><div class="collapse">	<p><p>If nsamp is a scalar it contains the number of subsamples
               which will be extracted. If nsamp=0
               all subsets will be extracted.</p> <p>
               Remark - if the number of all possible subset is &lt;300 the
               default is to extract all subsets, otherwise just 300
               If nsamp is a matrix it contains in the rows the indexes of
               the subsets which have to be extracted. nsamp in this case
               can be conveniently generated  by function subsets. nsamp can
               have k columns or k*(v+1) columns. If nsamp has k columns
               the k initial centroids each iteration i are given by
               X(nsamp(i,:),:) and the covariance matrices are equal to the
               identity.</p> <p>
               If nsamp has k*(v+1) columns the initial centroids and covariance
               matrices in iteration i are computed as follows:</p> <p>
               X1=X(nsamp(i,:),:);</p> <p>
               mean(X1(1:v+1,:)) contains the initial centroid for group  1;</p> <p>
               cov(X1(1:v+1,:)) contains the initial cov matrix for group 1;</p> <p>
               mean(X1(v+2:2*v+2,:)) contains the initial centroid for group 2;</p> <p>
               cov((v+2:2*v+2,:)) contains the initial cov matrix for group 2;</p> <p>
               ...;</p> <p>
               mean(X1((k-1)*v+1:k*(v+1))) contains the initial centroids for group k;</p> <p>
               cov(X1((k-1)*v+1:k*(v+1))) contains the initial cov matrix for group k.</p> <p>
               REMARK - if nsamp is not a scalar option option below
               startv1 is ignored. More precisely, if nsamp has k columns
               startv1=0 elseif nsamp has k*(v+1) columns option startv1
               =1.</p><p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'nsamp',1000
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_refsteps" class="clearfix"></div><h3 id="input_argument_namevalue_refsteps" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>refsteps</code> &#8212;Number of refining iterations.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>Number of refining
               iterations in each subsample. Default is 15.</p> <p>
               refsteps = 0 means "raw-subsampling" without iterations.</p><p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'refsteps',10
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>single | double</code></p></div></div><div class="expandableContent"><div id="inputarg_reftol" class="clearfix"></div><h3 id="input_argument_namevalue_reftol" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>reftol</code> &#8212;Tolerance for the refining steps.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>The default value is 1e-14;</p> <p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'reftol',1e-05
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>single | double</code></p></div></div><div class="expandableContent"><div id="inputarg_equalweights" class="clearfix"></div><h3 id="input_argument_namevalue_equalweights" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>equalweights</code> &#8212;Cluster weights in the concentration and assignment steps.</span></a><span class="example_desc">logical.</span></span></h3><div class="collapse">	<p><p>A logical value specifying whether cluster weights
               shall be considered in the concentration, assignment steps
               and computation of the likelihood.</p> <p>
               if equalweights = true we are (ideally) assuming equally
               sized groups by maximizing:</p><p>

                 </p>\[
                 \sum_{j=1}^k \sum_{ x_i \in group_j } \log f(x_i; m_j , S_j)
                 \]<p>

               else if equalweights = false (default) we allow for
               different group weights by maximizing:</p> <p>

                 </p>\[
                     \sum_{j=1}^k  \sum_{ x_i \in group_j }  \log \left[ \frac{n_j}{n}  f(x_i; m_j , S_j) \right]=
                 \]
                 \[
                   = \sum_{j=1}^k n_j \log n_j/n + \sum_{j=1}^k \sum_{ x_i \in group_j} \log f(x_i; m_j , S_j) .
                 \]

               Remark: $\sum_{j=1}^k n_j \log n_j/n$ is the so called entropy
               term
                 </p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'equalweights',true
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>Logical</code></p></div></div><div class="expandableContent"><div id="inputarg_mixt" class="clearfix"></div><h3 id="input_argument_namevalue_mixt" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>mixt</code> &#8212;Mixture modelling or crisp assignment.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>Option mixt specifies whether mixture modelling or crisp
               assignment approach to model based clustering must be used.</p> <p>
               In the case of mixture modelling parameter mixt also
               controls which is the criterion to find the untrimmed units
               in each step of the maximization.</p> <p>
               If mixt &gt;=1 mixture modelling is assumed else crisp
               assignment. The default value is mixt=0 (i.e. crisp assignment).</p> <p>
               In mixture modelling the likelihood is given by:</p><p>
                </p>\[
                \prod_{i=1}^n  \sum_{j=1}^k \pi_j \phi (y_i; \; \theta_j),
                \]<p>
               while in crisp assignment the likelihood is given by:</p> <p>
               </p>\[
               \prod_{j=1}^k   \prod _{i\in R_j} \phi (y_i; \; \theta_j),
               \]<p>
               where $R_j$ contains the indexes of the observations which
               are assigned to group $j$.</p> <p>
               Remark - if mixt&gt;=1 previous parameter equalweights is
               automatically set to 1.</p> <p>
               Parameter mixt also controls the criterion to select the
               units to trim,
               if mixt = 2 the h units are those which give the largest
               contribution to the likelihood that is the h largest
               values of:</p><p>
               </p>\[
                   \sum_{j=1}^k \pi_j \phi (y_i; \; \theta_j)   \qquad
                    i=1, 2, ..., n,
               \]<p>
               else if mixt=1 the criterion to select the h units is
               exactly the same as the one which is used in crisp
               assignment. That is: the n units are allocated to a
               cluster according to criterion:</p> <p>
               </p>\[
                \max_{j=1, \ldots, k} \hat \pi'_j \phi (y_i; \; \hat \theta_j)
               \]<p>
               and then these n numbers are ordered and the units
               associated with the largest h numbers are untrimmed.</p> <p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'mixt',1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>single | double</code></p></div></div><div class="expandableContent"><div id="inputarg_plots" class="clearfix"></div><h3 id="input_argument_namevalue_plots" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>plots</code> &#8212;Plot on the screen.</span></a><span class="example_desc">scalar structure.</span></span></h3><div class="collapse">	<p><p>Case 1: plots option used as scalar.</p> <p>
               - If plots=0,  plots are not generated.</p> <p>
               - If plots=1 (default), two plots are shown on the screen.</p> <p>
                 The first plot ("monitor plot") shows three panels
                 monitoring between two consecutive values of alpha the
                 change in classification using ARI index (top panel), the
                 change in centroids using squared euclidean distances
                 (central panel), the change in covariance matrices using
                 squared euclidean distance (bottom panel).</p> <p>
                 The second plot ("gscatter plot") shows a series of
                 subplots which monitor the classification for each value
                 of alpha. In order to make sure that consistent labels
                 are used for the groups, between two consecutive values
                 of alpha, we assign label r to a group if this group
                 shows the smallest distance with group r for the previous
                 value of alpha. The type of plot which is used to monitor
                 the stability of the classification depends on the value
                 of v.</p> <p>
                   * for v=1, we use histograms of the univariate data
                   (function histFS is called).</p> <p>
                   * for v=2, we use the scatter plot of the two
                   variables (function gscatter is called).</p> <p>
                   * for v&gt;2, we use the scatter plot of the first two
                   principal components (function gscatter is called and
                   we show on the axes titles the percentage of variance
                   explained by the first two principal components).</p> <p>

               Case 2: plots option used as struct.</p> <p>
                 If plots is a structure it may contain the following fields:</p><p>
         </p><table border="2" cellpadding="4" cellspacing="0" class="body"><colgroup><col width="20%"><col width="80%"></colgroup><thead><tr valign="top"><th valign="top">Value</th><th valign="top">Description</th></tr></thead><tr valign="top"><td><code>name</code></td><td><p>cell array of strings which enables to
                   specify which plot to display. plots.name = {'gscatter'}
                   produces a figure with a series of subplots which show the
                   classification for each value of alpha. plots.name = {'monitor'}
                   shows a figure with 3 panels which monitor between two
                   consecutive values of alpha the change in classification
                   using ARI index (top panel), the change in centroids
                   using squared euclidean distances (central panel), the
                   change in covariance matrices using squared euclidean
                   distance (bottom panel). If this field is
                   not specified plots.name={'gscatter' 'monitor'} and
                   both figures will be shown.</p></td></tr><tr valign="top"><td><code>alphasel</code></td><td><p><p>numeric vector which speciies for which
                   values of alpha it is possible to see the classification.</p> <p>
                   For example if plots.alphasel =[ 0.05 0.02], the
                   classification will be shown just for alpha=0.05 and
                   alpha=0.02; If this field is
                   not specified plots.alphasel=alpha and therefore the
                   classification is shown for each value of alpha.</p></p></td></tr><tr valign="top"><td><code>ylimy</code></td><td><p>2D array of size 3-by 2 which specifies the
                   lower and upper limits for the monitoring plots. The
                   first row refers the ARI index (top panel), the second
                   row refers to the the change in centroids using squared
                   euclidean distances (central panel), the third row is
                   associated with the change in covariance matrices using
                   squared euclidean distance (bottom panel).</p></td></tr></table></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'plots', 1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>single | double | struct</code></p></div></div><div class="expandableContent"><div id="inputarg_msg" class="clearfix"></div><h3 id="input_argument_namevalue_msg" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>msg</code> &#8212;Level of output to display.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>Scalar which controls whether to display or not messages
               on the screen.</p> <p>
               If msg=0 nothing is displayed on the screen.</p> <p>
               If msg=1 (default) messages are displayed
               on the screen about estimated time to compute the estimator
               or the number of subsets in which there was no convergence.</p> <p>
               If msg=2 detailed messages are displayed. For example the
               information at iteration level.</p><p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'msg',1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>single | double</code></p></div></div><div class="expandableContent"><div id="inputarg_nocheck" class="clearfix"></div><h3 id="input_argument_namevalue_nocheck" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>nocheck</code> &#8212;Check input arguments.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>If nocheck is equal to 1 no check is performed on
               matrix Y.</p> <p>
               As default nocheck=0.</p><p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'nocheck',1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>single | double</code></p></div></div><div class="expandableContent"><div id="inputarg_startv1" class="clearfix"></div><h3 id="input_argument_namevalue_startv1" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>startv1</code> &#8212;How to initialize centroids and covariance matrices.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>If startv1 is 1 then initial centroids and covariance
               matrices are based on (v+1) observations randomly chosen,
               else each centroid is initialized taking a random row of
               input data matrix and covariance matrices are initialized
               with identity matrices. The default value of startv1 is 1.</p> <p>
               Remark 1 - in order to start with a routine which is in the
               required parameter space, eigenvalue restrictions are
               immediately applied.</p> <p>
               Remark 2 - option startv1 is used just if nsamp is a scalar
               (see for more details the help associated with nsamp).</p><p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'startv1',1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>single | double</code></p></div></div><div class="expandableContent"><div id="inputarg_RandNumbForNini" class="clearfix"></div><h3 id="input_argument_namevalue_RandNumbForNini" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>RandNumbForNini</code> &#8212;Pre-extracted random numbers to initialize proportions.</span></a><span class="example_desc">matrix.</span></span></h3><div class="collapse">	<p><p>Matrix with size k-by-size(nsamp,1) containing the
                random numbers which are used to initialize the
                proportions of the groups. This option is effective just
                if nsamp is a matrix which contains pre-extracted
                subsamples. The purpose of this option is to enable to
                user to replicate the results in case routine tclust is
                called using a parfor instruction (as it happens for
                example in routine tclustIC, where tclust is called through a
                parfor for different values of the restriction factor).</p> <p>
                The default value of RandNumbForNini is empty that is
                random numbers from uniform are used.</p><p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'RandNumbForNini',''
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>single | double</code></p></div></div><div class="expandableContent"><div id="inputarg_restrtype" class="clearfix"></div><h3 id="input_argument_namevalue_restrtype" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>restrtype</code> &#8212;type of restriction.</span></a><span class="example_desc">character.</span></span></h3><div class="collapse">	<p><p>The type of restriction to
               be applied on the cluster scatter
               matrices. Valid values are 'eigen' (default), or 'deter'.</p> <p>
               eigen implies restriction on the eigenvalues while deter
               implies restriction on the determinants.</p><p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'restrtype','deter'
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>char</code></p></div></div><div class="expandableContent"><div id="inputarg_cshape" class="clearfix"></div><h3 id="input_argument_namevalue_cshape" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>cshape</code> &#8212;constraint to apply to each of the shape matrices.</span></a><span class="example_desc">scalar greater | equal than 1.</span></span></h3><div class="collapse">	<p><p>This options only works is 'restrtype' is
                   'deter'.</p> <p>
               When restrtype is deter the default value of the "shape" constraint (as
               defined below) applied to each group is fixed to
               $c_{shape}=10^{10}$, to ensure the procedure is (virtually)
               affine equivariant. In other words, the decomposition or the
               $j$-th scatter matrix $\Sigma_j$ is
               </p>\[
               \Sigma_j=\lambda_j^{1/v} \Omega_j \Gamma_j \Omega_j'
               \]<p>
               where $\Omega_j$ is an orthogonal matrix of eigenvectors, $\Gamma_j$ is a
               diagonal matrix with $|\Gamma_j|=1$ and with elements
               $\{\gamma_{j1},...,\gamma_{jv}\}$ in its diagonal (proportional to
               the eigenvalues of the $\Sigma_j$ matrix) and
               $|\Sigma_j|=\lambda_j$. The $\Gamma_j$ matrices are commonly
               known as "shape" matrices, because they determine the shape of the
               fitted cluster components. The following $k$
               constraints are then imposed on the shape matrices:</p> <p>
               </p>\[
               \frac{\max_{l=1,...,v} \gamma_{jl}}{\min_{l=1,...,v} \gamma_{jl}}\leq
                   c_{shape}, \text{ for } j=1,...,k,
               \]<p>
               In particular, if we are ideally searching for spherical
               clusters it is necessary to set  $c_{shape}=1$. Models with
               variable volume and spherical clusters are handled with
               'restrtype' 'deter', $1&lt;restrfactor&lt;\infty$ and $cshape=1$.</p> <p>
               The $restrfactor=cshape=1$ case yields a very constrained
               parametrization because it implies spherical clusters with
               equal volumes.</p><p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'cshape',10
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>single | double</code></p></div></div><div class="expandableContent"><div id="inputarg_UnitsSameGroup" class="clearfix"></div><h3 id="input_argument_namevalue_UnitsSameGroup" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>UnitsSameGroup</code> &#8212;list of the units which must (whenever possible)
                   have a particular label.</span></a><span class="example_desc">numeric vector.</span></span></h3><div class="collapse">	<p><p>For example if
                   UnitsSameGroup=[20 26], means that group which contains
                   unit 20 is always labelled with number 1. Similarly,
                   the group which contains unit 26 is always labelled
                   with number 2, (unless it is found that unit 26 already
                   belongs to group 1). In general, group which contains
                   unit UnitsSameGroup(r) where r=2, ...length(kk)-1 is
                   labelled with number r (unless it is found that unit
                   UnitsSameGroup(r) has already been assigned to groups
                   1, 2, ..., r-1).</p> <p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'UnitsSameGroup',[20 34]
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code> integer vector</code></p></div></div><div class="expandableContent"><div id="inputarg_numpool" class="clearfix"></div><h3 id="input_argument_namevalue_numpool" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>numpool</code> &#8212;The number of parallel sessions to open.</span></a><span class="example_desc">integer.</span></span></h3><div class="collapse">	<p><p>If
                   numpool is not defined, then it is set equal to the
                   number of physical cores in the computer.</p> <p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'numpool',4
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code> integer vector</code></p></div></div><div class="expandableContent"><div id="inputarg_cleanpool" class="clearfix"></div><h3 id="input_argument_namevalue_cleanpool" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>cleanpool</code> &#8212;Function name.</span></a><span class="example_desc">scalar {0,1}.</span></span></h3><div class="collapse">	<p><p>Indicated if the open pool
                   must be closed or not. It is useful to leave it open if
                   there are subsequent parallel sessions to execute, so
                   that to save the time required to open a new pool.</p> <p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'cleanpool',true
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>integer | logical</code></p></div></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="OutputArgs" >Output Arguments</h2><div class="expandableContent"><div class="arguments"><div class="output_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"><div id="outputarg_out" class="clearfix"></div><h3 id="output_argument_out" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>out</code> &#8212; description</span></a><span class="example_desc">Structure</span></span></h3><div class="collapse"><p>Structure which contains the following fields

    <table border="2" cellpadding="4" cellspacing="0" class="body"><colgroup><col width="20%"><col width="80%"></colgroup><thead><tr valign="top"><th valign="top">Value</th><th valign="top">Description</th></tr></thead><tr valign="top"><td><code>IDX</code></td><td><p>n-by-length(alpha) vector containing assignment of each unit to
                       each of the k groups. Cluster names are integer
                       numbers from 1 to k. 0 indicates trimmed
                       observations. First column refers of out.IDX refers
                       to alpha(1), second column of out.IDX refers to
                       alpha(2), ..., last column refers to alpha(end).</p></td></tr><tr valign="top"><td><code>MU</code></td><td><p>3D array of size k-by-v-by-length(alpha) containing
                       the monitoring of the centroid for each value of
                       alpha. out.MU(:,:,1), refers to alpha(1) ...,
                       out.MU(:,:,end) refers to alpha(end). First row in
                       each slice refers to group 1, second row refers to
                       group 2 ...</p></td></tr><tr valign="top"><td><code>SIGMA</code></td><td><p>cell of length length(alpha) containing in element
                       j, with j=1, 2, ...,  length(alpha), the 3D array
                       of size v-by-v-k containing the k (constrained)
                       estimated covariance matrices associated with
                       alpha(j).</p></td></tr><tr valign="top"><td><code>Amon</code></td><td><p><p>Amon stands for alpha monitoring. Matrix of size
                      (length(alpha)-1)-by-4 which contains for two
                       consecutive values of alpha the monitoring of three
                       quantities (change in classification, change in
                       centroid location, change in covariance location).</p> <p>
                       1st col = value of alpha.</p> <p>
                       2nd col = ARI index.</p> <p>
                       3rd col = squared Euclidean distance between
                           centroids.</p><p>
                       4th col = squared Euclidean distance between
                           covariance matrices.</p></p></td></tr><tr valign="top"><td><code>Y</code></td><td><p>Original data matrix Y.</p></td></tr></table></p></div></div><div class="expandableContent"><div id="outputarg_varargout" class="clearfix"></div><h3 id="output_argument_varargout" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>varargout</code> &#8212;In jth
                     position the structure which comes out from procedure
                     tclust applied to alpha(j), with j =1, 2, .</span></a><span class="example_desc">outcell : cell of length length(alpha)</span></span></h3><div class="collapse"><p>..,
                     length(alpha).</p></div></div></div></div></div></div><div class="moreabout ref_sect"><h2 id="MoreAbout">More About</h2><div class="expandableContent"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent" itemprop="content"><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span>Additional Details</span></a></span></h3><div class="expand"><p><p>

 This procedure extends to tclust the so called monitoring
 approach. The phylosophy is to investigate how the results change as the
 trimming proportion alpha reduces. This function enables us to monitor
 the change in classification (measured by the ARI index) and the change
 in centroids and covariance matrices (measured by the squared euclidean
 distances). In order to make sure that consistent labels are used for the
 groups, between two consecutive values of alpha, we assign label r to a
 group if this group shows the smallest distance with group r for the
 previous value of alpha.</p> <p>

</p></p></div></div></div></div><div class="ref_sect" itemprop="content"><div class="bibliography"><h2 id="References">References</h2> <div><p><p>Garcia-Escudero, L.A., Gordaliza, A., Matran, C. and Mayo-Iscar, A. (2008),
   A General Trimming Approach to Robust Cluster Analysis. Annals
   of Statistics, Vol. 36, 1324-1345. [Technical Report available at:</p> <p>
   www.eio.uva.es/inves/grupos/representaciones/trTCLUST.pdf]</p></p></div></div></div><div class="ref_sect"><h2 id="SeeAlso">See Also</h2><p><span itemprop="seealso"><a href="tclust.html" itemprop="url"><span itemprop="name"><code>tclust</code></span></a></span> | <span itemprop="seealso"><a href="tclustIC.html" itemprop="url"><span itemprop="name"><code>tclustIC</code></span></a></span></div><i>This page has been automatically generated by our routine <a href="publishFS.html">publishFS</a></i></div></section></div></div></div></div><div id="divbottom"></div></body></html>