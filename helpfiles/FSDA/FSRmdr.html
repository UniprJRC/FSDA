<!DOCTYPE HTML> <html itemscope="" xmlns="http://www.w3.org/1999/xhtml"><head><title>FSRmdr</title><meta content="refpage" name="chunktype"><meta content="function:FSRmdr" itemprop="refentity" name="refentity"><meta content="text/javascript" http-equiv="Content-Script-Type"><meta content="fcn" itemprop="pagetype" name="toctype"><meta content="ref/function" itemprop="infotype" name="infotype" /><meta content="FSRmdr computes minimum deletion residual and other basic linear regression quantities in each step of the search." itemprop="description" name="description" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" /><script type="text/x-mathjax-config">MathJax.Hub.Config({extensions: ["tex2jax.js"],jax: ["input/TeX","output/HTML-CSS"],menuSettings: {zoom: "Double-Click", zscale: "300"},tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},MathMenu: {showRenderer: false},"HTML-CSS": {availableFonts: ["TeX"],preferredFont: "TeX",imageFont: null}});</script><script type="text/javascript" src="includesFS/Mathjax/MathJax.js"></script><script src="includesFS/matlab-highlighter.min.js"></script><link href="includesFS/matlab-highlighter.css" rel="stylesheet" type="text/css"><script type="text/javascript" src="includesFS/jquery-latest.js"></script><script>$(document).ready(function(){      $("#divtop").load("includesFS/top.html");      $("#divbottom").load("includesFS/bottom.html");});</script><link href="../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)"></link><link href="../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)"></link><link href="../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)"></link><link href="../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)"></link><link href="../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)"></link><link href="../includes/product/css/site6_offcanvas.css" rel="stylesheet" type="text/css"></link><script src="../includes/shared/scripts/l10n.js" type="text/javascript"></script><script src="../includes/product/scripts/docscripts.js"></script><script src="../includes/shared/scripts/docscripts_rn.js"></script><script src="../includes/shared/scripts/mw.imageanimation.js" type="text/javascript"></script><script src="../includes/shared/scripts/jquery.highlight.js"></script><script src="../includes/product/scripts/bootstrap.min.js" type="text/javascript"></script><script src="../includes/product/scripts/global.js"></script><script src="includesFS/bottom.js" type="text/javascript"></script><script src="../includes/product/scripts/underscore-min.js"></script><script src="../includes/shared/scripts/f1help.js" type="text/javascript"></script><script src="../includes/product/scripts/suggest.js" type="text/javascript"></script><script src="../includes/shared/scripts/helpservices.js" type="text/javascript"></script><script src="../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script><!-- the following line should be kept this way only --><link href="includesFS/doc_center.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css"><link href="../includes/product/css/doc_center_print.css" media="print" rel="stylesheet" type="text/css"></head><body  onload="highlightMATLABCode();" id="responsive_offcanvas">  <div id="doc_header_spacer" class="header"></div><div class="sticky_header_container includes_subnav"><div class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-xs-12 col-sm-6 col-sm-push-6 col-md-5 col-md-push-7" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2017a" data-language="en" action="../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="sr-only">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"><div class="input-group-btn"><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search pull-right icon_32 visible-xs" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="col-sm-6 col-sm-pull-6 col-md-7 col-md-pull-5" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../documentation-center.html">Documentation</a></h1></div></div></div><div class="visible-xs" id="search_actuator"><button class="btn icon-search btn_search pull-right icon_16" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div><!--END.CLASS row--> </div><!--END.CLASS container-fluid--> </div><!--END.CLASS section_header level_3--><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_actuator" data-toggle="offcanvas" data-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="sr-only">Toggle navigation</span><span class="icon-menu icon_24"></span></button><span class="offcanvas_actuator_label"></span><span class="offcanvas_actuator_close"></span> </div><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-md-12 hidden-xs hidden-sm"></div></div></div></div></div></div></div><!--END.CLASS sticky_header_container--><div class="row-offcanvas row-offcanvas-left"><div id="sidebar" class="sidebar-offcanvas" role="navigation"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" xmlns:atict="http://www.arbortext.com/namespace/atict"><li itemprop="breadcrumb" itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb"> <a href="../documentation-center.html" itemprop="url"> <span itemprop="title">All Products</span></a></li></ul><ul class="nav_disambiguation" xmlns:atict="http://www.arbortext.com/namespace/atict"><li class="product"><a href="index.html">Flexible Statistics and Data Analysis (FSDA)</a><div class="dropdown"> <span id="dropdownMenu1" class="icon-arrow-down icon_16" data-toggle="dropdown"> </span><ul aria-labelledby="dropdownMenu1" class="dropdown-menu dropdown-menu-right" role="menu"><li role="presentation"> <a href="examples.html" role="menuitem" tabindex="-1">Examples</a></li><li role="presentation"> <a href="function-alpha.html" role="menuitem" tabindex="-1"> Functions and Other Reference</a></li><li role="presentation"> <a href="release_notes.html?s_cid=doc_flyout" role="menuitem" tabindex="-1"> Release Notes</a></li><li role="presentation"> <a href="tutorials.html" role="menuitem" tabindex="-1"> Tutorials</a></li></ul></div></li></ul><ul xmlns:atict="http://www.arbortext.com/namespace/atict" class="nav_disambiguation"> <li><a href="index.html">Flexible Statistics and Data Analysis Toolbox</a> </li> <li><a href="function-cate.html" itemprop="url">Functions</a></li></ul><!-- --><ul class="nav_scrollspy nav" xmlns:atict="http://www.arbortext.com/namespace/atict">  <li class="nav_scrollspy_function"> <a href="#responsive_offcanvas">FSRmdr</a></li> <li id="SSPY810-refentry" class="nav_scrollspy_title">On this page</li><li><a class="intrnllnk" href="#syntax">Syntax</a></li><li><a class="intrnllnk" href="#Description">Description</a></li><li><a class="intrnllnk" href="#Examples">Examples</a><ul><li><a class="intrnllnk" href="#Example_1">FSRmdr with all default options.</a></li><li><a class="intrnllnk" href="#Example_2">FSRmdr with optional arguments.</a></li><li><a class="intrnllnk" href="#Example_3">Analyze units entering the search in the final steps.</a></li><li><a class="intrnllnk" href="#Example_4">Units forming subset in each step.</a></li><li><a class="intrnllnk" href="#Example_5">Monitor \( \hat  \beta \).</a></li><li><a class="intrnllnk" href="#Example_6">Monitor $s^2$.</a></li></ul></li><li><a class="intrnllnk" href="#ExtraExamples">Extra Examples</a><ul><li><a class="intrnllnk" href="#ExtraExample_1">Specify a regression model without intercept.</a></li><li><a class="intrnllnk" href="#ExtraExample_2">Example of the use of option nocheck.</a></li><li><a class="intrnllnk" href="#ExtraExample_3">Monitoring of s2, and the evolution of beta coefficients for the Hawkins dataset
    load('hawkins.</a></li><li><a class="intrnllnk" href="#ExtraExample_4">Store units forming subsets in selected steps.</a></li><li><a class="intrnllnk" href="#ExtraExample_5">Example of the use of option threshlevoutX.</a></li></ul></li><li><a class="intrnllnk" href="#Inputs">Input Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_y">y</a></li><li><a class="intrnllnk" href="#input_argument_X">X</a></li><li><a class="intrnllnk" href="#input_argument_bsb">bsb</a></li></ul></li><li><a class="intrnllnk" href="#NameValuePairs">Name-Value Pair Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_namevalue_init">init</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_intercept">intercept</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_plots">plots</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_nocheck">nocheck</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_msg">msg</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_constr">constr</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_bsbmfullrank">bsbmfullrank</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_bsbsteps">bsbsteps</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_threshlevoutX">threshlevoutX</a></li></ul></li><li><a class="intrnllnk" href="#OutputArgs">Output Arguments</a><ul><li><a class="intrnllnk" href="#output_argument_mdr">mdr</a></li><li><a class="intrnllnk" href="#output_argument_Un">Un</a></li><li><a class="intrnllnk" href="#output_argument_BB">BB</a></li><li><a class="intrnllnk" href="#output_argument_Bols">Bols</a></li><li><a class="intrnllnk" href="#output_argument_S2">S2</a></li></ul></li><li><a class="intrnllnk" href="#MoreAbout">More About</a></li><li><a class="intrnllnk" href="#References">References</a></li><li><a class="intrnllnk" href="#SeeAlso">See Also</a></li></ul></nav><script src="../includes/product/scripts/offcanvas.js"></script></div><div id="divtop"></div><div class="site_container site_toc_closed"><div class="page_container"><div class="content_frame"><div id="content_container" class="content_container"><section id="doc_center_content"><div class="function_ref"><div itemprop="content"><h1 itemprop="title">FSRmdr</h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose">FSRmdr computes minimum deletion residual and other basic linear regression quantities in each step of the search</p><div class="switch"><a id="expandAllPage" href="javascript:void(0);">expand all in page</a></div></div></div></div><div class="ref_sect"><h2 id="syntax">Syntax</h2><div class="syntax_signature"><div class="syntax_signature_module"><ul><li><code class="synopsis">mdr=FSRmdr(y,X,bsb)</code><span class="syntax_example"><a class="intrnllnk" href="FSRmdr.html#Example_1">example</a></span></li><li><code class="synopsis">mdr=FSRmdr(y,X,bsb,Name,Value)</code><span class="syntax_example"><a class="intrnllnk" href="FSRmdr.html#Example_2">example</a></span></li><li><code class="synopsis">[mdr,Un]=FSRmdr(___)</code><span class="syntax_example"><a class="intrnllnk" href="FSRmdr.html#Example_3">example</a></span></li><li><code class="synopsis">[mdr,Un,BB]=FSRmdr(___)</code><span class="syntax_example"><a class="intrnllnk" href="FSRmdr.html#Example_4">example</a></span></li><li><code class="synopsis">[mdr,Un,BB,Bols]=FSRmdr(___)</code><span class="syntax_example"><a class="intrnllnk" href="FSRmdr.html#Example_5">example</a></span></li><li><code class="synopsis">[mdr,Un,BB,Bols,S2]=FSRmdr(___)</code><span class="syntax_example"><a class="intrnllnk" href="FSRmdr.html#Example_6">example</a></span></li></ul></div></div></div>	<div class="ref_sect" itemprop="content">							<h2 id="Description">Description</h2>							<div class="descriptions">								<div class="description_module"><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="FSRmdr.html#Example_1">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_mdr"><code>mdr</code></a>=FSRmdr(<a class="intrnllnk" href="#inputarg_y"><code>y</code></a>,<a class="intrnllnk" href="#inputarg_X"><code>X</code></a>,<a class="intrnllnk" href="#inputarg_bsb"><code>bsb</code></a>)</code></span>FSRmdr with all default options.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="FSRmdr.html#Example_2">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_mdr"><code>mdr</code></a>=FSRmdr(<a class="intrnllnk" href="#inputarg_y"><code>y</code></a>,<a class="intrnllnk" href="#inputarg_X"><code>X</code></a>,<a class="intrnllnk" href="#inputarg_bsb"><code>bsb</code></a>,<a class="intrnllnk" href="#namevaluepairarguments"><code>Name, Value</code></a>)</code></span>FSRmdr with optional arguments.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="FSRmdr.html#Example_3">	example</a></p>	<p><span itemprop="syntax"><code>[<a class="intrnllnk" href="#outputarg_mdr"><code>mdr</code></a>,<a class="intrnllnk" href="#outputarg_Un"><code>Un</code></a>]=FSRmdr(___)</code></span>Analyze units entering the search in the final steps.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="FSRmdr.html#Example_4">	example</a></p>	<p><span itemprop="syntax"><code>[<a class="intrnllnk" href="#outputarg_mdr"><code>mdr</code></a>,<a class="intrnllnk" href="#outputarg_Un"><code>Un</code></a>,<a class="intrnllnk" href="#outputarg_BB"><code>BB</code></a>]=FSRmdr(___)</code></span>Units forming subset in each step.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="FSRmdr.html#Example_5">	example</a></p>	<p><span itemprop="syntax"><code>[<a class="intrnllnk" href="#outputarg_mdr"><code>mdr</code></a>,<a class="intrnllnk" href="#outputarg_Un"><code>Un</code></a>,<a class="intrnllnk" href="#outputarg_BB"><code>BB</code></a>,<a class="intrnllnk" href="#outputarg_Bols"><code>Bols</code></a>]=FSRmdr(___)</code></span>Monitor \( \hat  \beta \).</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="FSRmdr.html#Example_6">	example</a></p>	<p><span itemprop="syntax"><code>[<a class="intrnllnk" href="#outputarg_mdr"><code>mdr</code></a>,<a class="intrnllnk" href="#outputarg_Un"><code>Un</code></a>,<a class="intrnllnk" href="#outputarg_BB"><code>BB</code></a>,<a class="intrnllnk" href="#outputarg_Bols"><code>Bols</code></a>,<a class="intrnllnk" href="#outputarg_S2"><code>S2</code></a>]=FSRmdr(___)</code></span>Monitor $s^2$.</p></div>								</div>							</div>							<div class="clear">							</div>						</div><div class="ref_sect" itemprop="content"><div class="examples"><h2 id="Examples">Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="example_1" class="example_module expandableContent"><div id="Example_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>FSRmdr with all default options.</li></span></a></span></h3><div class="collapse"><p>
     Compute minimum deletion residual.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">% Monitor minimum deletion residual in each step of the forward search.
% Common part to all examples: load fishery dataset.
load('fishery');
y=fishery.data(:,2);
X=fishery.data(:,1);
% Find starting subset
[out]=LXS(y,X,'nsamp',10000);
[mdr] = FSRmdr(y,X,out.bs);
plot(mdr(:,1),mdr(:,2))
title('Monitoring of minimum deletion residual')</pre></div></div></p></div></div><div id="example_2" class="example_module expandableContent"><div id="Example_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>FSRmdr with optional arguments.</li></span></a></span></h3><div class="collapse"><p>
     Choose step to start monitoring.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">% Compute minimum deletion residual and start monitoring it from step
% 60.
load('fishery');
y=fishery.data(:,2);
X=fishery.data(:,1);
% Find starting subset
[out]=LXS(y,X,'nsamp',10000);
[mdr] = FSRmdr(y,X,out.bs,'init',60);</pre></div></div></p></div></div><div id="example_3" class="example_module expandableContent"><div id="Example_3"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>Analyze units entering the search in the final steps.</li></span></a></span></h3><div class="collapse"><p>
     Compute minimum deletion residual and analyze the units entering
     subset in each step of the fwd search (matrix Un).  As is well known,
     the FS provides an ordering of the data from those most in agreement
     with a suggested model (which enter the first steps) to those least in
     agreement with it (which are included in the final steps).<div class="programlisting"><div class="codeinput"><pre class="matlab-code">load('fishery');
y=fishery.data(:,2);
X=fishery.data(:,1);
% Find starting subset
[out]=LXS(y,X,'nsamp',10000);
[mdr,Un] = FSRmdr(y,X,out.bs);</pre></div></div></p></div></div><div id="example_4" class="example_module expandableContent"><div id="Example_4"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>Units forming subset in each step.</li></span></a></span></h3><div class="collapse"><p>
     Obtain detailed information about the units forming subset in each
     step of the forward search (matrix BB).<div class="programlisting"><div class="codeinput"><pre class="matlab-code">load('fishery');
y=fishery.data(:,2);
X=fishery.data(:,1);
% Find starting subset
[out]=LXS(y,X,'nsamp',10000);
[mdr,Un,BB] = FSRmdr(y,X,out.bs);</pre></div></div></p></div></div><div id="example_5" class="example_module expandableContent"><div id="Example_5"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>Monitor \( \hat  \beta \).</li></span></a></span></h3><div class="collapse"><p>
     Monitor how the estimates of beta coefficients changes as the subset
     size increases (matrix Bols).<div class="programlisting"><div class="codeinput"><pre class="matlab-code">load('fishery');
y=fishery.data(:,2);
X=fishery.data(:,1);
% Find starting subset
[out]=LXS(y,X,'nsamp',10000);
[mdr,Un,BB,Bols] = FSRmdr(y,X,out.bs);</pre></div></div></p></div></div><div id="example_6" class="example_module expandableContent"><div id="Example_6"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>Monitor $s^2$.</li></span></a></span></h3><div class="collapse"><p>
     Monitor the estimate of $\sigma^2$ in each step of the fwd search
     (matrix S2).<div class="programlisting"><div class="codeinput"><pre class="matlab-code">load('fishery');
y=fishery.data(:,2);
X=fishery.data(:,1);
% Find starting subset
[out]=LXS(y,X,'nsamp',10000);
[mdr,Un,BB,Bols,S2] = FSRmdr(y,X,out.bs);
plot(S2(:,1),S2(:,2))
title('Monitoring of s2')</pre></div></div></p></div></div></div><p> </p><div class="examples"><h2 id="ExtraExamples" class="bottom_ruled">Related Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="Extraexample_1" class="example_module expandableContent"><div id="ExtraExample_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Specify a regression model without intercept.</li></span></a></span></h3><div class="collapse"><p>
     FSRmdr using a regression model without intercept.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">load('fishery');
y=fishery.data(:,2);
X=fishery.data(:,1);
% Find starting subset
[out]=LXS(y,X,'nsamp',10000);
[mdr,Un,BB,Bols,S2] = FSRmdr(y,X,out.bs,'intercept','0');</pre></div></div></p></div></div><div id="Extraexample_2" class="example_module expandableContent"><div id="ExtraExample_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Example of the use of option nocheck.</li></span></a></span></h3><div class="collapse"><p>
    FSRmdr applied without doing any checks on y and X variables.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">load('fishery');
y=fishery.data(:,2);
X=fishery.data(:,1);
% Find starting subset
[out]=LXS(y,X,'nsamp',10000);
[mdr,Un,BB,Bols,S2] = FSRmdr(y,X,out.bs,'nocheck',1);</pre></div></div></p></div></div><div id="Extraexample_3" class="example_module expandableContent"><div id="ExtraExample_3"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Monitoring of s2, and the evolution of beta coefficients for the Hawkins dataset
    load('hawkins.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">load('hawkins.txt');
y=hawkins(:,9);
X=hawkins(:,1:8);
[out]=LXS(y,X,'nsamp',10000);
[~,~,~,Bols,S2] = FSRmdr(y,X,out.bs);
if isnan(S2)
disp('NoFullRank in initial subset, please rerun FSRmdr')
else
%The forward plot of s2 shows that initially the estimate is virtually
%zero. The four line segments comprising the plot correspond to the four
%groups of observations
% Plot of the monitoring of S2 and R2
figure;
subplot(1,2,1)
plot(S2(:,1),S2(:,2))
xlabel('Subset size m');
ylabel('S2');
subplot(1,2,2)
plot(S2(:,1),S2(:,3))
xlabel('Subset size m');
ylabel('R2');
%The forward plots of the estimates of the beta coefficients show that they are virtually constant until m = 86, after which they start fluctuating in different directions.
% Plots of the monitoring of "Estimates of beta coefficients"
figure;
for j=3:size(Bols,2)
subplot(2,4,j-2)
plot(Bols(:,1),Bols(:,j))
xlabel('Subset size m');
ylabel(['b' num2str(j-2)]);
end
end</pre></div></div><pre class="codeoutput">Total estimated time to complete LMS:  0.13 seconds 
</pre><a href='http://rosa.unipr.it/fsda/FSRmdr.html#ExtraExample_3'><img vspace="5" hspace="5" src="images\FSRmdr_01.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website)"> <img vspace="5" hspace="5" src="images\FSRmdr_02.png" alt=""> </a></p></div></div><div id="Extraexample_4" class="example_module expandableContent"><div id="ExtraExample_4"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Store units forming subsets in selected steps.</li></span></a></span></h3><div class="collapse"><p>
     In this example the units forming subset are stored just for
     selected steps.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">load('hawkins.txt');
y=hawkins(:,9);
X=hawkins(:,1:8);
rng('default')
rng(100)
[out]=LXS(y,X,'nsamp',10000);
[mdr,Un,BB,Bols,S2] = FSRmdr(y,X,out.bs,'bsbsteps',[30 60]);
if isnan(S2)
disp('NoFullRank in initial subset, please rerun FSRmdr')
else
% BB has just two columns
% First column contains information about units forming subset at step m=30
% sum(~isnan(BB(:,1))) is 30
% Second column contains information about units forming subset at step m=60
% sum(~isnan(BB(:,2))) is 60
disp(sum(~isnan(BB(:,1))))
disp(sum(~isnan(BB(:,2))))
end</pre></div></div><pre class="codeoutput">Total estimated time to complete LMS:  0.19 seconds 
    30

    60

</pre></p></div></div><div id="Extraexample_5" class="example_module expandableContent"><div id="ExtraExample_5"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Example of the use of option threshlevoutX.</li></span></a></span></h3><div class="collapse"><p>
     In this example a set of remote units is added to a cloud of points.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">% The purpose of this example is to show that in presence of units very far
% from the bulk of th data (bad or good elverage points) it is necessary to
% bound their effect putting a constraint on their leverage hi=xi'(X'X)xi
rng(10000)
n=100;
p=1;
X=randn(n,p);
epsil=10;
beta=ones(p,1);
y=X*beta+randn(n,1)*epsil;
% Add 10 very remote points
add=3;
Xadd=X(1:add,:)+5000;
yadd=y(1:add)+200;
Xall=[X;Xadd];
yall=[y;yadd];
outLXS=LXS(y,X);
bs=outLXS.bs;
subplot(2,1,1)
out1=FSRmdr(yall,Xall,bs,'plots',1);
xylim=axis;
ylabel('mdr')
title('Monitoring of mdr without bound on the leverage')
subplot(2,1,2)
out2=FSRmdr(yall,Xall,bs,'plots',1,'threshlevoutX',10);
ylim(xylim(3:4));
ylabel('mdr')
title('Monitoring of mdr with bound on the leverage')</pre></div></div><pre class="codeoutput">Total estimated time to complete LMS:  0.02 seconds 
</pre><a href='http://rosa.unipr.it/fsda/FSRmdr.html#ExtraExample_5'><img vspace="5" hspace="5" src="images\FSRmdr_03.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website)"> </a></p></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="Inputs">Input Arguments</h2><div class="expandableContent"><div class="arguments"><div class="input_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"> <div id="inputarg_y" class="clearfix"> </div> <h3 id="input_argument_y" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>y</code> &#8212; Response variable. </span>  </a><span class="example_desc">Vector.</span></span></h3> <div class="collapse"> <p><p>Response variable, specified as
               a vector of length n, where n is the number of
               observations. Each entry in y is the response for the
               corresponding row of X.</p> <p>
               Missing values (NaN's) and infinite values (Inf's) are
               allowed, since observations (rows) with missing or infinite
               values will automatically be excluded from the
               computations.</p></p> <p class="datatypelist"><strong> Data Types: </strong><code>single| double</code></p> </div> </div><div class="expandableContent"> <div id="inputarg_X" class="clearfix"> </div> <h3 id="input_argument_X" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>X</code> &#8212; Predictor variables. </span>  </a><span class="example_desc">Matrix.</span></span></h3> <div class="collapse"> <p><p>Matrix of explanatory
               variables (also called 'regressors') of dimension n x (p-1)
               where p denotes the number of explanatory variables
               including the intercept.</p> <p>
               Rows of X represent observations, and columns represent
               variables. By default, there is a constant term in the
               model, unless you explicitly remove it using input option
               intercept, so do not include a column of 1s in X. Missing
               values (NaN's) and infinite values (Inf's) are allowed,
               since observations (rows) with missing or infinite values
               will automatically be excluded from the computations.</p></p> <p class="datatypelist"><strong> Data Types: </strong><code>single| double</code></p> </div> </div><div class="expandableContent"> <div id="inputarg_bsb" class="clearfix"> </div> <h3 id="input_argument_bsb" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>bsb</code> &#8212; list of units forming the initial subset. </span>  </a><span class="example_desc">Vector.</span></span></h3> <div class="collapse"> <p>If bsb=0
               (default) then the procedure starts with p units randomly
               chosen else if bsb is not 0 the search will start with
               m0=length(bsb)</p> <p class="datatypelist"><strong> Data Types: </strong><code>single| double</code></p> </div> </div><div id="namevaluepairarguments" class="clearfix"></div><h3 id="NameValuePairs" class="bottom_ruled">Name-Value Pair Arguments</h3><div class="namevaluecontainer"><p>Specify optional comma-separated pairs of <code>Name,Value</code> arguments. <code>Name</code> is the argument name and <code>Value</code> is the corresponding value. <code>Name</code> must appear  inside single quotes (<code>' '</code>).  You can specify several name and value pair arguments in any order as <code>  Name1,Value1,...,NameN,ValueN</code>.</p>  <span class="example_desc"><strong>Example:</strong><code><code> 'init',100 starts monitoring from step m=100
</code>,<code> 'intercept',1
</code>,<code> 'plots',1
</code>,<code> 'nocheck',1
</code>,<code> 'msg',1
</code>,<code> 'bsbmfullrank',1
</code>,<code> 'threshlevoutX',5
</code></code></span></div><div class="expandableContent"><div id="inputarg_init" class="clearfix"></div><h3 id="input_argument_namevalue_init" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>init</code> &#8212;Search initialization.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>It specifies the point where to initialize the search and
               start monitoring required diagnostics. If it is not
               specified it is set equal to:</p> <p>
                   p+1, if the sample size is smaller than 40;</p> <p>
                   min(3*p+1,floor(0.5*(n+p+1))), otherwise.</p><p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'init',100 starts monitoring from step m=100
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_intercept" class="clearfix"></div><h3 id="input_argument_namevalue_intercept" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>intercept</code> &#8212;Indicator for constant term.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>If 1, a model with
               constant term will be fitted (default), else no constant
               term will be included.</p> <p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'intercept',1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_plots" class="clearfix"></div><h3 id="input_argument_namevalue_plots" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>plots</code> &#8212;Plot on the screen.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>If equal to one a plot of
               minimum deletion residual appears  on the screen with 1%,
               50% and 99% confidence bands else (default) no plot is
               shown.</p> <p>
                              Remark: the plot which is produced is very simple. In order
               to control a series of options in this plot and in order to
               connect it dynamically to the other forward plots it is
               necessary to use function mdrplot.</p><p>
</p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'plots',1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_nocheck" class="clearfix"></div><h3 id="input_argument_namevalue_nocheck" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>nocheck</code> &#8212;Check input arguments.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p>If nocheck is equal to 1 no check is performed on
               matrix y and matrix X. Notice that y and X are left
               unchanged. In other words the additioanl column of ones for
               the intercept is not added. As default nocheck=0. The
               controls on h, alpha and nsamp still remain
               </p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'nocheck',1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_msg" class="clearfix"></div><h3 id="input_argument_namevalue_msg" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>msg</code> &#8212;Level of output to display.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p>It controls whether to
               display or not messages about great interchange on the
               screen If msg==1 (default)
               messages are displayed on the screen
               else no message is displayed on the screen
               </p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'msg',1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_constr" class="clearfix"></div><h3 id="input_argument_namevalue_constr" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>constr</code> &#8212;Constrained search.</span></a><span class="example_desc">vector.</span></span></h3><div class="collapse">	<p>r x 1 vector which contains the list of units which are
               forced to join the search in the last r steps. The default
               is constr=''.  No constraint is imposed
               </p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'constr',[1:10] forces the first 10 units to join
</code>               the subset in the last 10 steps</p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_bsbmfullrank" class="clearfix"></div><h3 id="input_argument_namevalue_bsbmfullrank" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>bsbmfullrank</code> &#8212;What to do in case subset at step m (say bsbm) produces a
               non singular X.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>This options controls what to do when rank(X(bsbm,:)) is
               smaller then number of explanatory variables.</p> <p>
               If bsbmfullrank = 1 (default is 1) these units (whose number
               is say mnofullrank) are constrained to enter the search in
               the final n-mnofullrank steps else the search continues
               using as estimate of beta at step m the estimate of beta
               found in the previous step.</p><p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'bsbmfullrank',1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_bsbsteps" class="clearfix"></div><h3 id="input_argument_namevalue_bsbsteps" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>bsbsteps</code> &#8212;Save the units forming subsets.</span></a><span class="example_desc">vector.</span></span></h3><div class="collapse">	<p><p>It specifies for
               which steps of the fwd search it
               is necessary to save the units forming subsets. If bsbsteps
               is 0 we store the units forming subset in all steps. The
               default is store the units forming subset in all steps if
               n&lt;=5000, else to store the units forming subset at steps
               init and steps which are multiple of 100. For example, as
               default, if n=753 and init=6,
               units forming subset are stored for
               m=init, 100, 200, 300, 400, 500 and 600.</p> <p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'bsbsteps',[100 200] stores the unis forming
</code>               subset in steps 100 and 200.</p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_threshlevoutX" class="clearfix"></div><h3 id="input_argument_namevalue_threshlevoutX" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>threshlevoutX</code> &#8212;threshold for high leverage units.</span></a><span class="example_desc">scalar | empty value.</span></span></h3><div class="collapse">	<p><p>Threshold to bound the effect of high leverage units in the
               computation of deletion residuals. In the computation of
               the quantity $h_i(m^*) = x_i^T\{X(m^*)^TX(m^*)\}^{-1}x_i$,
               $i \notin S^{(m)}_*$, units which very far from the bulk of
               the data (represented by $X(m^*)$) will have a huge value
               of $h_i(m^*)$ and consequently of the deletion residuals.</p> <p>
               In order to tackle this problem it is possible to put a
               bound to the value of $h_i(m^*)$. For example
               threshlevoutX=r imposes the contrainst that $h_i(m^*)$
               cannot exceed $r \times p/m$. The default value of
               threshlevoutX is empty, which means that no threshold is
               imposed.</p><p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'threshlevoutX',5
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="OutputArgs" >Output Arguments</h2><div class="expandableContent"><div class="arguments"><div class="output_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"><div id="outputarg_mdr" class="clearfix"></div><h3 id="output_argument_mdr" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>mdr</code> &#8212;Monitoring of minimum
               deletion residual at each step of the forward search.</span></a><span class="example_desc"><code>n -init -by- 2 </code>matrix</span></span></h3><div class="collapse"><p><p>
               1st col = fwd search index (from init to n-1).</p> <p>
               2nd col = minimum deletion residual.</p><p>
               REMARK: if in a certain step of the search matrix is
               singular, this procedure checks how many observations
               produce a singular matrix. In this case mdr is a column
               vector which contains the list of units for which matrix X
               is non singular.</p></p></div></div><div class="expandableContent"><div id="outputarg_Un" class="clearfix"></div><h3 id="output_argument_Un" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>Un</code> &#8212;Units included in each step.</span></a><span class="example_desc"><code> </code>Matrix</span></span></h3><div class="collapse"><p><p>
               (n-init) x 11 Matrix which contains the unit(s) included
               in the subset at each step of the search.</p> <p>
               REMARK: in every step the new subset is compared with the
               old subset. Un contains the unit(s) present in the new
               subset but not in the old one.</p> <p>
               Un(1,2) for example contains the unit included in step
               init+1.</p><p>
               Un(end,2) contains the units included in the final step
               of the search.</p></p></div></div><div class="expandableContent"><div id="outputarg_BB" class="clearfix"></div><h3 id="output_argument_BB" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>BB</code> &#8212;Units belonging to subset in each step.</span></a><span class="example_desc"><code> </code>Matrix</span></span></h3><div class="collapse"><p><p>
               n x (n-init+1) or n-by-length(bsbsteps) matrix (depending on input
               option bsbsteps) which contains information about the units
               belonging to the subset at each step of the forward search.</p> <p>
               BB has the following structure
               1-st row has number 1 in correspondence of the steps in
                   which unit 1 is included inside subset and a missing
                   value for the other steps
               ......</p><p>
               (n-1)-th row has number n-1 in correspondence of the steps in
                   which unit n-1 is included inside subset and a missing
                   value for the other steps
               n-th row has number n in correspondence of the steps in
                   which unit n is included inside subset and a missing
                   value for the other steps
               The size of matrix BB is n x (n-init+1) if option input
               bsbsteps is 0 else the size is n-by-length(bsbsteps).</p></p></div></div><div class="expandableContent"><div id="outputarg_Bols" class="clearfix"></div><h3 id="output_argument_Bols" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>Bols</code> &#8212;OLS coefficents.</span></a><span class="example_desc"><code> </code>Matrix</span></span></h3><div class="collapse"><p>
               (n-init+1) x (p+1) matrix containing the monitoring of
               estimated beta coefficients in each step of the forward
               search.</p></div></div><div class="expandableContent"><div id="outputarg_S2" class="clearfix"></div><h3 id="output_argument_S2" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>S2</code> &#8212;S2 and R2.</span></a><span class="example_desc"><code> </code>Matrix</span></span></h3><div class="collapse"><p>
               (n-init+1) x 3 matrix containing the monitoring of S2 (2nd
               column)and R2 (third column) in each step of the forward
               search.</p></div></div></div></div></div></div><div class="moreabout ref_sect"><h2 id="MoreAbout">More About</h2><div class="expandableContent"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent" itemprop="content"><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span>Additional Details</span></a></span></h3><div class="expand"><p><p>
               Let $S^{(m)}_* \in \cal{M}$ be the  optimum subset of size $m$,
               for which the matrix of regressors is $X(m^*)$. Least squares
               applied to this subset yields parameter estimates
               $\hat{\beta}(m^*)$ and $s^2(m^*)$, the mean square estimate of
               $\sigma^2$ on $m-p$ degrees of freedom. Residuals can be
               calculated for all observations including those not in
               $S^{(m)}_*$. The $n$ resulting least squares residuals are
               \begin{equation}
                 e_i(m^*) =  y_i -x_i^T\hat{\beta}(m^*). \label{eq2.14a}
               \end{equation}
               The search moves forward
               with the subset $S^{(m+1)}_*$ consisting of the observations with
               the $m+1$ smallest absolute values of $e_i(m^*)$. When $m &lt; n$ the
               estimates of the parameters are based on only those observations
               giving the central $m$ residuals.</p> <p>
               To test for outliers the deletion residual is calculated for the
               $n-m$ observations not in $S^{(m)}_*$. These residuals are
               \begin{equation}
               r_i^*(m^*)  = \frac{y_{i} - x_{i}^T\hat{\beta}(m^*)} {
               \sqrt{s^2(m^*)\{1 + h_i(m^*)\}}}  = \frac{e_{i}(m^*)} {
               \sqrt{s^2(m^*)\{1 + h_i(m^*)\}}}, 
               \end{equation}
               where $h_i(m^*) = x_i^T\{X(m^*)^TX(m^*)\}^{-1}x_i$;  the leverage
               of each observation depends on $S^{(m)}_*$. Let the observation
               nearest to those constituting $S^{(m)}_*$ be
               $i_{\mbox{min}}$ where
               </p>\[
               i_{\mbox{min}} = \arg \min | r^*_i(m^*)| \; \mbox{for} \; i \notin S^{(m)}_*,
               \]<p>
               the observation with the minimum absolute deletion  residual among
               those not in $S^{(m)}_*$. This function computes
               $r_i^*(m^*)$ for $m^*=init, init+1, \ldots, n-1$.</p> <p>

</p></p></div></div></div></div><div class="ref_sect" itemprop="content"><div class="bibliography"><h2 id="References">References</h2> <div><p>Atkinson, A.C. and Riani, M. (2000), "Robust Diagnostic Regression
 Analysis", Springer Verlag, New York.</p></div><div><p>Atkinson, A.C. and Riani, M. (2006), Distribution theory and
 simulations for tests of outliers in regression, "Journal of
 Computational and Graphical Statistics", Vol. 15, pp. 460-476.</p></div><div><p>Riani, M. and Atkinson, A.C. (2007), Fast calibrations of the forward
 search for testing multiple outliers in regression, "Advances in Data
 Analysis and Classification", Vol. 1, pp. 123-141.</p></div></div></div><div class="ref_sect"><h2 id="SeeAlso">See Also</h2><p><span itemprop="seealso"><a href="FSR.html" itemprop="url"><span itemprop="name"><code>FSR</code></span></a></span> | <span itemprop="seealso"><a href="FSReda.html" itemprop="url"><span itemprop="name"><code>FSReda</code></span></a></span></div><i>This page has been automatically generated by our routine <a href="publishFS.html">publishFS</a></i></div></section></div></div></div></div><div id="divbottom"></div></body></html>