<!DOCTYPE HTML> <html itemscope="" xmlns="http://www.w3.org/1999/xhtml"><head><title>boxtest</title><meta content="refpage" name="chunktype"><meta content="function:boxtest" itemprop="refentity" name="refentity"><meta content="text/javascript" http-equiv="Content-Script-Type"><meta content="fcn" itemprop="pagetype" name="toctype"><meta content="ref/function" itemprop="infotype" name="infotype" /><meta content="boxtest performs Box test of equality of covariance matrices." itemprop="description" name="description" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" /><script type="text/x-mathjax-config">MathJax.Hub.Config({extensions: ["tex2jax.js"],jax: ["input/TeX","output/HTML-CSS"],menuSettings: {zoom: "Double-Click", zscale: "300"},tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},MathMenu: {showRenderer: false},"HTML-CSS": {availableFonts: ["TeX"],preferredFont: "TeX",imageFont: null}});</script><script type="text/javascript" src="includesFS/Mathjax/MathJax.js"></script><script src="includesFS/matlab-highlighter.min.js"></script><link href="includesFS/matlab-highlighter.css" rel="stylesheet" type="text/css"><script type="text/javascript" src="includesFS/jquery-latest.js"></script><script>$(document).ready(function(){      $("#divtop").load("includesFS/top.html");      $("#divbottom").load("includesFS/bottom.html");});</script><link href="../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)"></link><link href="../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)"></link><link href="../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)"></link><link href="../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)"></link><link href="../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)"></link><link href="../includes/product/css/site6_offcanvas.css" rel="stylesheet" type="text/css"></link><script src="../includes/shared/scripts/l10n.js" type="text/javascript"></script><script src="../includes/product/scripts/docscripts.js"></script><script src="../includes/shared/scripts/docscripts_rn.js"></script><script src="../includes/shared/scripts/mw.imageanimation.js" type="text/javascript"></script><script src="../includes/shared/scripts/jquery.highlight.js"></script><script src="../includes/product/scripts/bootstrap.min.js" type="text/javascript"></script><script src="../includes/product/scripts/global.js"></script><script src="includesFS/bottom.js" type="text/javascript"></script><script src="../includes/product/scripts/underscore-min.js"></script><script src="../includes/shared/scripts/f1help.js" type="text/javascript"></script><script src="../includes/product/scripts/suggest.js" type="text/javascript"></script><script src="../includes/shared/scripts/helpservices.js" type="text/javascript"></script><script src="../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script><!-- the following line should be kept this way only --><link href="includesFS/doc_center.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css"><link href="../includes/product/css/doc_center_print.css" media="print" rel="stylesheet" type="text/css"></head><body  onload="highlightMATLABCode();" id="responsive_offcanvas">  <div id="doc_header_spacer" class="header"></div><div class="sticky_header_container includes_subnav"><div class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-xs-12 col-sm-6 col-sm-push-6 col-md-5 col-md-push-7" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2017a" data-language="en" action="../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="sr-only">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"><div class="input-group-btn"><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search pull-right icon_32 visible-xs" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="col-sm-6 col-sm-pull-6 col-md-7 col-md-pull-5" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../documentation-center.html">Documentation</a></h1></div></div></div><div class="visible-xs" id="search_actuator"><button class="btn icon-search btn_search pull-right icon_16" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div><!--END.CLASS row--> </div><!--END.CLASS container-fluid--> </div><!--END.CLASS section_header level_3--><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_actuator" data-toggle="offcanvas" data-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="sr-only">Toggle navigation</span><span class="icon-menu icon_24"></span></button><span class="offcanvas_actuator_label"></span><span class="offcanvas_actuator_close"></span> </div><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-md-12 hidden-xs hidden-sm"></div></div></div></div></div></div></div><!--END.CLASS sticky_header_container--><div class="row-offcanvas row-offcanvas-left"><div id="sidebar" class="sidebar-offcanvas" role="navigation"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" xmlns:atict="http://www.arbortext.com/namespace/atict"><li itemprop="breadcrumb" itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb"> <a href="../documentation-center.html" itemprop="url"> <span itemprop="title">All Products</span></a></li></ul><ul class="nav_disambiguation" xmlns:atict="http://www.arbortext.com/namespace/atict"><li class="product"><a href="index.html">Flexible Statistics and Data Analysis (FSDA)</a><div class="dropdown"> <span id="dropdownMenu1" class="icon-arrow-down icon_16" data-toggle="dropdown"> </span><ul aria-labelledby="dropdownMenu1" class="dropdown-menu dropdown-menu-right" role="menu"><li role="presentation"> <a href="examples.html" role="menuitem" tabindex="-1">Examples</a></li><li role="presentation"> <a href="function-alpha.html" role="menuitem" tabindex="-1"> Functions and Other Reference</a></li><li role="presentation"> <a href="release_notes.html?s_cid=doc_flyout" role="menuitem" tabindex="-1"> Release Notes</a></li><li role="presentation"> <a href="tutorials.html" role="menuitem" tabindex="-1"> Tutorials</a></li></ul></div></li></ul><ul xmlns:atict="http://www.arbortext.com/namespace/atict" class="nav_disambiguation"> <li><a href="index.html">Flexible Statistics and Data Analysis Toolbox</a> </li> <li><a href="function-cate.html" itemprop="url">Functions</a></li></ul><!-- --><ul class="nav_scrollspy nav" xmlns:atict="http://www.arbortext.com/namespace/atict">  <li class="nav_scrollspy_function"> <a href="#responsive_offcanvas">boxtest</a></li> <li id="SSPY810-refentry" class="nav_scrollspy_title">On this page</li><li><a class="intrnllnk" href="#syntax">Syntax</a></li><li><a class="intrnllnk" href="#Description">Description</a></li><li><a class="intrnllnk" href="#Examples">Examples</a><ul><li><a class="intrnllnk" href="#Example_1">Box test for Iris data.</a></li><li><a class="intrnllnk" href="#Example_2">Box test for Iris data displaying results.</a></li></ul></li><li><a class="intrnllnk" href="#ExtraExamples">Extra Examples</a><ul><li><a class="intrnllnk" href="#ExtraExample_1">Box test for Iris with option Fapprox.</a></li></ul></li><li><a class="intrnllnk" href="#Inputs">Input Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_Y">Y</a></li><li><a class="intrnllnk" href="#input_argument_group">group</a></li></ul></li><li><a class="intrnllnk" href="#NameValuePairs">Name-Value Pair Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_namevalue_Fapprox">Fapprox</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_dispresults">dispresults</a></li></ul></li><li><a class="intrnllnk" href="#OutputArgs">Output Arguments</a><ul><li><a class="intrnllnk" href="#output_argument_out">out</a></li></ul></li><li><a class="intrnllnk" href="#MoreAbout">More About</a></li><li><a class="intrnllnk" href="#References">References</a></li><li><a class="intrnllnk" href="#SeeAlso">See Also</a></li></ul></nav><script src="../includes/product/scripts/offcanvas.js"></script></div><div id="divtop"></div><div class="site_container site_toc_closed"><div class="page_container"><div class="content_frame"><div id="content_container" class="content_container"><section id="doc_center_content"><div class="function_ref"><div itemprop="content"><h1 itemprop="title">boxtest</h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose">boxtest performs Box test of equality of covariance matrices</p><div class="switch"><a id="expandAllPage" href="javascript:void(0);">expand all in page</a></div></div></div></div><div class="ref_sect"><h2 id="syntax">Syntax</h2><div class="syntax_signature"><div class="syntax_signature_module"><ul><li><code class="synopsis">out=boxtest(Y,group)</code><span class="syntax_example"><a class="intrnllnk" href="boxtest.html#Example_1">example</a></span></li><li><code class="synopsis">out=boxtest(Y,group,Name,Value)</code><span class="syntax_example"><a class="intrnllnk" href="boxtest.html#Example_2">example</a></span></li></ul></div></div></div>	<div class="ref_sect" itemprop="content">							<h2 id="Description">Description</h2>							<div class="descriptions">								<div class="description_module"><p>Box test is used to determine whether two or more covariance matrices
 are equal. Note that Box test is sensitive to departures from
 normality. If the samples come from non-normal distributions, then Box
 test may simply be testing for non-normality.</p><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="boxtest.html#Example_1">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_out"><code>out</code></a>=boxtest(<a class="intrnllnk" href="#inputarg_Y"><code>Y</code></a>,<a class="intrnllnk" href="#inputarg_group"><code>group</code></a>)</code></span>Box test for Iris data.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="boxtest.html#Example_2">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_out"><code>out</code></a>=boxtest(<a class="intrnllnk" href="#inputarg_Y"><code>Y</code></a>,<a class="intrnllnk" href="#inputarg_group"><code>group</code></a>,<a class="intrnllnk" href="#namevaluepairarguments"><code>Name, Value</code></a>)</code></span>Box test for Iris data displaying results.</p></div>								</div>							</div>							<div class="clear">							</div>						</div><div class="ref_sect" itemprop="content"><div class="examples"><h2 id="Examples">Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="example_1" class="example_module expandableContent"><div id="Example_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>Box test for Iris data.</li></span></a></span></h3><div class="collapse"><p>
     load iris data<div class="programlisting"><div class="codeinput"><pre class="matlab-code">load fisheriris
% Compute Box test of equality of covariance matrices
out=boxtest(meas,species);</pre></div></div></p></div></div><div id="example_2" class="example_module expandableContent"><div id="Example_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Box test for Iris data displaying results.</li></span></a></span></h3><div class="collapse"><p>
     load iris data<div class="programlisting"><div class="codeinput"><pre class="matlab-code">load fisheriris
% Compute Box test of equality of covariance matrices
out=boxtest(meas,species,'dispresults',true);</pre></div></div><pre class="codeoutput">*****************************************************************
Test of homogeneity of covariances (without correction factor)
  146.6632

LRchi2approx = Chi2 approximation of Box test of homogeneity of covariances
  140.9430

p value of the Chi2 approximation of Box test
   3.3520e-20

*****************************************************************
</pre></p></div></div></div><p> </p><div class="examples"><h2 id="ExtraExamples" class="bottom_ruled">Related Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="Extraexample_1" class="example_module expandableContent"><div id="ExtraExample_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Box test for Iris with option Fapprox.</li></span></a></span></h3><div class="collapse"><p>
     load iris data<div class="programlisting"><div class="codeinput"><pre class="matlab-code">load fisheriris
% Compute Box test of equality of covariance matrices
out=boxtest(meas,species,'dispresults',true,'Fapprox',true)</pre></div></div><pre class="codeoutput">*****************************************************************
Test of homogeneity of covariances (without correction factor)
  146.6632

LRchi2approx = Chi2 approximation of Box test of homogeneity of covariances
  140.9430

p value of the Chi2 approximation of Box test
   3.3520e-20

LRFapprox = F approximation of Box test of homogeneity of covariances
    7.0453

p value of the F approximation of Box test
   3.5781e-20

*****************************************************************

out = 

  struct with fields:

                   LR: 146.6632
         LRchi2approx: 140.9430
    LRchi2approx_pval: 3.3520e-20
            LRFapprox: 7.0453
       LRFapprox_pval: 3.5781e-20
                  Spl: [4&times;4 double]

</pre></p></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="Inputs">Input Arguments</h2><div class="expandableContent"><div class="arguments"><div class="input_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"> <div id="inputarg_Y" class="clearfix"> </div> <h3 id="input_argument_Y" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>Y</code> &#8212; Input data. </span>  </a><span class="example_desc">Matrix.</span></span></h3> <div class="collapse"> <p><p>n x v data matrix. n observations and v
               variables. Rows of Y represent observations, and columns represent
               variables. Missing values (NaN's) and infinite values
               (Inf's) are allowed, since observations (rows) with missing
               or infinite values will automatically be excluded from the
               computations.</p> <p>
               </p></p> <p class="datatypelist"><strong> Data Types: </strong><code>single | double</code></p> </div> </div><div class="expandableContent"> <div id="inputarg_group" class="clearfix"> </div> <h3 id="input_argument_group" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>group</code> &#8212; Grouping variable. </span>  </a><span class="example_desc">Numeric vector | logical vector | character array | cell
               array of character vectors.</span></span></h3> <div class="collapse"> <p>group is a grouping variable defined as a categorical
               variable, vector, character array, or cell array of
               character vectors. Two observations are in the same group
               if they have the same value in the group array. The
               observations in each group represent a sample from a
               population.</p> <p class="datatypelist"><strong> Data Types: </strong><code>single| double</code></p> </div> </div><div id="namevaluepairarguments" class="clearfix"></div><h3 id="NameValuePairs" class="bottom_ruled">Name-Value Pair Arguments</h3><div class="namevaluecontainer"><p>Specify optional comma-separated pairs of <code>Name,Value</code> arguments. <code>Name</code> is the argument name and <code>Value</code> is the corresponding value. <code>Name</code> must appear  inside single quotes (<code>' '</code>).  You can specify several name and value pair arguments in any order as <code>  Name1,Value1,...,NameN,ValueN</code>.</p>  <span class="example_desc"><strong>Example:</strong><code><code> 'Fapprox',true
</code>,<code> 'dispresults',true
</code></code></span></div><div class="expandableContent"><div id="inputarg_Fapprox" class="clearfix"></div><h3 id="input_argument_namevalue_Fapprox" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>Fapprox</code> &#8212;Test based on F approximation.</span></a><span class="example_desc">boolean.</span></span></h3><div class="collapse">	<p><p>If Fapprox is
               true, the asymptotic F distribution of the value of Box
               test is also computed. On the other hand is
               Fapprox is false (default) just the chi2 approximation is
               computed.</p> <p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'Fapprox',true
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>logical</code></p></div></div><div class="expandableContent"><div id="inputarg_dispresults" class="clearfix"></div><h3 id="input_argument_namevalue_dispresults" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>dispresults</code> &#8212;Display results.</span></a><span class="example_desc">boolean.</span></span></h3><div class="collapse">	<p><p>If dispresults is
               true, the value of the test and the associated p-value
               will be shown on the screen. On the other hand is
               dispresults is false (default) nothing is shown on the
               screen.</p> <p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'dispresults',true
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>logical</code></p></div></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="OutputArgs" >Output Arguments</h2><div class="expandableContent"><div class="arguments"><div class="output_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"><div id="outputarg_out" class="clearfix"></div><h3 id="output_argument_out" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>out</code> &#8212; description</span></a><span class="example_desc">Structure</span></span></h3><div class="collapse"><p>Structure which contains the following fields
   <table border="2" cellpadding="4" cellspacing="0" class="body"><colgroup><col width="20%"><col width="80%"></colgroup><thead><tr valign="top"><th valign="top">Value</th><th valign="top">Description</th></tr></thead><tr valign="top"><td><code>LR</code></td><td><p><p>scalar which contains Box test (uncorrected)
                       for equality of covariances.</p> <p>
                       This is -2ln M (see 'More About section' for the
                       definition of M).</p></p></td></tr><tr valign="top"><td><code>LRchi2approx</code></td><td><p><p>scalar which contains Box test (corrected)
                       for equality of covariances. This version is
                       called $\chi^2$ approximation of the Box test.</p> <p>
                       This is $-2(1-c_1)\ln M$ (see further details for the
                       definition of $c_1$ and $M$). This value must
                       be compared with a $\chi^2$ with $0.5v(v+1)(g-1)$
                       degrees of freedom.</p></p></td></tr><tr valign="top"><td><code>LRchi2approx_pval</code></td><td><p>scalar which contains the p-value of
                       $\chi^2$ approximation of Box test of homogeneity of
                       covariances.</p></td></tr><tr valign="top"><td><code>LRFapprox</code></td><td><p>scalar which contains the $F$ approximation of Box
                       test of homogeneity of covariances. This field is
                       given just if input option Fapprox is true.</p></td></tr><tr valign="top"><td><code>LRFapprox_pval</code></td><td><p>scalar which contains the p-value of
                       $F$ approximation of Box test of homogeneity of
                       covariances. This field is given just if input
                       option Fapprox is true.</p></td></tr><tr valign="top"><td><code>Spl</code></td><td><p>pooled variance covariance matrix.</p></td></tr></table></p></div></div></div></div></div></div><div class="moreabout ref_sect"><h2 id="MoreAbout">More About</h2><div class="expandableContent"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent" itemprop="content"><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span>Additional Details</span></a></span></h3><div class="expand"><p><p>
 We assume independent samples of size $n_1$, $n_2$, $\ldots$,
 $n_g$ from a $v$-multivariate normal distribution. The hypothesis of
 equality of covariances is:</p> <p>
 
 </p>\[
 H_0= \Sigma_1 = \Sigma_2 = \ldots = \Sigma_g
 \]<p>

 To make the test we calculate:</p> <p>
 
 </p>\[
 M=\frac{ |S_1|^{n_1-1} |S_2|^{n_2-1} \ldots |S_g|^{n_g-1} }{|S_{pl}|^{\sum_{i=1}^g n_i-1} }
 \]<p>

 where $S_i$ is the covariance matrix of group $i$ and $S_{pl}$ is the
 pooled sample covariance matrix. It is clear that we must have $n_i-1&gt;v$
 otherwise $|S_i|=0$ for some $i$ and $M$ would be zero. The statistic $M$
 is a modification of the likelihood ratio test and varies between 0 and 1
 with values near 1 favouring $H_0$ and values near 0 leading to the
 rejection of $H_0$ (see Rencher (2002) p. 256 for further details). The
 quantity $-2 \ln M$ is approximately distributed as a $\chi^2$
 distribution and is given in $\mbox{out.LR}$.  The quantity $-2(1-c_1) \ln  M$
 (where $c_1$ is a small sample correction factor) is usually called
 correct Box test and is approximately distributed as a $\chi^2$ with $0.5
 (g-1) v(v+1)$ degrees of freedom. We reject $H_0$ if 
 $$-2(1-c_1) \ln M  &gt;\chi^2_{1-\alpha}$$ where $\chi^2_{1-\alpha}$ is the 
 $1-\alpha$ quantile. The value of this test is contained in
 $\mbox{out.LRchi2approx}$  and the corresponding p-value of this test is
 given in $\mbox{out.LRchi2approx_pval}$.</p> <p>
 Box also derived and F approximation to the test. This test is computed
 just if input option Fapprox is true. The value of this last test and the
 corresponding p-values are given in $\mbox{out.LRFapprox}$ and
 $\mbox{LRFapprox_pval}$.</p> <p>
 WARNING: if the absolute value of the determinant of the
 covariance matrix of any group is less than 1e-40,
 a missing value for LR test is reported.</p><p>


</p></p></div></div></div></div><div class="ref_sect" itemprop="content"><div class="bibliography"><h2 id="References">References</h2> <div><p>Mardia, K.V., J.T. Kent, and J.M. Bibby (1979), "Multivariate Analysis,"
 Academic Press, London, pp. 140. [MKB].</p></div><div><p>Rencher A.C. (2002), "Methods of Multivariate Analysis", 2nd edition,
 Wiley, New York, pp. 280-284.</p></div></div></div><div class="ref_sect"><h2 id="SeeAlso">See Also</h2><p><span itemprop="seealso"><a href="matlab:web(fullfile(docroot,'stats/manova1.html'))" itemprop="url"><span itemprop="name"><code>manova1</code></span></a></span> | <span itemprop="seealso"><a href="tkmeans.html" itemprop="url"><span itemprop="name"><code>tkmeans</code></span></a></span></div><i>This page has been automatically generated by our routine <a href="publishFS.html">publishFS</a></i></div></section></div></div></div></div><div id="divbottom"></div></body></html>