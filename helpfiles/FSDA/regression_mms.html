<!DOCTYPE HTML>
<html itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage" xmlns="http://www.w3.org/1999/xhtml">

<script src="includesFS/headJS.js" type="text/javascript"></script>
<!--headJS loads all required javascripts-->
<script type="text/javascript">
document.write(headJS);
</script>
<!--Insert title of the page-->
<title>FSDA main page</title>
<!--Beginning of body-->
<body id="responsive_offcanvas">

<div id="doc_header_spacer" class="header">
</div>
<!--Include serch engine-->
<script type="text/javascript">
document.write(engine);
</script>
<!--Include left bar menu-->
<div class="row-offcanvas row-offcanvas-left">
	<script type="text/javascript">
	document.write(lbar);
	</script>
	<!--Include divs before FSDA text-->
	<script type="text/javascript">
document.write(divsbefore);
</script>
	<!--BEGINNING OF FSDA TEXT-->
	<!-- -->
	<!-- -->
	<!-- -->
	
<h2 id="bqvsgfl-1" class="title">S and MM estimators in linear regression</h2>
<a class="indexterm" name="zmw57dd0e2698"></a>
<p></p>
<p>In the analysis which follows we analyze the transformed fidelity data and we 
compare the residuals which come out from the different options of traditional robust 
estimators (S and MM) using individual tests or simultaneous tests 
confidence bands. In order to have a stable pattern of residuals we chose to 
extract 30000 subsets.</p>
<pre class="programlisting">
% Load the 'loyalty cards data' 
load('loyalty.txt');
% define y and X
y=loyalty(:,4);
X=loyalty(:,1:3);
% transform y
y1=y.^(0.4);

% Define nominal confidence level
conflev=0.99;
% Define number of subsets 
nsamp=3000;
% Define the main title of the plots
titl='';

% S residuals
[outS]=Sreg(y1,X,'nsamp',nsamp,'conflev',conflev);
h1=subplot(2,1,1);
laby='Scaled S residuals'; 
resindexplot(outS.residuals,'h',h1,'title',titl,'laby',laby,'numlab','','conflev',conflev)


% MM scaled residuals
[outMM]=MMreg(y1,X,'Snsamp',nsamp,'conflev',conflev);
h3=subplot(2,1,2);
laby='Scaled MM residuals'; 
resindexplot(outMM.residuals,'h',h3,'title',titl,'laby',laby,'numlab','','conflev',conflev)

</pre>
<p>
The picture below gives the residuals which appear if we use S or MM and we use a nominal 99% confidence interval 
individual test. Notice that using standard individual test procedure with 
nominal size $\alpha$, in 
each dataset we expect to declare as outliers $\alpha\%$ of the values. </p>
<p>
<img alt="" src="images_help/regression_mms01.gif"></p>
<p>If we use a simultaneous confidence interval,
that is if we specify <tt>conflev</tt> using the following code
</p>
<pre class="programlisting">
conflev=1-0.01/length(y);
</pre>
these are the plots that we get. Notice that using a simultaneous test procedure with size 
$\alpha$ we expect to find at least one outlier in $\alpha\%$ of the 
datasets.
<p>&nbsp;
</p>
<p>

<img alt="" src="images_help/regression_mms02.gif"><p>The structure of the residuals which comes from the use of 
S estimators seems to be 
quite different from the one which comes out from MM estimators.<p></p>
	<!-- -->
	<!-- -->
	<!-- -->
	<!--END OF FSDA TEXT-->
	<!--Include divs after FSDA text-->
	<script language="javaScript" type="text/javascript">
document.write(divsafter);
</script>
	<!--Include fixed text at the bottom of the page-->
	<script language="javaScript" type="text/javascript">
document.write(barra);
</script>
	<!--END.CLASS body_trail_container-->
	<!--close row-offcanvas--></div>
<!--close class="row-offcanvas row-offcanvas-left" -->

</body>

</html>
