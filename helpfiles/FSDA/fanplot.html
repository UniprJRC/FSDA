<!DOCTYPE HTML> <html itemscope="" xmlns="http://www.w3.org/1999/xhtml"><head><title>fanplot</title><meta content="refpage" name="chunktype"><meta content="function:fanplot" itemprop="refentity" name="refentity"><meta content="text/javascript" http-equiv="Content-Script-Type"><meta content="fcn" itemprop="pagetype" name="toctype"><meta content="ref/function" itemprop="infotype" name="infotype" /><meta content="fanplot plots the fan plot for transformation in linear regression." itemprop="description" name="description" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" /><script type="text/x-mathjax-config">MathJax.Hub.Config({extensions: ["tex2jax.js"],jax: ["input/TeX","output/HTML-CSS"],menuSettings: {zoom: "Double-Click", zscale: "300"},tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},MathMenu: {showRenderer: false},"HTML-CSS": {availableFonts: ["TeX"],preferredFont: "TeX",imageFont: null}});</script><script type="text/javascript" src="includesFS/Mathjax/MathJax.js"></script><script src="includesFS/matlab-highlighter.min.js"></script><link href="includesFS/matlab-highlighter.css" rel="stylesheet" type="text/css"><script type="text/javascript" src="includesFS/jquery-latest.js"></script><script>$(document).ready(function(){      $("#divtop").load("includesFS/top.html");      $("#divbottom").load("includesFS/bottom.html");});</script><link href="../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)"></link><link href="../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)"></link><link href="../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)"></link><link href="../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)"></link><link href="../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)"></link><link href="../includes/product/css/site6_offcanvas.css" rel="stylesheet" type="text/css"></link><script src="../includes/shared/scripts/l10n.js" type="text/javascript"></script><script src="../includes/product/scripts/docscripts.js"></script><script src="../includes/shared/scripts/docscripts_rn.js"></script><script src="../includes/shared/scripts/mw.imageanimation.js" type="text/javascript"></script><script src="../includes/shared/scripts/jquery.highlight.js"></script><script src="../includes/product/scripts/bootstrap.min.js" type="text/javascript"></script><script src="../includes/product/scripts/global.js"></script><script src="includesFS/bottom.js" type="text/javascript"></script><script src="../includes/product/scripts/underscore-min.js"></script><script src="../includes/shared/scripts/f1help.js" type="text/javascript"></script><script src="../includes/product/scripts/suggest.js" type="text/javascript"></script><script src="../includes/shared/scripts/helpservices.js" type="text/javascript"></script><script src="../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script><!-- the following line should be kept this way only --><link href="includesFS/doc_center.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css"><link href="../includes/product/css/doc_center_print.css" media="print" rel="stylesheet" type="text/css"></head><body  onload="highlightMATLABCode();" id="responsive_offcanvas">  <div id="doc_header_spacer" class="header"></div><div class="sticky_header_container includes_subnav"><div class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-xs-12 col-sm-6 col-sm-push-6 col-md-5 col-md-push-7" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2017a" data-language="en" action="../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="sr-only">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"><div class="input-group-btn"><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search pull-right icon_32 visible-xs" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="col-sm-6 col-sm-pull-6 col-md-7 col-md-pull-5" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../documentation-center.html">Documentation</a></h1></div></div></div><div class="visible-xs" id="search_actuator"><button class="btn icon-search btn_search pull-right icon_16" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div><!--END.CLASS row--> </div><!--END.CLASS container-fluid--> </div><!--END.CLASS section_header level_3--><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_actuator" data-toggle="offcanvas" data-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="sr-only">Toggle navigation</span><span class="icon-menu icon_24"></span></button><span class="offcanvas_actuator_label"></span><span class="offcanvas_actuator_close"></span> </div><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-md-12 hidden-xs hidden-sm"></div></div></div></div></div></div></div><!--END.CLASS sticky_header_container--><div class="row-offcanvas row-offcanvas-left"><div id="sidebar" class="sidebar-offcanvas" role="navigation"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" xmlns:atict="http://www.arbortext.com/namespace/atict"><li itemprop="breadcrumb" itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb"> <a href="../documentation-center.html" itemprop="url"> <span itemprop="title">All Products</span></a></li></ul><ul class="nav_disambiguation" xmlns:atict="http://www.arbortext.com/namespace/atict"><li class="product"><a href="index.html">Flexible Statistics and Data Analysis (FSDA)</a><div class="dropdown"> <span id="dropdownMenu1" class="icon-arrow-down icon_16" data-toggle="dropdown"> </span><ul aria-labelledby="dropdownMenu1" class="dropdown-menu dropdown-menu-right" role="menu"><li role="presentation"> <a href="examples.html" role="menuitem" tabindex="-1">Examples</a></li><li role="presentation"> <a href="function-alpha.html" role="menuitem" tabindex="-1"> Functions and Other Reference</a></li><li role="presentation"> <a href="release_notes.html?s_cid=doc_flyout" role="menuitem" tabindex="-1"> Release Notes</a></li><li role="presentation"> <a href="tutorials.html" role="menuitem" tabindex="-1"> Tutorials</a></li></ul></div></li></ul><ul xmlns:atict="http://www.arbortext.com/namespace/atict" class="nav_disambiguation"> <li><a href="index.html">Flexible Statistics and Data Analysis Toolbox</a> </li> <li><a href="function-cate.html" itemprop="url">Functions</a></li></ul><!-- --><ul class="nav_scrollspy nav" xmlns:atict="http://www.arbortext.com/namespace/atict">  <li class="nav_scrollspy_function"> <a href="#responsive_offcanvas">fanplot</a></li> <li id="SSPY810-refentry" class="nav_scrollspy_title">On this page</li><li><a class="intrnllnk" href="#syntax">Syntax</a></li><li><a class="intrnllnk" href="#Description">Description</a></li><li><a class="intrnllnk" href="#Examples">Examples</a><ul><li><a class="intrnllnk" href="#Example_1">fanplot with all default options.</a></li><li><a class="intrnllnk" href="#Example_2">fanplot with optional arguments.</a></li></ul></li><li><a class="intrnllnk" href="#ExtraExamples">Extra Examples</a><ul><li><a class="intrnllnk" href="#ExtraExample_1"><i>Interactive example 1.</i>
    FSRfan and fanplot with databrush option.</a></li><li><a class="intrnllnk" href="#ExtraExample_2"><i>Interactive example 2.</i>
    FSRfan and fanplot with databrush, persist, label and RemoveLabels options.</a></li><li><a class="intrnllnk" href="#ExtraExample_3"><i>Interactive example 3.</i>
    FSRfan and fanplot with databrush, bivarfit, label and  RemoveLabels options.</a></li><li><a class="intrnllnk" href="#ExtraExample_4"><i>Interactive example 4.</i>
    FSRfan and fanplot with databrush  and selectionmode options.</a></li><li><a class="intrnllnk" href="#ExtraExample_5">fanplot with datatooltip passed as scalar.</a></li><li><a class="intrnllnk" href="#ExtraExample_6">Construct fan plot specifying the confidence level and the xlimits.</a></li><li><a class="intrnllnk" href="#ExtraExample_7"><i>Interactive example 5.</i>
    Example of the use of multivarfit and xlimx.</a></li><li><a class="intrnllnk" href="#ExtraExample_8"><i>Interactive example 6.</i>
    Example of the use of FlagSize, namey, namex, lwd,FontSize, SizeAxesNum.</a></li><li><a class="intrnllnk" href="#ExtraExample_9"><i>Interactive example 7.</i>
     Only one brush specifying labels for y and X.</a></li></ul></li><li><a class="intrnllnk" href="#Inputs">Input Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_out">out</a></li></ul></li><li><a class="intrnllnk" href="#NameValuePairs">Name-Value Pair Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_namevalue_label">label</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_conflev">conflev</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_datatooltip">datatooltip</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_databrush">databrush</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_titl">titl</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_labx">labx</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_laby">laby</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_xlimx">xlimx</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_ylimy">ylimy</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_lwd">lwd</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_lwdenv">lwdenv</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_FontSize">FontSize</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_SizeAxesNum">SizeAxesNum</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_nameX">nameX</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_namey">namey</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_tag">tag</a></li></ul></li><li><a class="intrnllnk" href="#References">References</a></li><li><a class="intrnllnk" href="#SeeAlso">See Also</a></li></ul></nav><script src="../includes/product/scripts/offcanvas.js"></script></div><div id="divtop"></div><div class="site_container site_toc_closed"><div class="page_container"><div class="content_frame"><div id="content_container" class="content_container"><section id="doc_center_content"><div class="function_ref"><div itemprop="content"><h1 itemprop="title">fanplot</h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose">fanplot plots the fan plot for transformation in linear regression</p><div class="switch"><a id="expandAllPage" href="javascript:void(0);">expand all in page</a></div></div></div></div><div class="ref_sect"><h2 id="syntax">Syntax</h2><div class="syntax_signature"><div class="syntax_signature_module"><ul><li><code class="synopsis">fanplot(out)</code><span class="syntax_example"><a class="intrnllnk" href="fanplot.html#Example_1">example</a></span></li><li><code class="synopsis">fanplot(out,Name,Value)</code><span class="syntax_example"><a class="intrnllnk" href="fanplot.html#Example_2">example</a></span></li></ul></div></div></div>	<div class="ref_sect" itemprop="content">							<h2 id="Description">Description</h2>							<div class="descriptions">								<div class="description_module"><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="fanplot.html#Example_1">	example</a></p>	<p><span itemprop="syntax"><code>fanplot(<a class="intrnllnk" href="#inputarg_out"><code>out</code></a>)</code></span>fanplot with all default options.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="fanplot.html#Example_2">	example</a></p>	<p><span itemprop="syntax"><code>fanplot(<a class="intrnllnk" href="#inputarg_out"><code>out</code></a>,<a class="intrnllnk" href="#namevaluepairarguments"><code>Name, Value</code></a>)</code></span>fanplot with optional arguments.</p></div>								</div>							</div>							<div class="clear">							</div>						</div><div class="ref_sect" itemprop="content"><div class="examples"><h2 id="Examples">Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="example_1" class="example_module expandableContent"><div id="Example_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> fanplot with all default options.</li></span></a></span></h3><div class="collapse"><p>
     load the wool data<div class="programlisting"><div class="codeinput"><pre class="matlab-code">XX=load('wool.txt');
y=XX(:,end);
X=XX(:,1:end-1);
% FSRfan and fanplot with all default options
[out]=FSRfan(y,X);
fanplot(out);</pre></div></div><pre class="codeoutput">Total estimated time to complete LMS:  0.03 seconds 
------------------------------
Warning: Number of subsets without full rank equal to 16.4%
Total estimated time to complete LMS:  0.01 seconds 
------------------------------
Warning: Number of subsets without full rank equal to 12.7%
Total estimated time to complete LMS:  0.01 seconds 
------------------------------
Warning: Number of subsets without full rank equal to 16%
Total estimated time to complete LMS:  0.02 seconds 
------------------------------
Warning: Number of subsets without full rank equal to 16.5%
Total estimated time to complete LMS:  0.01 seconds 
------------------------------
Warning: Number of subsets without full rank equal to 14.8%
</pre><a href='http://rosa.unipr.it/fsda/fanplot.html#Example_1'><img vspace="5" hspace="5" src="images\fanplot_01.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website). Graphical output could not be included in the installation file because toolboxes cannot be greater than 20MB. To load locally the image files, download zip file http://rosa.unipr.it/fsda/images.zip and unzip it to <tt>(docroot)/FSDA/images</tt> or simply run routine <tt>downloadGraphicalOutput.m</tt>"> </a></p></div></div><div id="example_2" class="example_module expandableContent"><div id="Example_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> fanplot with optional arguments.</li></span></a></span></h3><div class="collapse"><p>
    FSRfan and fanplot with specified lambda<div class="programlisting"><div class="codeinput"><pre class="matlab-code">load('loyalty.txt');
y=loyalty(:,4);
X=loyalty(:,1:3);
% la = vector contanining the most common values of the transformation
% parameter
la=[-1 -0.5 0 0.5 1];
[out]=FSRfan(y,X,'la',la);
fanplot(out);</pre></div></div><pre class="codeoutput">Total estimated time to complete LMS:  0.03 seconds 
m=100
m=200
m=300
m=400
m=500
Total estimated time to complete LMS:  0.03 seconds 
m=100
m=200
m=300
m=400
m=500
Total estimated time to complete LMS:  0.03 seconds 
m=100
m=200
m=300
m=400
m=500
Total estimated time to complete LMS:  0.05 seconds 
m=100
m=200
m=300
m=400
m=500
Total estimated time to complete LMS:  0.04 seconds 
m=100
m=200
m=300
m=400
m=500
</pre><a href='http://rosa.unipr.it/fsda/fanplot.html#Example_2'><img vspace="5" hspace="5" src="images\fanplot_02.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website). Graphical output could not be included in the installation file because toolboxes cannot be greater than 20MB. To load locally the image files, download zip file http://rosa.unipr.it/fsda/images.zip and unzip it to <tt>(docroot)/FSDA/images</tt> or simply run routine <tt>downloadGraphicalOutput.m</tt>"> </a></p></div></div></div><p> </p><div class="examples"><h2 id="ExtraExamples" class="bottom_ruled">Related Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="Extraexample_1" class="example_module expandableContent"><div id="ExtraExample_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><i>Interactive example 1.</i>
    FSRfan and fanplot with databrush option.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">load('loyalty.txt');
y=loyalty(:,4);
X=loyalty(:,1:3);
la=[-1 -0.5 0 0.5 1];
[out]=FSRfan(y,X,'la',la);
fanplot(out,'databrush','1');</pre></div></div></p></div></div><div id="Extraexample_2" class="example_module expandableContent"><div id="ExtraExample_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><i>Interactive example 2.</i>
    FSRfan and fanplot with databrush, persist, label and RemoveLabels options.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">%Removelabels is a parameter of SelectdataFS function
load('loyalty.txt');
y=loyalty(:,4);
X=loyalty(:,1:3);
la=[-1 -0.5 0 0.5 1];
[out]=FSRfan(y,X,'la',la);
fanplot(out,'databrush',{ 'persist' 'on' 'Label' 'on' 'RemoveLabels' 'off'});</pre></div></div></p></div></div><div id="Extraexample_3" class="example_module expandableContent"><div id="ExtraExample_3"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><i>Interactive example 3.</i>
    FSRfan and fanplot with databrush, bivarfit, label and  RemoveLabels options.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">load('loyalty.txt');
y=loyalty(:,4);
X=loyalty(:,1:3);
la=[-1 -0.5 0 0.5 1];
[out]=FSRfan(y,X,'la',la);
fanplot(out,'databrush',{ 'bivarfit' '2' 'Label' 'on' 'RemoveLabels' 'off'});</pre></div></div></p></div></div><div id="Extraexample_4" class="example_module expandableContent"><div id="ExtraExample_4"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><i>Interactive example 4.</i>
    FSRfan and fanplot with databrush  and selectionmode options.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">%Example of the use of persistent cumulative brush.
%Every time a brushing action is performed
%current highlightments are added to previous highlightments
load('loyalty.txt');
y=loyalty(:,4);
X=loyalty(:,1:3);
la=[-1 -0.5 0 0.5 1];
[out]=FSRfan(y,X,'la',la);
fanplot(out,'databrush',{'selectionmode','Brush'});
fanplot(out,'databrush',{'selectionmode' 'Lasso' 'persist' 'off'})
fanplot(out,'databrush',{'selectionmode' 'Rect' 'persist' 'on'})</pre></div></div></p></div></div><div id="Extraexample_5" class="example_module expandableContent"><div id="ExtraExample_5"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>fanplot with datatooltip passed as scalar.</li></span></a></span></h3><div class="collapse"><p>
    That is using default options for datacursor (i.e. DisplayStyle=window).<div class="programlisting"><div class="codeinput"><pre class="matlab-code">load('loyalty.txt');
y=loyalty(:,4);
X=loyalty(:,1:3);
la=[-1 -0.5 0 0.5 1];
[out]=FSRfan(y,X,'la',la);
fanplot(out,'datatooltip',1);</pre></div></div></p></div></div><div id="Extraexample_6" class="example_module expandableContent"><div id="ExtraExample_6"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Construct fan plot specifying the confidence level and the xlimits.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">load('loyalty.txt');
y=loyalty(:,4);
X=loyalty(:,1:3);
la=[0 1/3 0.4 0.5];
[out]=FSRfan(y,X,'la',la,'init',size(X,2)+2,'nsamp',20000);
fanplot(out,'xlimx',[100 300],'conflev',0.95);</pre></div></div></p></div></div><div id="Extraexample_7" class="example_module expandableContent"><div id="ExtraExample_7"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><i>Interactive example 5.</i>
    Example of the use of multivarfit and xlimx.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">load('loyalty.txt');
y=loyalty(:,4);
X=loyalty(:,1:3);
la=[0 1/3 0.4 0.5];
[outs]=FSRfan(y,X,'la',la,'init',size(X,2)+2,'nsamp',20000);
fanplot(outs,'xlimx',[10 520],'databrush',{'selectionmode' 'Brush' 'multivarfit' '2'})</pre></div></div></p></div></div><div id="Extraexample_8" class="example_module expandableContent"><div id="ExtraExample_8"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><i>Interactive example 6.</i>
    Example of the use of FlagSize, namey, namex, lwd,FontSize, SizeAxesNum.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">load('loyalty.txt');
y=loyalty(:,4);
X=loyalty(:,1:3);
la=[-1 -0.5 0 0.5 1];
[out]=FSRfan(y,X,'la',la);
namey='Sales';
nameX={'Number of visits', 'Age', 'Number of persons in the family'};
%FlagSize controls how large must be the highlighted points. It is a
%parametr of selectdataFS.
fanplot(out,'xlimx',[10 520],'lwd',1.5,'FontSize',11,'SizeAxesNum',11,'nameX',nameX,'namey',namey,'databrush',{'selectionmode' 'Brush'...
'multivarfit' '2' 'FlagSize' '5'})</pre></div></div></p></div></div><div id="Extraexample_9" class="example_module expandableContent"><div id="ExtraExample_9"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><i>Interactive example 7.</i>
     Only one brush specifying labels for y and X.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">load('loyalty.txt');
y=loyalty(:,4);
X=loyalty(:,1:3);
la=[-1 -0.5 0 0.5 1];
[out]=FSRfan(y,X,'la',la);
fanplot(out,'databrush',{'selectionmode' 'Brush' 'FlagSize' '5'},'nameX',nameX,'namey',namey)</pre></div></div></p></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="Inputs">Input Arguments</h2><div class="expandableContent"><div class="arguments"><div class="input_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"> <div id="inputarg_out" class="clearfix"> </div> <h3 id="input_argument_out" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>out</code> &#8212; Data to plot. </span>  </a><span class="example_desc">Structure.</span></span></h3> <div class="collapse"> <p>Structure containing the following fields<table border="2" cellpadding="4" cellspacing="0" class="body"><colgroup><col width="20%"><col width="80%"></colgroup><thead><tr valign="top"><th valign="top">Value</th><th valign="top">Description</th></tr></thead><tr valign="top"><td><code>Score</code></td><td><p><p>(n-init) x length(la)+1 matrix:</p> <p>
               1st col = fwd search index;</p> <p>
               2nd col = value of the score test in each step
               of the fwd search for la(1);</p> <p>
               ...;</p><p>
               last col  =  value of the score test in each step
               of the fwd search for la(end).</p></p></td></tr><tr valign="top"><td><code>la</code></td><td><p>vector containing the values of lambda for which fan plot
               is constructed.</p></td></tr><tr valign="top"><td><code>bs</code></td><td><p><p>matrix of size p x length(la) containing the units forming
               the initial subset for each value of lambda.</p> <p>
      out. Un   =  cell of size length(la). out.Un{i} is a (n-init) x 11
               matrix which contains the unit(s) included in the subset
               at each step of the fwd search (necessary only if option
               datatooltip or databrush are not empty).</p></p></td></tr><tr valign="top"><td><code>y</code></td><td><p>a vector containing the response (necessary only if option
              databrush is true).</p></td></tr><tr valign="top"><td><code>X</code></td><td><p>a matrix containing the explanatory variables (necessary
              only if option databrush is not empty).</p></td></tr></table></p> <p class="datatypelist"><strong> Data Types: </strong><code>struct</code></p> </div> </div><div id="namevaluepairarguments" class="clearfix"></div><h3 id="NameValuePairs" class="bottom_ruled">Name-Value Pair Arguments</h3><div class="namevaluecontainer"><p>Specify optional comma-separated pairs of <code>Name,Value</code> arguments. <code>Name</code> is the argument name and <code>Value</code> is the corresponding value. <code>Name</code> must appear  inside single quotes (<code>' '</code>).  You can specify several name and value pair arguments in any order as <code>  Name1,Value1,...,NameN,ValueN</code>.</p>  <span class="example_desc"><strong>Example:</strong><code><code> 'corr',1
</code>,<code> 'conflev',[0.9 0.95 0.99]
</code>,<code> 'datatooltip',''
</code>,<code> 'databrush',1
</code>,<code> 'titl','Fan plot'
</code>,<code> 'labx','Subset size m'
</code>,<code> 'laby','Score test statistic'
</code>,<code> 'xlimx',[init n]
</code>,<code> 'ylimy',[0 100]
</code>,<code> 'lwd',2
</code>,<code> 'lwdenv',1
</code>,<code> 'FontSize',12
</code>,<code> 'SizeAxesNum',10
</code>,<code> 'nameX',''
</code>,<code> 'namey',''
</code>,<code> 'tag','pl_mycov'
</code></code></span></div><div class="expandableContent"><div id="inputarg_label" class="clearfix"></div><h3 id="input_argument_namevalue_label" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>label</code> &#8212;Labels.</span></a><span class="example_desc">cell array of strings.</span></span></h3><div class="collapse">	<p><p>Cell containing the labels of the units (optional
                   argument used when datatooltip=1). If this field is not
                   present labels row1, ..., rown will be automatically
                   created and included in the pop up datatooltip window.</p> <p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'corr',1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>Cell array of strings</code></p></div></div><div class="expandableContent"><div id="inputarg_conflev" class="clearfix"></div><h3 id="input_argument_namevalue_conflev" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>conflev</code> &#8212;Confidence level.</span></a><span class="example_desc">scalar | vector.</span></span></h3><div class="collapse">	<p><p>Confidence level for the bands (default is 0.99, that is
                   we plot two horizontal lines in correspondence of value
                   -2.58 and 2.58).</p> <p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'conflev',[0.9 0.95 0.99]
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_datatooltip" class="clearfix"></div><h3 id="input_argument_namevalue_datatooltip" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>datatooltip</code> &#8212;Information about the unit selected.</span></a><span class="example_desc">empty value | structure.</span></span></h3><div class="collapse">	<p><p>The
                   default is datatooltip=''.</p> <p>
                   If datatooltip is not empty the user can use the mouse
                   in order to have information about the unit selected,
                   the step in which the unit enters the search and the
                   associated label. If datatooltip is a structure, it is
                   possible to control the aspect of the data cursor (see
                   function datacursormode for more details or the
                   examples below). The default options of the structure
                   are DisplayStyle='Window' and SnapToDataVertex='on'.</p><p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'datatooltip',''
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>Empty value or structure</code></p></div></div><div class="expandableContent"><div id="inputarg_databrush" class="clearfix"></div><h3 id="input_argument_namevalue_databrush" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>databrush</code> &#8212;Databrush options.</span></a><span class="example_desc">empty value, scalar | cell.</span></span></h3><div class="collapse">	<p><p>DATABRUSH IS AN EMPTY VALUE: If databrush is an empty
                   value (default), no brushing is done. The activation of
                   this option (databrush is a scalar or a cell) enables
                   the user  to select a set of trajectories in the
                   current plot and to see them highlighted in the y|X
                   plot (notice that if the plot y|X does not exist it is
                   automatically created). In addition, brushed units can
                   be highlighted in the other following plots (only if
                   they are already open): monitoring residual plot
                   monitoring leverage plot maximum studentized residual
                   $s^2$ and $R^2$ Cook distance and modified Cook distance
                   deletion t statistics.</p> <p>
                   The window style of the
                   other figures is set equal to that which contains the
                   monitoring residual plot. In other words, if the
                   monitoring residual plot is docked all the other
                   figures will be docked too.</p> <p>
                   DATABRUSH IS A SCALAR: If databrush is a scalar the default selection tool is a
                   rectangular brush and it is possible to brush only once
                   (that is persist='').</p> <p>
                   DATABRUSH IS A CELL: If databrush is a cell, it is possible to use all
                   optional arguments of function <a href="selectdataFS.html">selectdataFS</a> and <a href="LXS.html">LXS</a> inside the curly brackets of
                   option databrush and the following optional argument:</p> <p>
                  persist = Persist is an empty value or a scalar containing
                   the strings 'on' or 'off'. If persist = 'on' or 'off'
                   brusing can be done as many time as the
                   user requires. In case persist='off', every time a new
                   brush is performed, units previously brushed are
                   removed. In case persist='on' the unit(s)
                   currently brushed are added to those previously
                   brushed. However in both cases, if the user brushes a
                   different trajectory from the one previously brushed,
                   the previos brushed plots are stored in a figure in the
                   background. The default value of persist is '' that is
                   brushing is allowed only once.</p> <p>
                 bivarfit = This option adds one or more least square
                   lines, based on SIMPLE REGRESSION of y on Xi, to the
                   plots of y|Xi.</p> <p>
                   If bivarfit = ''
                   is the default: no line is fitted.</p> <p>
                   If bivarfit = '1'
                   fits a single ols line to all points of each bivariate
                   plot in the scatter matrix y|X.</p> <p>
                   If bivarfit = '2'
                   fits two ols lines: one to all points and another to
                   the group of the genuine observations. The group of the
                   potential outliers is not fitted.</p> <p>
                   If bivarfit = '0'
                   fits one ols line to each group. This is useful for the
                   purpose of fitting mixtures of regression lines.</p> <p>
                   If bivarfit = 'i1' or 'i2' or 'i3' etc
                   fits an ols line to a specific group, the one with
                   index 'i' equal to 1, 2, 3 etc. Again, useful in case
                   of mixtures.</p> <p>
                 multivarfit = This option adds one or more least square lines,
                   based on MULTIVARIATE REGRESSION of y on X, to the
                   plots of y|Xi.</p> <p>
                   If multivarfit = ''
                   is the default: no line is fitted.</p> <p>
                   If multivarfit = '1'
                   fits a single ols line to all points of each bivariate
                   plot in the scatter matrix y|X. The line added to the
                   scatter plot y|Xi is avconst +Ci*Xi, where Ci is the
                   coefficient of Xi in the multivariate regression and
                   avconst is the effect of all the other explanatory
                   variables different from Xi evaluated at their centroid
                   (that is overline{y}'C))
                   If multivarfit = '2'
                   exactly equal to multivarfit ='1' but this time we add the
                   line based on the group of unselected observations.</p><p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'databrush',1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>Empty value, scalar or cell.</code></p></div></div><div class="expandableContent"><div id="inputarg_titl" class="clearfix"></div><h3 id="input_argument_namevalue_titl" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>titl</code> &#8212;Title.</span></a><span class="example_desc">string.</span></span></h3><div class="collapse">	<p>A label for the title (default: 'Fan plot')
                   </p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'titl','Fan plot'
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>char</code></p></div></div><div class="expandableContent"><div id="inputarg_labx" class="clearfix"></div><h3 id="input_argument_namevalue_labx" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>labx</code> &#8212;x-axis label.</span></a><span class="example_desc">string.</span></span></h3><div class="collapse">	<p><p>A label for the x-axis (default:</p> <p>
                   'Subset size m').</p><p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'labx','Subset size m'
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>char</code></p></div></div><div class="expandableContent"><div id="inputarg_laby" class="clearfix"></div><h3 id="input_argument_namevalue_laby" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>laby</code> &#8212;y-axis label.</span></a><span class="example_desc">string.</span></span></h3><div class="collapse">	<p><p>a label for the y-axis
                   (default:'Score test statistic').</p> <p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'laby','Score test statistic'
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>char</code></p></div></div><div class="expandableContent"><div id="inputarg_xlimx" class="clearfix"></div><h3 id="input_argument_namevalue_xlimx" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>xlimx</code> &#8212;Min and Max of the x axis.</span></a><span class="example_desc">vector.</span></span></h3><div class="collapse">	<p><p>Vector with two elements controlling minimum and maximum
                   of the x axis. Default value is [init n].</p> <p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'xlimx',[init n]
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_ylimy" class="clearfix"></div><h3 id="input_argument_namevalue_ylimy" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>ylimy</code> &#8212;Min and Max of the y axis.</span></a><span class="example_desc">vector.</span></span></h3><div class="collapse">	<p><p>Vector with two elements controlling minimum and
                   maximum of the y axis. Default value for
                   ylimy(1)=max(min(score_test),-20). Default value for
                   ylimy(2)=min(max(score_test),20).</p> <p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'ylimy',[0 100]
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_lwd" class="clearfix"></div><h3 id="input_argument_namevalue_lwd" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>lwd</code> &#8212;Linewidth.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>Scalar which controls linewidth of the curves which
                   contain the score test. Default line width=2.</p> <p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'lwd',2
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_lwdenv" class="clearfix"></div><h3 id="input_argument_namevalue_lwdenv" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>lwdenv</code> &#8212;Width of the envelope lines.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>Scalar which controls the width of the lines associated
                   with the envelopes. Default is lwdenv=1.</p> <p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'lwdenv',1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_FontSize" class="clearfix"></div><h3 id="input_argument_namevalue_FontSize" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>FontSize</code> &#8212;Font size of the labels.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>Scalar which controls the font size of the labels of
                   the axes and of the labels inside the plot. Default
                   value is 12.</p> <p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'FontSize',12
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_SizeAxesNum" class="clearfix"></div><h3 id="input_argument_namevalue_SizeAxesNum" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>SizeAxesNum</code> &#8212;Size of the numbers of the axis.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>Scalar which controls the size of the numbers of the
                   axes. Default value is 10.</p> <p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'SizeAxesNum',10
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_nameX" class="clearfix"></div><h3 id="input_argument_namevalue_nameX" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>nameX</code> &#8212;Labels of the X variables.</span></a><span class="example_desc">cell array of strings.</span></span></h3><div class="collapse">	<p><p>Cell array of strings of length p containing the labels
                   of the varibles of the regression dataset. If it is empty
                 	(default) the sequence X1, ..., Xp will be created
                   automatically.</p> <p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'nameX',''
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>Cell array of strings</code></p></div></div><div class="expandableContent"><div id="inputarg_namey" class="clearfix"></div><h3 id="input_argument_namevalue_namey" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>namey</code> &#8212;Labels of the y variable.</span></a><span class="example_desc">string.</span></span></h3><div class="collapse">	<p><p>String containing the label of the response variable.</p> <p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'namey',''
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>char</code></p></div></div><div class="expandableContent"><div id="inputarg_tag" class="clearfix"></div><h3 id="input_argument_namevalue_tag" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>tag</code> &#8212;Handle of the plot.</span></a><span class="example_desc">string.</span></span></h3><div class="collapse">	<p><p>String which identifies the handle of the plot which
                   is about to be created. The default is to use tag
                   pl_fan. Notice that if the program finds a plot which
                   has a tag equal to the one specified by the user, then
                   the output of the new plot overwrites the existing one
                   in the same window else a new window is created.</p> <p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'tag','pl_mycov'
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>char</code></p></div></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="OutputArgs" >Output Arguments</h2><div class="expandableContent"><div class="arguments"><div class="output_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p></div></div></div></div><div class="ref_sect" itemprop="content"><div class="bibliography"><h2 id="References">References</h2> <div><p>Atkinson, A.C. and Riani, M. (2000), "Robust Diagnostic Regression
 Analysis", Springer Verlag, New York.</p></div><div><p>Atkinson, A.C. and Riani, M. (2002a), Tests in the fan plot for robust,
 diagnostic transformations in regression, "Chemometrics and Intelligent
 Laboratory Systems", Vol. 60, pp. 87-100.</p></div></div></div><div class="ref_sect"><h2 id="SeeAlso">See Also</h2><p></div><i>This page has been automatically generated by our routine <a href="publishFS.html">publishFS</a></i></div></section></div></div></div></div><div id="divbottom"></div></body></html>