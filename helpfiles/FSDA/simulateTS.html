<!DOCTYPE HTML> <html itemscope="" xmlns="http://www.w3.org/1999/xhtml"><head><title>simulateTS</title><meta content="refpage" name="chunktype"><meta content="function:simulateTS" itemprop="refentity" name="refentity"><meta content="text/javascript" http-equiv="Content-Script-Type"><meta content="fcn" itemprop="pagetype" name="toctype"><meta content="ref/function" itemprop="infotype" name="infotype" /><meta content="Simulate a time series with trend, time varying seasonal, level shift and irregular component." itemprop="description" name="description" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" /><script type="text/x-mathjax-config">MathJax.Hub.Config({extensions: ["tex2jax.js"],jax: ["input/TeX","output/HTML-CSS"],menuSettings: {zoom: "Double-Click", zscale: "300"},tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},MathMenu: {showRenderer: false},"HTML-CSS": {availableFonts: ["TeX"],preferredFont: "TeX",imageFont: null}});</script><script type="text/javascript" src="includesFS/Mathjax/MathJax.js"></script><script src="includesFS/matlab-highlighter.min.js"></script><link href="includesFS/matlab-highlighter.css" rel="stylesheet" type="text/css"><script type="text/javascript" src="includesFS/jquery-latest.js"></script><script>$(document).ready(function(){      $("#divtop").load("includesFS/top.html");      $("#divbottom").load("includesFS/bottom.html");});</script><link href="../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)"></link><link href="../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)"></link><link href="../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)"></link><link href="../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)"></link><link href="../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)"></link><link href="../includes/product/css/site6_offcanvas.css" rel="stylesheet" type="text/css"></link><script src="../includes/shared/scripts/l10n.js" type="text/javascript"></script><script src="../includes/product/scripts/docscripts.js"></script><script src="../includes/shared/scripts/docscripts_rn.js"></script><script src="../includes/shared/scripts/mw.imageanimation.js" type="text/javascript"></script><script src="../includes/shared/scripts/jquery.highlight.js"></script><script src="../includes/product/scripts/bootstrap.min.js" type="text/javascript"></script><script src="../includes/product/scripts/global.js"></script><script src="includesFS/bottom.js" type="text/javascript"></script><script src="../includes/product/scripts/underscore-min.js"></script><script src="../includes/shared/scripts/f1help.js" type="text/javascript"></script><script src="../includes/product/scripts/suggest.js" type="text/javascript"></script><script src="../includes/shared/scripts/helpservices.js" type="text/javascript"></script><script src="../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script><!-- the following line should be kept this way only --><link href="includesFS/doc_center.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css"><link href="../includes/product/css/doc_center_print.css" media="print" rel="stylesheet" type="text/css"></head><body  onload="highlightMATLABCode();" id="responsive_offcanvas">  <div id="doc_header_spacer" class="header"></div><div class="sticky_header_container includes_subnav"><div class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-xs-12 col-sm-6 col-sm-push-6 col-md-5 col-md-push-7" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2017a" data-language="en" action="../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="sr-only">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"><div class="input-group-btn"><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search pull-right icon_32 visible-xs" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="col-sm-6 col-sm-pull-6 col-md-7 col-md-pull-5" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../documentation-center.html">Documentation</a></h1></div></div></div><div class="visible-xs" id="search_actuator"><button class="btn icon-search btn_search pull-right icon_16" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div><!--END.CLASS row--> </div><!--END.CLASS container-fluid--> </div><!--END.CLASS section_header level_3--><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_actuator" data-toggle="offcanvas" data-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="sr-only">Toggle navigation</span><span class="icon-menu icon_24"></span></button><span class="offcanvas_actuator_label"></span><span class="offcanvas_actuator_close"></span> </div><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-md-12 hidden-xs hidden-sm"></div></div></div></div></div></div></div><!--END.CLASS sticky_header_container--><div class="row-offcanvas row-offcanvas-left"><div id="sidebar" class="sidebar-offcanvas" role="navigation"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" xmlns:atict="http://www.arbortext.com/namespace/atict"><li itemprop="breadcrumb" itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb"> <a href="../documentation-center.html" itemprop="url"> <span itemprop="title">All Products</span></a></li></ul><ul class="nav_disambiguation" xmlns:atict="http://www.arbortext.com/namespace/atict"><li class="product"><a href="index.html">Flexible Statistics and Data Analysis (FSDA)</a><div class="dropdown"> <span id="dropdownMenu1" class="icon-arrow-down icon_16" data-toggle="dropdown"> </span><ul aria-labelledby="dropdownMenu1" class="dropdown-menu dropdown-menu-right" role="menu"><li role="presentation"> <a href="examples.html" role="menuitem" tabindex="-1">Examples</a></li><li role="presentation"> <a href="function-alpha.html" role="menuitem" tabindex="-1"> Functions and Other Reference</a></li><li role="presentation"> <a href="release_notes.html?s_cid=doc_flyout" role="menuitem" tabindex="-1"> Release Notes</a></li><li role="presentation"> <a href="tutorials.html" role="menuitem" tabindex="-1"> Tutorials</a></li></ul></div></li></ul><ul xmlns:atict="http://www.arbortext.com/namespace/atict" class="nav_disambiguation"> <li><a href="index.html">Flexible Statistics and Data Analysis Toolbox</a> </li> <li><a href="function-cate.html" itemprop="url">Functions</a></li></ul><!-- --><ul class="nav_scrollspy nav" xmlns:atict="http://www.arbortext.com/namespace/atict">  <li class="nav_scrollspy_function"> <a href="#responsive_offcanvas">simulateTS</a></li> <li id="SSPY810-refentry" class="nav_scrollspy_title">On this page</li><li><a class="intrnllnk" href="#syntax">Syntax</a></li><li><a class="intrnllnk" href="#Description">Description</a></li><li><a class="intrnllnk" href="#Examples">Examples</a><ul><li><a class="intrnllnk" href="#Example_1">Simulated time series with linear trend.</a></li><li><a class="intrnllnk" href="#Example_2">Same as above, but without homogenizing the y-scale.</a></li></ul></li><li><a class="intrnllnk" href="#ExtraExamples">Extra Examples</a><ul><li><a class="intrnllnk" href="#ExtraExample_1">Simulated time series with a linear time varying seasonal component.</a></li><li><a class="intrnllnk" href="#ExtraExample_2">Simulated time series with a quadratic time varying seasonal component.</a></li><li><a class="intrnllnk" href="#ExtraExample_3">Simulated time series with quadratic trend, fixed seasonal and level shift.</a></li><li><a class="intrnllnk" href="#ExtraExample_4">Simulated time series with quadratic trend, fixed seasonal and LS.</a></li><li><a class="intrnllnk" href="#ExtraExample_5">Simulated time series with quadratic trend, fixed seasonal, LS and
     two explanatory variables.</a></li><li><a class="intrnllnk" href="#ExtraExample_6">Example of the use of option FileNameOutput.</a></li><li><a class="intrnllnk" href="#ExtraExample_7">Example of the use of option StartDate.</a></li><li><a class="intrnllnk" href="#ExtraExample_8">Example of the use of option samescale.</a></li><li><a class="intrnllnk" href="#ExtraExample_9">Simulated data with linear trend and errors with AR(2) component.</a></li><li><a class="intrnllnk" href="#ExtraExample_10">Example of simulation and fitting.</a></li></ul></li><li><a class="intrnllnk" href="#Inputs">Input Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_T">T</a></li></ul></li><li><a class="intrnllnk" href="#NameValuePairs">Name-Value Pair Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_namevalue_model">model</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_plots">plots</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_StartDate">StartDate</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_nocheck">nocheck</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_FileNameOutput">FileNameOutput</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_samescale">samescale</a></li></ul></li><li><a class="intrnllnk" href="#OutputArgs">Output Arguments</a><ul><li><a class="intrnllnk" href="#output_argument_out">out</a></li></ul></li><li><a class="intrnllnk" href="#References">References</a></li><li><a class="intrnllnk" href="#SeeAlso">See Also</a></li></ul></nav><script src="../includes/product/scripts/offcanvas.js"></script></div><div id="divtop"></div><div class="site_container site_toc_closed"><div class="page_container"><div class="content_frame"><div id="content_container" class="content_container"><section id="doc_center_content"><div class="function_ref"><div itemprop="content"><h1 itemprop="title">simulateTS</h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose">Simulate a time series with trend, time varying seasonal, level shift and irregular component</p><div class="switch"><a id="expandAllPage" href="javascript:void(0);">expand all in page</a></div></div></div></div><div class="ref_sect"><h2 id="syntax">Syntax</h2><div class="syntax_signature"><div class="syntax_signature_module"><ul><li><code class="synopsis">out=simulateTS(T)</code><span class="syntax_example"><a class="intrnllnk" href="simulateTS.html#Example_1">example</a></span></li><li><code class="synopsis">out=simulateTS(T,Name,Value)</code><span class="syntax_example"><a class="intrnllnk" href="simulateTS.html#Example_2">example</a></span></li></ul></div></div></div>	<div class="ref_sect" itemprop="content">							<h2 id="Description">Description</h2>							<div class="descriptions">								<div class="description_module"><p>simulateTS simulates a time series with trend (up to third order),
 seasonality (constant or of varying amplitude) with a different number of
 harmonics and a level shift. Moreover, it is possible to add to the
 series the effect of explanatory variables.</p><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="simulateTS.html#Example_1">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_out"><code>out</code></a>=simulateTS(<a class="intrnllnk" href="#inputarg_T"><code>T</code></a>)</code></span>Simulated time series with linear trend.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="simulateTS.html#Example_2">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_out"><code>out</code></a>=simulateTS(<a class="intrnllnk" href="#inputarg_T"><code>T</code></a>,<a class="intrnllnk" href="#namevaluepairarguments"><code>Name, Value</code></a>)</code></span>Same as above, but without homogenizing the y-scale.</p></div>								</div>							</div>							<div class="clear">							</div>						</div><div class="ref_sect" itemprop="content"><div class="examples"><h2 id="Examples">Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="example_1" class="example_module expandableContent"><div id="Example_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Simulated time series with linear trend.</li></span></a></span></h3><div class="collapse"><p>
     A time series of 100 observations is simulated from a model which
     contains a linear trend (with slope 1 and intercept 0), no seasonal
     component, no explanatory variables and a signal to noise ratio egual
     to 20<div class="programlisting"><div class="codeinput"><pre class="matlab-code">out=simulateTS(100,'plots',1);</pre></div></div><a href='http://rosa.unipr.it/fsda/simulateTS.html#Example_1'><img vspace="5" hspace="5" src="images\simulateTS_01.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website). Graphical output could not be included in the installation file because toolboxes cannot be greater than 20MB. To load locally the image files, download zip file http://rosa.unipr.it/fsda/images.zip and unzip it to <tt>(docroot)/FSDA/images</tt> or simply run routine <tt>downloadGraphicalOutput.m</tt>"> </a></p></div></div><div id="example_2" class="example_module expandableContent"><div id="Example_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>Same as above, but without homogenizing the y-scale.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">close;
out=simulateTS(100,'plots',1,'samescale',false);</pre></div></div></p></div></div></div><p> </p><div class="examples"><h2 id="ExtraExamples" class="bottom_ruled">Related Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="Extraexample_1" class="example_module expandableContent"><div id="ExtraExample_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Simulated time series with a linear time varying seasonal component.</li></span></a></span></h3><div class="collapse"><p>
     A time series of 100 observations is simulated from a model which
     contains no trend, a linear time varying seasonal component with
     three harmonics, no explanatory variables and a signal to noise ratio
     egual to 20<div class="programlisting"><div class="codeinput"><pre class="matlab-code">rng(1)
model=struct;
model.trend=[];
model.trendb=[];
model.seasonal=103;
model.seasonalb=40*[0.1 -0.5 0.2 -0.3 0.3 -0.1 0.222];
model.signal2noiseratio=20;
T=100;
out=simulateTS(T,'model',model,'plots',1);</pre></div></div><a href='http://rosa.unipr.it/fsda/simulateTS.html#ExtraExample_1'><img vspace="5" hspace="5" src="images\simulateTS_02.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website)"> </a></p></div></div><div id="Extraexample_2" class="example_module expandableContent"><div id="ExtraExample_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Simulated time series with a quadratic time varying seasonal component.</li></span></a></span></h3><div class="collapse"><p>
     A time series of 100 observations is simulated from a model which
     contains no trend, a quadratic time varying seasonal component with
     one harmonic, no explanatory variables and a signal to noise ratio
     egual to 20<div class="programlisting"><div class="codeinput"><pre class="matlab-code">rng(1)
model=struct;
model.trend=[];
model.trendb=[];
model.seasonal=201;
model.seasonalb=40*[0.1 -0.5 10.222 -10];
model.signal2noiseratio=20;
T=100;
out=simulateTS(T,'model',model,'plots',1);</pre></div></div><a href='http://rosa.unipr.it/fsda/simulateTS.html#ExtraExample_2'><img vspace="5" hspace="5" src="images\simulateTS_03.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website)"> </a></p></div></div><div id="Extraexample_3" class="example_module expandableContent"><div id="ExtraExample_3"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Simulated time series with quadratic trend, fixed seasonal and level shift.</li></span></a></span></h3><div class="collapse"><p>
     A time series of 100 observations is simulated from a model which
     contains a quadratic trend, a seasonal component with two harmonics
     no explanatory variables and a level shift in position 30 with size
     5000 and a signal to noise ratio egual to 20<div class="programlisting"><div class="codeinput"><pre class="matlab-code">rng(1)
model=struct;
model.trend=2;
model.trendb=[5,10,-3];
model.seasonal=2;
model.seasonalb=100*[2 4 0.1 8];
model.signal2noiseratio=20;
model.lshift=30;
model.lshiftb=5000;
T=100;
out=simulateTS(T,'model',model,'plots',1);</pre></div></div><a href='http://rosa.unipr.it/fsda/simulateTS.html#ExtraExample_3'><img vspace="5" hspace="5" src="images\simulateTS_04.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website)"> </a></p></div></div><div id="Extraexample_4" class="example_module expandableContent"><div id="ExtraExample_4"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Simulated time series with quadratic trend, fixed seasonal and LS.</li></span></a></span></h3><div class="collapse"><p>
     A time series of 100 observations is simulated from a model
     which contains a quadratic trend, a linear time varying seasonal
     component with two harmonics no explanatory variables and a level
     shift in position 30 with size -10000 and a signal to noise ratio
     egual to 20<div class="programlisting"><div class="codeinput"><pre class="matlab-code">rng(1)
model=struct;
model.trend=2;
model.trendb=[5,10,-3];
model.seasonal=102;
model.seasonalb=100*[2 4 0.1 8 0.001];
model.signal2noiseratio=20;
model.lshift=30;
model.lshiftb=-10000;
T=100;
out=simulateTS(T,'model',model,'plots',1);</pre></div></div><a href='http://rosa.unipr.it/fsda/simulateTS.html#ExtraExample_4'><img vspace="5" hspace="5" src="images\simulateTS_05.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website)"> </a></p></div></div><div id="Extraexample_5" class="example_module expandableContent"><div id="ExtraExample_5"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Simulated time series with quadratic trend, fixed seasonal, LS and
     two explanatory variables.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">% A time series of 100 observations is simulated from a model
% which contains a quadratic trend, a linear time varying seasonal
% component with two harmonics, two explanatory variables and a level
% shift in position 30 with size -40000 and a signal to noise ratio
% egual to 10
rng(1)
model=struct;
model.trend=2;
model.trendb=[5,10,-3];
model.seasonal=102;
model.seasonalb=100*[2 4 0.1 8 0.001];
model.signal2noiseratio=10;
model.lshift=30;
model.lshiftb=-40000;
model.X=2;
model.Xb=[10000 20000];
T=100;
out=simulateTS(T,'model',model,'plots',1);</pre></div></div><a href='http://rosa.unipr.it/fsda/simulateTS.html#ExtraExample_5'><img vspace="5" hspace="5" src="images\simulateTS_06.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website)"> </a></p></div></div><div id="Extraexample_6" class="example_module expandableContent"><div id="ExtraExample_6"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Example of the use of option FileNameOutput.</li></span></a></span></h3><div class="collapse"><p>
     In this example the simulated time series is saved into a file named
     ysimout.txt in the current folder<div class="programlisting"><div class="codeinput"><pre class="matlab-code">FileNameOutput=[pwd filesep 'ysimout.txt'];
out=simulateTS(T,'FileNameOutput',FileNameOutput);</pre></div></div></p></div></div><div id="Extraexample_7" class="example_module expandableContent"><div id="ExtraExample_7"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Example of the use of option StartDate.</li></span></a></span></h3><div class="collapse"><p>
     Suppose that the inital observation refers to February 2016.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">StartDate=[2016 2];
% The x axis of the plots contains the dates using format mmm-yyyy
out=simulateTS(T,'model',model,'plots',1,'StartDate',StartDate);</pre></div></div><a href='http://rosa.unipr.it/fsda/simulateTS.html#ExtraExample_7'><img vspace="5" hspace="5" src="images\simulateTS_07.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website)"> </a></p></div></div><div id="Extraexample_8" class="example_module expandableContent"><div id="ExtraExample_8"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Example of the use of option samescale.</li></span></a></span></h3><div class="collapse"><p>
     Use a different scale for each panel in the output plot.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">out=simulateTS(T,'model',model,'plots',1,'samescale',false);</pre></div></div></p></div></div><div id="Extraexample_9" class="example_module expandableContent"><div id="ExtraExample_9"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Simulated data with linear trend and errors with AR(2) component.</li></span></a></span></h3><div class="collapse"><p>
     No seasonal component.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">rng(100)
model=struct;
model.trend=1;
model.trendb=[5,1000];
model.seasonal='';
model.signal2noiseratio=10;
model.ARb=[0.2 0.7];
T=100;
out=simulateTS(T,'model',model,'plots',1);
y=out.y;
% The lines below just work if the econometric toolbox is present
% The autocorrelation function of y shows just two peaks in
% correspondence of the first two lags
figure
parcorr(out.y)</pre></div></div></p></div></div><div id="Extraexample_10" class="example_module expandableContent"><div id="ExtraExample_10"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Example of simulation and fitting.</li></span></a></span></h3><div class="collapse"><p>
     Simulated data with linear trend, errors with AR(2) component and 1
     explanatory variable.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">rng(100)
model=struct;
model.trend=1;
model.trendb=[5,1000];
model.seasonal='';
model.signal2noiseratio=10;
model.ARb=[0.2 0.7];
T=100;
X=1e+2*randn(T,1);
model.X=X;
model.Xb=100;
out=simulateTS(T,'model',model,'plots',1);
y=out.y;
% Fit a model with linear trend, AR(3) and the true expl. variable  
model=struct;
model.trend=1;
model.seasonal=0;
model.lshift=0;
model.X=X;
model.ARp=3;
out=LTSts(y,'model',model,'plots',1,'dispresults',true);</pre></div></div></p></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="Inputs">Input Arguments</h2><div class="expandableContent"><div class="arguments"><div class="input_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"> <div id="inputarg_T" class="clearfix"> </div> <h3 id="input_argument_T" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>T</code> &#8212; time series length. </span>  </a><span class="example_desc">Scalar.</span></span></h3> <div class="collapse"> <p>T is a positive integer
               which defines the length of the simulated time series.</p> <p class="datatypelist"><strong> Data Types: </strong><code>single| double</code></p> </div> </div><div id="namevaluepairarguments" class="clearfix"></div><h3 id="NameValuePairs" class="bottom_ruled">Name-Value Pair Arguments</h3><div class="namevaluecontainer"><p>Specify optional comma-separated pairs of <code>Name,Value</code> arguments. <code>Name</code> is the argument name and <code>Value</code> is the corresponding value. <code>Name</code> must appear  inside single quotes (<code>' '</code>).  You can specify several name and value pair arguments in any order as <code>  Name1,Value1,...,NameN,ValueN</code>.</p>  <span class="example_desc"><strong>Example:</strong><code><code> 'model', model
</code>,<code> 'plots',1
</code>,<code> 'StartDate',[2016,3]
</code>,<code> 'nocheck',false
</code>,<code> 'FileNameOutput',['C:' filesep 'myoutput' fielsep 'savesimdata.txt']
</code>,<code> 'samescale',false
</code></code></span></div><div class="expandableContent"><div id="inputarg_model" class="clearfix"></div><h3 id="input_argument_namevalue_model" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>model</code> &#8212;model type.</span></a><span class="example_desc">structure.</span></span></h3><div class="collapse">	<p><p>A structure which specifies the model
               used to simulate the time series. The structure contains
               the following fields:</p> <p>
       </p><table border="2" cellpadding="4" cellspacing="0" class="body"><colgroup><col width="20%"><col width="80%"></colgroup><thead><tr valign="top"><th valign="top">Value</th><th valign="top">Description</th></tr></thead><tr valign="top"><td><code>trend</code></td><td><p><p>scalar (order of the trend component).</p> <p>
                       trend = 1 implies linear trend with intercept,
                       trend = 2 implies quadratic trend, etc.</p><p>
                       If this field is empty the simulated time series
                       will not contain a trend. The default value
                       of model.trend is 1.</p></p></td></tr><tr valign="top"><td><code>trendb</code></td><td><p><p>vector of doubles containining the beta
                       coefficients for the trend. For example model.trend=1
                       and model.trendb=[3.2 2] generate a linear trend
                       of the kind 3.2+2*t.</p> <p>
                       If this field is an empty double the simulated time
                       series will not contain a trend. The default value
                       of model.trendb is [0 1] that is a slope equal to 1
                       and intercept equal to 0.</p></p></td></tr><tr valign="top"><td><code>s</code></td><td><p><p>scalar greater than zero which specifies the
                       length of the seasonal period. For monthly
                       data (default) s=12, for quartely data s=4, ...</p> <p>
                       The default value of model.s is 12 (that is monthly
                       data are assumed)</p></p></td></tr><tr valign="top"><td><code>seasonal</code></td><td><p><p>scalar (integer specifying number of
                        frequencies, i.e. harmonics, in the seasonal
                        component. Possible values for seasonal are
                        $1, 2, ..., [s/2]$, where $[s/2]=floor(s/2)$.</p> <p>
                        For example:</p> <p>
                        if seasonal = 1 (default) we have:</p> <p>
                        $\beta_1 \cos( 2 \pi t/s) + \beta_2 sin ( 2 \pi t/s)$;</p> <p>
                        if seasonal = 2 we have:</p> <p>
                        $\beta_1 \cos( 2 \pi t/s) + \beta_2 \sin ( 2 \pi t/s)
                        + \beta_3 \cos(4 \pi t/s) + \beta_4 \sin (4 \pi t/s)$.</p> <p>
                        Note that when $s$ is even the sine term disappears
                        for $j=s/2$ and so the maximum number of
                        trigonometric parameters is $s-1$.</p> <p>
                        If seasonal is a number greater than 100 then it
                        is possible to specify how the seasonal component
                        grows over time.</p> <p>
                        For example, seasonal = 101 implies a seasonal
                        component which just uses one frequency
                        which grows linearly over time as follows:</p> <p>
                        $(1+\beta_3 t)\times ( \beta_1 cos( 2 \pi t/s) +
                        \beta_2 \sin ( 2 \pi t/s))$.</p> <p>
                        For example, seasonal = 201 implies a seasonal
                        component which just uses one frequency
                        which grows in a quadratic way over time as
                        follows:</p> <p>
                        $(1+\beta_3 t + \beta_4  t^2)\times( \beta_1 \cos(
                        2 \pi t/s) + \beta_2 \sin ( 2 \pi t/s))$.</p><p>
                       If this field is an empty double (default) the
                       simulated time series will not contain a seasonal
                       component.</p></p></td></tr><tr valign="top"><td><code>seasonalb</code></td><td><p><p>vector of doubles containing the beta
                       coefficients for the seasonal component.</p> <p>
                       For example model.seasonal = 201 and model
                       model.trendb = [1.2 2.3 3.4 4.5] generates a
                       seasonal component of the kind:</p> <p>
                        $(1+ 3.4 t + 4.5  t^2)\times( 1.2 \cos(
                        2 \pi t/s) + 2.3 \sin ( 2 \pi t/s))$.</p><p>
                       If this field is an empty double (default) the
                       simulated time series will not contain a seasonal
                       component.</p></p></td></tr><tr valign="top"><td><code>X</code></td><td><p><p>scalar or matrix of size T-by-nexpl. If model.X
                       is a matrix of size T-by-nexpl, it contains the
                       values of nexpl extra covariates which
                       affect y. If model.X is a scalar equal to k,
                       where k=1, 2, ... k explanatory variables using
                       random numbers from the normal distribution are
                       generated.</p> <p>
                       If this field is an empty double (default) the
                       simulated time series will not be affected by
                       explanatory variables.</p></p></td></tr><tr valign="top"><td><code>Xb</code></td><td><p><p>vector of doubles containing the beta
                       coefficients for the explanatory variables.</p> <p>
                       For example model.X = 2 and model.Xb = [4,5]
                       generate two additional explanatory variables
                       of the kind: $ 4*randn(T,1) + 5*randn(T,1) $.</p><p>
                       If this field is an empty double (default) the
                       simulated time series will not contain explanatory
                       variables.</p></p></td></tr><tr valign="top"><td><code>ARb</code></td><td><p><p>vector of doubles containing the beta
                       coefficients for the autoregressive component.</p> <p>
                       For example model.ARb = [0.5 -0.2]
                       generates an AR(2) time series of the
                       kind: $y_t=0.5 y_{t-1} -0.2 y_{t-2}$ + seasonal + lshift + $\epsilon_t$.</p><p>
                       If this field is an empty double (default) the
                       simulated time series will not have an
                       autoregressive component.</p></p></td></tr><tr valign="top"><td><code>lshift</code></td><td><p><p>scalar greater than 0 which specifies the
                       position where to include a level shift component.</p> <p>
                       If this field is an empty double (default) the
                       simulated time series will not contain a level shift.</p></p></td></tr><tr valign="top"><td><code>lshiftb</code></td><td><p><p>scalar double which specifies the magnitude
                       of the level shift component.</p> <p>
                       For example model.lshift = 26 and model.lshiftb = 3
                       generates the following explanatory variable
                        $ [zeros(25,1) + 3*ones(T-25+1,1)] $.</p><p>
                       If this field is an empty double (default) the
                       simulated time series will not contain a level
                       shift.</p></p></td></tr><tr valign="top"><td><code>signal2noiseratio</code></td><td><p><p>scalar wich defines the ratio
                       between the variance of the systematic part of the
                       model (signal) and the variance of the noise
                       (irregular model). The greater is this value, the
                       smaller is the effect of the irregular component.</p> <p>
                       If this field is empty or not present the default
                       value of 1 is used.</p> <p>
                                Remark: the default model is for monthly data with a linear
               trend with slope 1 and intercept 0, no seasonal, no
               level shift and a signal to noise ratio equal to 1, that is
                               model=struct;</p> <p>
                               model.s=[];</p> <p>
                               model.trend=1;</p> <p>
                               model.trendb=[0 1];</p> <p>
                               model.X=[];</p> <p>
                               model.lshift=[];</p><p>
                               model.signal2noiseratio=1;</p></p></td></tr></table></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'model', model
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>struct</code></p></div></div><div class="expandableContent"><div id="inputarg_plots" class="clearfix"></div><h3 id="input_argument_namevalue_plots" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>plots</code> &#8212;Plots on the screen.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>If plots == 1 a six panel plot appears on the screen.</p> <p>
               Top left panel contains the simulated time series y.</p> <p>
               y=TR+SE+X+LS+I.</p> <p>
               Top central panel contains the signal component (that is
               trend + seasonal + explanatory variables + level shift = TR
               + SE + LS + X).</p> <p>
               Top right panel contains the trend component (TR).</p> <p>
               Bottom left panel contains the (time varying) seasonal
               component (SE).</p> <p>
               Bottom central panel contains the level shift component
               (LS).</p> <p>
               Bottom right panel contains the explanatory variable component
               (X) if it is present, otherwise, it contains the irregular
               (I) component.</p> <p>
               The default value of plot is 0, that is no plot is shown on
               the screen.</p><p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'plots',1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_StartDate" class="clearfix"></div><h3 id="input_argument_namevalue_StartDate" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>StartDate</code> &#8212;The time of the first observation.</span></a><span class="example_desc">numeric vector of length 2.</span></span></h3><div class="collapse">	<p><p>Vector with two integers, which
               specify a natural time unit and a (1-based) number of
               samples into the time unit. For example, if model.s=12
               (that is the data are monthly) and the first observation
               starts in March 2016, then StartDate=[2016,3]; Similarly,
               if models.s=4 (that is the data are quarterly) and the first
               observation starts in the second quarter or year 2014, then
               StartData=[2014,2]. The information in option StartDate
               will be used to create in the output the dates inside the
               time series object.</p> <p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'StartDate',[2016,3]
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_nocheck" class="clearfix"></div><h3 id="input_argument_namevalue_nocheck" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>nocheck</code> &#8212;Check input arguments.</span></a><span class="example_desc">boolean.</span></span></h3><div class="collapse">	<p><p>If nocheck is true no
               check is performed on supplied input. Otherwise (default)
               every input of the structure model is checked.</p> <p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'nocheck',false
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_FileNameOutput" class="clearfix"></div><h3 id="input_argument_namevalue_FileNameOutput" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>FileNameOutput</code> &#8212;save simulated time series to txt file.</span></a><span class="example_desc">character.</span></span></h3><div class="collapse">	<p><p>If FileNameOutput is empty (default) nothing is saved on
               the disk, else FileNameOutput will contain the path where
               to save the file on the disk.</p> <p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'FileNameOutput',['C:' filesep 'myoutput' fielsep 'savesimdata.txt']
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>Character</code></p></div></div><div class="expandableContent"><div id="inputarg_samescale" class="clearfix"></div><h3 id="input_argument_namevalue_samescale" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>samescale</code> &#8212;same ylim  in the output plot.</span></a><span class="example_desc">logical.</span></span></h3><div class="collapse">	<p><p>If true (default), all underlying components of the time
               series are shown in the plot with the same scale.</p> <p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'samescale',false
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>logical</code></p></div></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="OutputArgs" >Output Arguments</h2><div class="expandableContent"><div class="arguments"><div class="output_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"><div id="outputarg_out" class="clearfix"></div><h3 id="output_argument_out" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>out</code> &#8212; description</span></a><span class="example_desc">Structure</span></span></h3><div class="collapse"><p><p>structure which contains the following fields:</p> <p>

        </p><table border="2" cellpadding="4" cellspacing="0" class="body"><colgroup><col width="20%"><col width="80%"></colgroup><thead><tr valign="top"><th valign="top">Value</th><th valign="top">Description</th></tr></thead><tr valign="top"><td><code>y</code></td><td><p><p>the simulated time series.</p> <p>
                   Column vector of length T, which is sum of trend +
                   (time varying) seasonal + explanatory variables + level
                   shift + irregular = TR+SE+X+LS+I.</p></p></td></tr><tr valign="top"><td><code>signal</code></td><td><p><p>signal (TR+SE+X+LS).</p> <p>
                   Column vector of length T, which is sum of trend +
                   (time varying) seasonal + explanatory variables + level
                   shift. Signal = out.y - out.irregular.</p></p></td></tr><tr valign="top"><td><code>trend</code></td><td><p><p>trend (TR).</p> <p>
                   Column vector of length T which contains the trend
                   component.</p></p></td></tr><tr valign="top"><td><code>seasonal</code></td><td><p><p>(time varying) seasonal (SE).</p> <p>
                   Column vector of length T which contains the seasonal
                   component. If there is no seasonal component
                   outyhatseaso=0.</p></p></td></tr><tr valign="top"><td><code>X</code></td><td><p><p>explanatory variables (X).</p> <p>
                   Column vector of length T which contains the component
                   associated to the explanatory variables.</p><p>
                   If there is no explanatory variable, out.X=0.</p></p></td></tr><tr valign="top"><td><code>lshift</code></td><td><p><p>level shift (LS).</p> <p>
                   Column vector of length T which contains the level
                   shift component.</p><p>
                   If there is no level shift component out.lshift=0.</p></p></td></tr><tr valign="top"><td><code>irregular</code></td><td><p><p>irregular component (I).</p> <p>
                   Column vector of length T which contains the irregular
                   component.</p><p>
                   When the signal to noise ratio tends to infinity the
                   irregular component tends to 0.</p></p></td></tr></table></p></div></div></div></div></div></div><div class="ref_sect" itemprop="content"><div class="bibliography"><h2 id="References">References</h2> <div><p>Rousseeuw, P.J., Perrotta D., Riani M. and Hubert, M. (2018), Robust
 Monitoring of Many Time Series with Application to Fraud Detection,
 "Econometrics and Statistics". [RPRH]</p></div></div></div><div class="ref_sect"><h2 id="SeeAlso">See Also</h2><p><span itemprop="seealso"><a href="LTSts.html" itemprop="url"><span itemprop="name"><code>LTSts</code></span></a></span> | <span itemprop="seealso"><a href="wedgeplot.html" itemprop="url"><span itemprop="name"><code>wedgeplot</code></span></a></span></div><i>This page has been automatically generated by our routine <a href="publishFS.html">publishFS</a></i></div></section></div></div></div></div><div id="divbottom"></div></body></html>