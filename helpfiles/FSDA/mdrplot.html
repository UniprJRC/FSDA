<!DOCTYPE HTML> <html itemscope="" xmlns="http://www.w3.org/1999/xhtml"><head><title>mdrplot</title><meta content="refpage" name="chunktype"><meta content="function:mdrplot" itemprop="refentity" name="refentity"><meta content="text/javascript" http-equiv="Content-Script-Type"><meta content="fcn" itemprop="pagetype" name="toctype"><meta content="ref/function" itemprop="infotype" name="infotype" /><meta content="mdrplot plots the trajectory of minimum deletion residual (mdr)." itemprop="description" name="description" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" /><script type="text/x-mathjax-config">MathJax.Hub.Config({extensions: ["tex2jax.js"],jax: ["input/TeX","output/HTML-CSS"],menuSettings: {zoom: "Double-Click", zscale: "300"},tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},MathMenu: {showRenderer: false},"HTML-CSS": {availableFonts: ["TeX"],preferredFont: "TeX",imageFont: null}});</script><script type="text/javascript" src="includesFS/Mathjax/MathJax.js"></script><script src="includesFS/matlab-highlighter.min.js"></script><link href="includesFS/matlab-highlighter.css" rel="stylesheet" type="text/css"><script type="text/javascript" src="includesFS/jquery-latest.js"></script><script>$(document).ready(function(){      $("#divtop").load("includesFS/top.html");      $("#divbottom").load("includesFS/bottom.html");});</script><link href="../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)"></link><link href="../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)"></link><link href="../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)"></link><link href="../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)"></link><link href="../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)"></link><link href="../includes/product/css/site6_offcanvas.css" rel="stylesheet" type="text/css"></link><script src="../includes/shared/scripts/l10n.js" type="text/javascript"></script><script src="../includes/product/scripts/docscripts.js"></script><script src="../includes/shared/scripts/docscripts_rn.js"></script><script src="../includes/shared/scripts/mw.imageanimation.js" type="text/javascript"></script><script src="../includes/shared/scripts/jquery.highlight.js"></script><script src="../includes/product/scripts/bootstrap.min.js" type="text/javascript"></script><script src="../includes/product/scripts/global.js"></script><script src="includesFS/bottom.js" type="text/javascript"></script><script src="../includes/product/scripts/underscore-min.js"></script><script src="../includes/shared/scripts/f1help.js" type="text/javascript"></script><script src="../includes/product/scripts/suggest.js" type="text/javascript"></script><script src="../includes/shared/scripts/helpservices.js" type="text/javascript"></script><script src="../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script><!-- the following line should be kept this way only --><link href="includesFS/doc_center.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css"><link href="../includes/product/css/doc_center_print.css" media="print" rel="stylesheet" type="text/css"></head><body  onload="highlightMATLABCode();" id="responsive_offcanvas">  <div id="doc_header_spacer" class="header"></div><div class="sticky_header_container includes_subnav"><div class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-xs-12 col-sm-6 col-sm-push-6 col-md-5 col-md-push-7" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2017a" data-language="en" action="../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="sr-only">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"><div class="input-group-btn"><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search pull-right icon_32 visible-xs" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="col-sm-6 col-sm-pull-6 col-md-7 col-md-pull-5" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../documentation-center.html">Documentation</a></h1></div></div></div><div class="visible-xs" id="search_actuator"><button class="btn icon-search btn_search pull-right icon_16" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div><!--END.CLASS row--> </div><!--END.CLASS container-fluid--> </div><!--END.CLASS section_header level_3--><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_actuator" data-toggle="offcanvas" data-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="sr-only">Toggle navigation</span><span class="icon-menu icon_24"></span></button><span class="offcanvas_actuator_label"></span><span class="offcanvas_actuator_close"></span> </div><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-md-12 hidden-xs hidden-sm"></div></div></div></div></div></div></div><!--END.CLASS sticky_header_container--><div class="row-offcanvas row-offcanvas-left"><div id="sidebar" class="sidebar-offcanvas" role="navigation"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" xmlns:atict="http://www.arbortext.com/namespace/atict"><li itemprop="breadcrumb" itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb"> <a href="../documentation-center.html" itemprop="url"> <span itemprop="title">All Products</span></a></li></ul><ul class="nav_disambiguation" xmlns:atict="http://www.arbortext.com/namespace/atict"><li class="product"><a href="index.html">Flexible Statistics and Data Analysis (FSDA)</a><div class="dropdown"> <span id="dropdownMenu1" class="icon-arrow-down icon_16" data-toggle="dropdown"> </span><ul aria-labelledby="dropdownMenu1" class="dropdown-menu dropdown-menu-right" role="menu"><li role="presentation"> <a href="examples.html" role="menuitem" tabindex="-1">Examples</a></li><li role="presentation"> <a href="function-alpha.html" role="menuitem" tabindex="-1"> Functions and Other Reference</a></li><li role="presentation"> <a href="release_notes.html?s_cid=doc_flyout" role="menuitem" tabindex="-1"> Release Notes</a></li><li role="presentation"> <a href="tutorials.html" role="menuitem" tabindex="-1"> Tutorials</a></li></ul></div></li></ul><ul xmlns:atict="http://www.arbortext.com/namespace/atict" class="nav_disambiguation"> <li><a href="index.html">Flexible Statistics and Data Analysis Toolbox</a> </li> <li><a href="function-cate.html" itemprop="url">Functions</a></li></ul><!-- --><ul class="nav_scrollspy nav" xmlns:atict="http://www.arbortext.com/namespace/atict">  <li class="nav_scrollspy_function"> <a href="#responsive_offcanvas">mdrplot</a></li> <li id="SSPY810-refentry" class="nav_scrollspy_title">On this page</li><li><a class="intrnllnk" href="#syntax">Syntax</a></li><li><a class="intrnllnk" href="#Description">Description</a></li><li><a class="intrnllnk" href="#Examples">Examples</a><ul><li><a class="intrnllnk" href="#Example_1">Example of the use of function mdrplot with all the default options.</a></li><li><a class="intrnllnk" href="#Example_2">Example of the use of function mdrplot with personalized envelopes.</a></li><li><a class="intrnllnk" href="#Example_3">datatooltip passed as scalar.</a></li></ul></li><li><a class="intrnllnk" href="#ExtraExamples">Extra Examples</a><ul><li><a class="intrnllnk" href="#ExtraExample_1">Datatooltip passed as structure.</a></li><li><a class="intrnllnk" href="#ExtraExample_2">Use of option sign.</a></li><li><a class="intrnllnk" href="#ExtraExample_3">Example of the use of option envm.</a></li><li><a class="intrnllnk" href="#ExtraExample_4">Example of the use of option ncoord.</a></li><li><a class="intrnllnk" href="#ExtraExample_5"><i>Interactive example 1.</i>
     Input option databrush passed as scalar.</a></li><li><a class="intrnllnk" href="#ExtraExample_6"><i>Interactive example 2.</i>
     Input option databrush passed as structure.</a></li><li><a class="intrnllnk" href="#ExtraExample_7"><i>Interactive example 3.</i>
     Input option databrush passed as structure and brush mode.</a></li><li><a class="intrnllnk" href="#ExtraExample_8"><i>Interactive example 4.</i>
     Persistent cumulative brush 1.</a></li><li><a class="intrnllnk" href="#ExtraExample_9"><i>Interactive example 5.</i>
     Persistent cumulative brush 2.</a></li></ul></li><li><a class="intrnllnk" href="#Inputs">Input Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_out">out</a></li></ul></li><li><a class="intrnllnk" href="#NameValuePairs">Name-Value Pair Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_namevalue_quant">quant</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_sign">sign</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_mplus1">mplus1</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_envm">envm</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_xlimx">xlimx</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_ylimy">ylimy</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_lwdenv">lwdenv</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_ncoord">ncoord</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_tag">tag</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_datatooltip">datatooltip</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_label">label</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_databrush">databrush</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_FontSize">FontSize</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_SizeAxesNum">SizeAxesNum</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_nameX">nameX</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_namey">namey</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_lwd">lwd</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_titl">titl</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_labx">labx</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_laby">laby</a></li></ul></li><li><a class="intrnllnk" href="#OutputArgs">Output Arguments</a><ul><li><a class="intrnllnk" href="#output_argument_brushedUnits">brushedUnits</a></li><li><a class="intrnllnk" href="#output_argument_BrushedUnits">BrushedUnits</a></li></ul></li><li><a class="intrnllnk" href="#References">References</a></li><li><a class="intrnllnk" href="#SeeAlso">See Also</a></li></ul></nav><script src="../includes/product/scripts/offcanvas.js"></script></div><div id="divtop"></div><div class="site_container site_toc_closed"><div class="page_container"><div class="content_frame"><div id="content_container" class="content_container"><section id="doc_center_content"><div class="function_ref"><div itemprop="content"><h1 itemprop="title">mdrplot</h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose">mdrplot plots the trajectory of minimum deletion residual (mdr)</p><div class="switch"><a id="expandAllPage" href="javascript:void(0);">expand all in page</a></div></div></div></div><div class="ref_sect"><h2 id="syntax">Syntax</h2><div class="syntax_signature"><div class="syntax_signature_module"><ul><li><code class="synopsis">brushedUnits=mdrplot(out)</code><span class="syntax_example"><a class="intrnllnk" href="mdrplot.html#Example_1">example</a></span></li><li><code class="synopsis">brushedUnits=mdrplot(out,Name,Value)</code><span class="syntax_example"><a class="intrnllnk" href="mdrplot.html#Example_2">example</a></span></li><li><code class="synopsis">[brushedUnits, BrushedUnits]=mdrplot(___)</code><span class="syntax_example"><a class="intrnllnk" href="mdrplot.html#Example_3">example</a></span></li></ul></div></div></div>	<div class="ref_sect" itemprop="content">							<h2 id="Description">Description</h2>							<div class="descriptions">								<div class="description_module"><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="mdrplot.html#Example_1">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_brushedUnits"><code>brushedUnits</code></a>=mdrplot(<a class="intrnllnk" href="#inputarg_out"><code>out</code></a>)</code></span>Example of the use of function mdrplot with all the default options.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="mdrplot.html#Example_2">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_brushedUnits"><code>brushedUnits</code></a>=mdrplot(<a class="intrnllnk" href="#inputarg_out"><code>out</code></a>,<a class="intrnllnk" href="#namevaluepairarguments"><code>Name, Value</code></a>)</code></span>Example of the use of function mdrplot with personalized envelopes.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="mdrplot.html#Example_3">	example</a></p>	<p><span itemprop="syntax"><code>[<a class="intrnllnk" href="#outputarg_brushedUnits"><code>brushedUnits</code></a>,<a class="intrnllnk" href="#outputarg_BrushedUnits"><code> BrushedUnits</code></a>]=mdrplot(___)</code></span>datatooltip passed as scalar.</p></div>								</div>							</div>							<div class="clear">							</div>						</div><div class="ref_sect" itemprop="content"><div class="examples"><h2 id="Examples">Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="example_1" class="example_module expandableContent"><div id="Example_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>Example of the use of function mdrplot with all the default options.</li></span></a></span></h3><div class="collapse"><p>
    Steps common to all the examples<div class="programlisting"><div class="codeinput"><pre class="matlab-code">load('loyalty.txt','loyalty');
y=loyalty(:,4);
X=loyalty(:,1:3);
[outLXS]=LXS(y,X,'nsamp',1000);
[out]=FSReda(y,X,outLXS.bs);
mdrplot(out);</pre></div></div></p></div></div><div id="example_2" class="example_module expandableContent"><div id="Example_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>Example of the use of function mdrplot with personalized envelopes.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">load('loyalty.txt','loyalty');
y=loyalty(:,4);
X=loyalty(:,1:3);
[outLXS]=LXS(y,X,'nsamp',1000);
[out]=FSReda(y,X,outLXS.bs);
mdrplot(out,'quant',[0.99;0.9999]);</pre></div></div></p></div></div><div id="example_3" class="example_module expandableContent"><div id="Example_3"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>datatooltip passed as scalar.</li></span></a></span></h3><div class="collapse"><p>
    Example of the use of function mdrplot with datatooltip passed as
    scalar (that is using default options for datacursor (i.e.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">%DisplayStyle =window)
load('loyalty.txt','loyalty');
y=loyalty(:,4);
X=loyalty(:,1:3);
[outLXS]=LXS(y,X,'nsamp',1000);
[out]=FSReda(y,X,outLXS.bs);
mdrplot(out,'datatooltip',1);</pre></div></div></p></div></div></div><p> </p><div class="examples"><h2 id="ExtraExamples" class="bottom_ruled">Related Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="Extraexample_1" class="example_module expandableContent"><div id="ExtraExample_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Datatooltip passed as structure.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">load('loyalty.txt','loyalty');
y=loyalty(:,4);
X=loyalty(:,1:3);
[outLXS]=LXS(y,X,'nsamp',1000);
[out]=FSReda(y,X,outLXS.bs);
clear tooltip
tooltip.SnapToDataVertex='on'
tooltip.DisplayStyle='datatip'
mdrplot(out,'datatooltip',tooltip);</pre></div></div></p></div></div><div id="Extraexample_2" class="example_module expandableContent"><div id="ExtraExample_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Use of option sign.</li></span></a></span></h3><div class="collapse"><p>
    Example of the information which can be extracted from option sign=1
    (default). If the data come from a distribution which has positive
    asymmetry generally the last part of the search is associated with
    positive values of the minimum residual among the units belonging to
    subset The example below shows that the last 60 steps of the curve are
    associated with a black curve (positive value of mdr)<div class="programlisting"><div class="codeinput"><pre class="matlab-code">state = 137; state1=4567;
rand('state', state);
randn('state', state1);
X=randn(200,3);
y=chi2rnd(8,200,1);
[outLXS]=LXS(y,X,'nsamp',1000);
[out]=FSReda(y,X,outLXS.bs);
mdrplot(out,'sign',1);</pre></div></div></p></div></div><div id="Extraexample_3" class="example_module expandableContent"><div id="ExtraExample_3"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Example of the use of option envm.</li></span></a></span></h3><div class="collapse"><p>
   In this case the resuperimposed envelope is based on n-2 observations<div class="programlisting"><div class="codeinput"><pre class="matlab-code">state = 137; state1=4567;
rand('state', state);
randn('state', state1);
X=randn(200,3);
y=chi2rnd(8,200,1);
[outLXS]=LXS(y,X,'nsamp',1000);
[out]=FSReda(y,X,outLXS.bs);
mdrplot(out,'envm',length(out.y)-2);</pre></div></div></p></div></div><div id="Extraexample_4" class="example_module expandableContent"><div id="ExtraExample_4"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Example of the use of option ncoord.</li></span></a></span></h3><div class="collapse"><p>
     In this example we compare the monitoring residual plot in traditional
     coordinates with that in normal coordinates.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">% load the Hospital data
load('hospitalFS.txt');
y=hospitalFS(:,5);
X=hospitalFS(:,1:4);
% Set initial subset
bs= [ 3   11   20   23   74];
outFS=FSReda(y,X,bs);
p=size(X,2)+1;
quant=[0.01 0.5 0.99 0.999 0.9999];
mdrplot(outFS,'quant',quant,'tag','mdrorigcooed')
title('Monitoring of mdr in traditional coordinates')
% Transform the values of mdr into normal coordinates
[MDRinv] = FSRinvmdr(abs(outFS.mdr),p);
outFS1=outFS;
outFS1.mdr=MDRinv(:,[1 3]);
mdrplot(outFS1,'ncoord',true,'quant',quant,'tag','mdrncoord')
title('Monitoring of mdr in normal coordinates')</pre></div></div><pre class="codeoutput">
ans =

     []


ans =

     []

</pre><a href='http://rosa.unipr.it/fsda/mdrplot.html#ExtraExample_4'><img vspace="5" hspace="5" src="images\mdrplot_01.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website)"> <img vspace="5" hspace="5" src="images\mdrplot_02.png" alt=""> </a></p></div></div><div id="Extraexample_5" class="example_module expandableContent"><div id="ExtraExample_5"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><i>Interactive example 1.</i>
     Input option databrush passed as scalar.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">%Example of the use of function mdrplot with databrush
state = 137; state1=4567;
rand('state', state);
randn('state', state1);
X=randn(200,3);
y=chi2rnd(8,200,1);
[outLXS]=LXS(y,X,'nsamp',1000);
[out]=FSReda(y,X,outLXS.bs);
mdrplot(out,'databrush',1);</pre></div></div></p></div></div><div id="Extraexample_6" class="example_module expandableContent"><div id="ExtraExample_6"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><i>Interactive example 2.</i>
     Input option databrush passed as structure.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">%Example where databrush is a structure
state = 137; state1=4567;
rand('state', state);
randn('state', state1);
X=randn(200,3);
y=chi2rnd(8,200,1);
[outLXS]=LXS(y,X,'nsamp',1000);
[out]=FSReda(y,X,outLXS.bs);
databrush=struct
databrush.selectionmode='Lasso'
mdrplot(out,'databrush',databrush)</pre></div></div></p></div></div><div id="Extraexample_7" class="example_module expandableContent"><div id="ExtraExample_7"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><i>Interactive example 3.</i>
     Input option databrush passed as structure and brush mode.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">%Example of the use of brush using brush mode
state = 137; state1=4567;
rand('state', state);
randn('state', state1);
X=randn(200,3);
y=chi2rnd(8,200,1);
[outLXS]=LXS(y,X,'nsamp',1000);
[out]=FSReda(y,X,outLXS.bs);
databrush=struct
databrush.selectionmode='Brush'
databrush.Label='on';
mdrplot(out,'databrush',databrush)</pre></div></div></p></div></div><div id="Extraexample_8" class="example_module expandableContent"><div id="ExtraExample_8"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><i>Interactive example 4.</i>
     Persistent cumulative brush 1.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">%Example of the use of persistent non cumulative brush. Every time a
%brushing action is performed previous highlightments are removed
state = 137; state1=4567;
rand('state', state);
randn('state', state1);
X=randn(200,3);
y=chi2rnd(8,200,1);
[outLXS]=LXS(y,X,'nsamp',1000);
[out]=FSReda(y,X,outLXS.bs);
databrush=struct
databrush.persist='off'
databrush.RemoveLabels='off';
mdrplot(out,'databrush',databrush)</pre></div></div></p></div></div><div id="Extraexample_9" class="example_module expandableContent"><div id="ExtraExample_9"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><i>Interactive example 5.</i>
     Persistent cumulative brush 2.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">%Example of the use of persistent cumulative brush. Every time a
%brushing action is performed current highlightments are added to
%previous highlightments
state = 137; state1=4567;
rand('state', state);
randn('state', state1);
X=randn(200,3);
y=chi2rnd(8,200,1);
[outLXS]=LXS(y,X,'nsamp',1000);
[out]=FSReda(y,X,outLXS.bs);
databrush=struct
databrush.persist='on';
databrush.selectionmode='Rect'
% outV is the vector of all selected units during brushing
% outM is a matrix, each column contains the groups of selected units
% at each brushing action
[outV, outM]=mdrplot(out,'databrush',databrush)</pre></div></div></p></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="Inputs">Input Arguments</h2><div class="expandableContent"><div class="arguments"><div class="input_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"> <div id="inputarg_out" class="clearfix"> </div> <h3 id="input_argument_out" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>out</code> &#8212; Structure containing monitoring of mdr. </span>  </a><span class="example_desc">Structure.</span></span></h3> <div class="collapse"> <p>Structure containing the following fields.<table border="2" cellpadding="4" cellspacing="0" class="body"><colgroup><col width="20%"><col width="80%"></colgroup><thead><tr valign="top"><th valign="top">Value</th><th valign="top">Description</th></tr></thead><tr valign="top"><td><code>mdr</code></td><td><p>minimum deletion residual. A matrix containing the monitoring of minimum deletion
               residual in each step of the forward search. The first
               column of mdr must contain the fwd search index
               This matrix can be created using function FSReda
               (compulsory argument)</p></td></tr><tr valign="top"><td><code>Un</code></td><td><p>order of entry of each unit. Matrix containing the order of entry of each unit
               (necessary if datatooltip is true or databrush is not empty)</p></td></tr><tr valign="top"><td><code>y</code></td><td><p>response. Vector containing the response (necessary only if
               option databrush is not empty)</p></td></tr><tr valign="top"><td><code>X</code></td><td><p>Regressors. A matrix containing the explanatory variables
               (necessary only if option databrush is not empty)</p></td></tr><tr valign="top"><td><code>Bols</code></td><td><p>Monitoring of beta coefficients. (n-init+1) x (p+1) matrix containing the monitoring of
               estimated beta coefficients in each step of the forward search
               (necessary only if option databrush is not empty and
               suboption multivarfit is not empty)</p></td></tr></table></p> <p class="datatypelist"><strong> Data Types: </strong><code>single|double</code></p> </div> </div><div id="namevaluepairarguments" class="clearfix"></div><h3 id="NameValuePairs" class="bottom_ruled">Name-Value Pair Arguments</h3><div class="namevaluecontainer"><p>Specify optional comma-separated pairs of <code>Name,Value</code> arguments. <code>Name</code> is the argument name and <code>Value</code> is the corresponding value. <code>Name</code> must appear  inside single quotes (<code>' '</code>).  You can specify several name and value pair arguments in any order as <code>  Name1,Value1,...,NameN,ValueN</code>.</p>  <span class="example_desc"><strong>Example:</strong><code><code> 'quant',[0.05;0.5;0.95]
</code>,<code> 'sign',1
</code>,<code> 'mplus1',1
</code>,<code> 'envm',100
</code>,<code> 'xlimx',[20 100]
</code>,<code> 'ylimy',[2 6]
</code>,<code> 'lwdenv',2
</code>,<code> 'ncoord',true
</code>,<code> 'tag','mymdr'
</code>,<code> 'datatooltip',''
</code>,<code> 'label',{'Smith','Johnson','Robert','Stallone'}
</code>,<code> 'databrush',1
</code>,<code> 'FontSize',14
</code>,<code> 'SizeAxesNum',14
</code>,<code> 'nameX',{'Age','Income','Married','Profession'}
</code>,<code> 'namey','response label'
</code>,<code> 'lwd',3
</code>,<code> 'namey','Plot title'
</code>,<code> 'labx','Subset size m'
</code>,<code> 'laby','mdr'
</code></code></span></div><div class="expandableContent"><div id="inputarg_quant" class="clearfix"></div><h3 id="input_argument_namevalue_quant" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>quant</code> &#8212;Quantiles for which envelopes have
                   to be computed.</span></a><span class="example_desc">vector.</span></span></h3><div class="collapse">	<p><p>The default is to produce 1%, 50% and
                   99% envelopes. In other words the default is
                   quant=[0.01;0.5;0.99];</p> <p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'quant',[0.05;0.5;0.95]
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_sign" class="clearfix"></div><h3 id="input_argument_namevalue_sign" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>sign</code> &#8212;mdr with sign.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>If it is equal 1 (default) we
                   distinguish steps for which minimum deletion residual
                   was associated with positive or negative value of the
                   residual. Steps associated with positive values of mdr
                   are plotted in black, while other steps are plotted in
                   red.</p> <p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'sign',1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_mplus1" class="clearfix"></div><h3 id="input_argument_namevalue_mplus1" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>mplus1</code> &#8212;plot of (m+1)th order statistic.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>Scalar, which
                   specifies if it is necessary to plot the
                   curve associated with (m+1)th order statistic.</p> <p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'mplus1',1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_envm" class="clearfix"></div><h3 id="input_argument_namevalue_envm" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>envm</code> &#8212;sample size for drawing envelopes.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>Scalar which
                   specifies the size of the sample which is used to
                   superimpose the envelope. The default is to add an
                   envelope based on all the observations (size n
                   envelope).</p> <p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'envm',100
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_xlimx" class="clearfix"></div><h3 id="input_argument_namevalue_xlimx" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>xlimx</code> &#8212;min and max for x axis.</span></a><span class="example_desc">vector.</span></span></h3><div class="collapse">	<p><p>vector with two
                   elements controlling minimum and maximum on the x axis.</p> <p>
                   Default value is mdr(1,1)-3 and mdr(end,1)*1.3
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'xlimx',[20 100]
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_ylimy" class="clearfix"></div><h3 id="input_argument_namevalue_ylimy" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>ylimy</code> &#8212;min and max for x axis.</span></a><span class="example_desc">vector.</span></span></h3><div class="collapse">	<p><p>Vector with two
                   elements controlling minimum and maximum on the y axis.</p> <p>
                   Default value is min(mdr(:,2)) and max(mdr(:,2));</p><p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'ylimy',[2 6]
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_lwdenv" class="clearfix"></div><h3 id="input_argument_namevalue_lwdenv" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>lwdenv</code> &#8212;Line width.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>Scalar which controls the width of
                   the lines associated with the envelopes.</p> <p>
                   Default is lwdenv=1
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'lwdenv',2
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_ncoord" class="clearfix"></div><h3 id="input_argument_namevalue_ncoord" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>ncoord</code> &#8212;input out.</span></a><span class="example_desc">mdr in normal coordinates.</span></span></h3><div class="collapse">	<p><p>Boolean.</p> <p>
                   If ncoord=true the input matrix which contains the 
                   minimum deletion residual has been transformed to
                   normal coordinates. The default is ncoord false.</p><p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'ncoord',true
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>logical</code></p></div></div><div class="expandableContent"><div id="inputarg_tag" class="clearfix"></div><h3 id="input_argument_namevalue_tag" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>tag</code> &#8212;plot handle.</span></a><span class="example_desc">string.</span></span></h3><div class="collapse">	<p><p>String which identifies the handle
                   of the plot which is about to be created. The default
                   is to use tag 'pl_mdr'. Notice that if the program
                   finds a plot which has a tag equal to the one specified
                   by the user, then the output of the new plot overwrites
                   the existing one in the same window else a new window
                   is created.</p> <p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'tag','mymdr'
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>char</code></p></div></div><div class="expandableContent"><div id="inputarg_datatooltip" class="clearfix"></div><h3 id="input_argument_namevalue_datatooltip" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>datatooltip</code> &#8212;interactive clicking.</span></a><span class="example_desc">empty value (default) |                   structure.</span></span></h3><div class="collapse">	<p>If datatooltip is not empty the user can use the mouse
                   in order to have information about the unit selected,
                   the step in which the unit enters the search and the
                   associated label. If datatooltip is a structure, it is
                   possible to control the aspect of the data cursor (see
                   function datacursormode for more details or the
                   examples below). The default options of the structure
                   are DisplayStyle='Window' and SnapToDataVertex='on'
                   </p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'datatooltip',''
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>empty value, numeric or structure</code></p></div></div><div class="expandableContent"><div id="inputarg_label" class="clearfix"></div><h3 id="input_argument_namevalue_label" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>label</code> &#8212;row labels.</span></a><span class="example_desc">cell of strings.</span></span></h3><div class="collapse">	<p>Cell containing the labels
                   of the units (optional argument used when
                   datatooltip=1. If this field is not present labels
                   row1, ..., rown will be automatically created and
                   included in the pop up datatooltip window)
                   </p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'label',{'Smith','Johnson','Robert','Stallone'}
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>cell</code></p></div></div><div class="expandableContent"><div id="inputarg_databrush" class="clearfix"></div><h3 id="input_argument_namevalue_databrush" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>databrush</code> &#8212;interactive mouse brushing.</span></a><span class="example_desc">empty value (default),                   scalar | structure.</span></span></h3><div class="collapse">	<p><p>DATABRUSH IS AN EMPTY VALUE.</p> <p>
                   If databrush is an empty
                   value (default), no brushing is done. The activation of
                   this option (databrush is a scalar or a structure) enables
                   the user  to select a set of trajectories in the
                   current plot and to see them highlighted in the y|X
                   plot (notice that if the plot y|X does not exist it is
                   automatically created). In addition, brushed units can
                   be highlighted in the monitoring residual plot
                   The window style of the
                   other figures is set equal to that which contains the
                   monitoring residual plot. In other words, if the
                   monitoring residual plot is docked all the other
                   figures will be docked too.</p> <p>
                  DATABRUSH IS A SCALAR.</p> <p>
                   If databrush is a scalar the default selection tool is a
                   rectangular brush and it is possible to brush only once
                   (that is persist='').</p> <p>
                  DATABRUSH IS A STRUCTURE.</p> <p>
                   If databrush is a structure, it is
                   possible to use all optional arguments
                   of function <a href="selectdataFS.html">selectdataFS</a> and the following optional
                   argument:</p> <p>
                  persist. Persist is an empty value or a scalar
                   containing the strings 'on' or 'off' If persist = 'on'
                   or 'off' brusing can be done as many time as the user
                   requires. If persist='on' then the unit(s) currently
                   brushed are added to those previously brushed. If
                   persist='off' every time a new brush is performed units
                   previously brushed are removed. The default value of
                   persist is '' that is brushing is allowed only once. If
                   persist is 'on' it is possible, every time a new
                   brushing is done, to use a different color for the
                   brushed units
                  bivarfit. This option is to add one or more least
                     square lines to the plots of y|X, depending on the
                     selected groups. bivarfit = ''
                       is the default: no line is fitted.</p> <p>
                     bivarfit = '1'
                       fits a single ols line to all points of each
                       bivariate plot in the scatter matrix y|X.</p> <p>
                     bivarfit = '2'
                       fits two ols lines: one to all points and another
                       to the last selected group. This is useful when
                       there are only two groups, of which one refers to a
                       set of potential outliers.</p> <p>
                     bivarfit = '0'
                       fits one ols line for each selected group. This is
                       useful for the purpose of fitting mixtures of
                       regression lines.</p> <p>
                     bivarfit = 'i1' or 'i2' or 'i3' etc.</p> <p>
                       fits a ols line to a specific group, the one with
                       index 'i' equal to 1, 2, 3 etc.</p> <p>
                   multivarfit. If this option is '1', we add to each scatter
                     plot of y|X a line based on the fitted hyperplane
                     coefficients. The line added to the scatter plot y|Xi
                     is mean(y)+Ci*Xi, being Ci the coefficient of Xi. The
                     default value of multivarfit is '', i.e. no line is
                     added.</p> <p>
                   labeladd. If this option is '1', we label the units
                     of the last selected group with the unit row index in
                     matrices X and y. The default value is labeladd='',
                     i.e. no label is added.</p><p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'databrush',1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>single | double | struct</code></p></div></div><div class="expandableContent"><div id="inputarg_FontSize" class="clearfix"></div><h3 id="input_argument_namevalue_FontSize" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>FontSize</code> &#8212;Size of axes labels.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>Scalar which controls the
                   fontsize of the labels of the axes.</p> <p>
                   Default value is 12.</p><p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'FontSize',14
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>single | double</code></p></div></div><div class="expandableContent"><div id="inputarg_SizeAxesNum" class="clearfix"></div><h3 id="input_argument_namevalue_SizeAxesNum" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>SizeAxesNum</code> &#8212;Size of axes numbers.</span></a><span class="example_desc">scalar which controls the                   fontsize of the numbers of the axes.</span></span></h3><div class="collapse">	<p><p>Default value is 10.</p> <p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'SizeAxesNum',14
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>single | double</code></p></div></div><div class="expandableContent"><div id="inputarg_nameX" class="clearfix"></div><h3 id="input_argument_namevalue_nameX" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>nameX</code> &#8212;Regressors names.</span></a><span class="example_desc">cell array of strings.</span></span></h3><div class="collapse">	<p><p>Cell array of
                   strings of length p containing the labels of the
                   varibles of the regression dataset. If it is empty
                 	(default) the sequence X1, ..., Xp will be created
                   automatically.</p> <p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'nameX',{'Age','Income','Married','Profession'}
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>cell</code></p></div></div><div class="expandableContent"><div id="inputarg_namey" class="clearfix"></div><h3 id="input_argument_namevalue_namey" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>namey</code> &#8212;response label.</span></a><span class="example_desc">character.</span></span></h3><div class="collapse">	<p><p>Character containing the
                   label of the response.</p> <p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'namey','response label'
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>char</code></p></div></div><div class="expandableContent"><div id="inputarg_lwd" class="clearfix"></div><h3 id="input_argument_namevalue_lwd" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>lwd</code> &#8212;Curves line width.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>Scalar which controls
                   linewidth of the curve which contains the monitoring of
                   minimum deletion residual.</p> <p>
                   Default line width=2
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'lwd',3
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>single | double</code></p></div></div><div class="expandableContent"><div id="inputarg_titl" class="clearfix"></div><h3 id="input_argument_namevalue_titl" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>titl</code> &#8212;main title.</span></a><span class="example_desc">character.</span></span></h3><div class="collapse">	<p><p>A label for the title (default: '').</p> <p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'namey','Plot title'
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>char</code></p></div></div><div class="expandableContent"><div id="inputarg_labx" class="clearfix"></div><h3 id="input_argument_namevalue_labx" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>labx</code> &#8212;x axis title.</span></a><span class="example_desc">character.</span></span></h3><div class="collapse">	<p><p>A label for the x-axis
                   (default: 'Subset size m').</p> <p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'labx','Subset size m'
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>char</code></p></div></div><div class="expandableContent"><div id="inputarg_laby" class="clearfix"></div><h3 id="input_argument_namevalue_laby" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>laby</code> &#8212;y axis title.</span></a><span class="example_desc">character.</span></span></h3><div class="collapse">	<p><p>A label for the y-axis
                  (default: 'Minimum deletion residual').</p> <p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'laby','mdr'
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>char</code></p></div></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="OutputArgs" >Output Arguments</h2><div class="expandableContent"><div class="arguments"><div class="output_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"><div id="outputarg_brushedUnits" class="clearfix"></div><h3 id="output_argument_brushedUnits" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>brushedUnits</code> &#8212;List of the
                 units which are inside subset in the trajectories which
                 have been brushed using option databrush.</span></a><span class="example_desc"><code>brushed units. </code>Vector. Vector</span></span></h3><div class="collapse"><p> If option
                 databrush has not been used brushedUnits will be an empty
                 value.</p></div></div><div class="expandableContent"><div id="outputarg_BrushedUnits" class="clearfix"></div><h3 id="output_argument_BrushedUnits" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>BrushedUnits</code> &#8212;brushed units.</span></a><span class="example_desc"><code> </code>Matrix</span></span></h3><div class="collapse"><p><p> Matrix of size
                 r-by-numBrushingActions which contains in column j
                 the brushed units after jth brushing.</p> <p>
                 If during jth brushing action the number of brushed units
                 is $s&lt;r$ the last $r-s$ units of column j are set to 0.</p></p></div></div></div></div></div></div><div class="ref_sect" itemprop="content"><div class="bibliography"><h2 id="References">References</h2> <div><p>Atkinson, A.C. and Riani, M. (2000), "Robust Diagnostic Regression
 Analysis", Springer Verlag, New York.</p></div></div></div><div class="ref_sect"><h2 id="SeeAlso">See Also</h2><p><span itemprop="seealso"><a href="resfwdplot.html" itemprop="url"><span itemprop="name"><code>resfwdplot</code></span></a></span> | <span itemprop="seealso"><a href="mmdplot.html" itemprop="url"><span itemprop="name"><code>mmdplot</code></span></a></span></div><i>This page has been automatically generated by our routine <a href="publishFS.html">publishFS</a></i></div></section></div></div></div></div><div id="divbottom"></div></body></html>