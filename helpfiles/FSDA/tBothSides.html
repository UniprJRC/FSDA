<!DOCTYPE HTML> <html itemscope="" xmlns="http://www.w3.org/1999/xhtml"><head><title>tBothSides</title><meta content="refpage" name="chunktype"><meta content="function:tBothSides" itemprop="refentity" name="refentity"><meta content="text/javascript" http-equiv="Content-Script-Type"><meta content="fcn" itemprop="pagetype" name="toctype"><meta content="ref/function" itemprop="infotype" name="infotype" /><meta content="tBothSides allows users to transform both sides of a (nonlinear) regression model.." itemprop="description" name="description" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" /><script type="text/x-mathjax-config">MathJax.Hub.Config({extensions: ["tex2jax.js"],jax: ["input/TeX","output/HTML-CSS"],menuSettings: {zoom: "Double-Click", zscale: "300"},tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},MathMenu: {showRenderer: false},"HTML-CSS": {availableFonts: ["TeX"],preferredFont: "TeX",imageFont: null}});</script><script type="text/javascript" src="includesFS/Mathjax/MathJax.js"></script><script src="includesFS/matlab-highlighter.min.js"></script><link href="includesFS/matlab-highlighter.css" rel="stylesheet" type="text/css"><script type="text/javascript" src="includesFS/jquery-latest.js"></script><script>$(document).ready(function(){      $("#divtop").load("includesFS/top.html");      $("#divbottom").load("includesFS/bottom.html");});</script><link href="../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)"></link><link href="../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)"></link><link href="../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)"></link><link href="../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)"></link><link href="../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)"></link><link href="../includes/product/css/site6_offcanvas.css" rel="stylesheet" type="text/css"></link><script src="../includes/shared/scripts/l10n.js" type="text/javascript"></script><script src="../includes/product/scripts/docscripts.js"></script><script src="../includes/shared/scripts/docscripts_rn.js"></script><script src="../includes/shared/scripts/mw.imageanimation.js" type="text/javascript"></script><script src="../includes/shared/scripts/jquery.highlight.js"></script><script src="../includes/product/scripts/bootstrap.min.js" type="text/javascript"></script><script src="../includes/product/scripts/global.js"></script><script src="includesFS/bottom.js" type="text/javascript"></script><script src="../includes/product/scripts/underscore-min.js"></script><script src="../includes/shared/scripts/f1help.js" type="text/javascript"></script><script src="../includes/product/scripts/suggest.js" type="text/javascript"></script><script src="../includes/shared/scripts/helpservices.js" type="text/javascript"></script><script src="../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script><!-- the following line should be kept this way only --><link href="includesFS/doc_center.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css"><link href="../includes/product/css/doc_center_print.css" media="print" rel="stylesheet" type="text/css"></head><body  onload="highlightMATLABCode();" id="responsive_offcanvas">  <div id="doc_header_spacer" class="header"></div><div class="sticky_header_container includes_subnav"><div class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-xs-12 col-sm-6 col-sm-push-6 col-md-5 col-md-push-7" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2017a" data-language="en" action="../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="sr-only">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"><div class="input-group-btn"><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search pull-right icon_32 visible-xs" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="col-sm-6 col-sm-pull-6 col-md-7 col-md-pull-5" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../documentation-center.html">Documentation</a></h1></div></div></div><div class="visible-xs" id="search_actuator"><button class="btn icon-search btn_search pull-right icon_16" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div><!--END.CLASS row--> </div><!--END.CLASS container-fluid--> </div><!--END.CLASS section_header level_3--><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_actuator" data-toggle="offcanvas" data-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="sr-only">Toggle navigation</span><span class="icon-menu icon_24"></span></button><span class="offcanvas_actuator_label"></span><span class="offcanvas_actuator_close"></span> </div><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-md-12 hidden-xs hidden-sm"></div></div></div></div></div></div></div><!--END.CLASS sticky_header_container--><div class="row-offcanvas row-offcanvas-left"><div id="sidebar" class="sidebar-offcanvas" role="navigation"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" xmlns:atict="http://www.arbortext.com/namespace/atict"><li itemprop="breadcrumb" itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb"> <a href="../documentation-center.html" itemprop="url"> <span itemprop="title">All Products</span></a></li></ul><ul class="nav_disambiguation" xmlns:atict="http://www.arbortext.com/namespace/atict"><li class="product"><a href="index.html">Flexible Statistics and Data Analysis (FSDA)</a><div class="dropdown"> <span id="dropdownMenu1" class="icon-arrow-down icon_16" data-toggle="dropdown"> </span><ul aria-labelledby="dropdownMenu1" class="dropdown-menu dropdown-menu-right" role="menu"><li role="presentation"> <a href="examples.html" role="menuitem" tabindex="-1">Examples</a></li><li role="presentation"> <a href="function-alpha.html" role="menuitem" tabindex="-1"> Functions and Other Reference</a></li><li role="presentation"> <a href="release_notes.html?s_cid=doc_flyout" role="menuitem" tabindex="-1"> Release Notes</a></li><li role="presentation"> <a href="tutorials.html" role="menuitem" tabindex="-1"> Tutorials</a></li></ul></div></li></ul><ul xmlns:atict="http://www.arbortext.com/namespace/atict" class="nav_disambiguation"> <li><a href="index.html">Flexible Statistics and Data Analysis Toolbox</a> </li> <li><a href="function-cate.html" itemprop="url">Functions</a></li></ul><!-- --><ul class="nav_scrollspy nav" xmlns:atict="http://www.arbortext.com/namespace/atict">  <li class="nav_scrollspy_function"> <a href="#responsive_offcanvas">tBothSides</a></li> <li id="SSPY810-refentry" class="nav_scrollspy_title">On this page</li><li><a class="intrnllnk" href="#syntax">Syntax</a></li><li><a class="intrnllnk" href="#Description">Description</a></li><li><a class="intrnllnk" href="#Examples">Examples</a><ul><li><a class="intrnllnk" href="#Example_1">Call of tBothSides with all default options.</a></li><li><a class="intrnllnk" href="#Example_2">Call of tBothSides with parameter lambda fixed.</a></li></ul></li><li><a class="intrnllnk" href="#ExtraExamples">Extra Examples</a><ul><li><a class="intrnllnk" href="#ExtraExample_1">Example of tBothSides with non linear link between X and beta.</a></li><li><a class="intrnllnk" href="#ExtraExample_2">Example where only beta coefficents are estimated and initial values for beta are provided.</a></li><li><a class="intrnllnk" href="#ExtraExample_3">Example of the use of option dispresults.</a></li><li><a class="intrnllnk" href="#ExtraExample_4">Example of the use of option prolik.</a></li></ul></li><li><a class="intrnllnk" href="#Inputs">Input Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_y">y</a></li><li><a class="intrnllnk" href="#input_argument_X">X</a></li></ul></li><li><a class="intrnllnk" href="#NameValuePairs">Name-Value Pair Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_namevalue_la">la</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_modelfun">modelfun</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_beta0">beta0</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_la0">la0</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_intercept">intercept</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_family">family</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_prolik">prolik</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_dispresults">dispresults</a></li></ul></li><li><a class="intrnllnk" href="#OutputArgs">Output Arguments</a><ul><li><a class="intrnllnk" href="#output_argument_out">out</a></li></ul></li><li><a class="intrnllnk" href="#MoreAbout">More About</a></li><li><a class="intrnllnk" href="#References">References</a></li><li><a class="intrnllnk" href="#SeeAlso">See Also</a></li></ul></nav><script src="../includes/product/scripts/offcanvas.js"></script></div><div id="divtop"></div><div class="site_container site_toc_closed"><div class="page_container"><div class="content_frame"><div id="content_container" class="content_container"><section id="doc_center_content"><div class="function_ref"><div itemprop="content"><h1 itemprop="title">tBothSides</h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose">tBothSides allows users to transform both sides of a (nonlinear) regression model.</p><div class="switch"><a id="expandAllPage" href="javascript:void(0);">expand all in page</a></div></div></div></div><div class="ref_sect"><h2 id="syntax">Syntax</h2><div class="syntax_signature"><div class="syntax_signature_module"><ul><li><code class="synopsis">out=tBothSides(y, X)</code><span class="syntax_example"><a class="intrnllnk" href="tBothSides.html#Example_1">example</a></span></li><li><code class="synopsis">out=tBothSides(y, X,Name,Value)</code><span class="syntax_example"><a class="intrnllnk" href="tBothSides.html#Example_2">example</a></span></li></ul></div></div></div>	<div class="ref_sect" itemprop="content">							<h2 id="Description">Description</h2>							<div class="descriptions">								<div class="description_module"><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="tBothSides.html#Example_1">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_out"><code>out</code></a>=tBothSides(<a class="intrnllnk" href="#inputarg_y"><code>y</code></a>,<a class="intrnllnk" href="#inputarg_X"><code> X</code></a>)</code></span>Call of tBothSides with all default options.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="tBothSides.html#Example_2">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_out"><code>out</code></a>=tBothSides(<a class="intrnllnk" href="#inputarg_y"><code>y</code></a>,<a class="intrnllnk" href="#inputarg_X"><code>X</code></a>,<a class="intrnllnk" href="#namevaluepairarguments"><code>Name, Value</code></a>)</code></span>Call of tBothSides with parameter lambda fixed.</p></div>								</div>							</div>							<div class="clear">							</div>						</div><div class="ref_sect" itemprop="content"><div class="examples"><h2 id="Examples">Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="example_1" class="example_module expandableContent"><div id="Example_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Call of tBothSides with all default options.</li></span></a></span></h3><div class="collapse"><p>
     Load Assay data from Davidian M. and Haaland P. (1989).<div class="programlisting"><div class="codeinput"><pre class="matlab-code">% The Relationship Between Transformation and Weighting
% in Regression, With Application to Biological and Physical Science,
% Institute of Statistics mimeo series Report 1947, North Carolina State University. 
% File is downloadable from
% https://pdfs.semanticscholar.org/7067/fd66fe06f114cac58eef8253eb7483edfd29.pdf
% The material assayed was obtained from two sources, with every other
% concentration starting with 0.476 from the first source and the remainder from the
% second. Replicate observations were obtained by subsampling at each concentration.
x=[0.476	0.924	1.905	3.696	7.619	14.874	30.474	59.134];
yy=[0.05706	0.11781	0.25071	0.49596	1.03928	2.14635	4.24397	8.53848...
0.057	0.11615	0.25398	0.4807	1.03659	2.09495		    8.41333...
0.06363	0.12587	0.24552	0.49442	1.12641	2.24941	4.7011	9.01437...
0.05566	0.12308	0.24889	0.52321	1.10456	2.19937	4.44709	8.73544...
0.05449	0.11629	0.24858	0.49931	1.03184	2.16042	4.42707	8.33862...
0.06153	0.11878	0.24657	0.5021	1.02598	2.09198	4.39725	8.33347...
0.05837	0.11869	0.24212	0.4886	0.98267	2.07686	4.35511	8.35725...
0.05388	0.11886	0.25975	0.48158	1.04321	2.06961	4.37357	8.39123...
0.05618	0.12492	0.25311	0.4827	1.03838	2.12548	4.3204	8.3901];
X=[x';x([1:6 8])'; repmat(x(:),7,1)];
y=yy';
% The plot of the data shows: a systematic increase in variance with level
% of mean response, small variability relative to the range of the means,
% and reasonably straight-line relationship.
plot(X,y,'o')
xlabel('Concentration')
ylabel('y')
% In this case both lambda and the beta coefficients are estimated
% A linear link between X and beta is assumed
out=tBothSides(y, X);
disp(out.Btable)</pre></div></div><pre class="codeoutput">                     bhat                     se                   tstat      
              ___________________    ____________________    _________________

    b1        -0.0106766638130858     0.00100092181390408     -10.666830979976
    b2          0.141425262416822    0.000859863685065905     164.474049634952
    lambda     0.0639294509915763      0.0816484724188695    0.782984042415492

</pre><a href='http://rosa.unipr.it/fsda/tBothSides.html#Example_1'><img vspace="5" hspace="5" src="images\tBothSides_01.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website). Graphical output could not be included in the installation file because toolboxes cannot be greater than 20MB. To load locally the image files, download zip file http://rosa.unipr.it/fsda/images.zip and unzip it to <tt>(docroot)/FSDA/images</tt> or simply run routine <tt>downloadGraphicalOutput.m</tt>"> </a></p></div></div><div id="example_2" class="example_module expandableContent"><div id="Example_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>Call of tBothSides with parameter lambda fixed.</li></span></a></span></h3><div class="collapse"><p>
     In this case only the beta coefficients are estimated<div class="programlisting"><div class="codeinput"><pre class="matlab-code">la=0.063;
% A linear link between X and beta is assumed
out=tBothSides(y, X,'la',la);</pre></div></div></p></div></div></div><p> </p><div class="examples"><h2 id="ExtraExamples" class="bottom_ruled">Related Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="Extraexample_1" class="example_module expandableContent"><div id="ExtraExample_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Example of tBothSides with non linear link between X and beta.</li></span></a></span></h3><div class="collapse"><p>
     Load spawners data (table 4.1 p. 141 Book CR)
     year spawner (S) recruiter (R)
     Model is R = \beta_1 S exp ( - \beta_2 S) = f_RK(S, \beta)<div class="programlisting"><div class="codeinput"><pre class="matlab-code">XX=[1940 963 2215
1941 572 1334
1942 305 800
1943 272 438
1944 824 3071
1945 940 957
1946 486 934
1947 307 971
1948 1066 2257
1949 480 1451
1950 393 686
1951 176 127
1952 237 700
1953 700 1381
1954 511 1393
1955 87 363
1956 370 668
1957 448 2067
1958 819 644
1959 799 1747
1960 273 744
1961 936 1087
1962 558 1335
1963 597 1981
1964 848 627
1965 619 1099
1966 397 1532
1967 616 2086];
% Row 12 is removed from the analysis.
XX(12,:)=[];
X=XX(:,2);
y=XX(:,3);
% Call of tBothSides non linear link between X and beta.
% In this case modelfun (function which specifies the link between X and beta) and
% the vector of initial regression coefficients is specified.
% This is the spawner recruiter model. See CR for more details.
modelfun = @(beta,X) X*beta(1).*exp(-beta(2)*X);
% Initial value of beta coefficients
bini=[3; 0.0009];
% The link between X and beta is specified inside modelfun given at the end
% of the example
out=tBothSides(y, X,'modelfun',modelfun,'beta0',bini,'family','BoxCox','dispresults',true);
% Plot the original values together with estimated median regression lines
% and 90 per cent confidence interval for fitted response.
close all
plot(X,y,'o')
hold('on')
laest=out.betaout(end);
upConfInt= normBoxCox(out.yhattra+1.65*out.scale,1,laest,'inverse',true,'Jacobian',false);
lowConfInt= normBoxCox(out.yhattra-1.65*out.scale,1,laest,'inverse',true,'Jacobian',false);
[Xsor,indXsor]=sort(X);
% Plot the estimated median recruitment
plot(Xsor,out.yhat(indXsor),'r-')
% Plot the estimated 95th percentile of recruitment
plot(Xsor,upConfInt(indXsor),'r--')
% Plot the estimated 5th percentile of recruitment
plot(Xsor,lowConfInt(indXsor),'r--')
ylabel('Recruiters')
xlabel('Spawners')</pre></div></div></p></div></div><div id="Extraexample_2" class="example_module expandableContent"><div id="ExtraExample_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Example where only beta coefficents are estimated and initial values for beta are provided.</li></span></a></span></h3><div class="collapse"><p>
     Initial value of beta coefficients<div class="programlisting"><div class="codeinput"><pre class="matlab-code">bini=[3; 0.0009];
% lambda is fixed
la=-0.2;
% modelfun is the function which specifies the link between X and beta
% This is the spawner recruiter model. See CR for more details.
modelfun = @(beta,X) X*beta(1).*exp(-beta(2)*X);
out=tBothSides(y, X,'modelfun',modelfun,'beta0',bini,'la',la);</pre></div></div></p></div></div><div id="Extraexample_3" class="example_module expandableContent"><div id="ExtraExample_3"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Example of the use of option dispresults.</li></span></a></span></h3><div class="collapse"><p>
     modelfun is the function which specifies the link between X and beta
     This is the spawner recruiter model. See CR for more details.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">modelfun = @(beta,X) X*beta(1).*exp(-beta(2)*X);
out=tBothSides(y, X,'modelfun',modelfun,'dispresults',true,'beta0',bini);
% modelfun is the function which specifies the link between X and beta
%     % This is the spawner recruiter model
%     function [yhat]=modelfun(beta, X)
%     yhat=X*beta(1).*exp(-beta(2)*X);
%     end</pre></div></div></p></div></div><div id="Extraexample_4" class="example_module expandableContent"><div id="ExtraExample_4"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Example of the use of option prolik.</li></span></a></span></h3><div class="collapse"><p>
     This is the spawner recruiter model. See CR for more details.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">% modelfun is the function which specifies the link between X and beta
modelfun = @(beta,X) X*beta(1).*exp(-beta(2)*X);
out=tBothSides(y, X,'modelfun',modelfun,'prolik',true);</pre></div></div></p></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="Inputs">Input Arguments</h2><div class="expandableContent"><div class="arguments"><div class="input_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"> <div id="inputarg_y" class="clearfix"> </div> <h3 id="input_argument_y" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>y</code> &#8212; Response variable. </span>  </a><span class="example_desc">Vector.</span></span></h3> <div class="collapse"> <p><p>Response variable, specified as
               a vector of length n, where n is the number of
               observations. Each entry in y is the response for the
               corresponding row of X.</p> <p>
               Missing values (NaN's) and infinite values (Inf's) are
               allowed, since observations (rows) with missing or infinite
               values will automatically be excluded from the
               computations.</p></p> <p class="datatypelist"><strong> Data Types: </strong><code>single| double</code></p> </div> </div><div class="expandableContent"> <div id="inputarg_X" class="clearfix"> </div> <h3 id="input_argument_X" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>X</code> &#8212; Predictor variables. </span>  </a><span class="example_desc">Matrix.</span></span></h3> <div class="collapse"> <p><p>Matrix of explanatory
               variables (also called 'regressors') of dimension n x (p-1)
               where p denotes the number of explanatory variables
               including the intercept.</p> <p>
               Rows of X represent observations, and columns represent
               variables. By default, there is a constant term in the
               model, unless you explicitly remove it using input option
               intercept, so do not include a column of 1s in X. Missing
               values (NaN's) and infinite values (Inf's) are allowed,
               since observations (rows) with missing or infinite values
               will automatically be excluded from the computations.</p></p> <p class="datatypelist"><strong> Data Types: </strong><code>single| double</code></p> </div> </div><div id="namevaluepairarguments" class="clearfix"></div><h3 id="NameValuePairs" class="bottom_ruled">Name-Value Pair Arguments</h3><div class="namevaluecontainer"><p>Specify optional comma-separated pairs of <code>Name,Value</code> arguments. <code>Name</code> is the argument name and <code>Value</code> is the corresponding value. <code>Name</code> must appear  inside single quotes (<code>' '</code>).  You can specify several name and value pair arguments in any order as <code>  Name1,Value1,...,NameN,ValueN</code>.</p>  <span class="example_desc"><strong>Example:</strong><code><code> 'la',0.5
</code>,<code> 'la',0.5
</code>,<code> 'beta0',[0.5 0.2 0.1]
</code>,<code> 'la',1
</code>,<code> 'intercept',1
</code>,<code> 'family','YJ'
</code>,<code>'prolik',true
</code>,<code> 'dispresults',false
</code></code></span></div><div class="expandableContent"><div id="inputarg_la" class="clearfix"></div><h3 id="input_argument_namevalue_la" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>la</code> &#8212;transformation parameter.</span></a><span class="example_desc">scalar | empty value (default).</span></span></h3><div class="collapse">	<p><p>Transformation parameter to estimate or prefixed value of
               lambda to apply to both sides of the equation. If la is
               empty (default), lambda will be estimated by the non linear
               least squares routine. If la is given, the supplied value
               will be used transform both sides of the equation and only
               beta parameters will be used.</p> <p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'la',0.5
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_modelfun" class="clearfix"></div><h3 id="input_argument_namevalue_modelfun" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>modelfun</code> &#8212;non linear function to use.</span></a><span class="example_desc">function_handle | empty value (default).</span></span></h3><div class="collapse">	<p><p>If
                modelfun is empty the link between X and \beta is assumed
                to be linear else it is necessary to specify a function
                (using @) that accepts two arguments, a coefficient vector
                and the array X and returns the vector of fitted values
                from the non linear model y. For example, to specify the
                hougen (Hougen-Watson) nonlinear regression function, use
                the function handle @hougen.</p> <p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'la',0.5
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>function_handle or empty value</code></p></div></div><div class="expandableContent"><div id="inputarg_beta0" class="clearfix"></div><h3 id="input_argument_namevalue_beta0" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>beta0</code> &#8212;empty value or vector containing initial values for the
                 coefficients just in case modelfun is non empty.</span></a><span class="example_desc">if modelfun is empty this argument is ignored.</span></span></h3><div class="collapse">	<p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'beta0',[0.5 0.2 0.1]
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_la0" class="clearfix"></div><h3 id="input_argument_namevalue_la0" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>la0</code> &#8212;initial value for transformation parameter.</span></a><span class="example_desc">scalar |                 empty value.</span></span></h3><div class="collapse">	<p><p>If optional input parameter la is empty, it
                 is possible to specify the initial value to use in the
                 non linear least squares routine. This argument is
                 ignored if la is nont empty.</p> <p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'la',1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_intercept" class="clearfix"></div><h3 id="input_argument_namevalue_intercept" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>intercept</code> &#8212;Indicator for constant term.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>If 1, and modelfun is empty (that is if the link between X and beta is linear)
               a model with constant term will be fitted (default), else
               no constant term will be included. This argument is ignored
               if modelfun is not empty.</p> <p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'intercept',1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_family" class="clearfix"></div><h3 id="input_argument_namevalue_family" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>family</code> &#8212;parametric transformation to use.</span></a><span class="example_desc">string.</span></span></h3><div class="collapse">	<p><p>String which
               identifies the family of transformations which
               must be used. Character. Possible values are 'BoxCox'
               (default) or 'YJ'.</p> <p>
               The Box-Cox family of power transformations equals
               $(y^{\lambda}-1)/\lambda$ for $\lambda$ not equal to zero,
               and $\log(y)$ if $\lambda = 0$.</p> <p>
               The Yeo-Johnson (YJ) transformation is the Box-Cox
               transformation of $y+1$ for nonnegative values, and of
               $|y|+1$ with parameter 2-lambda for y negative.</p> <p>
               The basic power transformation returns $y^{\lambda}$ if
               $\lambda$ is not zero, and $\log(\lambda)$  otherwise.</p> <p>
               Remark. BoxCox and the basic power family can be used just
               if input y is positive. Yeo-Johnson family of
               transformations does not have this limitation.</p><p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'family','YJ'
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>char</code></p></div></div><div class="expandableContent"><div id="inputarg_prolik" class="clearfix"></div><h3 id="input_argument_namevalue_prolik" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>prolik</code> &#8212;Monitor profile log likelihood for lambda.</span></a><span class="example_desc">empty value (default),               scalar | structure.</span></span></h3><div class="collapse">	<p><p>It
               specifies whether it is necessary to
               show the profile log likelihood of lambda
               If prolik is a Boolean and is equal to true, the plot of
               the profile loglikelihood is produced together with a 95
               per cent confidence interval. The default value of prolik
               is false, that is no plot is produced.</p> <p>
               If prolik is a structure it may contain the following fields:</p><p>
           </p><table border="2" cellpadding="4" cellspacing="0" class="body"><colgroup><col width="20%"><col width="80%"></colgroup><thead><tr valign="top"><th valign="top">Value</th><th valign="top">Description</th></tr></thead><tr valign="top"><td><code>conflev</code></td><td><p><p>scalar between 0 and 1 determining
                                 confidence level for 
                                 lambda based on the asymptotic chi1^2 of
                                 twice the loglikelihood ratio.</p> <p>
                                 The default confidence level is 0.95;</p></p></td></tr><tr valign="top"><td><code>xlim</code></td><td><p>vector with two elements determining
                                 minimum and maximum values of lambda in
                                 the plots of profile loglikelihoods. The
                                 default value of xlim is [-2 2];</p></td></tr><tr valign="top"><td><code>LineWidth</code></td><td><p>line width of the vertical lines
                                 defining confidence levels of the
                                 transformation parameters.</p></td></tr></table></p>	<p class="description_valueexample">       <strong>Example: </strong><code>'prolik',true
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>Boolean or struct</code></p></div></div><div class="expandableContent"><div id="inputarg_dispresults" class="clearfix"></div><h3 id="input_argument_namevalue_dispresults" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>dispresults</code> &#8212;Display results on the screen.</span></a><span class="example_desc">boolean.</span></span></h3><div class="collapse">	<p><p>If dispresults is true (default) it is possible to see on the
                 screen table Btable.</p> <p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'dispresults',false
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>Boolean</code></p></div></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="OutputArgs" >Output Arguments</h2><div class="expandableContent"><div class="arguments"><div class="output_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"><div id="outputarg_out" class="clearfix"></div><h3 id="output_argument_out" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>out</code> &#8212; description</span></a><span class="example_desc">Structure</span></span></h3><div class="collapse"><p>A structure containing the following fields

     <table border="2" cellpadding="4" cellspacing="0" class="body"><colgroup><col width="20%"><col width="80%"></colgroup><thead><tr valign="top"><th valign="top">Value</th><th valign="top">Description</th></tr></thead><tr valign="top"><td><code>betaout</code></td><td><p>Column vector containing estimated beta
                       coefficients (including the intercept if requested)
                       and input option la is empty estimate of lambda (in
                       the last element)</p></td></tr><tr valign="top"><td><code>covB</code></td><td><p>Matrix containing variance covariance matrix of
                        estimated coefficients</p></td></tr><tr valign="top"><td><code>Btable</code></td><td><p><p>table containing estimated beta coefficients,
                       standard errors, t-stat and p-values
                       The content of matrix B is as follows:</p> <p>
                       1st col = beta coefficients and lambda (in the last
                       element if input option la is empty).</p> <p>
                       2nd col = standard errors;</p> <p>
                       3rd col = t-statistics;</p> <p>
                       4th col = p values.</p><p> 
                       Remark:  note that the pseudo-model technique (see
                       CR p. 126) is used and this method only produces
                       consistent estiates of the standard errors of beta
                       and not of lambda. If the user is interested in an
                       asymptotic consistent confidence interval for
                       lambda it is necessary to use input option prolik.</p></p></td></tr><tr valign="top"><td><code>scale</code></td><td><p>scalar containing the estimate of the scale
                       (sigma). The estimate of the scale is the maximum
                       likelihood estimated corrected for the degrees of
                       freedom. It uses equation (4.18) of CR.</p></td></tr><tr valign="top"><td><code>residuals</code></td><td><p>n x 1 vector containing the estimates of the 
                        scaled residuals in the transformed scale. That is
                        residuals in the transformed scale divided by the estimate
                        of the scale.</p></td></tr><tr valign="top"><td><code>yhat</code></td><td><p>n x 1 vector containing the fitted values in the
                       original scale.</p></td></tr><tr valign="top"><td><code>yhattra</code></td><td><p>n x 1 vector containing the fitted values in the
                       transformed scale. Transformation which is used is
                       Box Cox or Yao and Johnson.</p></td></tr><tr valign="top"><td><code>ytra</code></td><td><p>n x 1 vector containing the response values in the
                       transformed scale. Transformation which is used is
                       Box Cox or Yao and Johnson.</p></td></tr></table></p></div></div></div></div></div></div><div class="moreabout ref_sect"><h2 id="MoreAbout">More About</h2><div class="expandableContent"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent" itemprop="content"><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span>Additional Details</span></a></span></h3><div class="expand"><p><p>

 There is sometimes a strong, often theoretically derived, relationship
 between the response and the model $\eta(x,\beta)$, combined with
 variance heterogeneity. Box-Cox transformation of the response to achieve
 stability of variance can destroy the relationship between E($Y$) and
 $\eta(x,\beta)$. For example, the kinetic models of chemistry provide
 deterministic relationships between concentrations of reactants and
 products and time and temperature. A well-known simple example is the
 Michaelis-Menten model for enzyme kinetics in which the response goes
 from zero to an asymptotic value $V_{\mbox{max}}$.  Transforming the
 response to $y^{\lambda}$ would result in a different range for the
 transformed response.</p> <p>
 
 Carrol and Ruppert (1988) [Chapter~4]developed a transform both sides
 model for such problems, motivated by theoretical models for sockeye
 salmon breeding. The transformation model is
  \begin{equation}
  \label{BSmodel}
  (y^{\lambda} - 1)/\lambda = \{\eta(x,\beta)^{\lambda} - 1\}/\lambda + \epsilon,
  \end{equation}
  where the independent errors are normally distributed. As with the
  Box-Cox transformation, the parameters $\lambda$ and $\beta$ are found
  by minimizing the residual sum of squares in the regression model which
  includes the Jacobian of the transformation, again $\dot{y}$.</p> <p>
  The theoretical procedure is to minimize the residual sum of squares
  using $y(\lambda)/\dot{y}^{\lambda -1}$, or equivalently
  $y(\lambda)/\dot{y}^{\lambda}$, as the response and the similarly
  transformed value of $\eta$ as the model. Carroll and Ruppert comment
  that, unless $\lambda$ is fixed, it is not possible to use standard
  nonlinear regression routines for this minimization as such  routings
  typically do not allow the response to depend upon unknown parameters.</p> <p>
  They reformulate the problem in terms of a `pseudo model'. This is what
  is implemented in this routine.</p><p>



</p></p></div></div></div></div><div class="ref_sect" itemprop="content"><div class="bibliography"><h2 id="References">References</h2> <div><p>Box, G.E.P. and Cox, D.R. (1964), The analysis of transformations,
 Journal of the Royal Statistical Society, Vol. 26, pp. 211-252.</p></div><div><p>Carroll, R.J. and Ruppert, D. (1988), Transformation and Weighting in
 Regression, London: Chapman and Hall.</p></div><div><p>Yeo, I.K and Johnson, R. (2000), A new family of power transformations to
 improve normality or symmetry, "Biometrika", Vol. 87, pp. 954-959.</p></div></div></div><div class="ref_sect"><h2 id="SeeAlso">See Also</h2><p><span itemprop="seealso"><a href="Score.html" itemprop="url"><span itemprop="name"><code>Score</code></span></a></span> | <span itemprop="seealso"><a href="FSRfan.html" itemprop="url"><span itemprop="name"><code>FSRfan</code></span></a></span></div><i>This page has been automatically generated by our routine <a href="publishFS.html">publishFS</a></i></div></section></div></div></div></div><div id="divbottom"></div></body></html>