<!DOCTYPE HTML> <html itemscope="" xmlns="http://www.w3.org/1999/xhtml"><head><title>FSM</title><meta content="refpage" name="chunktype"><meta content="function:FSM" itemprop="refentity" name="refentity"><meta content="text/javascript" http-equiv="Content-Script-Type"><meta content="fcn" itemprop="pagetype" name="toctype"><meta content="ref/function" itemprop="infotype" name="infotype" /><meta content="FSM computes forward search estimator in multivariate analysis." itemprop="description" name="description" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" /><script type="text/x-mathjax-config">MathJax.Hub.Config({extensions: ["tex2jax.js"],jax: ["input/TeX","output/HTML-CSS"],menuSettings: {zoom: "Double-Click", zscale: "300"},tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},MathMenu: {showRenderer: false},"HTML-CSS": {availableFonts: ["TeX"],preferredFont: "TeX",imageFont: null}});</script><script type="text/javascript" src="includesFS/Mathjax/MathJax.js"></script><script src="includesFS/matlab-highlighter.min.js"></script><link href="includesFS/matlab-highlighter.css" rel="stylesheet" type="text/css"><script type="text/javascript" src="includesFS/jquery-latest.js"></script><script>$(document).ready(function(){      $("#divtop").load("includesFS/top.html");      $("#divbottom").load("includesFS/bottom.html");});</script><link href="../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)"></link><link href="../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)"></link><link href="../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)"></link><link href="../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)"></link><link href="../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)"></link><link href="../includes/product/css/site6_offcanvas.css" rel="stylesheet" type="text/css"></link><script src="../includes/shared/scripts/l10n.js" type="text/javascript"></script><script src="../includes/product/scripts/docscripts.js"></script><script src="../includes/shared/scripts/docscripts_rn.js"></script><script src="../includes/shared/scripts/mw.imageanimation.js" type="text/javascript"></script><script src="../includes/shared/scripts/jquery.highlight.js"></script><script src="../includes/product/scripts/bootstrap.min.js" type="text/javascript"></script><script src="../includes/product/scripts/global.js"></script><script src="includesFS/bottom.js" type="text/javascript"></script><script src="../includes/product/scripts/underscore-min.js"></script><script src="../includes/shared/scripts/f1help.js" type="text/javascript"></script><script src="../includes/product/scripts/suggest.js" type="text/javascript"></script><script src="../includes/shared/scripts/helpservices.js" type="text/javascript"></script><script src="../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script><!-- the following line should be kept this way only --><link href="includesFS/doc_center.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css"><link href="../includes/product/css/doc_center_print.css" media="print" rel="stylesheet" type="text/css"></head><body  onload="highlightMATLABCode();" id="responsive_offcanvas">  <div id="doc_header_spacer" class="header"></div><div class="sticky_header_container includes_subnav"><div class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-xs-12 col-sm-6 col-sm-push-6 col-md-5 col-md-push-7" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2017a" data-language="en" action="../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="sr-only">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"><div class="input-group-btn"><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search pull-right icon_32 visible-xs" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="col-sm-6 col-sm-pull-6 col-md-7 col-md-pull-5" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../documentation-center.html">Documentation</a></h1></div></div></div><div class="visible-xs" id="search_actuator"><button class="btn icon-search btn_search pull-right icon_16" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div><!--END.CLASS row--> </div><!--END.CLASS container-fluid--> </div><!--END.CLASS section_header level_3--><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_actuator" data-toggle="offcanvas" data-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="sr-only">Toggle navigation</span><span class="icon-menu icon_24"></span></button><span class="offcanvas_actuator_label"></span><span class="offcanvas_actuator_close"></span> </div><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-md-12 hidden-xs hidden-sm"></div></div></div></div></div></div></div><!--END.CLASS sticky_header_container--><div class="row-offcanvas row-offcanvas-left"><div id="sidebar" class="sidebar-offcanvas" role="navigation"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" xmlns:atict="http://www.arbortext.com/namespace/atict"><li itemprop="breadcrumb" itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb"> <a href="../documentation-center.html" itemprop="url"> <span itemprop="title">All Products</span></a></li></ul><ul class="nav_disambiguation" xmlns:atict="http://www.arbortext.com/namespace/atict"><li class="product"><a href="index.html">Flexible Statistics and Data Analysis (FSDA)</a><div class="dropdown"> <span id="dropdownMenu1" class="icon-arrow-down icon_16" data-toggle="dropdown"> </span><ul aria-labelledby="dropdownMenu1" class="dropdown-menu dropdown-menu-right" role="menu"><li role="presentation"> <a href="examples.html" role="menuitem" tabindex="-1">Examples</a></li><li role="presentation"> <a href="function-alpha.html" role="menuitem" tabindex="-1"> Functions and Other Reference</a></li><li role="presentation"> <a href="release_notes.html?s_cid=doc_flyout" role="menuitem" tabindex="-1"> Release Notes</a></li><li role="presentation"> <a href="tutorials.html" role="menuitem" tabindex="-1"> Tutorials</a></li></ul></div></li></ul><ul xmlns:atict="http://www.arbortext.com/namespace/atict" class="nav_disambiguation"> <li><a href="index.html">Flexible Statistics and Data Analysis Toolbox</a> </li> <li><a href="function-cate.html" itemprop="url">Functions</a></li></ul><!-- --><ul class="nav_scrollspy nav" xmlns:atict="http://www.arbortext.com/namespace/atict">  <li class="nav_scrollspy_function"> <a href="#responsive_offcanvas">FSM</a></li> <li id="SSPY810-refentry" class="nav_scrollspy_title">On this page</li><li><a class="intrnllnk" href="#syntax">Syntax</a></li><li><a class="intrnllnk" href="#Description">Description</a></li><li><a class="intrnllnk" href="#Examples">Examples</a><ul><li><a class="intrnllnk" href="#Example_1">FSM with all default options.</a></li><li><a class="intrnllnk" href="#Example_2">FSM with optional arguments.</a></li></ul></li><li><a class="intrnllnk" href="#ExtraExamples">Extra Examples</a><ul><li><a class="intrnllnk" href="#ExtraExample_1">FSM with plots showing envelope superimposition in normal
     coordinates.</a></li><li><a class="intrnllnk" href="#ExtraExample_2">Monitor the exceedances from m=200 without showing plots.</a></li><li><a class="intrnllnk" href="#ExtraExample_3">Choosing an initial subset formed by the three observations with
     the smallest Mahalanobis Distance.</a></li><li><a class="intrnllnk" href="#ExtraExample_4">Forgery Swiss banknotes examples.</a></li></ul></li><li><a class="intrnllnk" href="#Inputs">Input Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_Y">Y</a></li></ul></li><li><a class="intrnllnk" href="#NameValuePairs">Name-Value Pair Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_namevalue_bonflev">bonflev</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_crit">crit</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_init">init</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_m0">m0</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_msg">msg</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_nocheck">nocheck</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_rf">rf</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_plots">plots</a></li></ul></li><li><a class="intrnllnk" href="#OutputArgs">Output Arguments</a><ul><li><a class="intrnllnk" href="#output_argument_out">out</a></li></ul></li><li><a class="intrnllnk" href="#References">References</a></li><li><a class="intrnllnk" href="#SeeAlso">See Also</a></li></ul></nav><script src="../includes/product/scripts/offcanvas.js"></script></div><div id="divtop"></div><div class="site_container site_toc_closed"><div class="page_container"><div class="content_frame"><div id="content_container" class="content_container"><section id="doc_center_content"><div class="function_ref"><div itemprop="content"><h1 itemprop="title">FSM</h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose">FSM computes forward search estimator in multivariate analysis</p><div class="switch"><a id="expandAllPage" href="javascript:void(0);">expand all in page</a></div></div></div></div><div class="ref_sect"><h2 id="syntax">Syntax</h2><div class="syntax_signature"><div class="syntax_signature_module"><ul><li><code class="synopsis">out=FSM(Y)</code><span class="syntax_example"><a class="intrnllnk" href="FSM.html#Example_1">example</a></span></li><li><code class="synopsis">out=FSM(Y,Name,Value)</code><span class="syntax_example"><a class="intrnllnk" href="FSM.html#Example_2">example</a></span></li></ul></div></div></div>	<div class="ref_sect" itemprop="content">							<h2 id="Description">Description</h2>							<div class="descriptions">								<div class="description_module"><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="FSM.html#Example_1">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_out"><code>out</code></a>=FSM(<a class="intrnllnk" href="#inputarg_Y"><code>Y</code></a>)</code></span>FSM with all default options.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="FSM.html#Example_2">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_out"><code>out</code></a>=FSM(<a class="intrnllnk" href="#inputarg_Y"><code>Y</code></a>,<a class="intrnllnk" href="#namevaluepairarguments"><code>Name, Value</code></a>)</code></span>FSM with optional arguments.</p></div>								</div>							</div>							<div class="clear">							</div>						</div><div class="ref_sect" itemprop="content"><div class="examples"><h2 id="Examples">Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="example_1" class="example_module expandableContent"><div id="Example_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> FSM with all default options.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">n=200;
v=3;
randn('state', 123456);
Y=randn(n,v);
% Contaminated data
Ycont=Y; Ycont(1:5,[1,3]) = Ycont(1:5,[1,3])+sign(randn(5,2))*4.5;
[out]=FSM(Ycont);
title('Outliers detected by FSM','Fontsize',24,'Interpreter','LaTex');</pre></div></div><pre class="codeoutput">-------------------------
Signal detection loop
dmin(195,200)&gt;99.9% and dmin(196,200)&gt;99.9% and rmin(194,200)&gt;99%
drmin(194,200)&gt;99.9% and dmin(195,200)&gt;99.9% and rmin(196,200)&gt;99%
dmin(195,200)&gt;99% at final step: Bonferroni signal in the final part of the search.
dmin(195,200)&gt;99.999%
-------------------
Signal validation
Validated signal
-------------------------------
Start resuperimposing envelopes from step m=194
Superimposition stopped because d_{min}(195,196)&gt;99% envelope
$d_{min}(195,196)&gt;99$\% envelope
----------------------------
Final output
Number of units declared as outliers=5
Summary of the exceedances
           1          99         999        9999       99999
           0           6           6           4           4

</pre><a href='http://rosa.unipr.it/fsda/FSM.html#Example_1'><img vspace="5" hspace="5" src="images\FSM_01.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website). Graphical output could not be included in the installation file because toolboxes cannot be greater than 20MB. To load locally the image files, download zip file http://rosa.unipr.it/fsda/images.zip and unzip it to <tt>(docroot)/FSDA/images</tt> or simply run routine <tt>downloadGraphicalOutput.m</tt>"> <img vspace="5" hspace="5" src="images\FSM_02.png" alt=""> </a></p></div></div><div id="example_2" class="example_module expandableContent"><div id="Example_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> FSM with optional arguments.</li></span></a></span></h3><div class="collapse"><p>
     FSM with plots showing envelope superimposition.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">n=200;
v=3;
randn('state', 123456);
Y=randn(n,v);
% Contaminated data
Ycont=Y;
Ycont(1:5,:)=Ycont(1:5,:)+3;
[out]=FSM(Ycont,'plots',2);</pre></div></div><pre class="codeoutput">-------------------------
Signal detection loop
dmin(195,200)&gt;99.9% and dmin(196,200)&gt;99.9% and rmin(194,200)&gt;99%
drmin(194,200)&gt;99.9% and dmin(195,200)&gt;99.9% and rmin(196,200)&gt;99%
dmin(195,200)&gt;99.999%
-------------------
Signal validation
Validated signal
-------------------------------
Start resuperimposing envelopes from step m=194
Superimposition stopped because d_{min}(195,198)&gt;99% envelope
$d_{min}(195,198)&gt;99$\% envelope
Subsample of 197 units is homogeneous
----------------------------
Final output
Number of units declared as outliers=3
Summary of the exceedances
           1          99         999        9999       99999
           0           6           5           3           3

</pre><a href='http://rosa.unipr.it/fsda/FSM.html#Example_2'><img vspace="5" hspace="5" src="images\FSM_03.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website). Graphical output could not be included in the installation file because toolboxes cannot be greater than 20MB. To load locally the image files, download zip file http://rosa.unipr.it/fsda/images.zip and unzip it to <tt>(docroot)/FSDA/images</tt> or simply run routine <tt>downloadGraphicalOutput.m</tt>"> <img vspace="5" hspace="5" src="images\FSM_04.png" alt=""> <img vspace="5" hspace="5" src="images\FSM_05.png" alt=""> <img vspace="5" hspace="5" src="images\FSM_06.png" alt=""> </a></p></div></div></div><p> </p><div class="examples"><h2 id="ExtraExamples" class="bottom_ruled">Related Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="Extraexample_1" class="example_module expandableContent"><div id="ExtraExample_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> FSM with plots showing envelope superimposition in normal
     coordinates.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">n=200;
v=3;
randn('state', 123456);
Y=randn(n,v);
% Contaminated data
Ycont=Y;
Ycont(1:5,:)=Ycont(1:5,:)+3;
plots=struct;
plots.ncoord=1;
[out]=FSM(Ycont,'plots',plots);</pre></div></div><pre class="codeoutput">-------------------------
Signal detection loop
dmin(195,200)&gt;99.9% and dmin(196,200)&gt;99.9% and rmin(194,200)&gt;99%
drmin(194,200)&gt;99.9% and dmin(195,200)&gt;99.9% and rmin(196,200)&gt;99%
dmin(195,200)&gt;99.999%
-------------------
Signal validation
Validated signal
-------------------------------
Start resuperimposing envelopes from step m=194
Superimposition stopped because d_{min}(195,198)&gt;99% envelope
$d_{min}(195,198)&gt;99$\% envelope
Subsample of 197 units is homogeneous
----------------------------
Final output
Number of units declared as outliers=3
Summary of the exceedances
           1          99         999        9999       99999
           0           6           5           3           3

</pre><a href='http://rosa.unipr.it/fsda/FSM.html#ExtraExample_1'><img vspace="5" hspace="5" src="images\FSM_07.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website)"> <img vspace="5" hspace="5" src="images\FSM_08.png" alt=""> <img vspace="5" hspace="5" src="images\FSM_09.png" alt=""> <img vspace="5" hspace="5" src="images\FSM_10.png" alt=""> </a></p></div></div><div id="Extraexample_2" class="example_module expandableContent"><div id="ExtraExample_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Monitor the exceedances from m=200 without showing plots.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">n=1000;
v=10;
Y=randn(n,v);
[out]=FSM(Y,'init',200,'plots',0);</pre></div></div></p></div></div><div id="Extraexample_3" class="example_module expandableContent"><div id="ExtraExample_3"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Choosing an initial subset formed by the three observations with
     the smallest Mahalanobis Distance.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">n=100;
v=3;
Y=randn(n,v);
% Contaminated data
Ycont=Y;
Ycont(1:5,:)=Ycont(1:5,:)+3;
[out]=FSM(Ycont,'m0',5,'crit','md');</pre></div></div></p></div></div><div id="Extraexample_4" class="example_module expandableContent"><div id="ExtraExample_4"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Forgery Swiss banknotes examples.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">load('swiss_banknotes');
Y=swiss_banknotes{:,:};
% Monitor the exceedances of Minimum Mahalanobis Distance
[out]=FSM(Y(101:200,:),'plots',1);
% Control minimum and maximum on the x axis
plots=struct;
plots.xlim=[60 90];
[out]=FSM(Y(101:200,:),'plots',plots);
% Monitor the exceedances of Minimum Mahalanobis Distance using normal coordinates for mmd.
plots.ncoord=1;
[out]=FSM(Y(101:200,:),'plots',plots);</pre></div></div></p></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="Inputs">Input Arguments</h2><div class="expandableContent"><div class="arguments"><div class="input_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"> <div id="inputarg_Y" class="clearfix"> </div> <h3 id="input_argument_Y" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>Y</code> &#8212; Input data. </span>  </a><span class="example_desc">Matrix.</span></span></h3> <div class="collapse"> <p><p>n x v data matrix; n observations and v variables. Rows of
               Y represent observations, and columns represent variables.</p> <p>
               Missing values (NaN's) and infinite values (Inf's) are
               allowed, since observations (rows) with missing or infinite
               values will automatically be excluded from the
               computations.</p><p>
                </p></p> <p class="datatypelist"><strong> Data Types: </strong><code>single|double</code></p> </div> </div><div id="namevaluepairarguments" class="clearfix"></div><h3 id="NameValuePairs" class="bottom_ruled">Name-Value Pair Arguments</h3><div class="namevaluecontainer"><p>Specify optional comma-separated pairs of <code>Name,Value</code> arguments. <code>Name</code> is the argument name and <code>Value</code> is the corresponding value. <code>Name</code> must appear  inside single quotes (<code>' '</code>).  You can specify several name and value pair arguments in any order as <code>  Name1,Value1,...,NameN,ValueN</code>.</p>  <span class="example_desc"><strong>Example:</strong><code><code> 'bonflev',0.7
</code>,<code> 'crit','md'
</code>,<code> 'init',50
</code>,<code> 'm0',5
</code>,<code> 'msg',0
</code>,<code> 'nocheck',1
</code>,<code> 'rf',0.9
</code>,<code> 'plots',2
</code></code></span></div><div class="expandableContent"><div id="inputarg_bonflev" class="clearfix"></div><h3 id="input_argument_namevalue_bonflev" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>bonflev</code> &#8212;option that might be used to identify extreme outliers
                 when the distribution of the data is strongly non normal.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>In these circumstances, the general signal detection rule based on
                 consecutive exceedances cannot be used. In this case
                 bonflev can be:</p> <p>
                 - a scalar smaller than 1, which specifies the confidence
                   level for a signal and a stopping rule based on the
                   comparison of the minimum deletion residual with a
                   Bonferroni bound. For example if bonflev=0.99 the
                   procedure stops when the trajectory exceeds for the
                   first time the 99% bonferroni bound.</p> <p>
                 - A scalar value greater than 1. In this case the
                   procedure stops when the residual trajectory exceeds
                   for the first time this value.</p> <p>
                 Default value is ' ', which means to rely on general rules
                 based on consecutive exceedances.</p><p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'bonflev',0.7
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_crit" class="clearfix"></div><h3 id="input_argument_namevalue_crit" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>crit</code> &#8212;It specified the criterion to be used to
                 initialize the search.</span></a><span class="example_desc">'md' (default) | 'biv' | 'uni.</span></span></h3><div class="collapse">	<p><p>if crit='md' (default) the units which form initial subset are
                  those which have the smallest m0 Mahalanobis
                  distances (defined as sum of bivariate robust
                  Mahalanobis distances) computed using procedure unibiv
                  (bivariate robust ellipses).</p> <p>
                 if crit='biv' sorting is done first in
                  terms of times units fell outside robust bivariate
                  ellipses and then in terms of Mahalanobis distances. In other words,
                  the units forming initial subset are chosen first among
                  the set of those which never fell outside robust
                  bivariate ellipses then among those which fell only once
                  outside bivariate ellipses ... up to reach m0.</p> <p>
                 if crit='uni' sorting is done first in
                  terms of number of times units fell outside univariate boxplots
                  and then in terms of Mahalanobis distances. In other words,
                  the units forming initial subset are chosen first among
                  the set of those which never fell outside
                  univariate boxplots then among those which fell only once
                  outside univariate boxplots... up to reach m0.</p> <p>
                                Remark: as the user can see the starting point of the
                 search is not going to affect at all the results of the
                 analysis. The user can explore this point with his own
                 datasets.</p> <p>
                 Remark: if crit='biv' the user can also supply in scalar rf
                 (see below) the confidence level of the bivariate
                 ellipses.</p><p>

</p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'crit','md'
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>char</code></p></div></div><div class="expandableContent"><div id="inputarg_init" class="clearfix"></div><h3 id="input_argument_namevalue_init" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>init</code> &#8212;Point where to start monitoring required diagnostics.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>Note that if initial subset is supplied (that is input
                 option m0 is a vector of length greater than 1)
                 init must be greater or equal than length(m0). If init is not
                 specified it will be set equal to floor(n*0.6).</p> <p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'init',50
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_m0" class="clearfix"></div><h3 id="input_argument_namevalue_m0" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>m0</code> &#8212;Initial subset size or vector which contains the list of
                 the units forming initial subset.</span></a><span class="example_desc">scalar | vector.</span></span></h3><div class="collapse">	<p><p>The default is $m0=v+1$, that is we start the search with v+1 units.</p> <p>  
                 The v+1 units are chosen according to input option 'crit'.</p> <p>
                 If on the other hand, m0 is a vector of length greater
                 than 1 it contains the indexes of the units which must
                 form the initial susbet. For example if m0=[1;3;10;23;45];</p> <p>
                 the initial subset is formed by units 1, 3, 10, 23 and
                 45. Note that if  m0 is a vector
                 of length greater than 1, option crit is ignored.</p><p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'm0',5
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_msg" class="clearfix"></div><h3 id="input_argument_namevalue_msg" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>msg</code> &#8212;It controls whether to display or not messages
                 on the screen.</span></a><span class="example_desc">boolean.</span></span></h3><div class="collapse">	<p><p>If msg==1 (default) messages about the progression of the
                 search are displayed on the screen otherwise only error
                 messages will be displayed.</p> <p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'msg',0
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>logical</code></p></div></div><div class="expandableContent"><div id="inputarg_nocheck" class="clearfix"></div><h3 id="input_argument_namevalue_nocheck" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>nocheck</code> &#8212;It controls whether to perform checks on matrix Y.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>If nocheck is equal to 1 no check is performed.</p> <p>
                 As default nocheck=0.</p><p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'nocheck',1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_rf" class="clearfix"></div><h3 id="input_argument_namevalue_rf" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>rf</code> &#8212;confidence level for bivariate ellipses.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>The default is
                 0.95. This option is used only if crit='biv' and input
                 option m0 is not a vector with length greater than 1.</p> <p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'rf',0.9
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_plots" class="clearfix"></div><h3 id="input_argument_namevalue_plots" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>plots</code> &#8212;plot of minimum Mahalanobis distance.</span></a><span class="example_desc">scalar | structure.</span></span></h3><div class="collapse">	<p><p>If plots is a missing value or is a
                 scalar equal to 0 no plot is produced.</p> <p>
                 If plots is a scalar equal to 1 (default) the plot
                 of minimum MD with envelopes based on n observations and
                 the scatterplot matrix with the outliers highlighted is
                 produced.</p> <p>
                 If plots is a scalar equal to 2 the additional plots of
                 envelope resuperimposition are
                 produced.</p> <p>
                 If plots is a structure it may contain the following fields:</p><p>
           </p><table border="2" cellpadding="4" cellspacing="0" class="body"><colgroup><col width="20%"><col width="80%"></colgroup><thead><tr valign="top"><th valign="top">Value</th><th valign="top">Description</th></tr></thead><tr valign="top"><td><code>ylim</code></td><td><p>vector with two elements controlling minimum and maximum
                       on the y axis. Default value is '' (automatic
                       scale);</p></td></tr><tr valign="top"><td><code>xlim</code></td><td><p>vector with two elements controlling minimum and maximum
                       on the x axis. Default value is '' (automatic
                       scale);</p></td></tr><tr valign="top"><td><code>resuper</code></td><td><p>vector which specifies for which steps it is
                       necessary to show the plots of resuperimposed envelopes
                       if resuper is not supplied a plot of each step in which the
                       envelope is resuperimposed is shown. Example if resuper =[85 87]
                       plots of resuperimposedenvelopes are shown at steps
                       m=85 and m=87;</p></td></tr><tr valign="top"><td><code>ncoord</code></td><td><p>boolean. If ncoord=true plots are shown in normal
                       coordinates else (default) plots are shown in
                       traditional mmd coordinates;</p></td></tr><tr valign="top"><td><code>labeladd</code></td><td><p>If this option is '1', the outliers in the
                       spm are labelled with the unit row index. The
                       default value is labeladd='', i.e. no label is
                       added;</p></td></tr><tr valign="top"><td><code>nameY</code></td><td><p>cell array of strings containing the labels of
                       the variables. As default value, the labels which are
                       added are Y1, ...Yv;</p></td></tr><tr valign="top"><td><code>lwd</code></td><td><p>Scalar which controls line width of the curve which
                       contains the monitoring of minimum Mahalanobis
                       distance. Default line of lwd=2.</p></td></tr><tr valign="top"><td><code>lwdenv</code></td><td><p>Scalar which controls linewidth of the
                       envelopes. Default value of lwdenv=2.</p></td></tr></table></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'plots',2
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="OutputArgs" >Output Arguments</h2><div class="expandableContent"><div class="arguments"><div class="output_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"><div id="outputarg_out" class="clearfix"></div><h3 id="output_argument_out" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>out</code> &#8212; description</span></a><span class="example_desc">Structure</span></span></h3><div class="collapse"><p>Structure which contains the following fields<table border="2" cellpadding="4" cellspacing="0" class="body"><colgroup><col width="20%"><col width="80%"></colgroup><thead><tr valign="top"><th valign="top">Value</th><th valign="top">Description</th></tr></thead><tr valign="top"><td><code>outliers</code></td><td><p>k x 1 vector containing the list of the units declared as
               outliers or NaN if the sample is homogeneous</p></td></tr><tr valign="top"><td><code>mmd</code></td><td><p><p>(n-init) x 2 matrix.</p> <p>
               1st col = fwd search index;</p><p>
               2nd col = value of minimum Mahalanobis Distance in each step
               of the fwd search.</p></p></td></tr><tr valign="top"><td><code>Un</code></td><td><p><p>(n-init) x 11 Matrix which contains the unit(s) included
               in the subset at each step of the fwd search.</p> <p>
               REMARK: in every step the new subset is compared with the
               old subset. Un contains the unit(s) present in the new
               subset but not in the old one. Un(1,2) for example
               contains the unit included in step init+1. Un(end,2)
               contains the units included in the final step of the search.</p></p></td></tr><tr valign="top"><td><code>nout</code></td><td><p><p>2 x 5 matrix containing the number of times mmd went out
               of particular quantiles.</p> <p>
               First row contains quantiles 1 99 99.9 99.99 99.999 per cent;</p><p>
               Second row contains the frequency distribution. It is NaN
               if bonflev threshold is used.</p></p></td></tr><tr valign="top"><td><code>loc</code></td><td><p>1 x v  vector containing location of the data.</p></td></tr><tr valign="top"><td><code>cov</code></td><td><p>v x v robust estimate of covariance matrix.</p></td></tr><tr valign="top"><td><code>md</code></td><td><p>n x 1 vector containing the estimates of the robust
               Mahalanobis distances (in squared units). This vector
               contains the distances of each observation from the
               location of the data, relative to the scatter matrix cov.</p></td></tr><tr valign="top"><td><code>class</code></td><td><p>'FSM'.</p></td></tr></table></p></div></div></div></div></div></div><div class="ref_sect" itemprop="content"><div class="bibliography"><h2 id="References">References</h2> <div><p>Riani, M., Atkinson, A.C. and Cerioli, A. (2009), Finding an unknown
 number of multivariate outliers, "Journal of the Royal Statistical
 Society Series B", Vol. 71, pp. 201-221.</p></div><div><p>Cerioli, A., Farcomeni, A. and Riani M. (2014), Strong consistency and
 robustness of the Forward Search estimator of multivariate location
 and scatter, "Journal of Multivariate Analysis", Vol. 126,
 pp. 167-183, <a href="http://dx.doi.org/10.1016/j.jmva.2013.12.010">http://dx.doi.org/10.1016/j.jmva.2013.12.010</a></p></div></div></div><div class="ref_sect"><h2 id="SeeAlso">See Also</h2><p><span itemprop="seealso"><a href="FSMeda.html" itemprop="url"><span itemprop="name"><code>FSMeda</code></span></a></span> | <span itemprop="seealso"><a href="unibiv.html" itemprop="url"><span itemprop="name"><code>unibiv</code></span></a></span> | <span itemprop="seealso"><a href="FSMmmd.html" itemprop="url"><span itemprop="name"><code>FSMmmd</code></span></a></span></div><i>This page has been automatically generated by our routine <a href="publishFS.html">publishFS</a></i></div></section></div></div></div></div><div id="divbottom"></div></body></html>