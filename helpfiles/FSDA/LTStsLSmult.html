<!DOCTYPE HTML> <html itemscope="" xmlns="http://www.w3.org/1999/xhtml"><head><title>LTStsLSmult</title><meta content="refpage" name="chunktype"><meta content="function:LTStsLSmult" itemprop="refentity" name="refentity"><meta content="text/javascript" http-equiv="Content-Script-Type"><meta content="fcn" itemprop="pagetype" name="toctype"><meta content="ref/function" itemprop="infotype" name="infotype" /><meta content="LTStsLSmult extends LTSts to the detection of multiple Level Shifts in time series." itemprop="description" name="description" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" /><script type="text/x-mathjax-config">MathJax.Hub.Config({extensions: ["tex2jax.js"],jax: ["input/TeX","output/HTML-CSS"],menuSettings: {zoom: "Double-Click", zscale: "300"},tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},MathMenu: {showRenderer: false},"HTML-CSS": {availableFonts: ["TeX"],preferredFont: "TeX",imageFont: null}});</script><script type="text/javascript" src="includesFS/Mathjax/MathJax.js"></script><script src="includesFS/matlab-highlighter.min.js"></script><link href="includesFS/matlab-highlighter.css" rel="stylesheet" type="text/css"><script type="text/javascript" src="includesFS/jquery-latest.js"></script><script>$(document).ready(function(){      $("#divtop").load("includesFS/top.html");      $("#divbottom").load("includesFS/bottom.html");});</script><link href="../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)"></link><link href="../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)"></link><link href="../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)"></link><link href="../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)"></link><link href="../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)"></link><link href="../includes/product/css/site6_offcanvas.css" rel="stylesheet" type="text/css"></link><script src="../includes/shared/scripts/l10n.js" type="text/javascript"></script><script src="../includes/product/scripts/docscripts.js"></script><script src="../includes/shared/scripts/docscripts_rn.js"></script><script src="../includes/shared/scripts/mw.imageanimation.js" type="text/javascript"></script><script src="../includes/shared/scripts/jquery.highlight.js"></script><script src="../includes/product/scripts/bootstrap.min.js" type="text/javascript"></script><script src="../includes/product/scripts/global.js"></script><script src="includesFS/bottom.js" type="text/javascript"></script><script src="../includes/product/scripts/underscore-min.js"></script><script src="../includes/shared/scripts/f1help.js" type="text/javascript"></script><script src="../includes/product/scripts/suggest.js" type="text/javascript"></script><script src="../includes/shared/scripts/helpservices.js" type="text/javascript"></script><script src="../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script><!-- the following line should be kept this way only --><link href="includesFS/doc_center.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css"><link href="../includes/product/css/doc_center_print.css" media="print" rel="stylesheet" type="text/css"></head><body  onload="highlightMATLABCode();" id="responsive_offcanvas">  <div id="doc_header_spacer" class="header"></div><div class="sticky_header_container includes_subnav"><div class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-xs-12 col-sm-6 col-sm-push-6 col-md-5 col-md-push-7" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2017a" data-language="en" action="../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="sr-only">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"><div class="input-group-btn"><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search pull-right icon_32 visible-xs" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="col-sm-6 col-sm-pull-6 col-md-7 col-md-pull-5" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../documentation-center.html">Documentation</a></h1></div></div></div><div class="visible-xs" id="search_actuator"><button class="btn icon-search btn_search pull-right icon_16" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div><!--END.CLASS row--> </div><!--END.CLASS container-fluid--> </div><!--END.CLASS section_header level_3--><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_actuator" data-toggle="offcanvas" data-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="sr-only">Toggle navigation</span><span class="icon-menu icon_24"></span></button><span class="offcanvas_actuator_label"></span><span class="offcanvas_actuator_close"></span> </div><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-md-12 hidden-xs hidden-sm"></div></div></div></div></div></div></div><!--END.CLASS sticky_header_container--><div class="row-offcanvas row-offcanvas-left"><div id="sidebar" class="sidebar-offcanvas" role="navigation"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" xmlns:atict="http://www.arbortext.com/namespace/atict"><li itemprop="breadcrumb" itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb"> <a href="../documentation-center.html" itemprop="url"> <span itemprop="title">All Products</span></a></li></ul><ul class="nav_disambiguation" xmlns:atict="http://www.arbortext.com/namespace/atict"><li class="product"><a href="index.html">Flexible Statistics and Data Analysis (FSDA)</a><div class="dropdown"> <span id="dropdownMenu1" class="icon-arrow-down icon_16" data-toggle="dropdown"> </span><ul aria-labelledby="dropdownMenu1" class="dropdown-menu dropdown-menu-right" role="menu"><li role="presentation"> <a href="examples.html" role="menuitem" tabindex="-1">Examples</a></li><li role="presentation"> <a href="function-alpha.html" role="menuitem" tabindex="-1"> Functions and Other Reference</a></li><li role="presentation"> <a href="release_notes.html?s_cid=doc_flyout" role="menuitem" tabindex="-1"> Release Notes</a></li><li role="presentation"> <a href="tutorials.html" role="menuitem" tabindex="-1"> Tutorials</a></li></ul></div></li></ul><ul xmlns:atict="http://www.arbortext.com/namespace/atict" class="nav_disambiguation"> <li><a href="index.html">Flexible Statistics and Data Analysis Toolbox</a> </li> <li><a href="function-cate.html" itemprop="url">Functions</a></li></ul><!-- --><ul class="nav_scrollspy nav" xmlns:atict="http://www.arbortext.com/namespace/atict">  <li class="nav_scrollspy_function"> <a href="#responsive_offcanvas">LTStsLSmult</a></li> <li id="SSPY810-refentry" class="nav_scrollspy_title">On this page</li><li><a class="intrnllnk" href="#syntax">Syntax</a></li><li><a class="intrnllnk" href="#Description">Description</a></li><li><a class="intrnllnk" href="#Examples">Examples</a><ul><li><a class="intrnllnk" href="#Example_1">A synthetic example with all default arguments.</a></li><li><a class="intrnllnk" href="#Example_2">A synthetic example with optional arguments msg and plots.</a></li></ul></li><li><a class="intrnllnk" href="#ExtraExamples">Extra Examples</a><ul><li><a class="intrnllnk" href="#ExtraExample_1">Trade data examples.</a></li><li><a class="intrnllnk" href="#ExtraExample_2">Multiple level shift and variable selection.</a></li><li><a class="intrnllnk" href="#ExtraExample_3">Multiple level shift and variable selection.</a></li></ul></li><li><a class="intrnllnk" href="#Inputs">Input Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_y">y</a></li></ul></li><li><a class="intrnllnk" href="#NameValuePairs">Name-Value Pair Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_namevalue_alphaLS">alphaLS</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_alphaLTS">alphaLTS</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_bdp">bdp</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_maxLS">maxLS</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_model">model</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_msg">msg</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_sampleLS">sampleLS</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_startLS">startLS</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_thresLS">thresLS</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_plots">plots</a></li></ul></li><li><a class="intrnllnk" href="#OutputArgs">Output Arguments</a><ul><li><a class="intrnllnk" href="#output_argument_out">out</a></li></ul></li><li><a class="intrnllnk" href="#References">References</a></li><li><a class="intrnllnk" href="#SeeAlso">See Also</a></li></ul></nav><script src="../includes/product/scripts/offcanvas.js"></script></div><div id="divtop"></div><div class="site_container site_toc_closed"><div class="page_container"><div class="content_frame"><div id="content_container" class="content_container"><section id="doc_center_content"><div class="function_ref"><div itemprop="content"><h1 itemprop="title">LTStsLSmult</h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose">LTStsLSmult extends LTSts to the detection of multiple Level Shifts in time series</p><div class="switch"><a id="expandAllPage" href="javascript:void(0);">expand all in page</a></div></div></div></div><div class="ref_sect"><h2 id="syntax">Syntax</h2><div class="syntax_signature"><div class="syntax_signature_module"><ul><li><code class="synopsis">out=LTStsLSmult(y)</code><span class="syntax_example"><a class="intrnllnk" href="LTStsLSmult.html#Example_1">example</a></span></li><li><code class="synopsis">out=LTStsLSmult(y,Name,Value)</code><span class="syntax_example"><a class="intrnllnk" href="LTStsLSmult.html#Example_2">example</a></span></li></ul></div></div></div>	<div class="ref_sect" itemprop="content">							<h2 id="Description">Description</h2>							<div class="descriptions">								<div class="description_module"><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="LTStsLSmult.html#Example_1">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_out"><code>out</code></a>=LTStsLSmult(<a class="intrnllnk" href="#inputarg_y"><code>y</code></a>)</code></span>A synthetic example with all default arguments.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="LTStsLSmult.html#Example_2">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_out"><code>out</code></a>=LTStsLSmult(<a class="intrnllnk" href="#inputarg_y"><code>y</code></a>,<a class="intrnllnk" href="#namevaluepairarguments"><code>Name, Value</code></a>)</code></span>A synthetic example with optional arguments msg and plots.</p></div>								</div>							</div>							<div class="clear">							</div>						</div><div class="ref_sect" itemprop="content"><div class="examples"><h2 id="Examples">Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="example_1" class="example_module expandableContent"><div id="Example_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>A synthetic example with all default arguments.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">Y=rand(50,1);
Y(35:end)=Y(35:end)+5;
Y(7:20)=Y(7:20)-3;
out  = LTStsLSmult(Y,'msg',true,'plots',1);</pre></div></div></p></div></div><div id="example_2" class="example_module expandableContent"><div id="Example_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> A synthetic example with optional arguments msg and plots.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">Y=rand(50,1);
Y(35:end)=Y(35:end)+5;
Y(7:20)=Y(7:20)-3;
out  = LTStsLSmult(Y,'msg',true,'plots',1);</pre></div></div><pre class="codeoutput">significant LS at position 35 (pval = 7.1054e-15)
significant LS at position 21 (pval = 0)
significant LS at position 7 (pval = 0)
</pre><a href='http://rosa.unipr.it/fsda/LTStsLSmult.html#Example_2'><img vspace="5" hspace="5" src="images\LTStsLSmult_01.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website). Graphical output could not be included in the installation file because toolboxes cannot be greater than 20MB. To load locally the image files, download zip file http://rosa.unipr.it/fsda/images.zip and unzip it to <tt>(docroot)/FSDA/images</tt> or simply run routine <tt>downloadGraphicalOutput.m</tt>"> <img vspace="5" hspace="5" src="images\LTStsLSmult_02.png" alt=""> </a></p></div></div></div><p> </p><div class="examples"><h2 id="ExtraExamples" class="bottom_ruled">Related Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="Extraexample_1" class="example_module expandableContent"><div id="ExtraExample_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Trade data examples.</li></span></a></span></h3><div class="collapse"><p>
     Two examples taken from the (extended version of the) series in:
     Rousseeuw, P.J., Perrotta D., Riani M. and Hubert, M. (2018), Robust
     Monitoring of Many Time Series with Application to Fraud Detection,
     "Econometrics and Statistics".<div class="programlisting"><div class="codeinput"><pre class="matlab-code">load('P12119085full.txt'); % KE-GB
load('P17049075full.txt'); % UA-LT
yin1   = P12119085full(:,2);
yin2   = P17049075full(:,2);
out1  = LTStsLSmult(yin1,'msg',true,'plots',1);
title('P12119085_KE_GB','interpreter','none','Fontsize',20);
pause(1);
out2  = LTStsLSmult(yin2,'msg',true,'plots',1);
title('P17049075_UA_LT','interpreter','none','Fontsize',20);</pre></div></div></p></div></div><div id="Extraexample_2" class="example_module expandableContent"><div id="ExtraExample_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Multiple level shift and variable selection.</li></span></a></span></h3><div class="collapse"><p> Example 1.
 Detection of multiple Level Shifts followed by variable selection on the
 dataset of example before.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">load('P17049075full.txt'); 
yin2   = P17049075full(:,2);
out = LTStsLSmult(yin2,'maxLS',4,'alphaLTS',0.01,...
'alphaLS',0.01,'thresLS',0.01,'plots',1,'msg',1);
outX = out.outX;
model.trend = 2;
model.lshift = 0;
model.seasonal=303;
model.X = outX(:,3:end);
[out_model_1, out_reduced_1] = LTStsVarSel(yin2,'model',model,'plots',1);
[out_LTSts]=LTSts(yin2,'model',out_model_1,...
'plots',1,'msg',0,'dispresults',1,'SmallSampleCor',1,'conflev',1-0.01/length(yin2));</pre></div></div></p></div></div><div id="Extraexample_3" class="example_module expandableContent"><div id="ExtraExample_3"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Multiple level shift and variable selection.</li></span></a></span></h3><div class="collapse"><p> Example 2.
     Detection of multiple Level Shifts followed by variable selection on the
     dataset of example before.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">load('P12119085full.txt');
yin2   = P12119085full(:,2);
out = LTStsLSmult(yin2,'maxLS',4,'alphaLTS',0.01,...
'alphaLS',0.01,'thresLS',0.01,'plots',1,'msg',1);
outX = out.outX;
model=struct;
model.trend = 2;
model.lshift = 0;
model.seasonal=303;
model.X = outX(:,3:end);
[out_model_1, out_reduced_1] = LTStsVarSel(yin2,'model',model,'plots',1);
[out_LTSts]=LTSts(yin2,'model',out_model_1,...
'plots',1,'msg',0,'dispresults',1,'SmallSampleCor',1,'conflev',1-0.01/length(yin2));</pre></div></div></p></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="Inputs">Input Arguments</h2><div class="expandableContent"><div class="arguments"><div class="input_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"> <div id="inputarg_y" class="clearfix"> </div> <h3 id="input_argument_y" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>y</code> &#8212; Time series to analyze. </span>  </a><span class="example_desc">Vector.</span></span></h3> <div class="collapse"> <p><p>A row or a column vector
               with T elements, which contains the time series.</p> <p>
               </p></p> <p class="datatypelist"><strong> Data Types: </strong><code>double.</code></p> </div> </div><div id="namevaluepairarguments" class="clearfix"></div><h3 id="NameValuePairs" class="bottom_ruled">Name-Value Pair Arguments</h3><div class="namevaluecontainer"><p>Specify optional comma-separated pairs of <code>Name,Value</code> arguments. <code>Name</code> is the argument name and <code>Value</code> is the corresponding value. <code>Name</code> must appear  inside single quotes (<code>' '</code>).  You can specify several name and value pair arguments in any order as <code>  Name1,Value1,...,NameN,ValueN</code>.</p>  <span class="example_desc"><strong>Example:</strong><code><code> 'alphaLS', 0.1
</code>,<code> 'alphaLTS',0.1
</code>,<code> 'bdp',0.4
</code>,<code> 'maxLS', 8
</code>,<code> 'model', model
</code>,<code> 'msg',true
</code>,<code> 'sampleLS', [5 16 27 35]
</code>,<code> 'startLS', 15
</code>,<code></code>,<code> 'plots',1
</code></code></span></div><div class="expandableContent"><div id="inputarg_alphaLS" class="clearfix"></div><h3 id="input_argument_namevalue_alphaLS" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>alphaLS</code> &#8212;maximum pvalue to consider a Level Shift significant.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>It is a threshold for detecting significant Level
               Shifts. Default is 0.01.</p> <p>
                </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'alphaLS', 0.1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_alphaLTS" class="clearfix"></div><h3 id="input_argument_namevalue_alphaLTS" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>alphaLTS</code> &#8212;complement of the confidence level.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>Scalar between 
               0 and 1 containing the complement (to 1) of the confidence
               level which is used to declare units as outliers in each
               call to LTSts. Usually alpha = 0.05/T, 0.025/T, 1-0.01/T
               (simultaneous alpha). Default value is 0.01/T where
               T=length(y).</p> <p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'alphaLTS',0.1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_bdp" class="clearfix"></div><h3 id="input_argument_namevalue_bdp" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>bdp</code> &#8212;breakdown point.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>It measures the fraction of outliers
               the algorithm should resist. In this case any value greater
               than 0 but smaller or equal than 0.5 will do fine. Default
               value 0.1.</p> <p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'bdp',0.4
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_maxLS" class="clearfix"></div><h3 id="input_argument_namevalue_maxLS" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>maxLS</code> &#8212;maximum number of Level Shifts.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>Maximum number of
               Level Shifts that the function looks for. Default is 5.</p> <p>
                </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'maxLS', 8
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_model" class="clearfix"></div><h3 id="input_argument_namevalue_model" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>model</code> &#8212;model type.</span></a><span class="example_desc">structure.</span></span></h3><div class="collapse">	<p><p>A structure which specifies the model
               which will be used. The model structure contains the following
               fields:</p> <p>
       </p><table border="2" cellpadding="4" cellspacing="0" class="body"><colgroup><col width="20%"><col width="80%"></colgroup><thead><tr valign="top"><th valign="top">Value</th><th valign="top">Description</th></tr></thead><tr valign="top"><td><code>s</code></td><td><p>scalar (length of seasonal period). For monthly
                         data s=12 (default), for quartely data s=4, ...</p></td></tr><tr valign="top"><td><code>trend</code></td><td><p><p>scalar (order of the trend component).</p> <p>
                       trend = 0 implies no trend;</p> <p>
                       trend = 1 implies linear trend with intercept (default);</p> <p>
                       trend = 2 implies quadratic trend;</p> <p>
                       trend = 3 implies cubic trend.</p><p>
                       Admissible values for trend are, 0, 1, 2 and 3.</p></p></td></tr><tr valign="top"><td><code>seasonal</code></td><td><p><p>scalar (integer specifying number of
                        frequencies, i.e. harmonics, in the seasonal
                        component. Possible values for seasonal are
                        $0,1, 2, ..., [s/2]$, where $[s/2]=floor(s/2)$.</p> <p>
                        If seasonal =0 we assume there is no seasonal
                        component.</p> <p>
                        If seasonal =1 (default) we have:</p> <p>
                        $\beta_1 \cos( 2 \pi t/s) + \beta_2 sin ( 2 \pi t/s)$;</p> <p>
                        if seasonal =2 we have:</p> <p>
                        $\beta_1 \cos( 2 \pi t/s) + \beta_2 \sin ( 2 \pi t/s)
                        + \beta_3 \cos(4 \pi t/s) + \beta_4 \sin (4 \pi t/s)$.</p> <p>
                        Note that when $s$ is even the sine term disappears
                        for $j=s/2$ and so the maximum number of
                        trigonometric parameters is $s-1$.</p> <p>
                        If seasonal is a number greater than 100 then it
                        is possible to specify how the seasonal component
                        grows over time.</p> <p>
                        For example, seasonal = 101 implies a seasonal
                        component which just uses one frequency
                        which grows linearly over time as follows:</p> <p>
                        $(1+\beta_3 t)\times ( \beta_1 cos( 2 \pi t/s) +
                        \beta_2 \sin ( 2 \pi t/s))$.</p> <p>
                        For example, seasonal =201 implies a seasonal
                        component which just uses one frequency
                        which grows in a quadratic way over time as
                        follows:</p> <p>
                        $(1+\beta_3 t + \beta_4  t^2)\times( \beta_1 \cos(
                        2 \pi t/s) + \beta_2 \sin ( 2 \pi t/s))$.</p> <p>
                        seasonal =0 implies a non seasonal model.</p> <p>
                       In the paper RPRH to denote the number of
                       frequencies of the seasonal component
                       symbol B is used, while symbol G is used to denote
                       the order of the trend of the seasonal component.</p><p>
                       Therefore, for example, model.seasonal=201
                       corresponds to B=1 and G=2, while model.seasonal=3
                       corresponds to B=3 and G=0;</p></p></td></tr><tr valign="top"><td><code>X</code></td><td><p>matrix of size T-by-nexpl containing the
                         values of nexpl extra covariates which are likely
                         to affect y.</p></td></tr><tr valign="top"><td><code>ARp</code></td><td><p><p>vector with non negative integer numbers
                       specifying the autoregressive
                       components. For example:</p> <p> 
                        model.ARp=[1 2] means a AR(2) process;</p> <p> 
                        model.ARp=2 means just the lag 2 component;</p> <p>
                        model.ARp=[1 2 5 8] means AR(2) + lag 5 + lag 8;</p><p>
                        model.ARp=0 (default) means no autoregressive component.</p></p></td></tr><tr valign="top"><td><code>ARtentout</code></td><td><p><p>matrix of size r-by-2 containing the list
                       of the units declared as outliers (first column)
                       and corresponding fitted values (second column) or
                       empty scalar. If model.ARtentout is not empty, when
                       the autoregressive component is present, the y
                       values which are used to compute the autoregressive
                       component are replaced by model.tentout(:,2) for
                       the units contained in model.tentout(:,1)
                                Remark: the default model is for monthly data with no
               trend (1 parameter) + seasonal component with just one
               harmonic (2 parameters), no additional explanatory
               variables and no level shift that is
                               model=struct;</p> <p>
                               model.s=12;</p> <p>
                               model.trend=0;</p> <p>
                               model.seasonal=1;</p><p>
                               model.X=[];</p></p></td></tr><tr valign="top"><td><code>lshift</code></td><td><p>0;</p></td></tr></table></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'model', model
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>struct</code></p></div></div><div class="expandableContent"><div id="inputarg_msg" class="clearfix"></div><h3 id="input_argument_namevalue_msg" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>msg</code> &#8212;Messages on the screen.</span></a><span class="example_desc">boolean.</span></span></h3><div class="collapse">	<p>Scalar which controls whether to display or not messages
               on the screen. If msg==true (default) messages are displayed on
               the screen about estimated time to compute the estimator
               and the warnings about 'MATLAB:rankDeficientMatrix',
               'MATLAB:singularMatrix' and 'MATLAB:nearlySingularMatrix'
               are set to off else no message is displayed on the screen
               </p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'msg',true
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>logical</code></p></div></div><div class="expandableContent"><div id="inputarg_sampleLS" class="clearfix"></div><h3 id="input_argument_namevalue_sampleLS" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>sampleLS</code> &#8212;vector of the positions in which Level Shift should be
               tested.</span></a><span class="example_desc">vector.</span></span></h3><div class="collapse">	<p><p>It is be the vector for the parameter 
                   model.lshift of the LTSts function.</p> <p>
                   Default is 3.</p><p> 
                </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'sampleLS', [5 16 27 35]
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_startLS" class="clearfix"></div><h3 id="input_argument_namevalue_startLS" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>startLS</code> &#8212;first position in which Level Shift should be tested.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>It is the low extreme of the interval for
                   the parameter model.lshift for the LTSts function.</p> <p>
                   Default is 3.</p><p> 
                </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'startLS', 15
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_thresLS" class="clearfix"></div><h3 id="input_argument_namevalue_thresLS" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>thresLS</code> &#8212;minimum length of the time series to look for Level Shift.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>In order to detect Level Shifts the series should 
               have more than thresLS observations.</p> <p> 
               Default is 20.</p><p> 
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code></code></p>	<p class="datatypelist"><strong>Data Types: </strong><code></code></p></div></div><div class="expandableContent"><div id="inputarg_plots" class="clearfix"></div><h3 id="input_argument_namevalue_plots" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>plots</code> &#8212;Plots on the screen.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>If plots = 1, a two panel plot will be shown on the screen.</p> <p>
               The upper panel contains the orginal time series with
               fitted values. The bottom panel will contain the plot
               of robust residuals against index number. The confidence
               level which is used to draw the horizontal lines associated
               with the bands for the residuals is specified in input
               option conflev.</p> <p> 
               The default value of plot is 0 i.e. no plot is shown on the
               screen.</p><p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'plots',1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="OutputArgs" >Output Arguments</h2><div class="expandableContent"><div class="arguments"><div class="output_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"><div id="outputarg_out" class="clearfix"></div><h3 id="output_argument_out" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>out</code> &#8212; description</span></a><span class="example_desc">Structure</span></span></h3><div class="collapse"><p>A structure containing the following fields
    <table border="2" cellpadding="4" cellspacing="0" class="body"><colgroup><col width="20%"><col width="80%"></colgroup><thead><tr valign="top"><th valign="top">Value</th><th valign="top">Description</th></tr></thead><tr valign="top"><td><code>R2</code></td><td><p>Scalar containing the goodness of fit.</p></td></tr><tr valign="top"><td><code>yhat</code></td><td><p>Vector of the fitted values</p></td></tr><tr valign="top"><td><code>LSpos</code></td><td><p>Vector of the positions of the detected Level
                       Shifts</p></td></tr><tr valign="top"><td><code>LSpval</code></td><td><p>Vector of the pvalues of the detected Level
                       Shifts</p></td></tr><tr valign="top"><td><code>LSud</code></td><td><p>Vector of the sign (positive or negative) of the detected Level
                       Shifts residuals</p></td></tr><tr valign="top"><td><code>outliers</code></td><td><p>Vector of the positions of the detected
                       outliers</p></td></tr><tr valign="top"><td><code>outX</code></td><td><p>Structure containing the final output of LTSts. It
               is useful later to run LTStsVarSel with in the parameter
               model also the item model.X, containing the dummy variables with
               Level Shifts positions.</p></td></tr></table></p></div></div></div></div></div></div><div class="ref_sect" itemprop="content"><div class="bibliography"><h2 id="References">References</h2> <div><p>Rousseeuw, P.J., Perrotta D., Riani M. and Hubert, M. (2018), Robust
 Monitoring of Many Time Series with Application to Fraud Detection,
 "Econometrics and Statistics". [RPRH]</p></div></div></div><div class="ref_sect"><h2 id="SeeAlso">See Also</h2><p><span itemprop="seealso"><a href="LTSts.html" itemprop="url"><span itemprop="name"><code>LTSts</code></span></a></span> | <span itemprop="seealso"><a href="wedgeplot.html" itemprop="url"><span itemprop="name"><code>wedgeplot</code></span></a></span> | <span itemprop="seealso"><a href="LTStsVarSel.html" itemprop="url"><span itemprop="name"><code>LTStsVarSel</code></span></a></span></div><i>This page has been automatically generated by our routine <a href="publishFS.html">publishFS</a></i></div></section></div></div></div></div><div id="divbottom"></div></body></html>