<!DOCTYPE HTML> <html itemscope="" xmlns="http://www.w3.org/1999/xhtml"><head><title>MixSim</title><meta content="refpage" name="chunktype"><meta content="function:MixSim" itemprop="refentity" name="refentity"><meta content="text/javascript" http-equiv="Content-Script-Type"><meta content="fcn" itemprop="pagetype" name="toctype"><meta content="ref/function" itemprop="infotype" name="infotype" /><meta content="MixSim generates k clusters in v dimensions with given overlap." itemprop="description" name="description" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" /><script type="text/x-mathjax-config">MathJax.Hub.Config({extensions: ["tex2jax.js"],jax: ["input/TeX","output/HTML-CSS"],menuSettings: {zoom: "Double-Click", zscale: "300"},tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},MathMenu: {showRenderer: false},"HTML-CSS": {availableFonts: ["TeX"],preferredFont: "TeX",imageFont: null}});</script><script type="text/javascript" src="includesFS/Mathjax/MathJax.js"></script><script src="includesFS/matlab-highlighter.min.js"></script><link href="includesFS/matlab-highlighter.css" rel="stylesheet" type="text/css"><script type="text/javascript" src="includesFS/jquery-latest.js"></script><script>$(document).ready(function(){      $("#divtop").load("includesFS/top.html");      $("#divbottom").load("includesFS/bottom.html");});</script><link href="../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)"></link><link href="../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)"></link><link href="../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)"></link><link href="../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)"></link><link href="../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)"></link><link href="../includes/product/css/site6_offcanvas.css" rel="stylesheet" type="text/css"></link><script src="../includes/shared/scripts/l10n.js" type="text/javascript"></script><script src="../includes/product/scripts/docscripts.js"></script><script src="../includes/shared/scripts/docscripts_rn.js"></script><script src="../includes/shared/scripts/mw.imageanimation.js" type="text/javascript"></script><script src="../includes/shared/scripts/jquery.highlight.js"></script><script src="../includes/product/scripts/bootstrap.min.js" type="text/javascript"></script><script src="../includes/product/scripts/global.js"></script><script src="includesFS/bottom.js" type="text/javascript"></script><script src="../includes/product/scripts/underscore-min.js"></script><script src="../includes/shared/scripts/f1help.js" type="text/javascript"></script><script src="../includes/product/scripts/suggest.js" type="text/javascript"></script><script src="../includes/shared/scripts/helpservices.js" type="text/javascript"></script><script src="../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script><!-- the following line should be kept this way only --><link href="includesFS/doc_center.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css"><link href="../includes/product/css/doc_center_print.css" media="print" rel="stylesheet" type="text/css"></head><body  onload="highlightMATLABCode();" id="responsive_offcanvas">  <div id="doc_header_spacer" class="header"></div><div class="sticky_header_container includes_subnav"><div class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-xs-12 col-sm-6 col-sm-push-6 col-md-5 col-md-push-7" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2017a" data-language="en" action="../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="sr-only">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"><div class="input-group-btn"><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search pull-right icon_32 visible-xs" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="col-sm-6 col-sm-pull-6 col-md-7 col-md-pull-5" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../documentation-center.html">Documentation</a></h1></div></div></div><div class="visible-xs" id="search_actuator"><button class="btn icon-search btn_search pull-right icon_16" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div><!--END.CLASS row--> </div><!--END.CLASS container-fluid--> </div><!--END.CLASS section_header level_3--><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_actuator" data-toggle="offcanvas" data-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="sr-only">Toggle navigation</span><span class="icon-menu icon_24"></span></button><span class="offcanvas_actuator_label"></span><span class="offcanvas_actuator_close"></span> </div><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-md-12 hidden-xs hidden-sm"></div></div></div></div></div></div></div><!--END.CLASS sticky_header_container--><div class="row-offcanvas row-offcanvas-left"><div id="sidebar" class="sidebar-offcanvas" role="navigation"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" xmlns:atict="http://www.arbortext.com/namespace/atict"><li itemprop="breadcrumb" itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb"> <a href="../documentation-center.html" itemprop="url"> <span itemprop="title">All Products</span></a></li></ul><ul class="nav_disambiguation" xmlns:atict="http://www.arbortext.com/namespace/atict"><li class="product"><a href="index.html">Flexible Statistics and Data Analysis (FSDA)</a><div class="dropdown"> <span id="dropdownMenu1" class="icon-arrow-down icon_16" data-toggle="dropdown"> </span><ul aria-labelledby="dropdownMenu1" class="dropdown-menu dropdown-menu-right" role="menu"><li role="presentation"> <a href="examples.html" role="menuitem" tabindex="-1">Examples</a></li><li role="presentation"> <a href="function-alpha.html" role="menuitem" tabindex="-1"> Functions and Other Reference</a></li><li role="presentation"> <a href="release_notes.html?s_cid=doc_flyout" role="menuitem" tabindex="-1"> Release Notes</a></li><li role="presentation"> <a href="tutorials.html" role="menuitem" tabindex="-1"> Tutorials</a></li></ul></div></li></ul><ul xmlns:atict="http://www.arbortext.com/namespace/atict" class="nav_disambiguation"> <li><a href="index.html">Flexible Statistics and Data Analysis Toolbox</a> </li> <li><a href="function-cate.html" itemprop="url">Functions</a></li></ul><!-- --><ul class="nav_scrollspy nav" xmlns:atict="http://www.arbortext.com/namespace/atict">  <li class="nav_scrollspy_function"> <a href="#responsive_offcanvas">MixSim</a></li> <li id="SSPY810-refentry" class="nav_scrollspy_title">On this page</li><li><a class="intrnllnk" href="#syntax">Syntax</a></li><li><a class="intrnllnk" href="#Description">Description</a></li><li><a class="intrnllnk" href="#Examples">Examples</a><ul><li><a class="intrnllnk" href="#Example_1">Generate 3 groups in 4 dimensions.</a></li><li><a class="intrnllnk" href="#Example_2">Generate 4 groups in 5 dimensions with prefixed average and maximum overlap.</a></li></ul></li><li><a class="intrnllnk" href="#ExtraExamples">Extra Examples</a><ul><li><a class="intrnllnk" href="#ExtraExample_1">Example of use of optional input option restrfactor.</a></li><li><a class="intrnllnk" href="#ExtraExample_2">Control of average and standard deviation of overlap.</a></li></ul></li><li><a class="intrnllnk" href="#Inputs">Input Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_k">k</a></li><li><a class="intrnllnk" href="#input_argument_v">v</a></li></ul></li><li><a class="intrnllnk" href="#NameValuePairs">Name-Value Pair Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_namevalue_BarOmega">BarOmega</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_MaxOmega">MaxOmega</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_StdOmega">StdOmega</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_sph">sph</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_hom">hom</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_ecc">ecc</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_restrfactor">restrfactor</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_PiLow">PiLow</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_int">int</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_resN">resN</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_tol">tol</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_lim">lim</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_Display">Display</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_R_seed">R_seed</a></li></ul></li><li><a class="intrnllnk" href="#OutputArgs">Output Arguments</a><ul><li><a class="intrnllnk" href="#output_argument_out">out</a></li></ul></li><li><a class="intrnllnk" href="#MoreAbout">More About</a></li><li><a class="intrnllnk" href="#References">References</a></li><li><a class="intrnllnk" href="#SeeAlso">See Also</a></li></ul></nav><script src="../includes/product/scripts/offcanvas.js"></script></div><div id="divtop"></div><div class="site_container site_toc_closed"><div class="page_container"><div class="content_frame"><div id="content_container" class="content_container"><section id="doc_center_content"><div class="function_ref"><div itemprop="content"><h1 itemprop="title">MixSim</h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose">MixSim generates k clusters in v dimensions with given overlap</p><div class="switch"><a id="expandAllPage" href="javascript:void(0);">expand all in page</a></div></div></div></div><div class="ref_sect"><h2 id="syntax">Syntax</h2><div class="syntax_signature"><div class="syntax_signature_module"><ul><li><code class="synopsis">out=MixSim(k,v)</code><span class="syntax_example"><a class="intrnllnk" href="MixSim.html#Example_1">example</a></span></li><li><code class="synopsis">out=MixSim(k,v,Name,Value)</code><span class="syntax_example"><a class="intrnllnk" href="MixSim.html#Example_2">example</a></span></li></ul></div></div></div>	<div class="ref_sect" itemprop="content">							<h2 id="Description">Description</h2>							<div class="descriptions">								<div class="description_module"><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="MixSim.html#Example_1">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_out"><code>out</code></a>=MixSim(<a class="intrnllnk" href="#inputarg_k"><code>k</code></a>,<a class="intrnllnk" href="#inputarg_v"><code>v</code></a>)</code></span>Generate 3 groups in 4 dimensions.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="MixSim.html#Example_2">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_out"><code>out</code></a>=MixSim(<a class="intrnllnk" href="#inputarg_k"><code>k</code></a>,<a class="intrnllnk" href="#inputarg_v"><code>v</code></a>,<a class="intrnllnk" href="#namevaluepairarguments"><code>Name, Value</code></a>)</code></span>Generate 4 groups in 5 dimensions with prefixed average and maximum overlap.</p></div>								</div>							</div>							<div class="clear">							</div>						</div><div class="ref_sect" itemprop="content"><div class="examples"><h2 id="Examples">Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="example_1" class="example_module expandableContent"><div id="Example_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Generate 3 groups in 4 dimensions.</li></span></a></span></h3><div class="collapse"><p>
     Use a maximum overlap equal to 0.15.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">rng(10,'twister')
out=MixSim(3,4)
n=200;
[X,id]=simdataset(n, out.Pi, out.Mu, out.S);
spmplot(X,id)</pre></div></div><pre class="codeoutput">
out = 

  struct with fields:

    OmegaMap: [3&times;3 double]
    BarOmega: 0.0876
    MaxOmega: 0.1500
    StdOmega: 0.0542
        fail: 0
          Pi: [3&times;1 double]
          Mu: [3&times;4 double]
           S: [4&times;4&times;3 double]
       rcMax: [2&times;1 double]


ans(:,:,1) =

   -1.0000   15.0233   18.0193   21.0156
   12.0753   -1.0000   19.0186   22.0144
   13.0247   16.0223   -1.0000   23.0131
   14.0244   17.0216   20.0166   -1.0000


ans(:,:,2) =

   -1.0000   27.0109   30.0099   33.0098
   24.0121   -1.0000   31.0098   34.0098
   25.0112   28.0105   -1.0000   35.0098
   26.0110   29.0101   32.0098   -1.0000


ans(:,:,3) =

         0   39.0081   42.0074   45.0067
   36.0094         0   43.0073   46.0067
   37.0085   40.0079         0   47.0066
   38.0082   41.0077   44.0071         0

</pre><a href='http://rosa.unipr.it/fsda/MixSim.html#Example_1'><img vspace="5" hspace="5" src="images\MixSim_01.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website). Graphical output could not be included in the installation file because toolboxes cannot be greater than 20MB. To load locally the image files, download zip file http://rosa.unipr.it/fsda/images.zip and unzip it to <tt>(docroot)/FSDA/images</tt> or simply run routine <tt>downloadGraphicalOutput.m</tt>"> </a></p></div></div><div id="example_2" class="example_module expandableContent"><div id="Example_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>Generate 4 groups in 5 dimensions with prefixed average and maximum overlap.</li></span></a></span></h3><div class="collapse"><p>
     Use average overlap of 0.05 and
     maximum overlap equal to 0.15.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">k=4;
v=5;
BarOmega=0.05;
out=MixSim(4,5,'BarOmega',BarOmega, 'MaxOmega',0.15)
% Check a posteriori the average overlap
disp('Posterior average overlap')
disp((sum(sum(out.OmegaMap))-k)/(0.5*k*(k-1)))
% Check a posteriori the maximum overlap
% Extract elements above the diagonal and sum them with the transpose
% of the elements below the diagonal. The maximum of all these numbers
% must be very close to the required maximum overlap
cand=triu(out.OmegaMap,1)+(tril(out.OmegaMap,-1))'
disp('Posterior average overlap')
max(cand(:))</pre></div></div></p></div></div></div><p> </p><div class="examples"><h2 id="ExtraExamples" class="bottom_ruled">Related Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="Extraexample_1" class="example_module expandableContent"><div id="ExtraExample_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Example of use of optional input option restrfactor.</li></span></a></span></h3><div class="collapse"><p> In the first case
     restrfactor is 1.1 and the clusters are roughly homogeneous. In the
     second case no constraint is imposed on the ratio of maximum and
     minimum eigevalue among clusters so elliptical shape clusters are
     allowed. In both cases the same random seed together with the same level
     of average and maximum overlapping is used<div class="programlisting"><div class="codeinput"><pre class="matlab-code">state1=2;
randn('state', state1);
rand('state', state1);
out=MixSim(3,5,'BarOmega',0.1, 'MaxOmega',0.2, 'restrfactor',1.1);
state1=2;
randn('state', state1);
rand('state', state1);
out1=MixSim(3,5,'BarOmega',0.1, 'MaxOmega',0.2);
n=200;
[X,id]=simdataset(n, out.Pi, out.Mu, out.S);
spmplot(X,id,[],'box');
set(gcf,'Name','restrfactor=1.1: almost homogeneous groups')
title('\texttt{restrfactor=1.1}: almost homogeneous groups','fontsize',17,'interpreter','latex');
[X1,id1]=simdataset(n, out1.Pi, out1.Mu, out1.S);
figure;
spmplot(X1,id1,[],'box')
set(gcf,'Name','Heterogeneous groups')
title('\texttt{restrfactor=`''}: heterogeneous groups','fontsize',17,'interpreter','latex')
cascade</pre></div></div></p></div></div><div id="Extraexample_2" class="example_module expandableContent"><div id="ExtraExample_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Control of average and standard deviation of overlap.</li></span></a></span></h3><div class="collapse"><p> Given an
     average value of overlap, we explore the differences between imposing a
     small or a large value of standard deviation of overlap.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">clc
close all
rng(10,'twister')
k=4;
v=5;
n=200;
BarOmega=0.10;
StdOmega=0.15;
out=MixSim(k,v,'BarOmega',BarOmega, 'StdOmega',StdOmega,'resN',10, 'Display', 'iter');
[X,id]=simdataset(n, out.Pi, out.Mu, out.S);
rng(10,'twister')
StdOmega1=0.05;
out1=MixSim(k,v,'BarOmega',BarOmega, 'StdOmega',StdOmega1,'resN',10, 'Display', 'iter');
[X1,id1]=simdataset(n, out1.Pi, out1.Mu, out1.S);
disp('Comparison using OmegaMap')
disp('When StdOmega is large in this example groups 3 are 4 do show a strong overlap')
disp('When StdOmega is large in this example groups 1, 2, 3 are quite separate')
disp(out.OmegaMap)
disp('When StdOmega is small the probabilities of overlapping are much more similar')
disp(out1.OmegaMap)
disp('Comparison using interactive scatter plot matrices')
spmplot(X,id,[],'box');
set(gcf,'name',['BarOmega=' num2str(BarOmega) ' StdOmega=' num2str(StdOmega)])
title(['BarOmega=' num2str(BarOmega) ' StdOmega=' num2str(StdOmega)])
figure
spmplot(X1,id1,[],'box');
set(gcf,'name',['BarOmega=' num2str(BarOmega) ' StdOmega=' num2str(StdOmega1)])
title(['BarOmega=' num2str(BarOmega) ' StdOmega=' num2str(StdOmega1)])
cascade</pre></div></div></p></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="Inputs">Input Arguments</h2><div class="expandableContent"><div class="arguments"><div class="input_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"> <div id="inputarg_k" class="clearfix"> </div> <h3 id="input_argument_k" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>k</code> &#8212; number of groups (components). </span>  </a><span class="example_desc">Scalar.</span></span></h3> <div class="collapse"> <p><p>Desired number of groups.</p> <p>
               </p></p> <p class="datatypelist"><strong> Data Types: </strong><code>int16|int32|int64|single|double</code></p> </div> </div><div class="expandableContent"> <div id="inputarg_v" class="clearfix"> </div> <h3 id="input_argument_v" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>v</code> &#8212; number of dimensions (variables). </span>  </a><span class="example_desc">Scalar.</span></span></h3> <div class="collapse"> <p><p>Desired number of variables.</p> <p>
               </p></p> <p class="datatypelist"><strong> Data Types: </strong><code>int16|int32|int64|single|double</code></p> </div> </div><div id="namevaluepairarguments" class="clearfix"></div><h3 id="NameValuePairs" class="bottom_ruled">Name-Value Pair Arguments</h3><div class="namevaluecontainer"><p>Specify optional comma-separated pairs of <code>Name,Value</code> arguments. <code>Name</code> is the argument name and <code>Value</code> is the corresponding value. <code>Name</code> must appear  inside single quotes (<code>' '</code>).  You can specify several name and value pair arguments in any order as <code>  Name1,Value1,...,NameN,ValueN</code>.</p>  <span class="example_desc"><strong>Example:</strong><code><code> 'BarOmega',0.05
</code>,<code> 'MaxOmega',0.05
</code>,<code> 'StdOmega',0.05
</code>,<code> 'sph',false
</code>,<code> 'hom',false
</code>,<code> 'ecc',0.8
</code>,<code> 'restrfactor',8
</code>,<code> 'PiLow',0.1
</code>,<code> 'int',[0 2]
</code>,<code> 'resN',20
</code>,<code> 'tol',[1e-06 1e-08]
</code>,<code> 'lim',1e6
</code>,<code> 'Display','off'
</code>,<code> 'R_seed',0
</code></code></span></div><div class="expandableContent"><div id="inputarg_BarOmega" class="clearfix"></div><h3 id="input_argument_namevalue_BarOmega" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>BarOmega</code> &#8212;Requested average overlap.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p>Value of desired average
               overlap. The default value is ''
               </p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'BarOmega',0.05
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_MaxOmega" class="clearfix"></div><h3 id="input_argument_namevalue_MaxOmega" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>MaxOmega</code> &#8212;Requested maximum overlap.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>Value of desired maximum
               overlap. If BarOmega is empty the default value of MaxOmega
               is 0.15.</p> <p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'MaxOmega',0.05
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_StdOmega" class="clearfix"></div><h3 id="input_argument_namevalue_StdOmega" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>StdOmega</code> &#8212;Requested std of overlap.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>Value of desired standard
               deviation of overlap.</p> <p>
               Remark1 - The probability of overlapping between two
               clusters $i$ and $j$, ($i \ne j =1, 2, ..., k$), called
               $p_{ij}$, is defined as the sum of the two misclassification
               probabilities
               $p_ij=w_{j|i} + w_{i|j}$
               Remark2- it is possible to specify up to two values among
               BarOmega MaxOmega and StdOmega.</p><p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'StdOmega',0.05
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_sph" class="clearfix"></div><h3 id="input_argument_namevalue_sph" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>sph</code> &#8212;Spherical covariances.</span></a><span class="example_desc">scalar logical | structure.</span></span></h3><div class="collapse">	<p><p>Scalar boolean or structure which specifies covariance
               matrix. When sph is logical value, if:</p> <p>
               sph=false (default) ==&gt; non-spherical clusters;</p> <p>
               sph=true            ==&gt; spherical clusters= const*I.</p> <p>
               The following options "hom", "ecc" and "restrfactor" have
               an effect just if sph is a scalar boolean. The default
               value of sph is false that is non spherical clusters are
               generated.</p> <p>
               If sph is a structure it may contain the following fields.</p><p>
       </p><table border="2" cellpadding="4" cellspacing="0" class="body"><colgroup><col width="20%"><col width="80%"></colgroup><thead><tr valign="top"><th valign="top">Value</th><th valign="top">Description</th></tr></thead><tr valign="top"><td><code>pars</code></td><td><p><p>a 3 letter character in the set:</p> <p>
                'VVE','EVE','VVV','EVV','VEE','EEE','VEV','EEV','VVI',
                'EVI','VEI','EEI','VII','EII' which
                specifies the type of Gaussian Parsimonious Clustering
                Model which needs to be generated.</p></p></td></tr><tr valign="top"><td><code>exactrestriction</code></td><td><p><p>boolean. If sph.exactrestriction is
                true the covariance matrices have to be generated with the
                exact values of the restrictions specified in sph.cdet,
                sph.shw and sph.shb. For example if sph.pars='VVE' and
                sph.exactrestriction=true model with varying determinants,
                varying shape and varying rotation matrix is generated.</p> <p>
                The max ratio of the determinants is equal to sph.cdet.</p><p>
                The maximum ratio between the shape elements in each group
                is sph.shw. The maximum ratio among the ordered elements
                across the groups is and sph.shb. On the other hand, if
                sph.exactrestriction is false and for example
                sph.pars='VVE' covariance matrices are generated assuming varying
                determinants, varying shape and equal rotation matrix and
                with ratio of determinants which satisfy the inequality
                constraint &lt;= sph.cdet and shape matrices which satisfy
                the inequality constraints &lt;= sph.shw and &lt;= sph.shb.</p></p></td></tr><tr valign="top"><td><code>cdet</code></td><td><p>scalar which specifies the restriction factor
                for determinants across groups. If this field is empty or
                if this field is missing no contraint is imposed among
                determinants.</p></td></tr><tr valign="top"><td><code>shw</code></td><td><p>scalar which specifies the restriction factor for
                shape matrices within each group. If this field is empty
                or if this field is missing, no contraint is imposed among
                the elements of each shape matrix of a particular group.</p></td></tr><tr valign="top"><td><code>shb</code></td><td><p>scalar which specifies the restriction factor for
                shape matrices between each group. If this field is empty
                or if this field is missing, no contraint is imposed
                across the elements of each shape matrix between the
                groups.</p></td></tr></table></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'sph',false
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>boolean</code></p></div></div><div class="expandableContent"><div id="inputarg_hom" class="clearfix"></div><h3 id="input_argument_namevalue_hom" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>hom</code> &#8212;Equal Sigmas.</span></a><span class="example_desc">scalar logical.</span></span></h3><div class="collapse">	<p><p>Scalar boolean which specifies heterogeneous or homogeneous
               clusters. This option has an effect just if previous option
               sph is a scalar boolean.</p> <p>
               hom=false (default) ==&gt; heterogeneous;</p><p>
               hom=true            ==&gt; homogeneous $\Sigma_1 = ... =
               \Sigma_k$
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'hom',false
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>boolean</code></p></div></div><div class="expandableContent"><div id="inputarg_ecc" class="clearfix"></div><h3 id="input_argument_namevalue_ecc" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>ecc</code> &#8212;maximum eccentricity.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>Scalar in the interval (0, 1] which defines maximum eccentricity.</p> <p>
               For example, if ecc=0.9 (default value), we require for
               each group that sqrt(1 - minL / maxL) &lt;= 0.9 where minL and
               maxL are respectively the min and max eigenvalue of the cov
               matrix of a particular group. This option has an effect
               just if previous option sph is a scalar boolean.</p><p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'ecc',0.8
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_restrfactor" class="clearfix"></div><h3 id="input_argument_namevalue_restrfactor" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>restrfactor</code> &#8212;eigenvalue restriction factor.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p>Scalar in the interval [1 \infty] which specifies the
               maximum ratio to allow between the largest eigenvalue and
               the smallest eigenvalue of the k covariance matrices which
               are generated. The default value is ''. More in details if
               for example restrfactor=10 after generating the covariance
               matrices we
               check that the ratio
               \[
                 \frac{   \max_{l=1, \ldots, v} \max_{j=1, \ldots, k}  \lambda_l(\hat \Sigma_j)}{   \min_{l=1, \ldots, v} \min_{j=1, \ldots, k}  \lambda_l(\hat \Sigma_j)}.
               \]<p>
               between the largest eigenvalue of the k cov matrices
               and the smallest eigenvalue of the k cov matrices is not
               larger than restrfactor. In order to apply this restriction
               (which is typical of tclust.m) we call routine
               <a href="restreigen.html">restreigen</a>.</p> <p>
               This option has an effect just if previous option sph is a
               scalar boolean.</p><p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'restrfactor',8
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_PiLow" class="clearfix"></div><h3 id="input_argument_namevalue_PiLow" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>PiLow</code> &#8212;Smallest mixing proportion.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>Value of the smallest mixing proportion (if 'PiLow'
               is not reachable with respect to k, equal proportions are
               taken; PiLow = 1.0 implies equal proportions by default).</p> <p>
               PiLow must be a number in the interval (0 1]. Default value
               0.</p><p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'PiLow',0.1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_int" class="clearfix"></div><h3 id="input_argument_namevalue_int" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>int</code> &#8212;Simulation interval of mean vectors.</span></a><span class="example_desc">vector of length 2.</span></span></h3><div class="collapse">	<p><p>Mean vectors are simulated uniformly on a hypercube with
               sides specified by int = [lower.bound, upper.bound].</p> <p>
               The default value of int is [0 1].</p><p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'int',[0 2]
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_resN" class="clearfix"></div><h3 id="input_argument_namevalue_resN" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>resN</code> &#8212;number of simulations.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>Maximum number of mixture resimulations to find a
               similation setting with prespecified level of overlapping.</p> <p>
               The default value of resN is 100
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'resN',20
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_tol" class="clearfix"></div><h3 id="input_argument_namevalue_tol" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>tol</code> &#8212;Tolerances.</span></a><span class="example_desc">vector of length 2.</span></span></h3><div class="collapse">	<p><p>tol(1) (which will be called tolmap) specifies
               the tolerance between the requested and empirical
               misclassification probabilities (default is 1e-06)
               tol(2) (which will be called tolnxc2) specifies the
               tolerance to use in routine <a href="ncx2mixtcdf.html">ncx2mixtcdf</a> (which computes cdf
               of linear combinations of non central chi2 distributions).</p> <p>
               The default value of tol(2) 1e-06.</p><p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'tol',[1e-06 1e-08]
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_lim" class="clearfix"></div><h3 id="input_argument_namevalue_lim" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>lim</code> &#8212;Precision in the calculation of probabilities of overlapping.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>Maximum number of integration terms to use inside routine
               <a href="ncx2mixtcdf.html">ncx2mixtcdf</a>. Default is 1e06.</p> <p>
               REMARK - Optional parameters tolncx2=tol(2) and lim will be
               used by function <a href="ncx2mixtcdf.html">ncx2mixtcdf</a> which computes the cdf of a
               linear combination of non central chi2 r.v.. This is the
               probability of misclassification
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'lim',1e6
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_Display" class="clearfix"></div><h3 id="input_argument_namevalue_Display" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>Display</code> &#8212;Level of display.</span></a><span class="example_desc">character.</span></span></h3><div class="collapse">	<p><p>'off' displays no output;</p> <p>
               'notify' (default) displays output if requested
               overlap cannot be reached in a particular simulation
               'iter' displays output at each iteration of each
               simulation
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'Display','off'
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>character</code></p></div></div><div class="expandableContent"><div id="inputarg_R_seed" class="clearfix"></div><h3 id="input_argument_namevalue_R_seed" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>R_seed</code> &#8212;use random numbers from R.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>If scalar &gt; 0 for the seed to be used to generate random numbers
               in a R instance. This is used to check consistency of the
               results obtained with the R package MixSim. See file
               <a href="Connect_Matlab_with_R_HELP.html">Connect_Matlab_with_R_HELP</a> to know how to connect MATLAB
               with R.  This option requires the installation of the
               R-(D)COM Interface. Default is 0, i.e. random numbers are
               generated by matlab.</p> <p>
                      </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'R_seed',0
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="OutputArgs" >Output Arguments</h2><div class="expandableContent"><div class="arguments"><div class="output_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"><div id="outputarg_out" class="clearfix"></div><h3 id="output_argument_out" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>out</code> &#8212; description</span></a><span class="example_desc">Structure</span></span></h3><div class="collapse"><p>Structure which contains the following fields

    <table border="2" cellpadding="4" cellspacing="0" class="body"><colgroup><col width="20%"><col width="80%"></colgroup><thead><tr valign="top"><th valign="top">Value</th><th valign="top">Description</th></tr></thead><tr valign="top"><td><code>Pi</code></td><td><p><p>vector of length k containing mixing proportions.</p> <p>
                       sum(out.Pi)=1</p></p></td></tr><tr valign="top"><td><code>Mu</code></td><td><p>k-by-v matrix consisting of components' mean vectors
                      Each row of this matrix is a centroid of a group</p></td></tr><tr valign="top"><td><code>S</code></td><td><p>v-by-v-by-k array containing covariances for the k
                      groups</p></td></tr><tr valign="top"><td><code>OmegaMap</code></td><td><p><p>matrix of misclassification probabilities (k-by-k);</p> <p>
                      OmegaMap(i,j) = w_{j|i} is the probability that X
                      coming from the i-th component (group) is classified
                      to the j-th component.</p></p></td></tr><tr valign="top"><td><code>BarOmega</code></td><td><p><p>scalar. Value of average overlap.</p> <p>
                      BarOmega is computed as
                      (sum(sum(OmegaMap))-k)/(0.5*k(k-1))</p></p></td></tr><tr valign="top"><td><code>MaxOmega</code></td><td><p>scalar. Value of maximum overlap. MaxOmega is the
                       maximum of OmegaMap(i,j)+OmegaMap(j,i)
                       (i ~= j)=1, 2, ..., k. In other words MaxOmega=
                      OmegaMap(rcMax(1),rcMax(2))+OmegaMap(rcMax(2),rcMax(1))</p></td></tr><tr valign="top"><td><code>StdOmega</code></td><td><p><p>scalar. Value of standard deviation (std) of overlap.</p> <p>
                      StdOmega is the standard deviation of k*(k-1)/2
                      probabilities of overlapping</p></p></td></tr><tr valign="top"><td><code>rcMax</code></td><td><p>vector of length 2. It containes the row and column
                      numbers associated with  the pair of components
                      producing maximum overlap 'MaxOmega'</p></td></tr><tr valign="top"><td><code>fail</code></td><td><p>scalar, flag value. 0 represents successful mixture
                      generation, 1 represents failure.</p></td></tr></table></p></div></div></div></div></div></div><div class="moreabout ref_sect"><h2 id="MoreAbout">More About</h2><div class="expandableContent"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent" itemprop="content"><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span>Additional Details</span></a></span></h3><div class="expand"><p><p>
  MixSim(k,v) generates k groups in v dimensions. It is possible to
  control the average and maximum or standard deviation of overlapping.</p> <p>

  Given two generic clusters $i$ and $j$ with $i \ne j =1, ..., k$,
  indexed by $\phi(x; \mu_i,\Sigma_i)$ and $\phi(x; \mu_j,\Sigma_j)$ with
  probabilities of occurrence $\pi_i$ and $\pi_j$, the misclassification
  probability with respect to cluster $i$ (that is conditionally on $x$
  belonging to cluster $i$,  which is called  $w_{j|i}$) is defined as
  $Pr[ \pi_i \phi(x;\mu_i,\Sigma_i) &lt; \pi_j \phi(x;\mu_j,\Sigma_j)]$.</p> <p>
  The matrix containing the misclassification probabilities $w_{j|i}$ is
  called OmegaMap
  The probability of overlapping between groups $i$ and $j$ is given by:</p><p>
  </p>\[
            w_{j|i} + w_{i|j}    \qquad      i,j=1,2, ..., k
  \]<p>
  The diagonal elements of OmegaMap are equal to 1.</p> <p>
  The average overlap (which in the code is called below BarOmega) is
  defined as the sum of the off diagonal elements of OmegaMap (matrix of
  misclassification probabilities) divided by 0.5*k*(k-1)
  The maximum overlap (which in the code is called MaxOmega) is defined as
  $\max(w_{j|i} + w_{i|j}$),  $i \ne j=1,2, ..., k$.</p> <p>
  The probability of misclassification $w_{j|i}$ is nothing but the cdf of a linear
  combination of non central $\chi^2$ distributions with 1 degree of freedom
  + a linear combination of $N(0,1)$ evaluated in a
  point c.  The coefficients of the linear combinations of non central
  $\chi^2$ and $N(0,1)$ depend on the eigenvalues and eigenvectors of matrix
  $\Sigma_{j|i} = \Sigma^{0.5}_i \Sigma^{-1}_j \Sigma^{0.5}_i$.</p> <p>
  Point $c$ depends on the same eigenvalues and eigenvectors
  of matrix $\Sigma_{j|i}$, the mixing proportions $\pi_i$ and $\pi_j$ and the
  determinants $|\Sigma_i|$ and $|\Sigma_j|$.</p><p>
  This probability is computed using routine <a href="ncx2mixtcdf.html">ncx2mixtcdf</a>


</p></p></div></div></div></div><div class="ref_sect" itemprop="content"><div class="bibliography"><h2 id="References">References</h2> <div><p>Maitra, R. and Melnykov, V. (2010), Simulating data to study performance
 of finite mixture modeling and clustering algorithms, "The Journal of
 Computational and Graphical Statistics", Vol. 19, pp. 354-376. [to refer to
 this publication we will use "MM2010 JCGS"]</p></div><div><p>Melnykov, V., Chen, W.-C. and Maitra, R. (2012), MixSim: An R Package
 for Simulating Data to Study Performance of Clustering Algorithms,
 "Journal of Statistical Software", Vol. 51, pp. 1-25.</p></div><div><p>Davies, R. (1980), The distribution of a linear combination of
 chi-square random variables, "Applied Statistics", Vol. 29, pp. 323-333.</p></div><div><p><p>Garcia-Escudero, L.A., Gordaliza, A., Matran, C. and Mayo-Iscar, A. (2008),
 A General Trimming Approach to Robust Cluster Analysis. Annals
 of Statistics, Vol. 36, 1324-1345. [Technical Report available at:</p> <p>
 www.eio.uva.es/inves/grupos/representaciones/trTCLUST.pdf]</p></p></div><div><p>Riani, M., Cerioli, A., Perrotta, D. and Torti, F. (2015), Simulating
 mixtures of multivariate data with fixed cluster overlap in FSDA,
 "Advances in data analysis and classification", Vol. 9, pp. 461-481.</p></div><div><p>Parlett, B.N. and Reinsch, C. (1969), Balancing a matrix for calculation
 of eigenvalues and eigenvectors, "Numerische Mathematik", Vol. 13,
 pp. 293-304.</p></div><div><p>Parlett, B.N. and Reinsch, C. (1971), Balancing a Matrix for Calculation of
 Eigenvalues and Eigenvectors, in Bauer, F.L. Eds, "Handbook for Automatic
 Computation", Vol. 2, pp. 315-326, Springer.</p></div></div></div><div class="ref_sect"><h2 id="SeeAlso">See Also</h2><p><span itemprop="seealso"><a href="tkmeans.html" itemprop="url"><span itemprop="name"><code>tkmeans</code></span></a></span> | <span itemprop="seealso"><a href="tclust.html" itemprop="url"><span itemprop="name"><code>tclust</code></span></a></span> | <span itemprop="seealso"><a href="tclustreg.html" itemprop="url"><span itemprop="name"><code>tclustreg</code></span></a></span> | <span itemprop="seealso"><a href="lga.html" itemprop="url"><span itemprop="name"><code>lga</code></span></a></span> | <span itemprop="seealso"><a href="rlga.html" itemprop="url"><span itemprop="name"><code>rlga</code></span></a></span> | <span itemprop="seealso"><a href="ncx2mixtcdf.html" itemprop="url"><span itemprop="name"><code>ncx2mixtcdf</code></span></a></span> | <span itemprop="seealso"><a href="restreigen.html" itemprop="url"><span itemprop="name"><code>restreigen</code></span></a></span></div><i>This page has been automatically generated by our routine <a href="publishFS.html">publishFS</a></i></div></section></div></div></div></div><div id="divbottom"></div></body></html>