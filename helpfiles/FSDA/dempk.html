<!DOCTYPE HTML> <html itemscope="" xmlns="http://www.w3.org/1999/xhtml"><head><title>dempk</title><meta content="refpage" name="chunktype"><meta content="function:dempk" itemprop="refentity" name="refentity"><meta content="text/javascript" http-equiv="Content-Script-Type"><meta content="fcn" itemprop="pagetype" name="toctype"><meta content="ref/function" itemprop="infotype" name="infotype" /><meta content=" dempk performs a merging of components found by tkmeans." itemprop="description" name="description" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" /><script type="text/x-mathjax-config">MathJax.Hub.Config({extensions: ["tex2jax.js"],jax: ["input/TeX","output/HTML-CSS"],menuSettings: {zoom: "Double-Click", zscale: "300"},tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},MathMenu: {showRenderer: false},"HTML-CSS": {availableFonts: ["TeX"],preferredFont: "TeX",imageFont: null}});</script><script type="text/javascript" src="includesFS/Mathjax/MathJax.js"></script><script src="includesFS/matlab-highlighter.min.js"></script><link href="includesFS/matlab-highlighter.css" rel="stylesheet" type="text/css"><script type="text/javascript" src="includesFS/jquery-latest.js"></script><script>$(document).ready(function(){      $("#divtop").load("includesFS/top.html");      $("#divbottom").load("includesFS/bottom.html");});</script><link href="../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)"></link><link href="../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)"></link><link href="../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)"></link><link href="../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)"></link><link href="../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)"></link><link href="../includes/product/css/site6_offcanvas.css" rel="stylesheet" type="text/css"></link><script src="../includes/shared/scripts/l10n.js" type="text/javascript"></script><script src="../includes/product/scripts/docscripts.js"></script><script src="../includes/shared/scripts/docscripts_rn.js"></script><script src="../includes/shared/scripts/mw.imageanimation.js" type="text/javascript"></script><script src="../includes/shared/scripts/jquery.highlight.js"></script><script src="../includes/product/scripts/bootstrap.min.js" type="text/javascript"></script><script src="../includes/product/scripts/global.js"></script><script src="includesFS/bottom.js" type="text/javascript"></script><script src="../includes/product/scripts/underscore-min.js"></script><script src="../includes/shared/scripts/f1help.js" type="text/javascript"></script><script src="../includes/product/scripts/suggest.js" type="text/javascript"></script><script src="../includes/shared/scripts/helpservices.js" type="text/javascript"></script><script src="../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script><!-- the following line should be kept this way only --><link href="includesFS/doc_center.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css"><link href="../includes/product/css/doc_center_print.css" media="print" rel="stylesheet" type="text/css"></head><body  onload="highlightMATLABCode();" id="responsive_offcanvas">  <div id="doc_header_spacer" class="header"></div><div class="sticky_header_container includes_subnav"><div class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-xs-12 col-sm-6 col-sm-push-6 col-md-5 col-md-push-7" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2017a" data-language="en" action="../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="sr-only">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"><div class="input-group-btn"><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search pull-right icon_32 visible-xs" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="col-sm-6 col-sm-pull-6 col-md-7 col-md-pull-5" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../documentation-center.html">Documentation</a></h1></div></div></div><div class="visible-xs" id="search_actuator"><button class="btn icon-search btn_search pull-right icon_16" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div><!--END.CLASS row--> </div><!--END.CLASS container-fluid--> </div><!--END.CLASS section_header level_3--><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_actuator" data-toggle="offcanvas" data-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="sr-only">Toggle navigation</span><span class="icon-menu icon_24"></span></button><span class="offcanvas_actuator_label"></span><span class="offcanvas_actuator_close"></span> </div><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-md-12 hidden-xs hidden-sm"></div></div></div></div></div></div></div><!--END.CLASS sticky_header_container--><div class="row-offcanvas row-offcanvas-left"><div id="sidebar" class="sidebar-offcanvas" role="navigation"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" xmlns:atict="http://www.arbortext.com/namespace/atict"><li itemprop="breadcrumb" itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb"> <a href="../documentation-center.html" itemprop="url"> <span itemprop="title">All Products</span></a></li></ul><ul class="nav_disambiguation" xmlns:atict="http://www.arbortext.com/namespace/atict"><li class="product"><a href="index.html">Flexible Statistics and Data Analysis (FSDA)</a><div class="dropdown"> <span id="dropdownMenu1" class="icon-arrow-down icon_16" data-toggle="dropdown"> </span><ul aria-labelledby="dropdownMenu1" class="dropdown-menu dropdown-menu-right" role="menu"><li role="presentation"> <a href="examples.html" role="menuitem" tabindex="-1">Examples</a></li><li role="presentation"> <a href="function-alpha.html" role="menuitem" tabindex="-1"> Functions and Other Reference</a></li><li role="presentation"> <a href="release_notes.html?s_cid=doc_flyout" role="menuitem" tabindex="-1"> Release Notes</a></li><li role="presentation"> <a href="tutorials.html" role="menuitem" tabindex="-1"> Tutorials</a></li></ul></div></li></ul><ul xmlns:atict="http://www.arbortext.com/namespace/atict" class="nav_disambiguation"> <li><a href="index.html">Flexible Statistics and Data Analysis Toolbox</a> </li> <li><a href="function-cate.html" itemprop="url">Functions</a></li></ul><!-- --><ul class="nav_scrollspy nav" xmlns:atict="http://www.arbortext.com/namespace/atict">  <li class="nav_scrollspy_function"> <a href="#responsive_offcanvas">dempk</a></li> <li id="SSPY810-refentry" class="nav_scrollspy_title">On this page</li><li><a class="intrnllnk" href="#syntax">Syntax</a></li><li><a class="intrnllnk" href="#Description">Description</a></li><li><a class="intrnllnk" href="#Examples">Examples</a><ul><li><a class="intrnllnk" href="#Example_1">Example using dempk on data obtained by simdataset, specifying both
     hierarchical clustering and a threshold value, in order to obtain
     additional plots.</a></li><li><a class="intrnllnk" href="#Example_2">Example using dempk with hierarchical merging on data obtained by
     simdataset, specifying additional arguments in the call to tkmeans.</a></li></ul></li><li><a class="intrnllnk" href="#ExtraExamples">Extra Examples</a><ul><li><a class="intrnllnk" href="#ExtraExample_1">Example using dempk with hierarchical merging on data obtained by
     simdataset, specifying additional arguments in the call to clusterdata.</a></li><li><a class="intrnllnk" href="#ExtraExample_2">Example using dempk, both setting a threshold and performing a
     hierarchical merging, for data obtained by simdataset with 10 percent
     uniform noise.</a></li><li><a class="intrnllnk" href="#ExtraExample_3">Example using the M5 dataset and various setting for dempk, using
     hierarchical clustering, in order to identify the real clusters using
     different strategies.</a></li></ul></li><li><a class="intrnllnk" href="#Inputs">Input Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_Y">Y</a></li><li><a class="intrnllnk" href="#input_argument_k">k</a></li><li><a class="intrnllnk" href="#input_argument_g">g</a></li></ul></li><li><a class="intrnllnk" href="#NameValuePairs">Name-Value Pair Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_namevalue_alpha">alpha</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_plots">plots</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_tkmeansOpt">tkmeansOpt</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_tkmeansOut">tkmeansOut</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_linkagearg">linkagearg</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_Ysave">Ysave</a></li></ul></li><li><a class="intrnllnk" href="#OutputArgs">Output Arguments</a><ul><li><a class="intrnllnk" href="#output_argument_out">out</a></li></ul></li><li><a class="intrnllnk" href="#References">References</a></li><li><a class="intrnllnk" href="#SeeAlso">See Also</a></li></ul></nav><script src="../includes/product/scripts/offcanvas.js"></script></div><div id="divtop"></div><div class="site_container site_toc_closed"><div class="page_container"><div class="content_frame"><div id="content_container" class="content_container"><section id="doc_center_content"><div class="function_ref"><div itemprop="content"><h1 itemprop="title">dempk</h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose"> dempk performs a merging of components found by tkmeans</p><div class="switch"><a id="expandAllPage" href="javascript:void(0);">expand all in page</a></div></div></div></div><div class="ref_sect"><h2 id="syntax">Syntax</h2><div class="syntax_signature"><div class="syntax_signature_module"><ul><li><code class="synopsis">out=dempk(Y, k, g)</code><span class="syntax_example"><a class="intrnllnk" href="dempk.html#Example_1">example</a></span></li><li><code class="synopsis">out=dempk(Y, k, g,Name,Value)</code><span class="syntax_example"><a class="intrnllnk" href="dempk.html#Example_2">example</a></span></li></ul></div></div></div>	<div class="ref_sect" itemprop="content">							<h2 id="Description">Description</h2>							<div class="descriptions">								<div class="description_module"><p>The function dempk performs either a hierarchical merging of the k components
 found by tkmeans (using the pairwise overlap values between them and giving
 g clusters), or if g is a decimal number between 0 and 1 it performs the
 merging phase according to the threshold g (the same algorithm as overlapmap).</p><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="dempk.html#Example_1">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_out"><code>out</code></a>=dempk(<a class="intrnllnk" href="#inputarg_Y"><code>Y</code></a>,<a class="intrnllnk" href="#inputarg_k"><code>k</code></a>,<a class="intrnllnk" href="#inputarg_g"><code> g</code></a>)</code></span>Example using dempk on data obtained by simdataset, specifying both
     hierarchical clustering and a threshold value, in order to obtain
     additional plots.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="dempk.html#Example_2">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_out"><code>out</code></a>=dempk(<a class="intrnllnk" href="#inputarg_Y"><code>Y</code></a>,<a class="intrnllnk" href="#inputarg_k"><code>k</code></a>,<a class="intrnllnk" href="#inputarg_g"><code>g</code></a>,<a class="intrnllnk" href="#namevaluepairarguments"><code>Name, Value</code></a>)</code></span>Example using dempk with hierarchical merging on data obtained by
     simdataset, specifying additional arguments in the call to tkmeans.</p></div>								</div>							</div>							<div class="clear">							</div>						</div><div class="ref_sect" itemprop="content"><div class="examples"><h2 id="Examples">Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="example_1" class="example_module expandableContent"><div id="Example_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Example using dempk on data obtained by simdataset, specifying both
     hierarchical clustering and a threshold value, in order to obtain
     additional plots.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">close all
% Specify k cluster in v dimensions with n obs
k = 10;
v = 2;
n = 5000;
% Generate homogeneous and spherical clusters
rng(100, 'twister');
out = MixSim(k, v, 'sph', true, 'hom', true, 'int', [0 10], 'Display', 'off', 'BarOmega', 0.05, 'Display','off');
% Simulating data
[X, id] = simdataset(n, out.Pi, out.Mu, out.S);
% Plotting data
gscatter(X(:,1), X(:,2), id);
str = sprintf('Simulated data with %d groups in %d dimensions and %d units', k, v, n);
title(str,'Interpreter','Latex');
% merging algorithm based on hierarchical clustering
g = 3;
DEMP = dempk(X, k*5, g, 'plots', 'contourf');
% merging algorithm based on the threshold value omega star
g = 0.01;
DEMP2 = dempk(X, k*5, g, 'plots', 'contour');
cascade;</pre></div></div><pre class="codeoutput">Total estimated time to complete trimmed k means: 18.61 seconds 
------------------------------
Warning: Number of subsets without convergence equal to 36.6667%
Total estimated time to complete trimmed k means:  1.39 seconds 
------------------------------
Warning: Number of subsets without convergence equal to 38.6667%
</pre><a href='http://rosa.unipr.it/fsda/dempk.html#Example_1'><img vspace="5" hspace="5" src="images\dempk_01.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website). Graphical output could not be included in the installation file because toolboxes cannot be greater than 20MB. To load locally the image files, download zip file http://rosa.unipr.it/fsda/images.zip and unzip it to <tt>(docroot)/FSDA/images</tt> or simply run routine <tt>downloadGraphicalOutput.m</tt>"> <img vspace="5" hspace="5" src="images\dempk_02.png" alt=""> <img vspace="5" hspace="5" src="images\dempk_03.png" alt=""> </a></p></div></div><div id="example_2" class="example_module expandableContent"><div id="Example_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Example using dempk with hierarchical merging on data obtained by
     simdataset, specifying additional arguments in the call to tkmeans.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">close all
% Specify k cluster in v dimensions with n obs
g = 3;
v = 2;
n = 5000;
% null trimming and noise level
alpha0 = 0;
% restriction factor
restr = 30;
% Maximum overlap
maxOm = 0.005;
% Generate heterogeneous and elliptical clusters
rng(500, 'twister');
out = MixSim(g, v, 'sph', false, 'restrfactor', restr, 'int', [0 10], ...
'Display', 'off', 'MaxOmega', maxOm, 'Display','off');
% Simulating data
[X, id] = simdataset(n, out.Pi, out.Mu, out.S);
% Plotting data
gg = gscatter(X(:,1), X(:,2), id);
str = sprintf('Simulated data with %d groups in %d dimensions and %d \nunits, with restriction factor %d and maximum overlap %.2f', ...
g, v, n, restr, maxOm);
title(str,'Interpreter','Latex', 'fontsize', 12);
set(findobj(gg), 'MarkerSize',10);
legend1 = legend(gca,'show');
set(legend1,'LineWidth',1,'Interpreter','latex','FontSize',14, 'Location', 'northwest')
% number of components searched by tkmeans
k = g * 6;
% additional input for tkmeans
tkmeansOpt = struct;
tkmeansOpt.reftol = 0.0001;
tkmeansOpt.msg = 1;
tkmplots = struct;
tkmplots.type = 'contourf';
tkmplots.cmap = [0.3 0.2 0.4; 0.4 0.5 0.5; 0.1 0.7 0.9; 0.5 0.3 0.8; 1 1 1];
tkmeansOpt.plots = tkmplots;
tkmeansOpt.nomes = 0;
% saving tkmeans output
tkmeansOut = 1;
DEMP = dempk(X, k, g, 'tkmeansOpt', tkmeansOpt, 'plots', 'ellipse');
cascade;</pre></div></div><pre class="codeoutput">Total estimated time to complete trimmed k means:  0.46 seconds 
------------------------------
Warning: Number of subsets without convergence equal to 21.6667%
</pre><a href='http://rosa.unipr.it/fsda/dempk.html#Example_2'><img vspace="5" hspace="5" src="images\dempk_04.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website). Graphical output could not be included in the installation file because toolboxes cannot be greater than 20MB. To load locally the image files, download zip file http://rosa.unipr.it/fsda/images.zip and unzip it to <tt>(docroot)/FSDA/images</tt> or simply run routine <tt>downloadGraphicalOutput.m</tt>"> <img vspace="5" hspace="5" src="images\dempk_05.png" alt=""> <img vspace="5" hspace="5" src="images\dempk_06.png" alt=""> </a></p></div></div></div><p> </p><div class="examples"><h2 id="ExtraExamples" class="bottom_ruled">Related Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="Extraexample_1" class="example_module expandableContent"><div id="ExtraExample_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Example using dempk with hierarchical merging on data obtained by
     simdataset, specifying additional arguments in the call to clusterdata.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">close all
% Specify k cluster in v dimensions with n obs
g = 3;
v = 2;
n = 5000;
% null trimming and noise level
alpha0 = 0;
% restriction factor
restr = 30;
% Maximum overlap
maxOm = 0.005;
% Generate heterogeneous and elliptical clusters
rng(500, 'twister');
out = MixSim(g, v, 'sph', false, 'restrfactor', restr, 'int', [0 10], ...
'Display', 'off', 'MaxOmega', maxOm, 'Display','off');
% Simulating data
[X, id] = simdataset(n, out.Pi, out.Mu, out.S);
% Plotting data
gg = gscatter(X(:,1), X(:,2), id);
str = sprintf('Simulated data with %d groups in %d dimensions and %d \nunits, with restriction factor %d and maximum overlap %.2f', ...
g, v, n, restr, maxOm);
title(str,'Interpreter','Latex', 'fontsize', 12);
set(findobj(gg), 'MarkerSize',10);
legend1 = legend(gca,'Group 1','Group 2','Group 3');
set(legend1,'LineWidth',1,'Interpreter','latex','FontSize',12, 'Location', 'northwest')
% number of components searched by tkmeans
disp('RUNNING TKMEANS WITH 18 COMPONENTS; THEN MERGING WITH dempk');
k = g * 6;
% additional input for clusterdata (i.e. hierOpt)
linkagearg = 'weights';
DEMP = dempk(X, k, g, 'linkagearg', linkagearg, 'plots', 'ellipse');
cascade;</pre></div></div><pre class="codeoutput">RUNNING TKMEANS WITH 18 COMPONENTS; THEN MERGING WITH dempk
Total estimated time to complete trimmed k means:  0.57 seconds 
------------------------------
Warning: Number of subsets without convergence equal to 37.3333%
</pre><a href='http://rosa.unipr.it/fsda/dempk.html#ExtraExample_1'><img vspace="5" hspace="5" src="images\dempk_07.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website)"> <img vspace="5" hspace="5" src="images\dempk_08.png" alt=""> </a></p></div></div><div id="Extraexample_2" class="example_module expandableContent"><div id="ExtraExample_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Example using dempk, both setting a threshold and performing a
     hierarchical merging, for data obtained by simdataset with 10 percent
     uniform noise.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">close all
% Specify k cluster in v dimensions with n obs
g = 3;
v = 2;
n = 5000;
% 10 percent trimming and uniform noise
alpha = 0.1;
noise = alpha*n;
% restriction factor
restr = 30;
% Maximum overlap
maxOm = 0.005;
% Generate heterogeneous and elliptical clusters
rng(500, 'twister');
out = MixSim(g, v, 'sph', false, 'restrfactor', restr, 'int', [0 10], ...
'Display', 'off', 'MaxOmega', maxOm, 'Display','off');
% Simulating data
[X,id] = simdataset(n, out.Pi, out.Mu, out.S, 'noiseunits', noise);
% Plotting data
gg = gscatter(X(:,1), X(:,2), id);
str = sprintf('Simulating %d groups in %d dimensions and %d units with %d%s \nuniform noise, setting a restriction factor %d and maximum overlap %.2f', ...
g, v, n, alpha*100, '\%', restr, maxOm);
title(str,'Interpreter','Latex', 'fontsize', 10);
set(findobj(gg), 'MarkerSize',10);
legend1 = legend(gca,'Outliers','Group 1','Group 2','Group 3');
set(legend1,'LineWidth',1,'Interpreter','latex','FontSize',12, 'Location', 'northwest')
% fixing the number of components searched by tkmeans
k = g * 6;
% dempk with hierarchical merging and trimming equal to the level of noise
DEMP = dempk(X, k, g, 'alpha', alpha, 'plots', 'contourf');
% dempk with a threshold value and trimming equal to the level of noise
g = 0.025;
DEMP = dempk(X, k, g, 'alpha', alpha, 'plots', 'contourf');
cascade;</pre></div></div><pre class="codeoutput">Total estimated time to complete trimmed k means:  7.44 seconds 
------------------------------
Warning: Number of subsets without convergence equal to 38%
Total estimated time to complete trimmed k means:  7.31 seconds 
------------------------------
Warning: Number of subsets without convergence equal to 36%
</pre><a href='http://rosa.unipr.it/fsda/dempk.html#ExtraExample_2'><img vspace="5" hspace="5" src="images\dempk_09.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website)"> <img vspace="5" hspace="5" src="images\dempk_10.png" alt=""> <img vspace="5" hspace="5" src="images\dempk_11.png" alt=""> </a></p></div></div><div id="Extraexample_3" class="example_module expandableContent"><div id="ExtraExample_3"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Example using the M5 dataset and various setting for dempk, using
     hierarchical clustering, in order to identify the real clusters using
     different strategies.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">close all
Y = load('M5data.txt');
id = Y(:,3);
Y = Y(:, 1:2);
G = max(id);
n = length(Y);
noise = length(Y(id==0, 1));
v = 2; % dimensions
id(id==0) = -1; % changing noise label
gg = gscatter(Y(:,1), Y(:,2), id);
str = sprintf('M5 data set with %d groups in %d dimensions and \n%d units where %d%s of them are noise', G, v, n, noise/n*100, '\%');
title(str,'Interpreter','Latex', 'fontsize', 12);
set(findobj(gg), 'MarkerSize',12);
legend1 = legend(gca,'Outliers','Group 1','Group 2','Group 3');
set(legend1,'LineWidth',1,'Interpreter','latex','FontSize',12, 'Location', 'northwest')
% number of components to search
k = G*5;
% null trimming and noise level
alpha0 = 0;
% mimimum overlap cut-off value between pair of merged components
omegaStar = 0.045;
DEMP = dempk(Y, k, G, 'alpha', alpha0, 'tkmeansOut', 1, 'plots', 1);
% setting alpha equal to noise level (usually not appropriate)
alpha = noise/n;
DEMP2 = dempk(Y, k, G, 'alpha', alpha, 'tkmeansOut', 1, 'plots', 1);
% setting alpha greater than the noise level (almost always appropriate)
DEMP3 = dempk(Y, k, G, 'alpha', alpha+0.04, 'tkmeansOut', 1, 'plots', 1);
cascade;</pre></div></div><pre class="codeoutput">Total estimated time to complete trimmed k means:  0.18 seconds 
------------------------------
Warning: Number of subsets without convergence equal to 36%
Total estimated time to complete trimmed k means:  2.77 seconds 
------------------------------
Warning: Number of subsets without convergence equal to 39%
Total estimated time to complete trimmed k means:  2.60 seconds 
------------------------------
Warning: Number of subsets without convergence equal to 38.6667%
</pre><a href='http://rosa.unipr.it/fsda/dempk.html#ExtraExample_3'><img vspace="5" hspace="5" src="images\dempk_12.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website)"> <img vspace="5" hspace="5" src="images\dempk_13.png" alt=""> <img vspace="5" hspace="5" src="images\dempk_14.png" alt=""> <img vspace="5" hspace="5" src="images\dempk_15.png" alt=""> </a></p></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="Inputs">Input Arguments</h2><div class="expandableContent"><div class="arguments"><div class="input_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"> <div id="inputarg_Y" class="clearfix"> </div> <h3 id="input_argument_Y" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>Y</code> &#8212; Input data. </span>  </a><span class="example_desc">Matrix.</span></span></h3> <div class="collapse"> <p><p>n x v data matrix. n observations and v
               variables. Rows of Y represent observations, and columns represent
               variables. Missing values (NaN's) and infinite values
               (Inf's) are allowed, since observations (rows) with missing
               or infinite values will automatically be excluded from the
               computations.</p> <p>
               </p></p> <p class="datatypelist"><strong> Data Types: </strong><code>single | double</code></p> </div> </div><div class="expandableContent"> <div id="inputarg_k" class="clearfix"> </div> <h3 id="input_argument_k" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>k</code> &#8212; Number of components searched by tkmeans algorithm. </span>  </a><span class="example_desc">Integer scalar.</span></span></h3> <div class="collapse"> <p></p> <p class="datatypelist"><strong> Data Types: </strong><code>single | double</code></p> </div> </div><div class="expandableContent"> <div id="inputarg_g" class="clearfix"> </div> <h3 id="input_argument_g" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>g</code> &#8212; Merging rule. </span>  </a><span class="example_desc">Scalar.</span></span></h3> <div class="collapse"> <p><p>Number of groups obtained by hierarchical
               merging, or threshold of the pairwise overlap values (i.e.
               omegaStar) if 0&lt;g&lt;1.</p> <p>
               </p></p> <p class="datatypelist"><strong> Data Types: </strong><code>single | double</code></p> </div> </div><div id="namevaluepairarguments" class="clearfix"></div><h3 id="NameValuePairs" class="bottom_ruled">Name-Value Pair Arguments</h3><div class="namevaluecontainer"><p>Specify optional comma-separated pairs of <code>Name,Value</code> arguments. <code>Name</code> is the argument name and <code>Value</code> is the corresponding value. <code>Name</code> must appear  inside single quotes (<code>' '</code>).  You can specify several name and value pair arguments in any order as <code>  Name1,Value1,...,NameN,ValueN</code>.</p>  <span class="example_desc"><strong>Example:</strong><code><code> 'alpha', 0.05
</code>,<code> 'plots', 1
</code>,<code> 'tkmeansOpt.reftol', 0.0001
</code>,<code> 'tkmeansOut', 1
</code>,<code></code>,<code> 'Ysave',1
</code></code></span></div><div class="expandableContent"><div id="inputarg_alpha" class="clearfix"></div><h3 id="input_argument_namevalue_alpha" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>alpha</code> &#8212;Global trimming level.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>alpha is a scalar between 0
               and 0.5. If alpha=0 (default) tkmeans reduces to kmeans.</p> <p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'alpha', 0.05
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>single | double</code></p></div></div><div class="expandableContent"><div id="inputarg_plots" class="clearfix"></div><h3 id="input_argument_namevalue_plots" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>plots</code> &#8212;Plot on the screen.</span></a><span class="example_desc">scalar, char, | struct.</span></span></h3><div class="collapse">	<p><p>- If plots=0 (default) no plot is produced.</p> <p>
               - If plots=1, the components merged are shown using the
               spmplot function. In particular:</p> <p>
                   * for v=1, an histogram of the univariate data.</p> <p>
                   * for v=2, a bivariate scatterplot.</p> <p>
                   * for v&gt;2, a scatterplot matrix.</p> <p>
               When v&gt;=2 plots offers the following additional features
               (for v=1 the behaviour is forced to be as for plots=1):</p> <p>
               - plots='contourf' adds in the background of the bivariate
                 scatterplots a filled contour plot. The colormap of the
                 filled contour is based on grey levels as default.</p> <p>
                 This argument may also be inserted in a field named 'type'
                 of a structure. In the latter case it is possible to
                 specify the additional field 'cmap', which changes the
                 default colors of the color map used. The field 'cmap'
                 may be a three-column matrix of values in the range [0,1]
                 where each row is an RGB triplet that defines one color.</p> <p>
                 Check the colormap function for additional informations.</p> <p>
               - plots='contour' adds in the background of the bivariate
                 scatterplots a contour plot. The colormap of the contour
                 is based on grey levels as default. This argument may
                 also be inserted in a field named 'type' of a structure.</p> <p>
                 In the latter case it is possible to specify the additional
                 field 'cmap', which changes the default colors of the
                 color map used. The field 'cmap' may be a three-column
                 matrix of values in the range [0,1] where each row is an
                 RGB triplet that defines one color.</p> <p>
                 Check the colormap function for additional informations.</p> <p>
               - plots='ellipse' superimposes confidence ellipses to
                 each group in the bivariate scatterplots. The size of the
                 ellipse is chi2inv(0.95,2), i.e. the confidence level used
                 by default is 95%. This argument may also be inserted in
                 a field named 'type' of a structure. In the latter case it
                 is possible to specify the additional field 'conflev',
                 which specifies the confidence level to use and it is a
                 value between 0 and 1.</p> <p>
               - plots='boxplotb' superimposes on the bivariate scatterplots
                 the bivariate boxplots for each group, using the boxplotb
                 function. This argument may also be inserted in a field
                 named 'type' of a structure.</p> <p>
               REMARK - The labels&lt;=0 are automatically excluded from the
                        overlaying phase, considering them as outliers.</p><p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'plots', 1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>single | double | string</code></p></div></div><div class="expandableContent"><div id="inputarg_tkmeansOpt" class="clearfix"></div><h3 id="input_argument_namevalue_tkmeansOpt" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>tkmeansOpt</code> &#8212;tkmeans optional arguments.</span></a><span class="example_desc">structure.</span></span></h3><div class="collapse">	<p><p>Empty structure (default)
               or structure containing optional input arguments for tkmeans.</p> <p>
               See tkmeans function.</p><p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'tkmeansOpt.reftol', 0.0001
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>struct</code></p></div></div><div class="expandableContent"><div id="inputarg_tkmeansOut" class="clearfix"></div><h3 id="input_argument_namevalue_tkmeansOut" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>tkmeansOut</code> &#8212;Saving tkmeans output structure.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>It is set to 1 to
               save the output structure of tkmeans into the output structure
               of dempk. Default is 0, i.e. no saving is done.</p> <p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'tkmeansOut', 1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>single | double</code></p></div></div><div class="expandableContent"><div id="inputarg_linkagearg" class="clearfix"></div><h3 id="input_argument_namevalue_linkagearg" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>linkagearg</code> &#8212;Linkage used.</span></a><span class="example_desc">single linkage is the default, see the               MATLAB linkage function for more general information.</span></span></h3><div class="collapse">	<p></p>	<p class="description_valueexample">       <strong>Example: </strong><code></code></p>	<p class="datatypelist"><strong>Data Types: </strong><code></code></p></div></div><div class="expandableContent"><div id="inputarg_Ysave" class="clearfix"></div><h3 id="input_argument_namevalue_Ysave" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>Ysave</code> &#8212;Saving Y.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>Scalar that is set to 1 to request that
               the input matrix Y is saved into the output structure out.</p> <p>
               Default is 0, i.e. no saving is done.</p><p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'Ysave',1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="OutputArgs" >Output Arguments</h2><div class="expandableContent"><div class="arguments"><div class="output_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"><div id="outputarg_out" class="clearfix"></div><h3 id="output_argument_out" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>out</code> &#8212; description</span></a><span class="example_desc">Structure</span></span></h3><div class="collapse"><p>Structure which contains the following fields

   <table border="2" cellpadding="4" cellspacing="0" class="body"><colgroup><col width="20%"><col width="80%"></colgroup><thead><tr valign="top"><th valign="top">Value</th><th valign="top">Description</th></tr></thead><tr valign="top"><td><code>PairOver</code></td><td><p>Pairwise overlap triangular matrix (sum of
                             misclassification probabilities) among
                             components found by tkmeans.</p></td></tr><tr valign="top"><td><code>mergID</code></td><td><p><p>Label for each unit. It is a vector with n
                             elements which assigns each unit to one of
                             the groups obtained according to the merging
                             algorithm applied.</p> <p>
                             REMARK - out.mergID=0 denotes trimmed units.</p></p></td></tr><tr valign="top"><td><code>tkmeansOut</code></td><td><p>Output from tkmeans function. The structure
                             is present if option tkmeansOut is set to 1.</p></td></tr><tr valign="top"><td><code>Y</code></td><td><p>Original data matrix Y. The field is present
                             if option Ysave is set to 1.</p></td></tr></table></p></div></div></div></div></div></div><div class="ref_sect" itemprop="content"><div class="bibliography"><h2 id="References">References</h2> <div><p>Melnykov, V., Michael, S. (2017), "Clustering large datasets by merging
   K-means solutions". Submitted.</p></div><div><p>Melnykov, V. (2016), Merging Mixture Components for Clustering Through
   Pairwise Overlap, "Journal of Computational and Graphical Statistics",
   Vol. 25, pp. 66-90.</p></div></div></div><div class="ref_sect"><h2 id="SeeAlso">See Also</h2><p><span itemprop="seealso"><a href="tkmeans.html" itemprop="url"><span itemprop="name"><code>tkmeans</code></span></a></span> | <span itemprop="seealso"><a href="matlab:web(fullfile(docroot,'stats/clusterdata.html'))" itemprop="url"><span itemprop="name"><code>clusterdata</code></span></a></span> | <span itemprop="seealso"><a href="overlapmap.html" itemprop="url"><span itemprop="name"><code>overlapmap</code></span></a></span></div><i>This page has been automatically generated by our routine <a href="publishFS.html">publishFS</a></i></div></section></div></div></div></div><div id="divbottom"></div></body></html>