<!DOCTYPE HTML> <html itemscope="" xmlns="http://www.w3.org/1999/xhtml"><head><title>FSR</title><meta content="refpage" name="chunktype"><meta content="function:FSR" itemprop="refentity" name="refentity"><link href="includesFS/bootstrap.min.css" rel="stylesheet" type="text/css"><meta content="text/javascript" http-equiv="Content-Script-Type"><meta content="fcn" itemprop="pagetype" name="toctype"><meta content="ref/function" itemprop="infotype" name="infotype" /><meta content="FSR gives an automatic outlier detection procedure in linear regression." itemprop="description" name="description" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" /><script type="text/x-mathjax-config">MathJax.Hub.Config({extensions: ["tex2jax.js"],jax: ["input/TeX","output/HTML-CSS"],menuSettings: {zoom: "Double-Click", zscale: "300"},tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},MathMenu: {showRenderer: false},"HTML-CSS": {availableFonts: ["TeX"],preferredFont: "TeX",imageFont: null}});</script><script type="text/javascript" src="includesFS/Mathjax/MathJax.js"></script><script src="includesFS/matlab-highlighter.min.js"></script><link href="includesFS/matlab-highlighter.css" rel="stylesheet" type="text/css"><script type="text/javascript" src="includesFS/jquery-latest.js"></script><script>$(document).ready(function(){      $("#divtop").load("includesFS/top.html");      $("#divbottom").load("includesFS/bottom.html");});</script><script src="includesFS/jquery-latest.js" type="text/javascript"></script><link href="includesFS/site6.css?201505100807" rel="stylesheet" type="text/css"><link href="includesFS/site6_lg.css?201505100807" media="screen and (min-width: 1200px)" rel="stylesheet"><link href="includesFS/site6_md.css?201505100807" media="screen and (min-width: 992px) and (max-width: 1199px)" rel="stylesheet"><link href="includesFS/site6_sm+xs.css?201505100807" media="screen and (max-width: 991px)" rel="stylesheet"><link href="includesFS/site6_sm.css?201505100807" media="screen and (min-width: 768px) and (max-width: 991px)" rel="stylesheet"><link href="includesFS/site6_xs.css?201505100807" media="screen and (max-width: 767px)" rel="stylesheet"><link href="includesFS/site6_offcanvas.css?201505100807" rel="stylesheet" type="text/css"><script src="includesFS/l10n.js" type="text/javascript"></script><script src="includesFS/SHAREDdocscripts.js"></script><script src="includesFS/PRODUCTdocscripts.js"></script><script src="includesFS/mw.toc.js" type="text/javascript"></script><script src="includesFS/mw.imagescaling.js" type="text/javascript"></script><script src="includesFS/mw.imageanimation.js" type="text/javascript"></script><script src="includesFS/jquery.highlight.js"></script><script src="includesFS/bootstrap.min.js" type="text/javascript"></script><script src="includesFS/global.js"></script><script src="includesFS/bottom.js" type="text/javascript"></script><script src="includesFS/suggest.js" type="text/javascript"></script><script src="includesFS/underscore-min.js"></script><link href="includesFS/reset.css" rel="stylesheet" type="text/css"><link href="includesFS/960.css" rel="stylesheet" type="text/css"><link href="includesFS/doc_center.css" rel="stylesheet" type="text/css"><link href="includesFS/doc_center_installed.css" rel="stylesheet" type="text/css"><link href="includesFS/doc_center.css" rel="stylesheet" type="text/css"><link href="includesFS/doc_center_installed.css" rel="stylesheet" type="text/css"><link href="includes/product/css/doc_center_print.css" media="print" rel="stylesheet" type="text/css"></head><body  onload="highlightMATLABCode();" id="responsive_offcanvas">  <div id="doc_header_spacer" class="header"></div><div class="sticky_header_container includes_subnav"><div class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-xs-12 col-sm-6 col-sm-push-6 col-md-5 col-md-push-7" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2017a" data-language="en" action="../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="sr-only">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"><div class="input-group-btn"><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search pull-right icon_32 visible-xs" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="col-sm-6 col-sm-pull-6 col-md-7 col-md-pull-5" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../documentation-center.html">Documentation</a></h1></div></div></div><div class="visible-xs" id="search_actuator"><button class="btn icon-search btn_search pull-right icon_16" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div><!--END.CLASS row--> </div><!--END.CLASS container-fluid--> </div><!--END.CLASS section_header level_3--><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_actuator" data-toggle="offcanvas" data-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="sr-only">Toggle navigation</span><span class="icon-menu icon_24"></span></button><span class="offcanvas_actuator_label"></span><span class="offcanvas_actuator_close"></span> </div><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-md-12 hidden-xs hidden-sm"></div></div></div></div></div></div></div><!--END.CLASS sticky_header_container--><div class="row-offcanvas row-offcanvas-left"><div id="sidebar" class="sidebar-offcanvas" role="navigation"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" xmlns:atict="http://www.arbortext.com/namespace/atict"><li itemprop="breadcrumb" itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb"> <a href="../documentation-center.html" itemprop="url"> <span itemprop="title">All Products</span></a></li></ul><ul class="nav_disambiguation" xmlns:atict="http://www.arbortext.com/namespace/atict"><li class="product"><a href="index.html">Flexible Statistics and Data Analysis (FSDA)</a><div class="dropdown"> <span id="dropdownMenu1" class="icon-arrow-down icon_16" data-toggle="dropdown"> </span><ul aria-labelledby="dropdownMenu1" class="dropdown-menu dropdown-menu-right" role="menu"><li role="presentation"> <a href="examples.html" role="menuitem" tabindex="-1">Examples</a></li><li role="presentation"> <a href="function-alpha.html" role="menuitem" tabindex="-1"> Functions and Other Reference</a></li><li role="presentation"> <a href="release-notes.html" role="menuitem" tabindex="-1"> Release Notes</a></li><li role="presentation"> <a href="tutorials.html" role="menuitem" tabindex="-1"> Tutorials</a></li></ul></div></li></ul><ul xmlns:atict="http://www.arbortext.com/namespace/atict" class="nav_disambiguation"> <li><a href="index.html">Flexible Statistics and Data Analysis Toolbox</a> </li> <li><a href="function-cate.html" itemprop="url">Functions</a></li></ul><!-- --><ul class="nav_scrollspy nav" xmlns:atict="http://www.arbortext.com/namespace/atict">  <li class="nav_scrollspy_function"> <a href="#responsive_offcanvas">FSR</a></li> <li id="SSPY810-refentry" class="nav_scrollspy_title">On this page</li><li><a class="intrnllnk" href="#syntax">Syntax</a></li><li><a class="intrnllnk" href="#Description">Description</a></li><li><a class="intrnllnk" href="#Examples">Examples</a><ul><li><a class="intrnllnk" href="#Example_1">FSR with all default options.</a></li><li><a class="intrnllnk" href="#Example_2">FSR with optional arguments.</a></li></ul></li><li><a class="intrnllnk" href="#ExtraExamples">Extra Examples</a><ul><li><a class="intrnllnk" href="#ExtraExample_1">FSR with optional arguments.</a></li><li><a class="intrnllnk" href="#ExtraExample_2">Initialize the search with the subsample which produces the smallest
     [h/n] quantile of squared residuals.</a></li><li><a class="intrnllnk" href="#ExtraExample_3">Extract all possible subsamples in order to find susbet to initialize
     the search.</a></li><li><a class="intrnllnk" href="#ExtraExample_4">Example for various combinations of the labeladd, bivarfit
     and multivarfit options.</a></li><li><a class="intrnllnk" href="#ExtraExample_5">Example of use of options xlim and ylim (Hawkins data).</a></li><li><a class="intrnllnk" href="#ExtraExample_6">Example of use of options nameX and nameY with contaminated data.</a></li><li><a class="intrnllnk" href="#ExtraExample_7">Example of point mass contamination.</a></li></ul></li><li><a class="intrnllnk" href="#Inputs">Input Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_y">y</a></li><li><a class="intrnllnk" href="#input_argument_X">X</a></li></ul></li><li><a class="intrnllnk" href="#NameValuePairs">Name-Value Pair Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_namevalue_intercept">intercept</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_h">h</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_nsamp">nsamp</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_lms">lms</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_plots">plots</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_init">init</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_nocheck">nocheck</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_bivarfit">bivarfit</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_multivarfit">multivarfit</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_labeladd">labeladd</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_nameX">nameX</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_namey">namey</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_ylim">ylim</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_xlim">xlim</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_bonflev">bonflev</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_msg">msg</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_bsbmfullrank">bsbmfullrank</a></li></ul></li><li><a class="intrnllnk" href="#OutputArgs">Output Arguments</a><ul><li><a class="intrnllnk" href="#output_argument_out">out</a></li></ul></li><li><a class="intrnllnk" href="#References">References</a></li><li><a class="intrnllnk" href="#SeeAlso">See Also</a></li></ul></nav><script src="includesFS/offcanvas.js"></script></div><div id="divtop"></div><div class="site_container site_toc_closed"><div class="page_container"><div class="content_frame"><div id="content_container" class="content_container"><section id="doc_center_content"><div class="function_ref"><div itemprop="content"><h1 itemprop="title">FSR</h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose">FSR gives an automatic outlier detection procedure in linear regression</p><div class="switch"><a id="expandAllPage" href="javascript:void(0);">expand all in page</a></div></div></div></div><div class="ref_sect"><h2 id="syntax">Syntax</h2><div class="syntax_signature"><div class="syntax_signature_module"><ul><li><code class="synopsis">out=FSR(y,X)</code><span class="syntax_example"><a class="intrnllnk" href="FSR.html#Example_1">example</a></span></li><li><code class="synopsis">out=FSR(y,X,Name,Value)</code><span class="syntax_example"><a class="intrnllnk" href="FSR.html#Example_2">example</a></span></li></ul></div></div></div>	<div class="ref_sect" itemprop="content">							<h2 id="Description">Description</h2>							<div class="descriptions">								<div class="description_module"><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="FSR.html#Example_1">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_out"><code>out</code></a>=FSR(<a class="intrnllnk" href="#inputarg_y"><code>y</code></a>,<a class="intrnllnk" href="#inputarg_X"><code>X</code></a>)</code></span>FSR with all default options.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="FSR.html#Example_2">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_out"><code>out</code></a>=FSR(<a class="intrnllnk" href="#inputarg_y"><code>y</code></a>,<a class="intrnllnk" href="#inputarg_X"><code>X</code></a>,<a class="intrnllnk" href="#namevaluepairarguments"><code>Name, Value</code></a>)</code></span>FSR with optional arguments.</p></div>								</div>							</div>							<div class="clear">							</div>						</div><div class="ref_sect" itemprop="content"><div class="examples"><h2 id="Examples">Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="example_1" class="example_module expandableContent"><div id="Example_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>FSR with all default options.</li></span></a></span></h3><div class="collapse"><p>
     Run this code to see the output shown in the help file.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">
    n=200;
    p=3;
    randn('state', 123456);
    X=randn(n,p);
    % Uncontaminated data
    y=randn(n,1);
    % Contaminated data
    ycont=y;
    ycont(1:5)=ycont(1:5)+6;
    [out]=FSR(ycont,X,'plots',2);</pre></div></div></p></div></div><div id="example_2" class="example_module expandableContent"><div id="Example_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> FSR with optional arguments.</li></span></a></span></h3><div class="collapse"><p>
     Run this code to see the output shown in the help file.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">
    state=100;
    randn('state', state);
    n=100;
    X=randn(n,3);
    bet=[3;4;5];
    y=3*randn(n,1)+X*bet;
    y(1:20)=y(1:20)+13;
    [outFS]=FSR(y,X,'plots',2);
    % The envelopes based on all the observations show that in the central
    % part of the search the observed curve is well beyond the extreme
    % thresholds. More precisely, the message inside the graph informs that
    % the signal took place in step 81 because the value of minimum deletion
    % residual in this step was greater than 99.999% threshold.
    % Once a signal takes place the envelopes are resuperimposed until a
    % stopping rule is fulfilled.
    % The procedure of resuperimposing envelopes in this case stops when 
    % n = 85, the first time in which we have a value of rmin(m) for
    % $n&gt;=m^\dagger-1$ greater than the 99% threshold. The group can
    % therefore be considered as homogeneous up to when we include 84 units.</pre></div></div><pre class="codeoutput">Total estimated time to complete LMS:  0.01 seconds 
-------------------------
Signal detection loop
Tentative signal in central part of the search: step m=81 because
rmin(81,100)&gt;99.999%
-------------------
Signal validation exceedance of upper envelopes
Validated signal
-------------------------------
Start resuperimposing envelopes from step m=80
Superimposition stopped because r_{min}(82,85)&gt;99% envelope
$r_{min}(82,85)&gt;99$\% envelope
Subsample of 84 units is homogeneous
----------------------------
Final output
Number of units declared as outliers=16
Summary of the exceedances
           1          99         999        9999       99999
           2          17          10           9           6

</pre><img vspace="5" hspace="5" src="images\FSR_01.png" alt=""> <img vspace="5" hspace="5" src="images\FSR_02.png" alt=""> <img vspace="5" hspace="5" src="images\FSR_03.png" alt=""> <img vspace="5" hspace="5" src="images\FSR_04.png" alt=""> </p></div></div></div><p> </p><h3 id="ExtraExamples" class="bottom_ruled">Related Examples</h3><div id="ExtraExample_1" class="example_module expandableContent"><div id="ExtraExample_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>FSR with optional arguments.</li></span></a></span></h3><div class="collapse"><p>
     Monitor the exceedances from m=60 without showing plots.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">
    n=200;
    p=3;
    X=rand(n,p);
    y=rand(n,1);
    [out]=FSR(y,X,'init',60,'plots',0);</pre></div></div></p></div></div><div id="ExtraExample_2" class="example_module expandableContent"><div id="ExtraExample_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Initialize the search with the subsample which produces the smallest
     [h/n] quantile of squared residuals.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">
    n=200;
    p=3;
    X=randn(n,p);
    y=randn(n,1);
    [out]=FSR(y,X,'h',120);</pre></div></div></p></div></div><div id="ExtraExample_3" class="example_module expandableContent"><div id="ExtraExample_3"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Extract all possible subsamples in order to find susbet to initialize
     the search.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">
    n=200;
    p=3;
    X=randn(n,p);
    y=randn(n,1);
    [out]=FSR(y,X,'nsamp',0);</pre></div></div></p></div></div><div id="ExtraExample_4" class="example_module expandableContent"><div id="ExtraExample_4"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Example for various combinations of the labeladd, bivarfit
     and multivarfit options.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">
    n=200;
    p=3;
    X=randn(n,p);
    y=randn(n,1);
    [out]=FSR(y,X, 'labeladd','1','bivarfit','1','multivarfit','1');</pre></div></div><pre class="codeoutput">Total estimated time to complete LMS:  0.01 seconds 
-------------------------
Signal detection loop
Sample seems homogeneous, no outlier has been found
Summary of the exceedances
           1          99         999        9999       99999
           0           0           0           0           0

</pre><img vspace="5" hspace="5" src="images\FSR_05.png" alt=""> <img vspace="5" hspace="5" src="images\FSR_06.png" alt=""> </p></div></div><div id="ExtraExample_5" class="example_module expandableContent"><div id="ExtraExample_5"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Example of use of options xlim and ylim (Hawkins data).</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">
    load('hawkins.txt','hawkins');
    y=hawkins(:,9);
    X=hawkins(:,1:8);
    % Use of FSR starting with 1000 subsamples
    [out]=FSR(y,X,'nsamp',1000);
    % Use of FSR starting with 1000 subsamples
    % focusing in the output plots to the interval 1-6 on the y axis and
    % to steps 30-90.
    [out]=FSR(y,X,'nsamp',1000,'ylim',[1 6],'xlim',[30 90]);</pre></div></div></p></div></div><div id="ExtraExample_6" class="example_module expandableContent"><div id="ExtraExample_6"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Example of use of options nameX and nameY with contaminated data.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">
    n=200;
    p=3;
    state1=123498;
    randn('state', state1);
    X=randn(n,p);
    y=randn(n,1);
    kk=33;
    % shift contamination of the first 6 units of the response
    y(1:kk)=y(1:kk)+6;
    nameX={'age', 'salary', 'position'};
    namey='salary';
    [out]=FSR(y,X,'nameX',nameX,'namey',namey);</pre></div></div></p></div></div><div id="ExtraExample_7" class="example_module expandableContent"><div id="ExtraExample_7"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Example of point mass contamination.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">
    n=130;
    p=5;
    state1=123498;
    randn('state', state1);
    X=randn(n,p);
    y=randn(n,1);
    kk=30;
    % point mass contamination of the first kk units
    X(1:kk,:)=1;
    y(1:kk)=3;
    [out]=FSR(y,X);</pre></div></div></p></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="Inputs">Input Arguments</h2><div class="expandableContent"><div class="arguments"><div class="input_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"> <div id="inputarg_y" class="clearfix"> </div> <h3 id="input_argument_y" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>y</code> &#8212; Response variable. </span>  </a><span class="example_desc">Vector.</span></span></h3> <div class="collapse"> <p><p>Response variable, specified as
               a vector of length n, where n is the number of
               observations. Each entry in y is the response for the
               corresponding row of X.</p> <p>
               Missing values (NaN's) and infinite values (Inf's) are
               allowed, since observations (rows) with missing or infinite
               values will automatically be excluded from the
               computations.</p></p> <p class="datatypelist"><strong> Data Types: </strong><code>single| double</code></p> </div> </div><div class="expandableContent"> <div id="inputarg_X" class="clearfix"> </div> <h3 id="input_argument_X" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>X</code> &#8212; Predictor variables. </span>  </a><span class="example_desc">Matrix.</span></span></h3> <div class="collapse"> <p><p>Matrix of explanatory
               variables (also called 'regressors') of dimension n x (p-1)
               where p denotes the number of explanatory variables
               including the intercept.</p> <p>
               Rows of X represent observations, and columns represent
               variables. By default, there is a constant term in the
               model, unless you explicitly remove it using input option
               intercept, so do not include a column of 1s in X. Missing
               values (NaN's) and infinite values (Inf's) are allowed,
               since observations (rows) with missing or infinite values
               will automatically be excluded from the computations.</p></p> <p class="datatypelist"><strong> Data Types: </strong><code>single| double</code></p> </div> </div><div id="namevaluepairarguments" class="clearfix"></div><h3 id="NameValuePairs" class="bottom_ruled">Name-Value Pair Arguments</h3><div class="namevaluecontainer"><p>Specify optional comma-separated pairs of <code>Name,Value</code> arguments. <code>Name</code> is the argument name and <code>Value</code> is the corresponding value. <code>Name</code> must appear  inside single quotes (<code>' '</code>).  You can specify several name and value pair arguments in any order as <code>  Name1,Value1,...,NameN,ValueN</code>.</p>  <span class="example_desc"><strong>Example:</strong><code><code> 'intercept',1 
</code>,<code> 'h',round(n*0,75) 
</code>,<code> 'nsamp',1000 
</code>,<code> 'lms',1 
</code>,<code> 'plots',1 
</code>,<code> 'init',100 starts monitoring from step m=100 
</code>,<code> 'nocheck',1 
</code>,<code> 'bivarfit','2' 
</code>,<code> 'multivarfit','1' 
</code>,<code> 'labeladd','1' 
</code>,<code> 'nameX',{'NameVar1','NameVar2'} 
</code>,<code> 'namey','NameOfResponse' 
</code>,<code> 'bonflev',0.99
</code>,<code> 'msg',1 
</code>,<code> 'bsbmfullrank',1 
</code></code></span></div><div class="expandableContent"><div id="inputarg_intercept" class="clearfix"></div><h3 id="input_argument_namevalue_intercept" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>intercept</code> &#8212;Indicator for constant term.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>If 1, a model with
               constant term will be fitted (default), else no constant
               term will be included.</p> <p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'intercept',1 
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_h" class="clearfix"></div><h3 id="input_argument_namevalue_h" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>h</code> &#8212;The number of observations that have determined the least
                 trimmed squares estimator.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>h is an integer
                 greater or equal than p but smaller then n. Generally if
                 the purpose is outlier detection h=[0.5*(n+p+1)] (default
                 value). h can be smaller than this threshold if the
                 purpose is to find subgroups of homogeneous observations.</p> <p>
                 In this function the LTS/LMS estimator is used just to
                 initialize the search.</p><p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'h',round(n*0,75) 
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_nsamp" class="clearfix"></div><h3 id="input_argument_namevalue_nsamp" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>nsamp</code> &#8212;Number of subsamples which will be extracted to find the
                 robust estimator.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>If nsamp=0 all subsets will be extracted.</p> <p>
                 They will be (n choose p).</p> <p>
                 If the number of all possible subset is &lt;1000 the
                 default is to extract all subsets otherwise just 1000.</p><p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'nsamp',1000 
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_lms" class="clearfix"></div><h3 id="input_argument_namevalue_lms" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>lms</code> &#8212;Criterion to use to find the initial
                 subset to initialize the search.</span></a><span class="example_desc">scalar,  vector | structure.</span></span></h3><div class="collapse">	<p><p>lms specifies the criterion to use to find the initial
                 subset to initialize the search (LMS, LTS with
                 concentration steps, LTS without concentration steps
                 or subset supplied directly by the user).</p> <p>
                 The default value is 1 (Least Median of Squares
                 is computed to initialize the search). On the other hand,
                 if the user wants to initialze the search with LTS with
                 all the default options for concentration steps then
                 lms=2. If the user wants to use LTS without
                 concentration steps, lms can be a scalar different from 1
                 or 2. If lms is a struct it is possible to control a
                 series of options for concentration steps (for more
                 details see option lms inside LXS.m)
                 <a href="LXS.html">LXS</a>.</p> <p>
                 If, on the other hand, the user wants to initialize the
                 search with a prespecified set of units there are two
                 possibilities:</p> <p> 
                 1) lms can be a vector with length greater than 1 which
                 contains the list of units forming the initial subset. For 
                 example, if the user wants to initialize the search
                 with units 4, 6 and 10 then lms=[4 6 10];</p><p> 
                 2) lms is a struct which contains a field named bsb which
                 contains the list of units to initialize the search. For
                 example, in the case of simple regression through the
                 origin with just one explanatory variable, if the user
                 wants to initialize the search with unit 3 then
                 lms=struct;</p><table border="2" cellpadding="4" cellspacing="0" class="body"><colgroup><col width="20%"><col width="80%"></colgroup><thead><tr valign="top"><th valign="top">Value</th><th valign="top">Description</th></tr></thead><tr valign="top"><td><code>bsb</code></td><td><p>3;</p></td></tr></table></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'lms',1 
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_plots" class="clearfix"></div><h3 id="input_argument_namevalue_plots" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>plots</code> &#8212;Plot on the screen.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>If plots=1 (default) the plot of minimum deletion
                 residual with envelopes based on n observations and the
                 scatterplot matrix with the outliers highlighted is
                 produced.</p> <p>
                 If plots=2 the user can also monitor the intermediate
                 plots based on envelope superimposition.</p> <p>
                 Else no plot is produced.</p><p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'plots',1 
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_init" class="clearfix"></div><h3 id="input_argument_namevalue_init" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>init</code> &#8212;Search initialization.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>It specifies the initial subset size to start
                 monitoring exceedances of minimum deletion residual, if
                 init is not specified it set equal to:</p> <p>
                   p+1, if the sample size is smaller than 40;</p> <p>
                   min(3*p+1,floor(0.5*(n+p+1))), otherwise.</p><p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'init',100 starts monitoring from step m=100 
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_nocheck" class="clearfix"></div><h3 id="input_argument_namevalue_nocheck" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>nocheck</code> &#8212;Check input arguments.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>If nocheck is equal to 1 no check is performed on
                 matrix y and matrix X. Notice that y and X are left
                 unchanged. In other words the additional column of ones
                 for the intercept is not added. As default nocheck=0.</p> <p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'nocheck',1 
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_bivarfit" class="clearfix"></div><h3 id="input_argument_namevalue_bivarfit" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>bivarfit</code> &#8212;Superimpose bivariate least square lines.</span></a><span class="example_desc">character.</span></span></h3><div class="collapse">	<p><p>This option adds
                 one or more least squares lines, based on
                 SIMPLE REGRESSION of y on Xi, to the plots of y|Xi.</p> <p>
                 bivarfit = ''
                   is the default: no line is fitted.</p> <p>
                 bivarfit = '1'
                   fits a single ols line to all points of each bivariate
                   plot in the scatter matrix y|X.</p> <p>
                 bivarfit = '2'
                   fits two ols lines: one to all points and another to
                   the group of the genuine observations. The group of the
                   potential outliers is not fitted.</p> <p>
                 bivarfit = '0'
                   fits one ols line to each group. This is useful for the
                   purpose of fitting mixtures of regression lines.</p> <p>
                 bivarfit = 'i1' or 'i2' or 'i3' etc. fits 
                   an ols line to a specific group, the one with
                   index 'i' equal to 1, 2, 3 etc. Again, useful in case
                   of mixtures.</p><p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'bivarfit','2' 
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>char</code></p></div></div><div class="expandableContent"><div id="inputarg_multivarfit" class="clearfix"></div><h3 id="input_argument_namevalue_multivarfit" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>multivarfit</code> &#8212;Superimpose multivariate least square lines.</span></a><span class="example_desc">character.</span></span></h3><div class="collapse">	<p><p>This option adds one or more least square lines, based on
                 MULTIVARIATE REGRESSION of y on X, to the plots of y|Xi.</p> <p>
                 multivarfit = ''
                   is the default: no line is fitted.</p> <p>
                 multivarfit = '1'
                   fits a single ols line to all points of each bivariate
                   plot in the scatter matrix y|X. The line added to the
                   scatter plot y|Xi is avconst + Ci*Xi, where Ci is the
                   coefficient of Xi in the multivariate regression and
                   avconst is the effect of all the other explanatory
                   variables different from Xi evaluated at their centroid
                   (that is overline{y}'C))
                 multivarfit = '2'
                   equal to multivarfit ='1' but this time we also add the
                   line based on the group of unselected observations
                   (i.e. the normal units).</p><p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'multivarfit','1' 
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>char</code></p></div></div><div class="expandableContent"><div id="inputarg_labeladd" class="clearfix"></div><h3 id="input_argument_namevalue_labeladd" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>labeladd</code> &#8212;Add outlier labels in plot.</span></a><span class="example_desc">character.</span></span></h3><div class="collapse">	<p><p>If this option is
                 '1',  we label the outliers with the
                 unit row index in matrices X and y. The default value is
                 labeladd='', i.e. no label is added.</p> <p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'labeladd','1' 
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>char</code></p></div></div><div class="expandableContent"><div id="inputarg_nameX" class="clearfix"></div><h3 id="input_argument_namevalue_nameX" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>nameX</code> &#8212;Add variable labels in plot.</span></a><span class="example_desc">cell array of strings.</span></span></h3><div class="collapse">	<p>Cell
                 array of strings of length p containing the labels of
                 the variables of the regression dataset. If it is empty
                 (default) the sequence X1, ..., Xp will be created
                 automatically
               </p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'nameX',{'NameVar1','NameVar2'} 
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>cell</code></p></div></div><div class="expandableContent"><div id="inputarg_namey" class="clearfix"></div><h3 id="input_argument_namevalue_namey" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>namey</code> &#8212;Add response label.</span></a><span class="example_desc">character.</span></span></h3><div class="collapse">	<p>String containing the
                 label of the response
               </p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'namey','NameOfResponse' 
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>char</code></p></div></div><div class="expandableContent"><div id="inputarg_ylim" class="clearfix"></div><h3 id="input_argument_namevalue_ylim" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>ylim</code> &#8212;Control y scale in plot.</span></a><span class="example_desc">vector.</span></span></h3><div class="collapse">	<p>Vector with two elements controlling minimum and maximum
                 on the y axis. Default value is '' (automatic scale)
               </p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'ylim',[0,10] sets the minimum value to 0 and the
</code>               max to 10 on the y axis</p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_xlim" class="clearfix"></div><h3 id="input_argument_namevalue_xlim" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>xlim</code> &#8212;Control x scale in plot.</span></a><span class="example_desc">vector.</span></span></h3><div class="collapse">	<p>Vector with two elements
               minimum and maximum on the x axis. Default value is ''
               (automatic scale)
               </p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'xlim',[0,10] sets the minimum value to 0 and the
</code>               max to 10 on the x axis</p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_bonflev" class="clearfix"></div><h3 id="input_argument_namevalue_bonflev" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>bonflev</code> &#8212;Signal to use to identify outliers.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>Option to be
                used if the distribution of the data is
                 strongly non normal and, thus, the general signal
                 detection rule based on consecutive exceedances cannot be
                 used. In this case bonflev can be:</p> <p>
                 - a scalar smaller than 1 which specifies the confidence
                   level for a signal and a stopping rule based on the
                   comparison of the minimum MD with a
                   Bonferroni bound. For example if bonflev=0.99 the
                   procedure stops when the trajectory exceeds for the
                   first time the 99% bonferroni bound.</p> <p>
                 - A scalar value greater than 1. In this case the
                   procedure stops when the residual trajectory exceeds
                   for the first time this value.</p> <p>
                 Default value is '', which means to rely on general rules
                 based on consecutive exceedances.</p><p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'bonflev',0.99
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_msg" class="clearfix"></div><h3 id="input_argument_namevalue_msg" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>msg</code> &#8212;Level of output to display.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>It controls whether
                 to display or not messages on the screen
                 If msg==1 (default) messages are displayed on the screen about
                   step in which signal took place
                 else no message is displayed on the screen.</p> <p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'msg',1 
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_bsbmfullrank" class="clearfix"></div><h3 id="input_argument_namevalue_bsbmfullrank" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>bsbmfullrank</code> &#8212;Dealing with singluar X matrix.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>This option tells
                 how to behave in case subset at step m
                 (say bsbm) produces a singular X. In other words,
                 this options controls what to do when rank(X(bsbm,:)) is
                 smaller then number of explanatory variables. If
                 bsbmfullrank =1 (default) these units (whose number is
                 say mnofullrank) are constrained to enter the search in
                 the final n-mnofullrank steps else the search continues
                 using as estimate of beta at step m the estimate of beta
                 found in the previous step.</p> <p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'bsbmfullrank',1 
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="OutputArgs" >Output Arguments</h2><div class="expandableContent"><div class="arguments"><div class="output_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"><div id="outputarg_out" class="clearfix"></div><h3 id="output_argument_out" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>out</code> &#8212; description</span></a><span class="example_desc">Structure</span></span></h3><div class="collapse"><p>Structure which contains the following fields<table border="2" cellpadding="4" cellspacing="0" class="body"><colgroup><col width="20%"><col width="80%"></colgroup><thead><tr valign="top"><th valign="top">Value</th><th valign="top">Description</th></tr></thead><tr valign="top"><td><code>ListOut</code></td><td><p>k x 1 vector containing the list of the units declared as
                outliers or NaN if the sample is homogeneous</p></td></tr><tr valign="top"><td><code>outliers</code></td><td><p>out.ListOut. This field is added for homogeneity with the
                other robust estimators.</p></td></tr><tr valign="top"><td><code>beta</code></td><td><p>p-by-1 vector containing the estimated regression
               parameters (in step n-k).</p></td></tr><tr valign="top"><td><code>scale</code></td><td><p>scalar containing the estimate of the scale (sigma).</p></td></tr><tr valign="top"><td><code>residuals</code></td><td><p>n x 1 vector containing the estimates of the robust
                scaled residuals.</p></td></tr><tr valign="top"><td><code>fittedvalues</code></td><td><p>n x 1 vector containing the fitted values.</p></td></tr><tr valign="top"><td><code>mdr</code></td><td><p>(n-init) x 2 matrix
               1st col = fwd search index
               2nd col = value of minimum deletion residual in each step
               of the fwd search</p></td></tr><tr valign="top"><td><code>Un</code></td><td><p><p>(n-init) x 11 matrix which contains the unit(s) included
               in the subset at each step of the fwd search.</p> <p>
               REMARK: in every step the new subset is compared with the
               old subset. Un contains the unit(s) present in the new
               subset but not in the old one.</p> <p>
               Un(1,2) for example contains the unit included in step
               init+1.</p><p>
               Un(end,2) contains the units included in the final step
               of the search.</p></p></td></tr><tr valign="top"><td><code>nout</code></td><td><p><p>2 x 5 matrix containing the number of times mdr went out
               of particular quantiles.</p> <p>
               First row contains quantiles 1 99 99.9 99.99 99.999.</p><p>
               Second row contains the frequency distribution.</p></p></td></tr><tr valign="top"><td><code>constr</code></td><td><p>This output is produced only if the search found at a
               certain step X is a singular matrix. In this case the
               search runs in a constrained mode, that is including the
               units which produced a non singular matrix in the last n-constr
               steps. out.constr is a vector which contains the list of
               units which produced a singular X matrix</p></td></tr><tr valign="top"><td><code>class</code></td><td><p>'FSR'.</p></td></tr></table></p></div></div></div></div></div></div><div class="ref_sect" itemprop="content"><div class="bibliography"><h2 id="References">References</h2> <div><p>Riani, M., Atkinson A.C., Cerioli A. (2009). Finding an unknown
       number of multivariate outliers. Journal of the Royal Statistical
       Society Series B, Vol. 71, pp. 201-221.</p></div></div></div><div class="ref_sect"><h2 id="SeeAlso">See Also</h2><p><span itemprop="seealso"><a href="FSReda.html" itemprop="url"><span itemprop="name"><code>FSReda</code></span></a></span> | <span itemprop="seealso"><a href="LXS.html" itemprop="url"><span itemprop="name"><code>LXS</code></span></a></span></div><i>This page has been automatically generated by our routine <a href="publishFS.html">publishFS</a></i></div></section></div></div></div></div><div id="divbottom"></div></body></html>