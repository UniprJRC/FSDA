<!DOCTYPE HTML> <html itemscope="" xmlns="http://www.w3.org/1999/xhtml"><head><title>FSMinvmmd</title><meta content="refpage" name="chunktype"><meta content="function:FSMinvmmd" itemprop="refentity" name="refentity"><meta content="text/javascript" http-equiv="Content-Script-Type"><meta content="fcn" itemprop="pagetype" name="toctype"><meta content="ref/function" itemprop="infotype" name="infotype" /><meta content="FSMinvmmd converts values of minimum Mahalanobis distance into confidence levels." itemprop="description" name="description" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" /><script type="text/x-mathjax-config">MathJax.Hub.Config({extensions: ["tex2jax.js"],jax: ["input/TeX","output/HTML-CSS"],menuSettings: {zoom: "Double-Click", zscale: "300"},tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},MathMenu: {showRenderer: false},"HTML-CSS": {availableFonts: ["TeX"],preferredFont: "TeX",imageFont: null}});</script><script type="text/javascript" src="includesFS/Mathjax/MathJax.js"></script><script src="includesFS/matlab-highlighter.min.js"></script><link href="includesFS/matlab-highlighter.css" rel="stylesheet" type="text/css"><script type="text/javascript" src="includesFS/jquery-latest.js"></script><script>$(document).ready(function(){      $("#divtop").load("includesFS/top.html");      $("#divbottom").load("includesFS/bottom.html");});</script><link href="../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)"></link><link href="../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)"></link><link href="../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)"></link><link href="../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)"></link><link href="../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)"></link><link href="../includes/product/css/site6_offcanvas.css" rel="stylesheet" type="text/css"></link><script src="../includes/shared/scripts/l10n.js" type="text/javascript"></script><script src="../includes/product/scripts/docscripts.js"></script><script src="../includes/shared/scripts/docscripts_rn.js"></script><script src="../includes/shared/scripts/mw.imageanimation.js" type="text/javascript"></script><script src="../includes/shared/scripts/jquery.highlight.js"></script><script src="../includes/product/scripts/bootstrap.min.js" type="text/javascript"></script><script src="../includes/product/scripts/global.js"></script><script src="includesFS/bottom.js" type="text/javascript"></script><script src="../includes/product/scripts/underscore-min.js"></script><script src="../includes/shared/scripts/f1help.js" type="text/javascript"></script><script src="../includes/product/scripts/suggest.js" type="text/javascript"></script><script src="../includes/shared/scripts/helpservices.js" type="text/javascript"></script><script src="../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script><!-- the following line should be kept this way only --><link href="includesFS/doc_center.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css"><link href="../includes/product/css/doc_center_print.css" media="print" rel="stylesheet" type="text/css"></head><body  onload="highlightMATLABCode();" id="responsive_offcanvas">  <div id="doc_header_spacer" class="header"></div><div class="sticky_header_container includes_subnav"><div class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-xs-12 col-sm-6 col-sm-push-6 col-md-5 col-md-push-7" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2017a" data-language="en" action="../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="sr-only">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"><div class="input-group-btn"><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search pull-right icon_32 visible-xs" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="col-sm-6 col-sm-pull-6 col-md-7 col-md-pull-5" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../documentation-center.html">Documentation</a></h1></div></div></div><div class="visible-xs" id="search_actuator"><button class="btn icon-search btn_search pull-right icon_16" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div><!--END.CLASS row--> </div><!--END.CLASS container-fluid--> </div><!--END.CLASS section_header level_3--><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_actuator" data-toggle="offcanvas" data-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="sr-only">Toggle navigation</span><span class="icon-menu icon_24"></span></button><span class="offcanvas_actuator_label"></span><span class="offcanvas_actuator_close"></span> </div><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-md-12 hidden-xs hidden-sm"></div></div></div></div></div></div></div><!--END.CLASS sticky_header_container--><div class="row-offcanvas row-offcanvas-left"><div id="sidebar" class="sidebar-offcanvas" role="navigation"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" xmlns:atict="http://www.arbortext.com/namespace/atict"><li itemprop="breadcrumb" itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb"> <a href="../documentation-center.html" itemprop="url"> <span itemprop="title">All Products</span></a></li></ul><ul class="nav_disambiguation" xmlns:atict="http://www.arbortext.com/namespace/atict"><li class="product"><a href="index.html">Flexible Statistics and Data Analysis (FSDA)</a><div class="dropdown"> <span id="dropdownMenu1" class="icon-arrow-down icon_16" data-toggle="dropdown"> </span><ul aria-labelledby="dropdownMenu1" class="dropdown-menu dropdown-menu-right" role="menu"><li role="presentation"> <a href="examples.html" role="menuitem" tabindex="-1">Examples</a></li><li role="presentation"> <a href="function-alpha.html" role="menuitem" tabindex="-1"> Functions and Other Reference</a></li><li role="presentation"> <a href="release_notes.html?s_cid=doc_flyout" role="menuitem" tabindex="-1"> Release Notes</a></li><li role="presentation"> <a href="tutorials.html" role="menuitem" tabindex="-1"> Tutorials</a></li></ul></div></li></ul><ul xmlns:atict="http://www.arbortext.com/namespace/atict" class="nav_disambiguation"> <li><a href="index.html">Flexible Statistics and Data Analysis Toolbox</a> </li> <li><a href="function-cate.html" itemprop="url">Functions</a></li></ul><!-- --><ul class="nav_scrollspy nav" xmlns:atict="http://www.arbortext.com/namespace/atict">  <li class="nav_scrollspy_function"> <a href="#responsive_offcanvas">FSMinvmmd</a></li> <li id="SSPY810-refentry" class="nav_scrollspy_title">On this page</li><li><a class="intrnllnk" href="#syntax">Syntax</a></li><li><a class="intrnllnk" href="#Description">Description</a></li><li><a class="intrnllnk" href="#Examples">Examples</a><ul><li><a class="intrnllnk" href="#Example_1">FSMinvmmd with all default options.</a></li><li><a class="intrnllnk" href="#Example_2">FSMinvmmd with optional arguments.</a></li></ul></li><li><a class="intrnllnk" href="#ExtraExamples">Extra Examples</a><ul><li><a class="intrnllnk" href="#ExtraExample_1">Resuperimposing envelopes and normal coordinates.</a></li></ul></li><li><a class="intrnllnk" href="#Inputs">Input Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_mmd">mmd</a></li><li><a class="intrnllnk" href="#input_argument_v">v</a></li></ul></li><li><a class="intrnllnk" href="#NameValuePairs">Name-Value Pair Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_namevalue_n">n</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_plots">plots</a></li></ul></li><li><a class="intrnllnk" href="#OutputArgs">Output Arguments</a><ul><li><a class="intrnllnk" href="#output_argument_mmdinv">mmdinv</a></li></ul></li><li><a class="intrnllnk" href="#MoreAbout">More About</a></li><li><a class="intrnllnk" href="#References">References</a></li><li><a class="intrnllnk" href="#SeeAlso">See Also</a></li></ul></nav><script src="../includes/product/scripts/offcanvas.js"></script></div><div id="divtop"></div><div class="site_container site_toc_closed"><div class="page_container"><div class="content_frame"><div id="content_container" class="content_container"><section id="doc_center_content"><div class="function_ref"><div itemprop="content"><h1 itemprop="title">FSMinvmmd</h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose">FSMinvmmd converts values of minimum Mahalanobis distance into confidence levels</p><div class="switch"><a id="expandAllPage" href="javascript:void(0);">expand all in page</a></div></div></div></div><div class="ref_sect"><h2 id="syntax">Syntax</h2><div class="syntax_signature"><div class="syntax_signature_module"><ul><li><code class="synopsis">mmdinv=FSMinvmmd(mmd,v)</code><span class="syntax_example"><a class="intrnllnk" href="FSMinvmmd.html#Example_1">example</a></span></li><li><code class="synopsis">mmdinv=FSMinvmmd(mmd,v,Name,Value)</code><span class="syntax_example"><a class="intrnllnk" href="FSMinvmmd.html#Example_2">example</a></span></li></ul></div></div></div>	<div class="ref_sect" itemprop="content">							<h2 id="Description">Description</h2>							<div class="descriptions">								<div class="description_module"><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="FSMinvmmd.html#Example_1">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_mmdinv"><code>mmdinv</code></a>=FSMinvmmd(<a class="intrnllnk" href="#inputarg_mmd"><code>mmd</code></a>,<a class="intrnllnk" href="#inputarg_v"><code>v</code></a>)</code></span>FSMinvmmd with all default options.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="FSMinvmmd.html#Example_2">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_mmdinv"><code>mmdinv</code></a>=FSMinvmmd(<a class="intrnllnk" href="#inputarg_mmd"><code>mmd</code></a>,<a class="intrnllnk" href="#inputarg_v"><code>v</code></a>,<a class="intrnllnk" href="#namevaluepairarguments"><code>Name, Value</code></a>)</code></span>FSMinvmmd with optional arguments.</p></div>								</div>							</div>							<div class="clear">							</div>						</div><div class="ref_sect" itemprop="content"><div class="examples"><h2 id="Examples">Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="example_1" class="example_module expandableContent"><div id="Example_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>FSMinvmmd with all default options.</li></span></a></span></h3><div class="collapse"><p>
     After creating 99 per cent confidence envelopes based on 1000
     observations and 5 variables are created, their confidence level 
     is calculated with FSMinvmmd.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">v=5;
mmdenv=FSMenvmmd(1000,v,'prob',0.99);
mmdinv=FSMinvmmd(mmdenv,v);
% mmdinv is a matrix which in the second colum contains
% all values equal to 0.99.</pre></div></div></p></div></div><div id="example_2" class="example_module expandableContent"><div id="Example_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>FSMinvmmd with optional arguments.</li></span></a></span></h3><div class="collapse"><p>
     Example of finding confidence level of mmd. Forgery Swiss Banknotes data. <div class="programlisting"><div class="codeinput"><pre class="matlab-code">load('swiss_banknotes');
Y=swiss_banknotes{:,:};
Y=Y(101:200,:);
% The line below shows the plot of mmd
[out]=FSM(Y,'plots',1);
% The line below transforms the values of mmd into observed confidence
% levels and shows the output in a plot in normal coordinates using all
% default options
plots=struct;
plots.conflev=[0.01 0.5 0.99 0.999 0.9999 0.99999];
mmdinv=FSMinvmmd(out.mmd,size(Y,2),'plots',plots);</pre></div></div></p></div></div></div><p> </p><div class="examples"><h2 id="ExtraExamples" class="bottom_ruled">Related Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="Extraexample_1" class="example_module expandableContent"><div id="ExtraExample_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Resuperimposing envelopes and normal coordinates.</li></span></a></span></h3><div class="collapse"><p>
     Comparison of resuperimposing envelopes using mmd coordinates and normal
     coordinates. Forgery Swiss Banknotes data. <div class="programlisting"><div class="codeinput"><pre class="matlab-code">load('swiss_banknotes');
Y=swiss_banknotes{:,:};
Y=Y(101:200,:);
% The line below shows the plot of mmd
[out]=FSM(Y,'plots',2);
n0=83:86;
quantplo=[0.01 0.5 0.99 0.999 0.9999 0.99999];
ninv=norminv(quantplo);
lwdenv=2;
supn0=max(n0);
ij=0;
for jn0=n0;
ij=ij+1;
MMDinv = FSMinvmmd(out.mmd,size(Y,2),'n',jn0);
% Resuperimposed envelope in normal coordinates
subplot(2,2,ij)
plot(MMDinv(:,1),MMDinv(:,3),'LineWidth',2)
xlim([out.mmd(1,1) supn0])
v=axis;
line(v(1:2)',[ninv;ninv],'color','g','LineWidth',lwdenv,'LineStyle','--','Tag','env');
text(v(1)*ones(length(quantplo),1),ninv',strcat(num2str(100*quantplo'),'%'));
title(['Resuperimposed envelope n=' num2str(jn0)]);
end</pre></div></div><pre class="codeoutput">-------------------------
Signal detection loop
Tentative signal in central part of the search: step m=84 because
dmin(84,100)&gt;99.999%
-------------------
Signal validation
Validated signal
-------------------------------
Start resuperimposing envelopes from step m=83
Superimposition stopped because d_{min}(85,86)&gt;99% envelope
$d_{min}(85,86)&gt;99$\% envelope
----------------------------
Final output
Number of units declared as outliers=15
Summary of the exceedances
           1          99         999        9999       99999
           0          21          15           7           7

</pre><a href='http://rosa.unipr.it/fsda/FSMinvmmd.html#ExtraExample_1'><img vspace="5" hspace="5" src="images\FSMinvmmd_01.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website)"> <img vspace="5" hspace="5" src="images\FSMinvmmd_02.png" alt=""> <img vspace="5" hspace="5" src="images\FSMinvmmd_03.png" alt=""> </a></p></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="Inputs">Input Arguments</h2><div class="expandableContent"><div class="arguments"><div class="input_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"> <div id="inputarg_mmd" class="clearfix"> </div> <h3 id="input_argument_mmd" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>mmd</code> &#8212; Distances. </span>  </a><span class="example_desc">Matrix.</span></span></h3> <div class="collapse"> <p><p>n-m0 x 2 matrix.</p> <p>
                1st col = fwd search index;</p> <p>
                2nd col = minimum Mahalanobis distance.</p><p>
                </p></p> <p class="datatypelist"><strong> Data Types: </strong><code>single | double</code></p> </div> </div><div class="expandableContent"> <div id="inputarg_v" class="clearfix"> </div> <h3 id="input_argument_v" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>v</code> &#8212; Number of variables. </span>  </a><span class="example_desc">Scalar.</span></span></h3> <div class="collapse"> <p><p>Number of variables of the underlying dataset.</p> <p>
                </p></p> <p class="datatypelist"><strong> Data Types: </strong><code>single | double</code></p> </div> </div><div id="namevaluepairarguments" class="clearfix"></div><h3 id="NameValuePairs" class="bottom_ruled">Name-Value Pair Arguments</h3><div class="namevaluecontainer"><p>Specify optional comma-separated pairs of <code>Name,Value</code> arguments. <code>Name</code> is the argument name and <code>Value</code> is the corresponding value. <code>Name</code> must appear  inside single quotes (<code>' '</code>).  You can specify several name and value pair arguments in any order as <code>  Name1,Value1,...,NameN,ValueN</code>.</p>  <span class="example_desc"><strong>Example:</strong><code><code> 'n',5
</code>,<code> 'plots',1
</code></code></span></div><div class="expandableContent"><div id="inputarg_n" class="clearfix"></div><h3 id="input_argument_namevalue_n" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>n</code> &#8212;It specifies the size of the sample.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>If it is not specified
               it is set equal to mmd(end,1)+1.</p> <p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'n',5
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_plots" class="clearfix"></div><h3 id="input_argument_namevalue_plots" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>plots</code> &#8212;Plot on the screen.</span></a><span class="example_desc">scalar | structure.</span></span></h3><div class="collapse">	<p><p>If plots = 1, a plot which shows the
               confidence level of mmd in each step is shown on the
               screen. Three horizontal lines associated respectively with
               values 0.01, 0.5 and 0.99  are added to the plot.</p> <p>
               If plots is a structure, it may contain the following fields:</p><p>
           </p><table border="2" cellpadding="4" cellspacing="0" class="body"><colgroup><col width="20%"><col width="80%"></colgroup><thead><tr valign="top"><th valign="top">Value</th><th valign="top">Description</th></tr></thead><tr valign="top"><td><code>conflev</code></td><td><p>vector containing horizontal lines associated
                       with confidence levels;</p></td></tr><tr valign="top"><td><code>conflevlab</code></td><td><p>scalar if it is equal 1 labels associated with
                       horizontal lines are shown on the screen;</p></td></tr><tr valign="top"><td><code>xlim</code></td><td><p>minimum and maximum on the x axis;</p></td></tr><tr valign="top"><td><code>ylim</code></td><td><p>minimum and maximum on the y axis;</p></td></tr><tr valign="top"><td><code>LineWidth</code></td><td><p>Line width of the trajectory of mmd in
                   normal coordinates;</p></td></tr><tr valign="top"><td><code>LineStyle</code></td><td><p>Line style of the
                   trajectory of mle of transformation parameters;</p></td></tr><tr valign="top"><td><code>LineWidthEnv</code></td><td><p>Line width of the horizontal lines;</p></td></tr><tr valign="top"><td><code>Tag</code></td><td><p>tag of the plot (default is pl_mmdinv);</p></td></tr><tr valign="top"><td><code>FontSize</code></td><td><p>font size of the text labels which identify
                   the trajectories</p></td></tr></table></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'plots',1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="OutputArgs" >Output Arguments</h2><div class="expandableContent"><div class="arguments"><div class="output_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"><div id="outputarg_mmdinv" class="clearfix"></div><h3 id="output_argument_mmdinv" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>mmdinv</code> &#8212;confidence levels plotted in normal coordinates.</span></a><span class="example_desc"><code>
               (n-m0) -by- 3 </code>matrix (same rows of input matrix mmd)</span></span></h3><div class="collapse"><p><p>
               It contains information about requested
               confidence levels plotted in normal coordinates.</p> <p>
               1st col = fwd search index from m0 to n-1;</p> <p>
               2nd col = confidence level of each value of mmd;</p> <p>
               3rd col = confidence level in normal coordinates.</p> <p>
                    50 per cent conf level becomes norminv(0.50)=0;</p><p>
                    99 per cent conf level becomes norminv(0.99)=2.33.</p></p></div></div></div></div></div></div><div class="moreabout ref_sect"><h2 id="MoreAbout">More About</h2><div class="expandableContent"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent" itemprop="content"><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span>Additional Details</span></a></span></h3><div class="expand"><p><p>
Let $d^2_i(m )$ and  $d_{\mbox{min}}(m)$ be respectively the deletion
distance for unit $i$ based
 on a subset of size $m$ and $d_{\mbox{min}}(m)$ the min. Mahalanobis
 distance in the forward search at step m. Testing for outliers requires a
 reference distribution for $d^2_i(m )$ in and hence for
 $d_{\mbox{min}}(m)$ in (\ref{min}). When $\Sigma$ is estimated from all
 $n$ observations, the squared statistics  have an $F$ distribution.</p> <p>
 However, the estimate $\hat{\Sigma}(m)$ in the search uses the central
 $m$ out of $n$ observations, so that the variability is underestimated.</p><p>
 The consistency factor $c(m,n)$ given below
 </p>\[
  c(m,n)=\frac{n}{m} C_{v+2} \{C_{v}^{-1} (m/n) \}
 \]<p>
 where $C_r$ is the c.d.f. of the $\chi^2$ distribution on $r$ degrees of
 freedom, allows for estimation from this truncated distribution,  providing an
  approximately unbiased estimate of $\Sigma$.</p> <p>

 We can treat the distribution of the rescaled deletion Mahalanobis distance
 $c(m,n)d_{\mbox{min}}^2(m)$ as a squared deletion distance on $m-1$
 degrees of freedom, whose distribution is (Atkinson Riani and Cerioli,
 2004; pp. 43-44)
 \begin{equation}\label{F}
   \frac{m^2-1}{m(m-v)} F_{v,m-v},
 \end{equation}

 The distribution of the rescaled min Mahalanobis distance
  $c(m,n) d_{\mbox{min}}^2(m)$
 of a subset of size $m$ constructed in such a way that
  the centroid and covariance matrix of the subset are taken using the
  units having the $m$ smallest Mahalanobis distances can be treated as
  the distribution of the $(m+1)$th order statistic from ($F_{v,m-v}$).</p> <p>

 The results of order statistics $Y_{(1)}$, $Y_{(2)}$, $\cdots$,  $Y_{(n)}$ from a sample of size $n$ from a distribution with CDF $G(y)$, state that
 \begin{equation}
 \label{orderstat}
  P\{Y_{(m+1)} \le y \}  =  P \left\{ F_{2(n-m),2(m+1)} &gt;  \frac{1-G(y)}{G(y)} \times
  \frac{m+1}{n-m} \right\}
  \end{equation}
 Given that in our case $G(y)$ is the CDF of the  $F_{v,m-v}$ we can rewrite this equation  as

 \begin{eqnarray*}
   &&  P\{d_{\mbox{ min}}^2(m)  \leq \widehat{ d_{\mbox{min}}^2(m)} \} = \\
    && 1-  F_{2(n-m),2(m+1)} \left( \left( \frac{1}{  F_{v,m-v} \left( \frac{m(m-v)}{m^2-1 } c(m,n) d_{\mbox{min}}^2(m) \right)  }-1 \right) \frac{m+1}{n-m} \right)
 \end{eqnarray*}
 where $F_{a,b}(y)$ is the CDF of the $F$ distribution with $a$ and $b$ degrees of freedom evaluated in $y$.</p><p>
 The value of the min. Mahalanobis distance transformed in normal coordinates computed by this routine is
 nothing but
 </p>\[
 \Phi^{-1} \left(  P\left\{ d_{\mbox{min}}^2(m)  \leq \widehat{ d_{\mbox{min}}^2(m)} \right\}    \right)
 \]<p>
 where $\Phi^{-1}$ is the inverse of the CDF of the standard normal distribution.</p> <p>

</p></p></div></div></div></div><div class="ref_sect" itemprop="content"><div class="bibliography"><h2 id="References">References</h2> <div><p>Atkinson, A.C. and Riani, M. (2006), Distribution theory and
 simulations for tests of outliers in regression, "Journal of
 Computational and Graphical Statistics", Vol. 15, pp. 460-476.</p></div><div><p>Riani, M. and Atkinson, A.C. (2007), Fast calibrations of the forward
 search for testing multiple outliers in regression, "Advances in Data
 Analysis and Classification", Vol. 1, pp. 123-141.</p></div></div></div><div class="ref_sect"><h2 id="SeeAlso">See Also</h2><p><span itemprop="seealso"><a href="FSMenvmmd.html" itemprop="url"><span itemprop="name"><code>FSMenvmmd</code></span></a></span> | <span itemprop="seealso"><a href="FSM.html" itemprop="url"><span itemprop="name"><code>FSM</code></span></a></span> | <span itemprop="seealso"><a href="FSMeda.html" itemprop="url"><span itemprop="name"><code>FSMeda</code></span></a></span></div><i>This page has been automatically generated by our routine <a href="publishFS.html">publishFS</a></i></div></section></div></div></div></div><div id="divbottom"></div></body></html>