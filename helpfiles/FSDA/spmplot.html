<!DOCTYPE HTML> <html itemscope="" xmlns="http://www.w3.org/1999/xhtml"><head><title>spmplot</title><meta content="refpage" name="chunktype"><meta content="function:spmplot" itemprop="refentity" name="refentity"><meta content="text/javascript" http-equiv="Content-Script-Type"><meta content="fcn" itemprop="pagetype" name="toctype"><meta content="ref/function" itemprop="infotype" name="infotype" /><meta content="spmplot produces an interactive scatterplot matrix with boxplots or histograms on the main diagonal and possibly robust bivariate contours." itemprop="description" name="description" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" /><script type="text/x-mathjax-config">MathJax.Hub.Config({extensions: ["tex2jax.js"],jax: ["input/TeX","output/HTML-CSS"],menuSettings: {zoom: "Double-Click", zscale: "300"},tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},MathMenu: {showRenderer: false},"HTML-CSS": {availableFonts: ["TeX"],preferredFont: "TeX",imageFont: null}});</script><script type="text/javascript" src="includesFS/Mathjax/MathJax.js"></script><script src="includesFS/matlab-highlighter.min.js"></script><link href="includesFS/matlab-highlighter.css" rel="stylesheet" type="text/css"><script type="text/javascript" src="includesFS/jquery-latest.js"></script><script>$(document).ready(function(){      $("#divtop").load("includesFS/top.html");      $("#divbottom").load("includesFS/bottom.html");});</script><link href="../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)"></link><link href="../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)"></link><link href="../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)"></link><link href="../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)"></link><link href="../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)"></link><link href="../includes/product/css/site6_offcanvas.css" rel="stylesheet" type="text/css"></link><script src="../includes/shared/scripts/l10n.js" type="text/javascript"></script><script src="../includes/product/scripts/docscripts.js"></script><script src="../includes/shared/scripts/docscripts_rn.js"></script><script src="../includes/shared/scripts/mw.imageanimation.js" type="text/javascript"></script><script src="../includes/shared/scripts/jquery.highlight.js"></script><script src="../includes/product/scripts/bootstrap.min.js" type="text/javascript"></script><script src="../includes/product/scripts/global.js"></script><script src="includesFS/bottom.js" type="text/javascript"></script><script src="../includes/product/scripts/underscore-min.js"></script><script src="../includes/shared/scripts/f1help.js" type="text/javascript"></script><script src="../includes/product/scripts/suggest.js" type="text/javascript"></script><script src="../includes/shared/scripts/helpservices.js" type="text/javascript"></script><script src="../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script><!-- the following line should be kept this way only --><link href="includesFS/doc_center.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css"><link href="../includes/product/css/doc_center_print.css" media="print" rel="stylesheet" type="text/css"></head><body  onload="highlightMATLABCode();" id="responsive_offcanvas">  <div id="doc_header_spacer" class="header"></div><div class="sticky_header_container includes_subnav"><div class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-xs-12 col-sm-6 col-sm-push-6 col-md-5 col-md-push-7" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2017a" data-language="en" action="../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="sr-only">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"><div class="input-group-btn"><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search pull-right icon_32 visible-xs" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="col-sm-6 col-sm-pull-6 col-md-7 col-md-pull-5" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../documentation-center.html">Documentation</a></h1></div></div></div><div class="visible-xs" id="search_actuator"><button class="btn icon-search btn_search pull-right icon_16" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div><!--END.CLASS row--> </div><!--END.CLASS container-fluid--> </div><!--END.CLASS section_header level_3--><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_actuator" data-toggle="offcanvas" data-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="sr-only">Toggle navigation</span><span class="icon-menu icon_24"></span></button><span class="offcanvas_actuator_label"></span><span class="offcanvas_actuator_close"></span> </div><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-md-12 hidden-xs hidden-sm"></div></div></div></div></div></div></div><!--END.CLASS sticky_header_container--><div class="row-offcanvas row-offcanvas-left"><div id="sidebar" class="sidebar-offcanvas" role="navigation"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" xmlns:atict="http://www.arbortext.com/namespace/atict"><li itemprop="breadcrumb" itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb"> <a href="../documentation-center.html" itemprop="url"> <span itemprop="title">All Products</span></a></li></ul><ul class="nav_disambiguation" xmlns:atict="http://www.arbortext.com/namespace/atict"><li class="product"><a href="index.html">Flexible Statistics and Data Analysis (FSDA)</a><div class="dropdown"> <span id="dropdownMenu1" class="icon-arrow-down icon_16" data-toggle="dropdown"> </span><ul aria-labelledby="dropdownMenu1" class="dropdown-menu dropdown-menu-right" role="menu"><li role="presentation"> <a href="examples.html" role="menuitem" tabindex="-1">Examples</a></li><li role="presentation"> <a href="function-alpha.html" role="menuitem" tabindex="-1"> Functions and Other Reference</a></li><li role="presentation"> <a href="release_notes.html?s_cid=doc_flyout" role="menuitem" tabindex="-1"> Release Notes</a></li><li role="presentation"> <a href="tutorials.html" role="menuitem" tabindex="-1"> Tutorials</a></li></ul></div></li></ul><ul xmlns:atict="http://www.arbortext.com/namespace/atict" class="nav_disambiguation"> <li><a href="index.html">Flexible Statistics and Data Analysis Toolbox</a> </li> <li><a href="function-cate.html" itemprop="url">Functions</a></li></ul><!-- --><ul class="nav_scrollspy nav" xmlns:atict="http://www.arbortext.com/namespace/atict">  <li class="nav_scrollspy_function"> <a href="#responsive_offcanvas">spmplot</a></li> <li id="SSPY810-refentry" class="nav_scrollspy_title">On this page</li><li><a class="intrnllnk" href="#syntax">Syntax</a></li><li><a class="intrnllnk" href="#Description">Description</a></li><li><a class="intrnllnk" href="#Examples">Examples</a><ul><li><a class="intrnllnk" href="#Example_1">Call of spmplot with Y as table.</a></li><li><a class="intrnllnk" href="#Example_2">Call of spmplot without name/value pairs.</a></li><li><a class="intrnllnk" href="#Example_3">Call of spmplot without name/value pairs (2nd example).</a></li><li><a class="intrnllnk" href="#Example_4">Call of spmplot with name/value pairs and specifying overlay,
     also discarding some groups with the field include, and changing
     the default colormap.</a></li></ul></li><li><a class="intrnllnk" href="#ExtraExamples">Extra Examples</a><ul><li><a class="intrnllnk" href="#ExtraExample_1">Call of spmplot with name/value pairs and specifying overlay and undock.</a></li><li><a class="intrnllnk" href="#ExtraExample_2">Call of spmplot with name/value pairs and additional options for
     overlay, specifying densities just for one group.</a></li><li><a class="intrnllnk" href="#ExtraExample_3">Iris data: scatter plot matrix with univariate boxplots on the main
     diagonal and personalized options for symbols, colors, symbol
     size and no legend.</a></li><li><a class="intrnllnk" href="#ExtraExample_4">Example of spmplot called by routine FSM.</a></li><li><a class="intrnllnk" href="#ExtraExample_5">Now test the direct use of FSM.</a></li><li><a class="intrnllnk" href="#ExtraExample_6">spm with personalized tags.</a></li><li><a class="intrnllnk" href="#ExtraExample_7">An example with 5 groups.</a></li><li><a class="intrnllnk" href="#ExtraExample_8">Another example of spmplot called with name/pairs.</a></li><li><a class="intrnllnk" href="#ExtraExample_9"><i>Interactive example 1.</i></a></li><li><a class="intrnllnk" href="#ExtraExample_10">Example of use of option datatooltip.</a></li><li><a class="intrnllnk" href="#ExtraExample_11">First example of the use of options selunit when first input argument is a 2D array.</a></li><li><a class="intrnllnk" href="#ExtraExample_12">Second  example of the use of options selunit when first input argument is a 2D array.</a></li><li><a class="intrnllnk" href="#ExtraExample_13">Option datatooltip combined with rownames.</a></li><li><a class="intrnllnk" href="#ExtraExample_14"><i>Interactive example 2.</i>
       Example of the use of options selstep and selunit combined with databrush.</a></li><li><a class="intrnllnk" href="#ExtraExample_15"><i>Interactive example 3.</i>
       Example of the use of options selstep and selunit.</a></li><li><a class="intrnllnk" href="#ExtraExample_16"><i>Interactive example 4.</i>
       Example of the use of options selstep and selunit.</a></li><li><a class="intrnllnk" href="#ExtraExample_17">Example of use of option typespm passed as character.</a></li><li><a class="intrnllnk" href="#ExtraExample_18">Example of use of option typespm passed as struct.</a></li><li><a class="intrnllnk" href="#ExtraExample_19">Example 1 of use of option typespm passed as struct with groups.</a></li><li><a class="intrnllnk" href="#ExtraExample_20">Example 2 of use of option typespm passed as struct with groups.</a></li><li><a class="intrnllnk" href="#ExtraExample_21">Example of use of option colorBackground.</a></li></ul></li><li><a class="intrnllnk" href="#Inputs">Input Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_Y">Y</a></li></ul></li><li><a class="intrnllnk" href="#NameValuePairs">Name-Value Pair Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_namevalue_colorBackground">colorBackground</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_dispopt">dispopt</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_group">group</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_overlay">overlay</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_plo">plo</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_selunit">selunit</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_tag">tag</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_typespm">typespm</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_undock">undock</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_datatooltip">datatooltip</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_databrush">databrush</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_subsize">subsize</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_selstep">selstep</a></li></ul></li><li><a class="intrnllnk" href="#OutputArgs">Output Arguments</a><ul><li><a class="intrnllnk" href="#output_argument_H">H</a></li><li><a class="intrnllnk" href="#output_argument_AX">AX</a></li><li><a class="intrnllnk" href="#output_argument_BigAx">BigAx</a></li></ul></li><li><a class="intrnllnk" href="#MoreAbout">More About</a></li><li><a class="intrnllnk" href="#References">References</a></li><li><a class="intrnllnk" href="#SeeAlso">See Also</a></li></ul></nav><script src="../includes/product/scripts/offcanvas.js"></script></div><div id="divtop"></div><div class="site_container site_toc_closed"><div class="page_container"><div class="content_frame"><div id="content_container" class="content_container"><section id="doc_center_content"><div class="function_ref"><div itemprop="content"><h1 itemprop="title">spmplot</h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose">spmplot produces an interactive scatterplot matrix with boxplots or histograms on the main diagonal and possibly robust bivariate contours</p><div class="switch"><a id="expandAllPage" href="javascript:void(0);">expand all in page</a></div></div></div></div><div class="ref_sect"><h2 id="syntax">Syntax</h2><div class="syntax_signature"><div class="syntax_signature_module"><ul><li><code class="synopsis">H=spmplot(Y)</code><span class="syntax_example"><a class="intrnllnk" href="spmplot.html#Example_1">example</a></span></li><li><code class="synopsis">H=spmplot(Y,Name,Value)</code><span class="syntax_example"><a class="intrnllnk" href="spmplot.html#Example_2">example</a></span></li><li><code class="synopsis">[H,AX]=spmplot(___)</code><span class="syntax_example"><a class="intrnllnk" href="spmplot.html#Example_3">example</a></span></li><li><code class="synopsis">[H,AX,BigAx]=spmplot(___)</code><span class="syntax_example"><a class="intrnllnk" href="spmplot.html#Example_4">example</a></span></li></ul></div></div></div>	<div class="ref_sect" itemprop="content">							<h2 id="Description">Description</h2>							<div class="descriptions">								<div class="description_module"><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="spmplot.html#Example_1">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_H"><code>H</code></a>=spmplot(<a class="intrnllnk" href="#inputarg_Y"><code>Y</code></a>)</code></span>Call of spmplot with Y as table.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="spmplot.html#Example_2">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_H"><code>H</code></a>=spmplot(<a class="intrnllnk" href="#inputarg_Y"><code>Y</code></a>,<a class="intrnllnk" href="#namevaluepairarguments"><code>Name, Value</code></a>)</code></span>Call of spmplot without name/value pairs.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="spmplot.html#Example_3">	example</a></p>	<p><span itemprop="syntax"><code>[<a class="intrnllnk" href="#outputarg_H"><code>H</code></a>,<a class="intrnllnk" href="#outputarg_AX"><code>AX</code></a>]=spmplot(___)</code></span>Call of spmplot without name/value pairs (2nd example).</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="spmplot.html#Example_4">	example</a></p>	<p><span itemprop="syntax"><code>[<a class="intrnllnk" href="#outputarg_H"><code>H</code></a>,<a class="intrnllnk" href="#outputarg_AX"><code>AX</code></a>,<a class="intrnllnk" href="#outputarg_BigAx"><code>BigAx</code></a>]=spmplot(___)</code></span>Call of spmplot with name/value pairs and specifying overlay,
     also discarding some groups with the field include, and changing
     the default colormap.</p></div>								</div>							</div>							<div class="clear">							</div>						</div><div class="ref_sect" itemprop="content"><div class="examples"><h2 id="Examples">Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="example_1" class="example_module expandableContent"><div id="Example_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>Call of spmplot with Y as table.</li></span></a></span></h3><div class="collapse"><p>
     In this case the VariableNames of the table are added at the margins
     of the plot.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">load fisheriris;
meastable=array2table(meas,'VariableNames',{'SL','SW','PL','PW'});
spmplot(meastable);</pre></div></div></p></div></div><div id="example_2" class="example_module expandableContent"><div id="Example_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>Call of spmplot without name/value pairs.</li></span></a></span></h3><div class="collapse"><p>
     Iris data: scatter plot matrix with univariate boxplots on the main
     diagonal.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">close all
load fisheriris;
plo=struct;
plo.nameY={'SL','SW','PL','PW'};
figure;
spmplot(meas,species,plo,'hist');</pre></div></div></p></div></div><div id="example_3" class="example_module expandableContent"><div id="Example_3"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>Call of spmplot without name/value pairs (2nd example).</li></span></a></span></h3><div class="collapse"><p>
     With this way of calling spmplot just the first 4 arguments are
     considered. All the rest is discarded. A message appears to alert the
     user that this is the case.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">close all
load fisheriris;
plo=struct;
plo.nameY={'SL','SW','PL','PW'};
figure;
spmplot(meas,species,plo,'hist','tag','dfgdfg');</pre></div></div></p></div></div><div id="example_4" class="example_module expandableContent"><div id="Example_4"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Call of spmplot with name/value pairs and specifying overlay,
     also discarding some groups with the field include, and changing
     the default colormap.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">% The Tag setting will be used in the next example to demonstrate the
% undock option.
% Iris data: scatter plot matrix with univariate boxplots on the main
% diagonal.
close all
load fisheriris;
plo=struct;
plo.nameY={'SL','SW','PL','PW'};
spmplot(meas,'group',species,'plo',plo,'dispopt','box');
figure
spmplot(meas,'group',species,'plo',plo,'dispopt','box','overlay','ellipse');
figure
spmplot(meas,'group',species,'plo',plo,'dispopt','box','overlay','contour');
figure
spmplot(meas,'group',species,'plo',plo,'dispopt','box','overlay','contourf');
set(gcf,'Tag','newTag')
cascade</pre></div></div><a href='http://rosa.unipr.it/fsda/spmplot.html#Example_4'><img vspace="5" hspace="5" src="images\spmplot_01.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website)."> <img vspace="5" hspace="5" src="images\spmplot_02.png" alt=""> <img vspace="5" hspace="5" src="images\spmplot_03.png" alt=""> <img vspace="5" hspace="5" src="images\spmplot_04.png" alt=""> </a></p></div></div></div><p> </p><div class="examples"><h2 id="ExtraExamples" class="bottom_ruled">Related Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="Extraexample_1" class="example_module expandableContent"><div id="ExtraExample_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Call of spmplot with name/value pairs and specifying overlay and undock.</li></span></a></span></h3><div class="collapse"><p>
     The latter argument requires to change the tag of the scatterplot
     matrix not to delete.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">% This example uses a matrix of logicals to set the undocked panels
load fisheriris;
plo=struct;
plo.nameY={'SL','SW','PL','PW'};
figure
spmplot(meas,'group',species,'plo',plo,'dispopt','hist','undock',logical(eye(size(meas,2))));
cascade
% This example uses a matrix n x 2 to set the undocked panels
close all;
figure
spmplot(meas,'group',species,'plo',plo,'dispopt','box','overlay','boxplotb','undock',[1,3;2,4]);
cascade</pre></div></div><a href='http://rosa.unipr.it/fsda/spmplot.html#ExtraExample_1'><img vspace="5" hspace="5" src="images\spmplot_05.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website)"> <img vspace="5" hspace="5" src="images\spmplot_06.png" alt=""> </a></p></div></div><div id="Extraexample_2" class="example_module expandableContent"><div id="ExtraExample_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Call of spmplot with name/value pairs and additional options for
     overlay, specifying densities just for one group.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">% Iris data: scatter plot matrix with univariate boxplots on the main
% diagonal.
close all
load fisheriris;
plo=struct;
plo.nameY={'SL','SW','PL','PW'};
over = struct;
over.type = 'contourf';
over.include = logical([1 0 0]);
over.cmap = summer;
figure
spmplot(meas,'group',species,'plo',plo,'dispopt','box','overlay',over);</pre></div></div><a href='http://rosa.unipr.it/fsda/spmplot.html#ExtraExample_2'><img vspace="5" hspace="5" src="images\spmplot_07.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website)"> </a></p></div></div><div id="Extraexample_3" class="example_module expandableContent"><div id="ExtraExample_3"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Iris data: scatter plot matrix with univariate boxplots on the main
     diagonal and personalized options for symbols, colors, symbol
     size and no legend.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">close all;
load fisheriris;
plo=struct;
plo.nameY={'SL','SW','PL','PW'}; % Name of the variables
plo.clr='kbr'; % Colors of the groups
plo.sym={'+' '+' 'v'}; % Symbols of the groups (inside a cell)
% Symbols can also be specified as characters
% plo.sym='++v'; % Symbols of the groups
plo.siz=3.4; % Symbol size
plo.doleg='off'; % Remove the legend
figure
spmplot(meas,species,plo,'box');</pre></div></div></p></div></div><div id="Extraexample_4" class="example_module expandableContent"><div id="ExtraExample_4"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Example of spmplot called by routine FSM.</li></span></a></span></h3><div class="collapse"><p>
     Generate contaminated data.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">close all;
state=100;
randn('state', state);
n=200;
Y=randn(n,3);
Ycont=Y;
Ycont(1:5,:)=Ycont(1:5,:)+3;
% spmplot is called automatically by all outlier detection methods, e.g. FSM
[out]=FSM(Ycont,'plots',1);</pre></div></div></p></div></div><div id="Extraexample_5" class="example_module expandableContent"><div id="ExtraExample_5"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Now test the direct use of FSM.</li></span></a></span></h3><div class="collapse"><p> Set two groups, e.g. those obtained
     from FSM.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">% Generate contaminated data
state=100;
randn('state', state);
n=200;
Y=randn(n,3);
Ycont=Y;
Ycont(1:5,:)=Ycont(1:5,:)+3;
close all;
[out]=FSM(Ycont,'plots',1);
group = zeros(n,1);
group(out.outliers)=1;
plo=struct;
plo.labeladd='1'; % option plo.labeladd is used to label the outliers
% By default, the legend identifies the groups with the identifiers
% given in vector 'group'.
figure;
plo.clr = 'br';
spmplot(Ycont,group,plo,'box');</pre></div></div></p></div></div><div id="Extraexample_6" class="example_module expandableContent"><div id="ExtraExample_6"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>spm with personalized tags.</li></span></a></span></h3><div class="collapse"><p>
     With two groups, and if the Tag of the figure contains the word
     'outlier', the legend will identify one group for outliers and the
     other for normal units. The largest number in the 'group' variable
     identifies the group of outliers.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">close all
state=100;
randn('state', state);
n=200;
Y=randn(n,3);
Ycont=Y;
Ycont(1:5,:)=Ycont(1:5,:)+3;
[out]=FSM(Ycont,'plots',1);
group = zeros(n,1);
group(out.outliers)=1;
plo=struct;
plo.labeladd='1'; % option plo.labeladd is used to label the outliers
figure('tag','This is a scatterplot with ouTliErs'); % case insensitive
spmplot(Ycont,group);
% If the Tag of the Figure contains the string 'group', then the
% legend identifies the groups with 'Group 1', Group 2', etc.
figure('tag','This scatterplot contains groups');
spmplot(Ycont,group,plo,'box');
% If the tag figure includes the word 'brush', the legend will identify
% one group for 'Unbrushed units' and the others for 'Brushed units 1',
% 'Brushed units 2', etc.
figure('Tag','Scatterplot with brushed units');
spmplot(Ycont,group,plo);
cascade;</pre></div></div></p></div></div><div id="Extraexample_7" class="example_module expandableContent"><div id="ExtraExample_7"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>An example with 5 groups.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">close all
rng('default')
rng(2); n1=100;
n2=80;
n3=50;
n4=80;
n5=70;
v=5;
Y1=randn(n1,v)+5;
Y2=randn(n2,v)+3;
Y3=rand(n3,v)-2;
Y4=rand(n4,v)+2;
Y5=rand(n5,v);
group=ones(n1+n2+n3+n4+n5,1);
group(n1+1:n1+n2)=2;
group(n1+n2+1:n1+n2+n3)=3;
group(n1+n2+n3+1:n1+n2+n3+n4)=4;
group(n1+n2+n3+n4+1:n1+n2+n3+n4+n5)=5;
Y=[Y1;Y2;Y3;Y4;Y5];
spmplot(Y,group,[],'box');</pre></div></div></p></div></div><div id="Extraexample_8" class="example_module expandableContent"><div id="ExtraExample_8"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Another example of spmplot called with name/pairs.</li></span></a></span></h3><div class="collapse"><p>
     The example which follow make use of the name/value pairs arguments.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">close all
load fisheriris;
plo=struct;
plo.nameY={'SL','SW','PL','PW'}; % Name of the variables
plo.clr='kbr'; % Colors of the groups
plo.sym={'+' '+' 'v'}; % Symbols of the groups (inside a cell)
% Symbols can also be specified as characters
% plo.sym='++v'; % Symbols of the groups
plo.siz=3.4; % Symbol size
spmplot(meas,'group',species,'plo',plo,'dispopt','box','tag','myspm');</pre></div></div></p></div></div><div id="Extraexample_9" class="example_module expandableContent"><div id="ExtraExample_9"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><i>Interactive example 1.</i></li></span></a></span></h3><div class="collapse"><p>
     In the previous examples the first argument of spmplot was a matrix. In
     the two examples below the first argument is a structure which contains
     the fields Y and Un
     Example when first input argument is a structure.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">% Example of use of option databrush
close all
rng(841,'shr3cong');
n=100;
v=3;
m0=v+1;
Y=randn(n,v);
% Contaminated data
Ycont=Y;
Ycont(1:5,:)=Ycont(1:5,:)+3;
[fre]=unibiv(Y);
%create an initial subset with the 3 observations with the lowest
%Mahalanobis Distance
fre=sortrows(fre,4);
bs=fre(1:m0,1);
[out]=FSMeda(Ycont,bs,'plots',1);
% mmdplot(out);
figure
% 'Label' 'on' 'RemoveLabels' 'off'  enables the user to label the units in the scatterplot
% matrix once selected. Option labeladd '1' inside databrush enables to add
% the labels of the selected units in the linked malfwdplot
spmplot(out,'databrush',{'persist','on','selectionmode' 'Rect', ...
'Label' 'on' 'RemoveLabels' 'off'  'labeladd','1'},'dispopt','hist');</pre></div></div></p></div></div><div id="Extraexample_10" class="example_module expandableContent"><div id="ExtraExample_10"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Example of use of option datatooltip.</li></span></a></span></h3><div class="collapse"><p>
     First input argument is a structure.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">close all
n=100;
v=3;
m0=3;
Y=randn(n,v);
% Contaminated data
Ycont=Y;
Ycont(1:10,:)=5;
[fre]=unibiv(Ycont);
%create an initial subset with the 3 observations with the lowest
%Mahalanobis Distance
fre=sortrows(fre,4);
bs=fre(1:m0,1);
[out]=FSMeda(Ycont,bs,'plots',1);
% mmdplot(out);
figure
plo=struct;
plo.labeladd='1';
plo.clr = 'b';
spmplot(out,'datatooltip',1,'plo',plo);</pre></div></div></p></div></div><div id="Extraexample_11" class="example_module expandableContent"><div id="ExtraExample_11"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>First example of the use of options selunit when first input argument is a 2D array.</li></span></a></span></h3><div class="collapse"><p>
       In this case row names of Y are not
       specified so numbers in the interval 1:n are added to the scatters.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">n=100; p=5;
seluni=[10 30];
Y =randn(n,p);
Y(seluni,:)=Y(seluni,:)+2;
% add labels for units inside vector seluni
spmplot(Y,'selunit',seluni);</pre></div></div></p></div></div><div id="Extraexample_12" class="example_module expandableContent"><div id="ExtraExample_12"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Second  example of the use of options selunit when first input argument is a 2D array.</li></span></a></span></h3><div class="collapse"><p>
       In this case the row names
       are contained inside input argument plo.label<div class="programlisting"><div class="codeinput"><pre class="matlab-code">close all
load carsmall
x1 = Weight;
x2 = Horsepower;    % Contains NaN data
y = MPG;    % response
Y=[x1 x2 y];
% Remove Nans
boo=~isnan(y);
Y=Y(boo,:);
RowLabelsMatrixY=Model(boo,:);
seluni=[10 30];
plo=struct;
plo.label=cellstr(RowLabelsMatrixY);
% add labels for units inside vector seluni
spmplot(Y,'selunit',seluni,'plo',plo);</pre></div></div></p></div></div><div id="Extraexample_13" class="example_module expandableContent"><div id="ExtraExample_13"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Option datatooltip combined with rownames.</li></span></a></span></h3><div class="collapse"><p>
     Example of use of option datatooltip.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">% First input argument is a structure.
close all
load carsmall
x1 = Weight;
x2 = Horsepower;    % Contains NaN data
y = MPG;    % response
Y=[x1 x2 y];
% Remove Nans
boo=~isnan(y);
Y=Y(boo,:);
Model=Model(boo,:);
m0=5;
[fre]=unibiv(Y);
%create an initial subset with the 3 observations with the lowest
%Mahalanobis Distance
fre=sortrows(fre,4);
bs=fre(1:m0,1);
[out]=FSMeda(Y,bs,'plots',0);
% field label (rownames) is added to structure out
% In this case datatooltip will display the rowname and not the default
% string row.
out.label=cellstr(Model);
figure
plo=struct;
plo.labeladd='1';
plo.clr = 'b';
spmplot(out,'datatooltip',1,'plo',plo);
% The units which are already labelled in each panel of the scatter
% plot matrix are those which in the search had a Mahalanobis distance
% greater than 2.5. Note that the labelling is controlled by option selunit.</pre></div></div><a href='http://rosa.unipr.it/fsda/spmplot.html#ExtraExample_13'><img vspace="5" hspace="5" src="images\spmplot_08.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website)"> </a></p></div></div><div id="Extraexample_14" class="example_module expandableContent"><div id="ExtraExample_14"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><i>Interactive example 2.</i>
       Example of the use of options selstep and selunit combined with databrush.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">%   selunit is passed as a character.
%   It produces a scatter plot matrix in which labels are put for units
%   which have a Mahalanobis distance greater than str2num(selunit). When a set of
%   units is brushed in the spmplot in the monitoring MD
%   plot the labels for the units which have a MD greater than 10
%   are added in steps selsteps.
load carsmall
x1 = Weight;
x2 = Horsepower;    % Contains NaN data
y = MPG;    % response
Y=[x1 x2 y];
% Remove Nans
boo=~isnan(y);
Y=Y(boo,:);
Model=Model(boo,:);
m0=5;
[fre]=unibiv(Y);
fre=sortrows(fre,4);
bs=fre(1:m0,1);
[out]=FSMeda(Y,bs,'plots',0);
spmplot(out,'selstep',[60 80],'selunit','10',...
'databrush',{'persist','off','selectionmode' 'Rect'});</pre></div></div></p></div></div><div id="Extraexample_15" class="example_module expandableContent"><div id="ExtraExample_15"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><i>Interactive example 3.</i>
       Example of the use of options selstep and selunit.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">%   selunit is passed as a numeric vector.
%   It produces a scatter plot matrix in which labels are put for units
%   selunit. When a set of
%   units is brushed in the spmplot in the monitoring MD
%   plot the labels for the units selunit
%   are added in steps selsteps.
load carsmall
x1 = Weight;
x2 = Horsepower;    % Contains NaN data
y = MPG;    % response
Y=[x1 x2 y];
% Remove Nans
boo=~isnan(y);
Y=Y(boo,:);
Model=Model(boo,:);
m0=5;
[fre]=unibiv(Y);
fre=sortrows(fre,4);
bs=fre(1:m0,1);
[out]=FSMeda(Y,bs,'plots',0);
spmplot(out,'selstep',[60 80],'selunit',1:5,...
'databrush',{'persist','off','selectionmode' 'Rect'});</pre></div></div></p></div></div><div id="Extraexample_16" class="example_module expandableContent"><div id="ExtraExample_16"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><i>Interactive example 4.</i>
       Example of the use of options selstep and selunit.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">%   selunit is passed as a cell array of length 2.
%   It produces a scatter plot matrix in which labels are put for units
%   which have a min MD &gt; selunit{1} and max MD &lt;selunit{2}. When a set of
%   units is brushed in the spmplot in the monitoring MD
%   plot the labels for the units selunit
%   are added in steps selsteps.
load carsmall
x1 = Weight;
x2 = Horsepower;    % Contains NaN data
y = MPG;    % response
Y=[x1 x2 y];
% Remove Nans
boo=~isnan(y);
Y=Y(boo,:);
Model=Model(boo,:);
m0=5;
[fre]=unibiv(Y);
fre=sortrows(fre,4);
bs=fre(1:m0,1);
[out]=FSMeda(Y,bs,'plots',0);
spmplot(out,'selstep',[60 80],'selunit',{'1.2' '1.6'},...
'databrush',{'persist','off','selectionmode' 'Rect'});</pre></div></div></p></div></div><div id="Extraexample_17" class="example_module expandableContent"><div id="ExtraExample_17"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Example of use of option typespm passed as character.</li></span></a></span></h3><div class="collapse"><p>
     if 'typespm','lower' ('upper') just the panels below the main
     diagonal are shown. In the other part the values of the correlation
     coefficient are shown<div class="programlisting"><div class="codeinput"><pre class="matlab-code">load fisheriris;
spmplot(meas,'group',species,'typespm','lower');</pre></div></div><a href='http://rosa.unipr.it/fsda/spmplot.html#ExtraExample_17'><img vspace="5" hspace="5" src="images\spmplot_09.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website)"> </a></p></div></div><div id="Extraexample_18" class="example_module expandableContent"><div id="ExtraExample_18"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Example of use of option typespm passed as struct.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">load head;
typespm=struct;
typespm.lower='circle';
typespm.upper="number";
spmplot(head,'typespm',typespm);</pre></div></div><a href='http://rosa.unipr.it/fsda/spmplot.html#ExtraExample_18'><img vspace="5" hspace="5" src="images\spmplot_10.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website)"> </a></p></div></div><div id="Extraexample_19" class="example_module expandableContent"><div id="ExtraExample_19"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Example 1 of use of option typespm passed as struct with groups.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">close all
load swiss_banknotes.mat
X=swiss_banknotes;
group=ones(200,1);
group(101:end)=2;
% In the lower part the correlations are shown with numbers
typespm=struct;
typespm.lower="number";
typespm.upper="scatter";
spmplot(swiss_banknotes,'group',group,'typespm',typespm);</pre></div></div><a href='http://rosa.unipr.it/fsda/spmplot.html#ExtraExample_19'><img vspace="5" hspace="5" src="images\spmplot_11.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website)"> </a></p></div></div><div id="Extraexample_20" class="example_module expandableContent"><div id="ExtraExample_20"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Example 2 of use of option typespm passed as struct with groups.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">close all
load swiss_banknotes.mat
X=swiss_banknotes;
group=ones(200,1);
group(101:end)=2;
% In the lower part the correlations are shown with squares
% and in the upper part with numbers
typespm=struct;
typespm.lower="square";
typespm.upper="number";
spmplot(swiss_banknotes,'group',group,'typespm',typespm);</pre></div></div><pre class="codeoutput">Warning: Error updating AxesLayoutManager.

 Value must be a handle.
 
</pre><a href='http://rosa.unipr.it/fsda/spmplot.html#ExtraExample_20'><img vspace="5" hspace="5" src="images\spmplot_12.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website)"> </a></p></div></div><div id="Extraexample_21" class="example_module expandableContent"><div id="ExtraExample_21"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Example of use of option colorBackground.</li></span></a></span></h3><div class="collapse"><p>
     if 'colorBackground is true the background color of each scatter 
     depends on the value of the correlation coefficient <div class="programlisting"><div class="codeinput"><pre class="matlab-code">load head;
spmplot(head,'colorBackground',true);</pre></div></div><a href='http://rosa.unipr.it/fsda/spmplot.html#ExtraExample_21'><img vspace="5" hspace="5" src="images\spmplot_13.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website)"> </a></p></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="Inputs">Input Arguments</h2><div class="expandableContent"><div class="arguments"><div class="input_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"> <div id="inputarg_Y" class="clearfix"> </div> <h3 id="input_argument_Y" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>Y</code> &#8212; data matrix (2D array or table) containing n observations on v variables
         or a structure 'out' coming from function FSMeda. </span>  </a><span class="example_desc">Matrix or
         struct.</span></span></h3> <div class="collapse"> <p><p>If Y is a 2D array or table, varargin can be either a sequence of name/value
     pairs, detailed below, or one of the following explicit assignments:

       spmplot(Y,group);</p> <p>

       spmplot(Y,group,plo);</p> <p>

       spmplot(Y,group,plo,dispopt);</p> <p>

     where group, plo and dispopt have the meaning described in the pairs/values section.</p> <p>

     If varargin{1} (that is second input element) is a n-elements vector,
     then it is interpreted as a grouping variable vector 'group'. In this
     case, it can only be followed by 'plo' and 'dispopt'. Otherwise, the
     program expects a sequence of name/value pairs.</p> <p>

  If first input Y is a structure (generally created by function FSMeda),
  then this structure must have the following fields:

       Required fields in input structure Y.</p><p>
</p><table border="2" cellpadding="4" cellspacing="0" class="body"><colgroup><col width="20%"><col width="80%"></colgroup><thead><tr valign="top"><th valign="top">Value</th><th valign="top">Description</th></tr></thead><tr valign="top"><td><code>Y</code></td><td><p><p>a data matrix of size n-by-v.</p> <p>

               If the input structure Y contains just the data matrix, a
               standard static scatter plot matrix will be created.</p> <p>

               On the other hand, if Y also contains information on
               statistics monitored along a search, then the scatter plots
               will be linked with other (forward) plots with interaction
               possibilities, enabled via brushing and datatooltip. More
               precisely, with option databrush it is possible to create
               an automatic interaction with the other plots, while with
               option datatooltip it is possible to retrieve information
               about a particular unit once selected with the mouse).</p><p>

       Optional fields in input structure Y.</p></p></td></tr><tr valign="top"><td><code>MAL</code></td><td><p>matrix containing the Mahalanobis distances monitored in each
               step of the forward search. Every row is associated with a
               unit (this is a necessary field if the user wants to brush
               the scatter plot matrix).</p></td></tr><tr valign="top"><td><code>Un</code></td><td><p>matrix containing the order of entry of each unit
               (necessary if datatooltip is true or databrush is not
               empty).</p></td></tr><tr valign="top"><td><code>label</code></td><td><p><p>cell of length n containing the labels of the units.</p> <p>
               This optional argument is used in conjuction with options
               databrush and datatooltip.</p> <p>
               When datatooltip=1, if this
               field is not present labels row1, ..., rown will be
               automatically created and included in the pop up
               datatooltip window else the labels contained in Y.label will be used.</p><p>
               When databrush is a cell and it is called together with
               option 'labeladd' '1', the trajectories in the malfwdplot
               will be labelled with the labels contained in Y.label.</p></p></td></tr></table></p> <p class="datatypelist"><strong> Data Types: </strong><code>single|double</code></p> </div> </div><div id="namevaluepairarguments" class="clearfix"></div><h3 id="NameValuePairs" class="bottom_ruled">Name-Value Pair Arguments</h3><div class="namevaluecontainer"><p>Specify optional comma-separated pairs of <code>Name,Value</code> arguments. <code>Name</code> is the argument name and <code>Value</code> is the corresponding value. <code>Name</code> must appear  inside single quotes (<code>' '</code>).  You can specify several name and value pair arguments in any order as <code>  Name1,Value1,...,NameN,ValueN</code>.</p>  <span class="example_desc"><strong>Example:</strong><code><code> 'colorBackground',true
</code>,<code> 'dispopt','box'
</code>,<code> 'group',group
</code>,<code> 'overlay',1
</code>,<code> 'plo',1
</code>,<code> 'selunit','3'
</code>,<code> 'tag','myspm'
</code>,<code> 'typespm','lower'
</code>,<code> 'undock', [1 1; 1 3; 3 4]
</code>,<code> 'datatooltip',''
</code>,<code> 'databrush',1
</code>,<code> 'subsize',10:100
</code>,<code> 'selstep',100
</code></code></span></div><div class="expandableContent"><div id="inputarg_colorBackground" class="clearfix"></div><h3 id="input_argument_namevalue_colorBackground" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>colorBackground</code> &#8212;background color of each scatter which depends on the
           value of the correlation coefficient.</span></a><span class="example_desc">boolean.</span></span></h3><div class="collapse">	<p><p>If
           colorBackground is false (default), no color is applied, else a
           background color which depends on the value of the correlation
           coefficient is used.</p> <p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'colorBackground',true
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>logical</code></p></div></div><div class="expandableContent"><div id="inputarg_dispopt" class="clearfix"></div><h3 id="input_argument_namevalue_dispopt" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>dispopt</code> &#8212;what to put on the diagonal.</span></a><span class="example_desc">character.</span></span></h3><div class="collapse">	<p><p>String which controls
          how to fill the diagonals in a plot of Y vs Y (main diagonal of
          the scatter plot matrix). Set dispopt to 'hist' (default) to
          plot histograms, or 'box' to plot boxplots.</p> <p>

       REMARK 1: the style which is used for univariate boxplots is
       'traditional' if the number of groups is &lt;=5, else it is 'compact'.</p><p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'dispopt','box'
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>char</code></p></div></div><div class="expandableContent"><div id="inputarg_group" class="clearfix"></div><h3 id="input_argument_namevalue_group" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>group</code> &#8212;grouping variable.</span></a><span class="example_desc">vector with n elements.</span></span></h3><div class="collapse">	<p><p>group is a grouping variable defined as a categorical variable,
          numeric, or array of strings, or string matrix, and it must have
          the same number of rows of Y. This grouping variable that
          determines the marker and color assigned to each point.</p> <p>
                            Remark: if 'group' is used to distinguish a set of outliers from
         a set of good units, the id number for the outliers should be the
         larger (see optional field 'labeladd' of option 'plo' for details).</p><p>

</p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'group',group
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>char</code></p></div></div><div class="expandableContent"><div id="inputarg_overlay" class="clearfix"></div><h3 id="input_argument_namevalue_overlay" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>overlay</code> &#8212;Superimposition on the panels out of the main diagonal of
               the scatter matrix.</span></a><span class="example_desc">scalar, char | structure.</span></span></h3><div class="collapse">	<p><p>It specifies
               what to add in the background for the panels specified in
               undock (default is for all oh them).</p> <p>
               The default value is overlay='', i.e. nothing is changed. If
               overlay=1 the the filled contours are added to each panel,
               considering all groups, as default. If overlay is a structure
               it may contain the following fields:
      </p><table border="2" cellpadding="4" cellspacing="0" class="body"><colgroup><col width="20%"><col width="80%"></colgroup><thead><tr valign="top"><th valign="top">Value</th><th valign="top">Description</th></tr></thead><tr valign="top"><td><code>type</code></td><td><p>Type of plot to add in the background or to
                                superimpose. String. It can be: 'contourf',
                                'contour', 'ellipse' or 'boxplotb',
                                specifying respectively to add filled
                                contour (default when overlay=1), contour,
                                ellipses or a bivariate boxplot (see
                                function boxplotb.m).</p></td></tr><tr valign="top"><td><code>include</code></td><td><p>Boolean vector specifying which groups to
                                include in the type of plot specified in
                                overlay.type, the default value is a vector
                                of ones (i.e. all groups).</p></td></tr><tr valign="top"><td><code>cmap</code></td><td><p><p>The colormap for the type 'contourf' and
                                'contour' is grey as default. In these case,
                                this field may specify the colors used for
                                the color map. It is a three-column matrix of
                                values in the range [0,1] where each row
                                is an RGB triplet that defines one color.</p> <p>
                                Check the colormap function for additional
                                informations.</p></p></td></tr><tr valign="top"><td><code>conflev</code></td><td><p>When the type specified is 'ellipse', the
                                size of the ellipses is chi2inv(0.95,2) as
                                default. In this case, this field may
                                specify a different confidence level used
                                and it is a value between 0 and 1.</p></td></tr></table></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'overlay',1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>single | double</code></p></div></div><div class="expandableContent"><div id="inputarg_plo" class="clearfix"></div><h3 id="input_argument_namevalue_plo" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>plo</code> &#8212;names, labels, colors, marker type.</span></a><span class="example_desc">empty value, scalar | structure.</span></span></h3><div class="collapse">	<p><p>This options controls the names which
         are displayed in the margins of the scatter-plot matrix and the
         labels of the legend.</p> <p>

         If plo is the empty vector [], then nameY and labeladd are
           both set to the empty string '' (default), and no label and
           no name is added to the plot.</p> <p>

         If plo = 1 the names Y1,..., Yv or the variable names of the
           table are added to the margins of the
           the scatter plot matrix else nothing is added.</p><p>

         If plo is a structure, it is possible to control not only the
         names but also, point labels, colors, symbols. More precisely
         structure pl may contain the following fields:</p><table border="2" cellpadding="4" cellspacing="0" class="body"><colgroup><col width="20%"><col width="80%"></colgroup><thead><tr valign="top"><th valign="top">Value</th><th valign="top">Description</th></tr></thead><tr valign="top"><td><code>labeladd</code></td><td><p>if
         it is '1', the elements belonging to the max(group)
                in the spm are labelled with their unit row index or their
                rowname. The rowname is taken from plo.label or if
                plo.label is empty from
                The default value is labeladd = '', i.e. no label is added.</p></td></tr><tr valign="top"><td><code>nameY</code></td><td><p>cell array of strings containing the labels of the
                variables. As default value, the labels which are added
                are Y1, ..., Yv.</p></td></tr><tr valign="top"><td><code>clr</code></td><td><p>a string of color specifications. By default, the colors
                are 'brkmgcy'.</p></td></tr><tr valign="top"><td><code>sym</code></td><td><p><p>a string or a cell of marker specifications. For example,
                if sym = 'o+x', the first group will be plotted with a
                circle, the second with a plus, and the third with a 'x'.</p> <p>
                This is obtained with the assignment plo.sym = 'o+x'
                or equivalently with plo.sym = {'o' '+' 'x'}.</p> <p>
                By default the sequence of marker types is:
                '+';'o';'*';'x';'s';'d';'^';'v';'&gt;';'&lt;';'p';'h';'.'
         plo.siz: scalar, a marker size to use for all plots. By default the
                marker size depends on the number of plots and the size of
                the figure window. Default is siz = '' (empty value).</p> <p>
        plo.doleg: a string to control whether legends are created or not.</p> <p>
                Set doleg to 'on' (default) or 'off'.</p><p>
       plo.label : cell of length n containing the labels of the units. If
                   this field is empty the sequence 1:n will be used to
                   label the units.</p></p></td></tr></table></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'plo',1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>Empty value, scalar or structure.</code></p></div></div><div class="expandableContent"><div id="inputarg_selunit" class="clearfix"></div><h3 id="input_argument_namevalue_selunit" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>selunit</code> &#8212;unit labelling in the spmplot and in the malfwdplot.</span></a><span class="example_desc">cell array of strings | string | numeric vector for               labelling units.</span></span></h3><div class="collapse">	<p><p>When input argument Y is a structure
               the threshold is associated with the trajectories of
               the Mahalanobis distances monitored along the search.</p> <p>
               If it is a cell array of strings, only the units that
               in at least one step of the search had a Mahalanobis
               distance greater than selunit{1} or smaller than selline{2}
               will have a textbox in the scatter plot matrix and in the
               associated malfwdplot after brushing.</p> <p>
               If it is a string it specifies the threshold above which
               labels have to be put. For example selunit='2.6' means that
               the text labels in the scatter plot matrix (and in the
               malfwdplot after brushing) are added only for the units
               which have in at least one step of the search a value of
               the Mahalanobis distance greater than 2.6.</p> <p>
               If it is a numeric vector it contains the list of the units
               for which it is necessary to put the text labels in each
               panel of the spmplot and in the associated malfwdplot (if
               input option databrush is not empty). For example if
               selunit is [20 34], the labels associated to rows 20 and 34
               are added to each scatter plot. The labels which are used
               are taken from Y.label is Y is a structure or from
               plo.label if plo.label is notemp and Y is a 2D array, else the
               numbers 1:n are used.</p> <p>
               The default value of selunit is string '2.5' if input
               argument Y is a structure else it is an empty value if
               input argument Y is a matrix.</p><p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'selunit','3'
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>numeric or character</code></p></div></div><div class="expandableContent"><div id="inputarg_tag" class="clearfix"></div><h3 id="input_argument_namevalue_tag" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>tag</code> &#8212;plot tag.</span></a><span class="example_desc">string.</span></span></h3><div class="collapse">	<p><p>string which identifies the handle of the
               plot which is about to be created. The default is to use
               tag 'pl_spm'. Notice that if the program finds a plot which
               has a tag equal to the one specified by the user, then the
               output of the new plot overwrites the existing one in the
               same window else a new window is created.</p> <p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'tag','myspm'
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>char</code></p></div></div><div class="expandableContent"><div id="inputarg_typespm" class="clearfix"></div><h3 id="input_argument_namevalue_typespm" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>typespm</code> &#8212;type of scatter plot matrix.</span></a><span class="example_desc">character/string | struct.</span></span></h3><div class="collapse">	<p><p>If typespm is 'full'
               (default) panels above and below the main diagonal are
               shown with scatter. If typespm is 'lower' scatter plots are shown just
               below the main diagonal. The upper part of the scatter plot
               matrix contains the values of the correlation
               coefficients. If optional input argument group is present,
               the correlation coefficient is also computed for each group
               and shown in each scatter. The size of the label of the
               correlation coefficient reflects his magnitude (in
               absolute value). It typespm is 'upper' the upper part of
               the scatter plot matrix contains the scatters
               and the lower part just the values of the
               correlations.</p> <p>
               if typespm is a struct it is possible to control how the
               lower (upper) part of the scatter plot matrix is shown.</p> <p>
               More precisely, typespm.lower controls how the part below
               the diagonal is shown and typespm.upper controls the upper
               part. Possible entries of typespm.lower or typespm.upper
               are "scatter", "circle", "square" "number" and "none";</p><p>
               For example if</p><table border="2" cellpadding="4" cellspacing="0" class="body"><colgroup><col width="20%"><col width="80%"></colgroup><thead><tr valign="top"><th valign="top">Value</th><th valign="top">Description</th></tr></thead><tr valign="top"><td><code>lower</code></td><td><p>"number" and</p></td></tr><tr valign="top"><td><code>upper</code></td><td><p>"circle", the correlations in the part below
               the diagonal are shown with numbers and the upper part with
               circles. Similarly, if typespm.lower="none" and</p></td></tr><tr valign="top"><td><code>scatter</code></td><td><p><p>"none" just the upper part of the scatter
               plot matrix is shown. The fields of the struct can either
               be charaters or strings.</p> <p>
               typespm='lower' is equivalent to typespm=struct;</p><p>
               typespm.lower='scatter', typespm.upper='number';</p></p></td></tr></table></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'typespm','lower'
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>char or struct</code></p></div></div><div class="expandableContent"><div id="inputarg_undock" class="clearfix"></div><h3 id="input_argument_namevalue_undock" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>undock</code> &#8212;Panel to undock and visualize separately.</span></a><span class="example_desc">matrix | logical               matrix.</span></span></h3><div class="collapse">	<p><p>If undock='' (default), no panel is extracted. If
               undock is a r-by-2 matrix, it specifies the r coordinates
               of the scatter plot matrix to undock and visualize
               separately in a bivariate plot (i.e. for panels out of the
               main diagonal plots) or in an univariate plot (i.e. the ones
               on the main diagonal). If undock is a v-by-v logical matrix,
               where v are the number of columns in Y, the trues of undock
               are undocked and visualized separately.</p> <p>
               REMARK - When used, undock automatically deletes the plots
               obtained by spmplots. If it is desired to keep some of them,
               the respective 'Tag' associated has to be changed (e.g.</p> <p>
               selecting the figure and then: set(gcf,'Tag','newTag');).</p><p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'undock', [1 1; 1 3; 3 4]
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>single | double | logical</code></p></div></div><div class="expandableContent"><div id="inputarg_datatooltip" class="clearfix"></div><h3 id="input_argument_namevalue_datatooltip" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>datatooltip</code> &#8212;interactive clicking.</span></a><span class="example_desc">empty value (default) |                   structure.</span></span></h3><div class="collapse">	<p>If datatooltip is not empty the user can use
                   the mouse in order to have information about the unit
                   selected, the step in which the unit enters the search
                   and the associated label. If datatooltip is a
                   structure, it may contain the following fields:
           <table border="2" cellpadding="4" cellspacing="0" class="body"><colgroup><col width="20%"><col width="80%"></colgroup><thead><tr valign="top"><th valign="top">Value</th><th valign="top">Description</th></tr></thead><tr valign="top"><td><code>DisplayStyle</code></td><td><p>Determines how the data
                   cursor displays.</p></td></tr><tr valign="top"><td><code>SnapToDataVertex</code></td><td><p>Specifies whether the
                   data cursor snaps to the nearest data value or is
                   located at the actual pointer position. The default
                   options of the structure are
                   DisplayStyle='Window' and SnapToDataVertex='on'.</p></td></tr></table></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'datatooltip',''
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>empty value, scalar or struct</code></p></div></div><div class="expandableContent"><div id="inputarg_databrush" class="clearfix"></div><h3 id="input_argument_namevalue_databrush" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>databrush</code> &#8212;interactive mouse brushing.</span></a><span class="example_desc">empty value (default),                   scalar | cell.</span></span></h3><div class="collapse">	<p><p>DATABRUSH IS AN EMPTY VALUE.</p> <p>
                   If databrush is an empty value (default), no brushing
                   is done.</p> <p>
                   The activation of this option (databrush is a scalar or a cell)
                   enables the user  to select a set of observations in
                   the current plot and to see them highlighted in the
                   malfwdplot, i.e. the plot of the trajectories of all
                   observations, grouped according to the selection(s)
                   done by brushing. If the malfwdplot does not exist it
                   is automatically created.</p> <p>
                   In addition, brushed units can be highlighted in the
                   other following plots (only if they are already open):
                   - minimum Mahalanobis distance plot;</p> <p>
                   Remark. the window style of the other figures is set
                   equal to that which contains the spmplot. In other
                   words, if the scatterplot matrix plot is docked all the
                   other figures will be docked too.</p> <p>
                   DATABRUSH IS A SCALAR.</p> <p>
                   If databrush is a scalar the default selection tool is
                   a rectangular brush and it is possible to brush only
                   once (that is persist='').</p> <p>
                   DATABRUSH IS A CELL.</p> <p>
                   If databrush is a cell, it is possible to use all
                   optional arguments of function <a href="selectdataFS.html">selectdataFS</a> and the
                   following optional argument:
                   - persist = Persistent brushing.</p> <p>
                     Persist is an empty value or a scalar
                     containing the strings 'on' or 'off'.</p> <p>
                     The default value of persist is '', that is brushing
                     is allowed only once.</p> <p>
                     If persist is 'on' or 'off' brushing can be done as
                     many time as the user requires.</p> <p>
                     If persist='on' then the unit(s) currently brushed
                     are added to those previously brushed. It is
                     possible, every time a new brushing is done, to use a
                     different color for the brushed units.</p> <p>
                     If persist='off' every time a new brush is performed
                     units previously brushed are removed.</p> <p>
                   - labeladd= point labelling. If this option is '1', we label the units
                     of the last selected group with the unit row index in
                     input Y if Y is a matrix or with the labels contained
                     in Y.label if input Y is a struct.</p> <p>
                     The default value is labeladd='', i.e. no label is
                     added in the malfwdplot.</p> <p>
                          Remark: The options which follow (subsize, selstep and selunit)
       work in connection with previous option databrush and produce their
       effect on the monitoring MD plot (malfwdplot). Note that the
       options which follow can only be used if the first argument of
       spmplot is a structure containing information about the fwd search
       (i.e. the fields MAL, Un and eventually label).</p><p>


</p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'databrush',1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>single | double | struct</code></p></div></div><div class="expandableContent"><div id="inputarg_subsize" class="clearfix"></div><h3 id="input_argument_namevalue_subsize" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>subsize</code> &#8212;x axis control in malfwdplot.</span></a><span class="example_desc">vector.</span></span></h3><div class="collapse">	<p><p>numeric vector
                   containing the subset size with length
                   equal to the number of columns of matrix Y.MAL.</p> <p>
                   If it is not specified it will be set equal to
                   size(Y.MAL,1)-size(Y.MAL,2)+1:size(Y.MAL,1)
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'subsize',10:100
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>single | double</code></p></div></div><div class="expandableContent"><div id="inputarg_selstep" class="clearfix"></div><h3 id="input_argument_namevalue_selstep" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>selstep</code> &#8212;position of text labels of brushed units in malfwdplot.</span></a><span class="example_desc">vector.</span></span></h3><div class="collapse">	<p><p>Numeric vector which specifies for which steps
                   of the forward search text labels are added in the
                   monitoring MD plot after a brushing action in the
                   spmplot. The default is to write the labels at the
                   initial and final step. The default is selstep=[m0 n]
                   where m0 and n are respectively the first and final
                   step of the search.</p> <p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'selstep',100
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>single | double</code></p></div></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="OutputArgs" >Output Arguments</h2><div class="expandableContent"><div class="arguments"><div class="output_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"><div id="outputarg_H" class="clearfix"></div><h3 id="output_argument_H" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>H</code> &#8212;array of handles H to the plotted points.</span></a><span class="example_desc">3D array</span></span></h3><div class="collapse"><p> See
                   gplotmatrix for further details.</p></div></div><div class="expandableContent"><div id="outputarg_AX" class="clearfix"></div><h3 id="output_argument_AX" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>AX</code> &#8212;handles to the individual subaxes.</span></a><span class="example_desc"><code> </code>Matrix</span></span></h3><div class="collapse"><p> See
                   gplotmatrix for further details.</p></div></div><div class="expandableContent"><div id="outputarg_BigAx" class="clearfix"></div><h3 id="output_argument_BigAx" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>BigAx</code> &#8212;handle to big (invisible) axes framing the subaxes.</span></a><span class="example_desc">Scalar</span></span></h3><div class="collapse"><p> See gplotmatrix for further details.</p></div></div></div></div></div></div><div class="moreabout ref_sect"><h2 id="MoreAbout">More About</h2><div class="expandableContent"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent" itemprop="content"><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span>Additional Details</span></a></span></h3><div class="expand"><p><p>
   spmplot has the same output of gplotmatrix in the statistics toolbox:
   [H,AX,BigAx] = spmplot(...) returns an array of handles H to the
   plotted points; a matrix AX of handles to the individual subaxes; and a
   handle BIGAX to big (invisible) axes framing the subaxes.  The third
   dimension of H corresponds to groups in G. AX contains one extra row of
   handles to invisible axes in which the histograms are plotted. BigAx is
   left as the CurrentAxes so that a subsequent TITLE, XLABEL, or YLABEL
   will be centered with respect to the matrix of axes.</p> <p>


</p></p></div></div></div></div><div class="ref_sect" itemprop="content"><div class="bibliography"><h2 id="References">References</h2> </div></div><div class="ref_sect"><h2 id="SeeAlso">See Also</h2><p><span itemprop="seealso"><a href="matlab:web(fullfile(docroot,'stats/gplotmatrix.html'))" itemprop="url"><span itemprop="name"><code>gplotmatrix</code></span></a></span> | <span itemprop="seealso"><a href="yXplot.html" itemprop="url"><span itemprop="name"><code>yXplot</code></span></a></span> | <span itemprop="seealso"><a href="boxplotb.html" itemprop="url"><span itemprop="name"><code>boxplotb</code></span></a></span></div><i>This page has been automatically generated by our routine <a href="publishFS.html">publishFS</a></i></div></section></div></div></div></div><div id="divbottom"></div></body></html>