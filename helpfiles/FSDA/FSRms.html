<!DOCTYPE HTML> <html itemscope="" xmlns="http://www.w3.org/1999/xhtml"><head><title>FSRms</title><meta content="refpage" name="chunktype"><meta content="function:FSRms" itemprop="refentity" name="refentity"><meta content="text/javascript" http-equiv="Content-Script-Type"><meta content="fcn" itemprop="pagetype" name="toctype"><meta content="ref/function" itemprop="infotype" name="infotype" /><meta content="FSRms performs robust model selection using flexible trimming in linear regression." itemprop="description" name="description" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" /><script type="text/x-mathjax-config">MathJax.Hub.Config({extensions: ["tex2jax.js"],jax: ["input/TeX","output/HTML-CSS"],menuSettings: {zoom: "Double-Click", zscale: "300"},tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},MathMenu: {showRenderer: false},"HTML-CSS": {availableFonts: ["TeX"],preferredFont: "TeX",imageFont: null}});</script><script type="text/javascript" src="includesFS/Mathjax/MathJax.js"></script><script src="includesFS/matlab-highlighter.min.js"></script><link href="includesFS/matlab-highlighter.css" rel="stylesheet" type="text/css"><script type="text/javascript" src="includesFS/jquery-latest.js"></script><script>$(document).ready(function(){      $("#divtop").load("includesFS/top.html");      $("#divbottom").load("includesFS/bottom.html");});</script><link href="../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)"></link><link href="../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)"></link><link href="../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)"></link><link href="../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)"></link><link href="../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)"></link><link href="../includes/product/css/site6_offcanvas.css" rel="stylesheet" type="text/css"></link><script src="../includes/shared/scripts/l10n.js" type="text/javascript"></script><script src="../includes/product/scripts/docscripts.js"></script><script src="../includes/shared/scripts/docscripts_rn.js"></script><script src="../includes/shared/scripts/mw.imageanimation.js" type="text/javascript"></script><script src="../includes/shared/scripts/jquery.highlight.js"></script><script src="../includes/product/scripts/bootstrap.min.js" type="text/javascript"></script><script src="../includes/product/scripts/global.js"></script><script src="includesFS/bottom.js" type="text/javascript"></script><script src="../includes/product/scripts/underscore-min.js"></script><script src="../includes/shared/scripts/f1help.js" type="text/javascript"></script><script src="../includes/product/scripts/suggest.js" type="text/javascript"></script><script src="../includes/shared/scripts/helpservices.js" type="text/javascript"></script><script src="../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script><!-- the following line should be kept this way only --><link href="includesFS/doc_center.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css"><link href="../includes/product/css/doc_center_print.css" media="print" rel="stylesheet" type="text/css"></head><body  onload="highlightMATLABCode();" id="responsive_offcanvas">  <div id="doc_header_spacer" class="header"></div><div class="sticky_header_container includes_subnav"><div class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-xs-12 col-sm-6 col-sm-push-6 col-md-5 col-md-push-7" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2017a" data-language="en" action="../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="sr-only">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"><div class="input-group-btn"><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search pull-right icon_32 visible-xs" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="col-sm-6 col-sm-pull-6 col-md-7 col-md-pull-5" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../documentation-center.html">Documentation</a></h1></div></div></div><div class="visible-xs" id="search_actuator"><button class="btn icon-search btn_search pull-right icon_16" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div><!--END.CLASS row--> </div><!--END.CLASS container-fluid--> </div><!--END.CLASS section_header level_3--><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_actuator" data-toggle="offcanvas" data-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="sr-only">Toggle navigation</span><span class="icon-menu icon_24"></span></button><span class="offcanvas_actuator_label"></span><span class="offcanvas_actuator_close"></span> </div><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-md-12 hidden-xs hidden-sm"></div></div></div></div></div></div></div><!--END.CLASS sticky_header_container--><div class="row-offcanvas row-offcanvas-left"><div id="sidebar" class="sidebar-offcanvas" role="navigation"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" xmlns:atict="http://www.arbortext.com/namespace/atict"><li itemprop="breadcrumb" itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb"> <a href="../documentation-center.html" itemprop="url"> <span itemprop="title">All Products</span></a></li></ul><ul class="nav_disambiguation" xmlns:atict="http://www.arbortext.com/namespace/atict"><li class="product"><a href="index.html">Flexible Statistics and Data Analysis (FSDA)</a><div class="dropdown"> <span id="dropdownMenu1" class="icon-arrow-down icon_16" data-toggle="dropdown"> </span><ul aria-labelledby="dropdownMenu1" class="dropdown-menu dropdown-menu-right" role="menu"><li role="presentation"> <a href="examples.html" role="menuitem" tabindex="-1">Examples</a></li><li role="presentation"> <a href="function-alpha.html" role="menuitem" tabindex="-1"> Functions and Other Reference</a></li><li role="presentation"> <a href="release_notes.html?s_cid=doc_flyout" role="menuitem" tabindex="-1"> Release Notes</a></li><li role="presentation"> <a href="tutorials.html" role="menuitem" tabindex="-1"> Tutorials</a></li></ul></div></li></ul><ul xmlns:atict="http://www.arbortext.com/namespace/atict" class="nav_disambiguation"> <li><a href="index.html">Flexible Statistics and Data Analysis Toolbox</a> </li> <li><a href="function-cate.html" itemprop="url">Functions</a></li></ul><!-- --><ul class="nav_scrollspy nav" xmlns:atict="http://www.arbortext.com/namespace/atict">  <li class="nav_scrollspy_function"> <a href="#responsive_offcanvas">FSRms</a></li> <li id="SSPY810-refentry" class="nav_scrollspy_title">On this page</li><li><a class="intrnllnk" href="#syntax">Syntax</a></li><li><a class="intrnllnk" href="#Description">Description</a></li><li><a class="intrnllnk" href="#Examples">Examples</a><ul><li><a class="intrnllnk" href="#Example_1">FSRms with all default options.</a></li><li><a class="intrnllnk" href="#Example_2">FSRms with optional arguments.</a></li></ul></li><li><a class="intrnllnk" href="#ExtraExamples">Extra Examples</a><ul><li><a class="intrnllnk" href="#ExtraExample_1">Reproduce the candlestick plot given in Figure 5 of Riani and Atkinson (2010).</a></li><li><a class="intrnllnk" href="#ExtraExample_2">Considering all submodels.</a></li><li><a class="intrnllnk" href="#ExtraExample_3">Comparing results of different settings.</a></li><li><a class="intrnllnk" href="#ExtraExample_4">Changing confidence bands.</a></li><li><a class="intrnllnk" href="#ExtraExample_5">Personalized LineWidth and CandleWidth.</a></li><li><a class="intrnllnk" href="#ExtraExample_6">Input fin_step supplied as fraction (1).</a></li><li><a class="intrnllnk" href="#ExtraExample_7">Input fin_step supplied as fraction (2).</a></li><li><a class="intrnllnk" href="#ExtraExample_8">Input fin_step supplied as integers.</a></li></ul></li><li><a class="intrnllnk" href="#Inputs">Input Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_y">y</a></li><li><a class="intrnllnk" href="#input_argument_X">X</a></li></ul></li><li><a class="intrnllnk" href="#NameValuePairs">Name-Value Pair Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_namevalue_intercept">intercept</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_init">init</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_h">h</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_nsamp">nsamp</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_lms">lms</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_nocheck">nocheck</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_smallpint">smallpint</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_labels">labels</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_fin_step">fin_step</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_first_k">first_k</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_ignore">ignore</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_ExclThresh">ExclThresh</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_meanmed">meanmed</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_plots">plots</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_rl">rl</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_quant">quant</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_CandleWidth">CandleWidth</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_LineWidth">LineWidth</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_ylimy">ylimy</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_xlimx">xlimx</a></li></ul></li><li><a class="intrnllnk" href="#OutputArgs">Output Arguments</a><ul><li><a class="intrnllnk" href="#output_argument_outms">outms</a></li></ul></li><li><a class="intrnllnk" href="#References">References</a></li><li><a class="intrnllnk" href="#SeeAlso">See Also</a></li></ul></nav><script src="../includes/product/scripts/offcanvas.js"></script></div><div id="divtop"></div><div class="site_container site_toc_closed"><div class="page_container"><div class="content_frame"><div id="content_container" class="content_container"><section id="doc_center_content"><div class="function_ref"><div itemprop="content"><h1 itemprop="title">FSRms</h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose">FSRms performs robust model selection using flexible trimming in linear regression</p><div class="switch"><a id="expandAllPage" href="javascript:void(0);">expand all in page</a></div></div></div></div><div class="ref_sect"><h2 id="syntax">Syntax</h2><div class="syntax_signature"><div class="syntax_signature_module"><ul><li><code class="synopsis">outms=FSRms(y,X)</code><span class="syntax_example"><a class="intrnllnk" href="FSRms.html#Example_1">example</a></span></li><li><code class="synopsis">outms=FSRms(y,X,Name,Value)</code><span class="syntax_example"><a class="intrnllnk" href="FSRms.html#Example_2">example</a></span></li></ul></div></div></div>	<div class="ref_sect" itemprop="content">							<h2 id="Description">Description</h2>							<div class="descriptions">								<div class="description_module"><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="FSRms.html#Example_1">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_outms"><code>outms</code></a>=FSRms(<a class="intrnllnk" href="#inputarg_y"><code>y</code></a>,<a class="intrnllnk" href="#inputarg_X"><code>X</code></a>)</code></span>FSRms with all default options.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="FSRms.html#Example_2">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_outms"><code>outms</code></a>=FSRms(<a class="intrnllnk" href="#inputarg_y"><code>y</code></a>,<a class="intrnllnk" href="#inputarg_X"><code>X</code></a>,<a class="intrnllnk" href="#namevaluepairarguments"><code>Name, Value</code></a>)</code></span>FSRms with optional arguments.</p></div>								</div>							</div>							<div class="clear">							</div>						</div><div class="ref_sect" itemprop="content"><div class="examples"><h2 id="Examples">Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="example_1" class="example_module expandableContent"><div id="Example_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>FSRms with all default options.</li></span></a></span></h3><div class="collapse"><p>
     Common part to all examples: load Ozone dataset, tranform the 
     response using logs and add a time trend.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">X=load('ozone.txt');
X(:,end)=log(X(:,end));
X=[(-40:39)' X];
y=X(:,end);
X=X(:,1:end-1);
[Cpms]=FSRms(y,X);</pre></div></div></p></div></div><div id="example_2" class="example_module expandableContent"><div id="Example_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> FSRms with optional arguments.</li></span></a></span></h3><div class="collapse"><p>
     Perform robust model selection and show the generalized candlestick
     plot.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">X=load('ozone.txt');
X(:,end)=log(X(:,end));
X=[(-40:39)' X];
y=X(:,end);
X=X(:,1:end-1);
labels={'Time','1','2','3','4','5','6','7','8'};
[Cpms]=FSRms(y,X,'labels',labels,'plots',1);</pre></div></div><pre class="codeoutput">small p=9
small p=8
small p=7
small p=6
small p=5
small p=4
small p=3
</pre><a href='http://rosa.unipr.it/fsda/FSRms.html#Example_2'><img vspace="5" hspace="5" src="images\FSRms_01.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website). Graphical output could not be included in the installation file because toolboxes cannot be greater than 20MB. To load locally the image files, download zip file http://rosa.unipr.it/fsda/images.zip and unzip it to <tt>(docroot)/FSDA/images</tt> or simply run routine <tt>downloadGraphicalOutput.m</tt>"> </a></p></div></div></div><p> </p><div class="examples"><h2 id="ExtraExamples" class="bottom_ruled">Related Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="Extraexample_1" class="example_module expandableContent"><div id="ExtraExample_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Reproduce the candlestick plot given in Figure 5 of Riani and Atkinson (2010).</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">X=load('ozone.txt');
X(:,end)=log(X(:,end));
X=[(-40:39)' X];
y=X(:,end);
X=X(:,1:end-1);
n=length(y);
fin_step=floor([n*0.1 n*0.02]);
outms=FSRms(y,X,'fin_step',fin_step,'plots',1,'labels',labels,'smallpint',[4:7]);
%The figure has slightly changed and certainly there can be some random
%fluctuations due to the number of subset which have been used to initialize
%the search for each model. However, The indication of the previous two
%Figures does not change at all: the values of smallp of 4 or 5 should yield
%a satisfactory model. For smallp = 4 the best model has the trend, x3 and
%x7, although the plot shows the values of Cp(m) increasing towards the end
%of the search. By far the most stable model for smallp= 5 adds x2 to these
%variables.</pre></div></div><pre class="codeoutput">small p=7
small p=6
small p=5
small p=4
</pre><a href='http://rosa.unipr.it/fsda/FSRms.html#ExtraExample_1'><img vspace="5" hspace="5" src="images\FSRms_02.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website)"> </a></p></div></div><div id="Extraexample_2" class="example_module expandableContent"><div id="ExtraExample_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Considering all submodels.</li></span></a></span></h3><div class="collapse"><p>
     Perform robust model selection and show the generalized candlestick
     plot considering all submodels for each smallp from 2 to size(X).<div class="programlisting"><div class="codeinput"><pre class="matlab-code">X=load('ozone.txt');
X(:,end)=log(X(:,end));
X=[(-40:39)' X];
y=X(:,end);
X=X(:,1:end-1);
[Cpms]=FSRms(y,X,'labels',labels,'ignore',0,'plots',1);</pre></div></div></p></div></div><div id="Extraexample_3" class="example_module expandableContent"><div id="ExtraExample_3"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Comparing results of different settings.</li></span></a></span></h3><div class="collapse"><p>
     Perform robust model selection and show the generalized candlestick
     plot. Restric attention to the models with size in the interval 4:6
     Compare the results using ignore=1 with those with ignore=0
     default option ignore=1.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">X=load('ozone.txt');
X(:,end)=log(X(:,end));
X=[(-40:39)' X];
y=X(:,end);
X=X(:,1:end-1);
[Cpms]=FSRms(y,X,'smallpint',4:6,'labels',labels,'plots',1);
% ignore=0
[Cpms]=FSRms(y,X,'ignore',0,'smallpint',4:6,'labels',labels,'plots',1);
% with ignore=0 but changing the threshold for excluding models
[Cpms]=FSRms(y,X,'smallpint',4:6,'labels',labels,'plots',1,'ExclThresh',0.99999999999999);</pre></div></div><pre class="codeoutput">small p=6
small p=5
small p=4
small p=6
small p=5
Warning: Rank deficient, rank = 3, tol =  5.715223e-13. 
Warning: Rank deficient, rank = 3, tol =  7.937901e-13. 
small p=4
small p=6
small p=5
small p=4
</pre><a href='http://rosa.unipr.it/fsda/FSRms.html#ExtraExample_3'><img vspace="5" hspace="5" src="images\FSRms_03.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website)"> <img vspace="5" hspace="5" src="images\FSRms_04.png" alt=""> <img vspace="5" hspace="5" src="images\FSRms_05.png" alt=""> </a></p></div></div><div id="Extraexample_4" class="example_module expandableContent"><div id="ExtraExample_4"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Changing confidence bands.</li></span></a></span></h3><div class="collapse"><p>
     Same options as before but using different confidence bands.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">X=load('ozone.txt');
X(:,end)=log(X(:,end));
X=[(-40:39)' X];
y=X(:,end);
X=X(:,1:end-1);
[Cpms]=FSRms(y,X,'smallpint',4:6,'labels',labels,'plots',1,'quant',[0.01 0.5 0.99])</pre></div></div></p></div></div><div id="Extraexample_5" class="example_module expandableContent"><div id="ExtraExample_5"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Personalized LineWidth and CandleWidth.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">X=load('ozone.txt');
X(:,end)=log(X(:,end));
X=[(-40:39)' X];
y=X(:,end);
X=X(:,1:end-1);
LineWidth=2;
CandleWidth=0.03;
[Cpms]=FSRms(y,X,'smallpint',4:6,'labels',labels,'plots',1,'LineWidth',LineWidth,'CandleWidth',CandleWidth)</pre></div></div></p></div></div><div id="Extraexample_6" class="example_module expandableContent"><div id="ExtraExample_6"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Input fin_step supplied as fraction (1).</li></span></a></span></h3><div class="collapse"><p>
     For example when fin_step=[0.3 0.1] the central part of the search
     goes from m=round(n*0.7)=56 to m=round(n*0.9)=72 and the final part
     of the search goes from m=73 to m=80.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">X=load('ozone.txt');
X(:,end)=log(X(:,end));
X=[(-40:39)' X];
y=X(:,end);
X=X(:,1:end-1);
[Cpms]=FSRms(y,X,'smallpint',4:6,'labels',labels,'plots',1,'fin_step',[0.3 0.1])</pre></div></div></p></div></div><div id="Extraexample_7" class="example_module expandableContent"><div id="ExtraExample_7"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Input fin_step supplied as fraction (2).</li></span></a></span></h3><div class="collapse"><p>
     For example when fin_step=[0.36 0.06] the central part of the search
     goes from m=round(n*0.64)=51 to m=round(n*0.94)=75 and the final part of the search goes from
     m=76 to m=80.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">X=load('ozone.txt');
X(:,end)=log(X(:,end));
X=[(-40:39)' X];
y=X(:,end);
X=X(:,1:end-1);
[Cpms]=FSRms(y,X,'smallpint',4:6,'labels',labels,'plots',1,'fin_step',[0.36 0.06])</pre></div></div></p></div></div><div id="Extraexample_8" class="example_module expandableContent"><div id="ExtraExample_8"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Input fin_step supplied as integers.</li></span></a></span></h3><div class="collapse"><p>
     For example when fin_step=[20 5] the central part of the search
     goes from m=n-20=61 to m=n-5=75 and the final part of the search goes from
     m=76 to m=80.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">% It is worthwhile to notice that independently on how fin_step is
% chosen, the message of the generalized candlestick plot remains the
% same. In other words, the best two models with 5 variables are always
% (Time,4,5,6) and (Time,2,4,5)
% while two reasonable models with 6 variables are (Time,2,4,5,6) and
% (Time,2,3,4,5).
X=load('ozone.txt');
X(:,end)=log(X(:,end));
X=[(-40:39)' X];
y=X(:,end);
X=X(:,1:end-1);
[Cpms]=FSRms(y,X,'smallpint',4:6,'labels',labels,'plots',1,'fin_step',[25 5],'CandleWidth',0.01)</pre></div></div></p></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="Inputs">Input Arguments</h2><div class="expandableContent"><div class="arguments"><div class="input_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"> <div id="inputarg_y" class="clearfix"> </div> <h3 id="input_argument_y" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>y</code> &#8212; Response variable. </span>  </a><span class="example_desc">Vector.</span></span></h3> <div class="collapse"> <p><p>A vector with n elements that contains the response variables.</p> <p>
               Missing values (NaN's) and infinite values (Inf's) are
               allowed, since observations (rows) with missing or infinite
               values will automatically be excluded from the
               computations.</p></p> <p class="datatypelist"><strong> Data Types: </strong><code>single| double</code></p> </div> </div><div class="expandableContent"> <div id="inputarg_X" class="clearfix"> </div> <h3 id="input_argument_X" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>X</code> &#8212; Predictor variables. </span>  </a><span class="example_desc">Matrix.</span></span></h3> <div class="collapse"> <p><p>Data matrix of explanatory variables (also called
               'regressors') of dimension (n x (bigP-1)).</p> <p>
               The intercept will be added in automatic way, so that the
               dimension of the full model is bigP
               Rows of X represent observations, and columns represent
               variables. Missing values (NaN's) and infinite values
               (Inf's) are allowed, since observations (rows) with missing
               or infinite values will automatically be excluded from the
               computations.</p></p> <p class="datatypelist"><strong> Data Types: </strong><code>single| double</code></p> </div> </div><div id="namevaluepairarguments" class="clearfix"></div><h3 id="NameValuePairs" class="bottom_ruled">Name-Value Pair Arguments</h3><div class="namevaluecontainer"><p>Specify optional comma-separated pairs of <code>Name,Value</code> arguments. <code>Name</code> is the argument name and <code>Value</code> is the corresponding value. <code>Name</code> must appear  inside single quotes (<code>' '</code>).  You can specify several name and value pair arguments in any order as <code>  Name1,Value1,...,NameN,ValueN</code>.</p>  <span class="example_desc"><strong>Example:</strong><code><code> 'intercept',1 
</code>,<code> 'init',100 starts monitoring from step m=100 
</code>,<code> 'h',round(n*0,75) 
</code>,<code> 'nsamp',1000 
</code>,<code> 'lms',1 
</code>,<code> 'nocheck',1 
</code>,<code> 'smallpint',3 
</code>,<code> 'labels',{'1','2'} 
</code>,<code> 'fin_step',[1 50] 
</code>,<code> 'first_k',5
</code>,<code> 'ignore',1
</code>,<code> 'ExclThresh',0.9
</code>,<code> 'meanmed',1
</code>,<code> 'plots',1
</code>,<code> 'rl',0.3
</code>,<code> 'quant',[0.01;0.99]
</code>,<code> 'CandleWidth',0.01
</code>,<code> 'LineWidth',0.01
</code>,<code> 'ylimy',[0 10]
</code>,<code> 'xlimy',[0 10]
</code></code></span></div><div class="expandableContent"><div id="inputarg_intercept" class="clearfix"></div><h3 id="input_argument_namevalue_intercept" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>intercept</code> &#8212;Indicator for constant term.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>If 1, a model with constant term will be fitted (default),
               else, no constant term will be included.</p> <p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'intercept',1 
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_init" class="clearfix"></div><h3 id="input_argument_namevalue_init" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>init</code> &#8212;Search initialization.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>It specifies the initial subset size to start
               monitoring the required quantities, if
               init is not specified it set equal to:</p> <p>
                   p+1, if the sample size is smaller than 40;</p> <p>
                   min(3*p+1,floor(0.5*(n+p+1))), otherwise.</p><p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'init',100 starts monitoring from step m=100 
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_h" class="clearfix"></div><h3 id="input_argument_namevalue_h" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>h</code> &#8212;The number of observations that have determined the least
               trimmed squares estimator.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p>h is an integer greater or
               equal than [(n+p+1)/2] but smaller then n
                 </p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'h',round(n*0,75) 
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_nsamp" class="clearfix"></div><h3 id="input_argument_namevalue_nsamp" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>nsamp</code> &#8212;Number of subsamples which will be extracted to find the
                 robust estimator.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>Number of subsamples which will be extracted to find the
               robust estimator. If nsamp=0 all subsets will be extracted.</p> <p>
               They will be (n choose smallp).</p> <p>
               Remark. if the number of all possible subset is &lt;1000 the
               default is to extract all subsets otherwise just 1000.</p><p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'nsamp',1000 
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_lms" class="clearfix"></div><h3 id="input_argument_namevalue_lms" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>lms</code> &#8212;Criterion to use to find the initlal
                 subset to initialize the search.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>If lms=1 (default) Least Median of Squares is
               computed, else Least Trimmed of Squares is computed.</p> <p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'lms',1 
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_nocheck" class="clearfix"></div><h3 id="input_argument_namevalue_nocheck" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>nocheck</code> &#8212;Check input arguments.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>If nocheck is equal to 1 no check is performed on
               matrix y and matrix X. Note that y and X are left
               unchanged. In other words the additional column of ones
               for the intercept is not added. As default nocheck=0.</p> <p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'nocheck',1 
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_smallpint" class="clearfix"></div><h3 id="input_argument_namevalue_smallpint" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>smallpint</code> &#8212;submodels to consider.</span></a><span class="example_desc">vector.</span></span></h3><div class="collapse">	<p><p>It specifies which submodels (number of variables)
               must be considered.</p> <p> 
               The default is to consider all models
               from size 2 to size bigP-1. In other words, as default,
               smallpint=(bigP-1):-1:2.</p> <p>
               When smallpint=2 all submodels including one explanatory
               variable and the constant will be considered.</p> <p>
               When smallpint=3 all submodels including two explanatory
               variables and a constant will be considered. ....</p><p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'smallpint',3 
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_labels" class="clearfix"></div><h3 id="input_argument_namevalue_labels" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>labels</code> &#8212;names of the explanatory variables.</span></a><span class="example_desc">cell array of strings.</span></span></h3><div class="collapse">	<p><p>Cell array of strings of length bigP-1 containing the
               names of the explanatory variables.</p> <p>
                If labels is a missing
               value the following sequence of strings will be
               automatically created for labelling the column of matrix X
               (1,2,3,4,5,6,7,8,9,A,B,C,D,E,E,G,H,I,J,K,...,Z)
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'labels',{'1','2'} 
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>cell</code></p></div></div><div class="expandableContent"><div id="inputarg_fin_step" class="clearfix"></div><h3 id="input_argument_namevalue_fin_step" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>fin_step</code> &#8212;Initial and final step.</span></a><span class="example_desc">vector with two elements.</span></span></h3><div class="collapse">	<p><p>Initial and final step of the search
               which has to be monitored to choose the best models as
               specified in scalar first_k.</p> <p> 
               The first element of the vector specifies the initial step of the search
               which has to be monitored to choose the best models as
               specified in scalar first_k below. The second element
               specifies the ending point of the central part of the
               search. This information will be used to create the
               candlestick Cp plot.</p> <p>
               If the elements of fin_step are integers greater or equal 1
               they refer to the number of steps. For example if
               fin_step=[10 3] the program considers the last 10 steps to
               choose the best models and the central part of the search
               is defined up to step n-3.</p> <p>
               If the elements of fin_step are real numbers
               alpha (0&lt;alpha&lt;0.5) in the interval (0 0.5] then the
               program considers the last round(n*alpha) steps.</p> <p>
               As default fin_step(1)=round(n*0.2) that is the last 20%
               of the steps are considered.</p><p>
               As default fin_step(2)=round(n*0.05) that
               is the central part of the search extends up to 95% of the
               observations
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'fin_step',[1 50] 
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_first_k" class="clearfix"></div><h3 id="input_argument_namevalue_first_k" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>first_k</code> &#8212;Number of models to consider.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>Number of best models to
               consider in each of the last fin_step.</p> <p> 
               For example if
               first_k=5 in each of the fin_step the models which had
               the 5 smallest values of Cp are considered. As default
               first_k=3
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'first_k',5
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_ignore" class="clearfix"></div><h3 id="input_argument_namevalue_ignore" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>ignore</code> &#8212;submodels to consider.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>If ignore=1, when dealing with p explanatory
               variables, the submodels of the models with p+1
               explanatory variables which were considered irrelevant
               according to option ExclThresh, are not considered. As
               default ignore=1, because this saves computational time.</p> <p>
               If ignore is different from 1, for each p all submodels of
               size p which contain a constant are considered
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'ignore',1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_ExclThresh" class="clearfix"></div><h3 id="input_argument_namevalue_ExclThresh" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>ExclThresh</code> &#8212;Exclusion threshold.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>It has effect only if ignore=1.</p> <p>
               Exclusion threshold associated to the uppper
               percentage point of the F distribution of Cp which defines
               the threshold for each p declaring models as irrelevant.</p><p>
               The default value of ExclThresh is 0.99999 that is the
               models whose minimum value of Cp in the part of the
               search defined by fin_step is above ExclThresh are
               stored for each p. If option ignore=1, the submodels with
               p-1 explanatory variables which are contained inside the
               models considered irrelevant are not considered
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'ExclThresh',0.9
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_meanmed" class="clearfix"></div><h3 id="input_argument_namevalue_meanmed" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>meanmed</code> &#8212;Boxes of tha candles.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>It specifies how to construct the boxes of the candles.</p> <p> 
               If meanmed=1 boxes are constructed using mean and median
               else using the first and third quartile.</p><p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'meanmed',1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_plots" class="clearfix"></div><h3 id="input_argument_namevalue_plots" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>plots</code> &#8212;Plot on the screen.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p>If plot==1 a candlestick Cp plot is created on the screen
               else (default) no plot is shown on the screen
               The options below only work when plots=1
               </p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'plots',1
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_rl" class="clearfix"></div><h3 id="input_argument_namevalue_rl" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>rl</code> &#8212;spread of the candles around
               each integer value defining the size of the submodels.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p>For example if rl=0.4 for each smallp candles are spread in the
               interval [smallp-rl smallp+rl]. The default value of rl
               is 0.4. rl does not have to be greater than 0.45 otherwise
               the candles overlap
               </p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'rl',0.3
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_quant" class="clearfix"></div><h3 id="input_argument_namevalue_quant" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>quant</code> &#8212;quantiles for the horizontal lines
               associated with the confidence bands of Cp.</span></a><span class="example_desc">vector.</span></span></h3><div class="collapse">	<p><p>The default is to plot 2.5% and
               97.5% envelopes. In other words the default is
               quant=[0.025;0.975];</p> <p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'quant',[0.01;0.99]
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_CandleWidth" class="clearfix"></div><h3 id="input_argument_namevalue_CandleWidth" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>CandleWidth</code> &#8212;width of the boxes associated with
               the central part of the search.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>The default width is 0.05;</p> <p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'CandleWidth',0.01
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_LineWidth" class="clearfix"></div><h3 id="input_argument_namevalue_LineWidth" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>LineWidth</code> &#8212;Line Width (in points) for the vertical lines outside the 
               boxes of the candles.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>The default LineWidth is 0.5 points.</p> <p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'LineWidth',0.01
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_ylimy" class="clearfix"></div><h3 id="input_argument_namevalue_ylimy" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>ylimy</code> &#8212;minimum and maximum
               on the y axis.</span></a><span class="example_desc">vector.</span></span></h3><div class="collapse">	<p>Default value is [-2 50] (automatic scale)
               </p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'ylimy',[0 10]
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_xlimx" class="clearfix"></div><h3 id="input_argument_namevalue_xlimx" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>xlimx</code> &#8212;minimum and maximum
               on the x axis.</span></a><span class="example_desc">vector.</span></span></h3><div class="collapse">	<p>Default value is '' (automatic scale)
               </p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'xlimy',[0 10]
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="OutputArgs" >Output Arguments</h2><div class="expandableContent"><div class="arguments"><div class="output_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"><div id="outputarg_outms" class="clearfix"></div><h3 id="output_argument_outms" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>outms</code> &#8212; description</span></a><span class="example_desc">Structure</span></span></h3><div class="collapse"><p>Structure which contains the following fields

<table border="2" cellpadding="4" cellspacing="0" class="body"><colgroup><col width="20%"><col width="80%"></colgroup><thead><tr valign="top"><th valign="top">Value</th><th valign="top">Description</th></tr></thead><tr valign="top"><td><code>stor</code></td><td><p><p>k x 9 matrix containing statistics which can be used to create the candles
               1st col: max Cp values;</p> <p> 
               2nd col: min Cp values;</p> <p> 
               3rd col: average Cp values;</p> <p> 
               4nd col: median Cp values;</p> <p> 
                   Remark: the information in the first 4 columns is
                   referred to the central part of the search.</p> <p> 
               5th col: x coordinates (or size of submodel);</p> <p> 
               6th col: number of explanatory variables of the submodel
               7th col: y coordinate of final Cp;</p> <p> 
               8th col: units entering the final step of the search;</p><p> 
               9th col: maximum Cp value during the (central and final
               part of the) search (This information is used to print the
               labels on top of each model).</p></p></td></tr><tr valign="top"><td><code>outl</code></td><td><p><p>r x 4 matrix containing information about 'influential
               units' or empty matrix.</p> <p> 
               Influential units in this context are defined as the units
               which enter the subset in the final part of the search and
               bring the value of Cp below the minimum or above the
               maximum value of the central part of the search.</p> <p> 
               1st col: x coordinates;</p> <p> 
               2nd col: y coordinates;</p> <p> 
               3rd col: step of entry into subset;</p> <p> 
               4nd col: unit number.</p><p> 
               If matrix outl contains more columns they are ignored.</p></p></td></tr><tr valign="top"><td><code>siz</code></td><td><p>vector of length 2 containing information about n (number of
               units of the sample and bigP, number of explanatory
               variables, including the constant, in the full model). This
               information is necessary to compute the envelopes.</p></td></tr><tr valign="top"><td><code>MAL</code></td><td><p><p>(n-init+1) x (k+1) matrix
                 Mallows Cp monitored along the search for the selected
                 models.</p> <p> 
                   1st col is fwd search index;</p> <p> 
                   2nd col is associated with first selected model;</p> <p> 
                   3rd col is associated with second selected model;</p> <p> 
                   ............;</p><p> 
                   (k+1)th col is associated with k-th selected model
                   Notice that k&lt;=(n choose smallp) and that all
                   models contain the constant.</p></p></td></tr><tr valign="top"><td><code>LAB</code></td><td><p>cell array of strings of length k containing the labels
                   of the models which have been extracted. First element
                   of LAB is associated with second column of matrix
                   MAL ... last element of LAB is associated with last
                   column of matrix MAL</p></td></tr></table><p>

       Remark: the loop through all values of smallp works backwards in
       the sense that first all possible submodels of size bigP-1 are
       considered, then the models with size bigP-2 ...</p></p></div></div></div></div></div></div><div class="ref_sect" itemprop="content"><div class="bibliography"><h2 id="References">References</h2> <div><p>Riani M. and Atkinson A.C. (2010), Robust Model Selection with Flexible Trimming,
   "Computational Statistics and Data Analysis", Vol. 54, p. 3300-3312.</p></div></div></div><div class="ref_sect"><h2 id="SeeAlso">See Also</h2><p><span itemprop="seealso"><a href="FSRcp.html" itemprop="url"><span itemprop="name"><code>FSRcp</code></span></a></span> | <span itemprop="seealso"><a href="cdsplot.html" itemprop="url"><span itemprop="name"><code>cdsplot</code></span></a></span></div><i>This page has been automatically generated by our routine <a href="publishFS.html">publishFS</a></i></div></section></div></div></div></div><div id="divbottom"></div></body></html>