<!DOCTYPE HTML> <html itemscope="" xmlns="http://www.w3.org/1999/xhtml"><head><title>FSRinvmdr</title><meta content="refpage" name="chunktype"><meta content="function:FSRinvmdr" itemprop="refentity" name="refentity"><link href="includesFS/bootstrap.min.css" rel="stylesheet" type="text/css"><meta content="text/javascript" http-equiv="Content-Script-Type"><meta content="fcn" itemprop="pagetype" name="toctype"><meta content="ref/function" itemprop="infotype" name="infotype" /><meta content="FSRinvmdr converts values of minimum deletion residual into confidence levels." itemprop="description" name="description" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" /><script type="text/x-mathjax-config">MathJax.Hub.Config({extensions: ["tex2jax.js"],jax: ["input/TeX","output/HTML-CSS"],menuSettings: {zoom: "Double-Click", zscale: "300"},tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},MathMenu: {showRenderer: false},"HTML-CSS": {availableFonts: ["TeX"],preferredFont: "TeX",imageFont: null}});</script><script type="text/javascript" src="includesFS/Mathjax/MathJax.js"></script><script src="includesFS/matlab-highlighter.min.js"></script><link href="includesFS/matlab-highlighter.css" rel="stylesheet" type="text/css"><script type="text/javascript" src="includesFS/jquery-latest.js"></script><script>$(document).ready(function(){      $("#div002").load("includesFS/top.html");      $("#div001").load("includesFS/bottom.html");});</script><script src="includesFS/jquery-latest.js" type="text/javascript"></script><link href="includesFS/site6.css?201505100807" rel="stylesheet" type="text/css"><link href="includesFS/site6_lg.css?201505100807" media="screen and (min-width: 1200px)" rel="stylesheet"><link href="includesFS/site6_md.css?201505100807" media="screen and (min-width: 992px) and (max-width: 1199px)" rel="stylesheet"><link href="includesFS/site6_sm+xs.css?201505100807" media="screen and (max-width: 991px)" rel="stylesheet"><link href="includesFS/site6_sm.css?201505100807" media="screen and (min-width: 768px) and (max-width: 991px)" rel="stylesheet"><link href="includesFS/site6_xs.css?201505100807" media="screen and (max-width: 767px)" rel="stylesheet"><link href="includesFS/site6_offcanvas.css?201505100807" rel="stylesheet" type="text/css"><script src="includesFS/l10n.js" type="text/javascript"></script><script src="includesFS/SHAREDdocscripts.js"></script><script src="includesFS/PRODUCTdocscripts.js"></script><script src="includesFS/mw.toc.js" type="text/javascript"></script><script src="includesFS/mw.imagescaling.js" type="text/javascript"></script><script src="includesFS/mw.imageanimation.js" type="text/javascript"></script><script src="includesFS/jquery.highlight.js"></script><script src="includesFS/bootstrap.min.js" type="text/javascript"></script><script src="includesFS/global.js"></script><script src="includesFS/bottom.js" type="text/javascript"></script><script src="includesFS/suggest.js" type="text/javascript"></script><script src="includesFS/underscore-min.js"></script><link href="includesFS/reset.css" rel="stylesheet" type="text/css"><link href="includesFS/960.css" rel="stylesheet" type="text/css"><link href="includesFS/doc_center.css" rel="stylesheet" type="text/css"><link href="includesFS/doc_center_installed.css" rel="stylesheet" type="text/css"><link href="includesFS/doc_center.css" rel="stylesheet" type="text/css"><link href="includesFS/doc_center_installed.css" rel="stylesheet" type="text/css"><link href="includes/product/css/doc_center_print.css" media="print" rel="stylesheet" type="text/css"></head><body  onload="highlightMATLABCode();" id="responsive_offcanvas"><div class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-xs-12 col-sm-6 col-sm-push-6 col-md-5 col-md-push-7" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2016a" data-language="en" action="../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="sr-only">Search Documentation</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Documentation" id="docsearch"><div class="input-group-btn"><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search pull-right icon_32 visible-xs" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="col-sm-6 col-sm-pull-6 col-md-7 col-md-pull-5" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../documentation-center.html">Documentation</a></h1></div></div></div><div class="visible-xs" id="search_actuator"><button class="btn icon-search btn_search pull-right icon_16" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div><!--END.CLASS row--></div><!--END.CLASS container-fluid--></div><!--START.CLASS sticky_header_container--><div class="sticky_header_container includes_subnav"><div class="horizontal_nav_container"><div id="nav_toggle" class="offcanvas_actuator" data-target="#sidebar" data-toggle="offcanvas"><button class="btn" type="button"><span class="sr-only">Toggle navigation</span><span class="icon-menu icon_32"></span></button><span class="offcanvas_actuator_label"></span><span class="offcanvas_actuator_close"></span></div><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"></div></div></div></div></div><div class="row-offcanvas row-offcanvas-left"><div id="sidebar" class="sidebar-offcanvas" role="navigation"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" xmlns:atict="http://www.arbortext.com/namespace/atict"><li itemprop="breadcrumb" itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb"><a href="../documentation-center.html" itemprop="url"><span itemprop="title">All Products</span></a></li></ul><ul class="nav_disambiguation" xmlns:atict="http://www.arbortext.com/namespace/atict"><li class="product"><a href="index.html">Flexible Statistics and Data Analysis (FSDA)</a><div class="dropdown"><span id="dropdownMenu1" class="icon-arrow-down icon_16" data-toggle="dropdown"></span><ul aria-labelledby="dropdownMenu1" class="dropdown-menu dropdown-menu-right" role="menu"><li role="presentation"><a href="examples.html" role="menuitem" tabindex="-1">Examples</a></li><li role="presentation"><a href="functionlist.html" role="menuitem" tabindex="-1">Functions and Other Reference</a></li><li role="presentation"><a href="release-notes.html" role="menuitem" tabindex="-1">Release Notes</a></li><li role="presentation"><a href="tutorials.html" role="menuitem" tabindex="-1">Tutorials</a></li></ul></div></li></ul><ul xmlns:atict="http://www.arbortext.com/namespace/atict" class="nav_disambiguation"><li><a href="index.html">Flexible Statistics and Data Analysis Toolbox</a></li><li><a href="function-cate.html" itemprop="url">Functions</a></li></ul><!-- --><ul class="nav_scrollspy nav" xmlns:atict="http://www.arbortext.com/namespace/atict"><li class="nav_scrollspy_function"><a href="#responsive_offcanvas">FSRinvmdr</a></li><li id="SSPY810-refentry" class="nav_scrollspy_title">On this page</li><li><a class="intrnllnk" href="#syntax">Syntax</a></li><li><a class="intrnllnk" href="#Description">Description</a></li><li><a class="intrnllnk" href="#Examples">Examples</a><ul><li><a class="intrnllnk" href="#Example_1">FSRinvmdr with all default options.</a></li><li><a class="intrnllnk" href="#Example_2">FSRinvmdr with optional arguments.</a></li></ul></li><li><a class="intrnllnk" href="#ExtraExamples">Extra Examples</a><ul><li><a class="intrnllnk" href="#ExtraExample_1">Resuperimposing envelopes.</a></li><li><a class="intrnllnk" href="#ExtraExample_2">Example with Hospital Data.</a></li></ul></li><li><a class="intrnllnk" href="#Inputs">Input Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_mdr">mdr</a></li><li><a class="intrnllnk" href="#input_argument_p">p</a></li></ul></li><li><a class="intrnllnk" href="#NameValuePairs">Name-Value Pair Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_namevalue_n">n</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_plots">plots</a></li></ul></li><li><a class="intrnllnk" href="#OutputArgs">Output Arguments</a><ul><li><a class="intrnllnk" href="#output_argument_MDRinv">MDRinv</a></li></ul></li><li><a class="intrnllnk" href="#References">References</a></li><li><a class="intrnllnk" href="#SeeAlso">See Also</a></li></ul></nav><script src="includesFS/offcanvas.js"></script></div><div id="div002"></div><div class="site_container site_toc_closed"><div class="page_container"><div class="content_frame"><div id="content_container" class="content_container"><section id="doc_center_content"><div class="function_ref"><div itemprop="content"><h1 itemprop="title">FSRinvmdr</h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose">FSRinvmdr converts values of minimum deletion residual into confidence levels</p><div class="switch"><a id="expandAllPage" href="javascript:void(0);">expand all in page</a></div></div></div></div><div class="ref_sect"><h2 id="syntax">Syntax</h2><div class="syntax_signature"><div class="syntax_signature_module"><ul><li><code class="synopsis">MDRinv=FSRinvmdr(mdr,p)</code><span class="syntax_example"><a class="intrnllnk" href="FSRinvmdr.html#Example_1">example</a></span></li><li><code class="synopsis">MDRinv=FSRinvmdr(mdr,p,Name,Value)</code><span class="syntax_example"><a class="intrnllnk" href="FSRinvmdr.html#Example_2">example</a></span></li></ul></div></div></div>	<div class="ref_sect" itemprop="content">							<h2 id="Description">Description</h2>							<div class="descriptions">								<div class="description_module"><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="FSRinvmdr.html#Example_1">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_MDRinv"><code>MDRinv</code></a>=FSRinvmdr(<a class="intrnllnk" href="#inputarg_mdr"><code>mdr</code></a>,<a class="intrnllnk" href="#inputarg_p"><code>p</code></a>)</code></span>FSRinvmdr with all default options.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="FSRinvmdr.html#Example_2">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_MDRinv"><code>MDRinv</code></a>=FSRinvmdr(<a class="intrnllnk" href="#inputarg_mdr"><code>mdr</code></a>,<a class="intrnllnk" href="#inputarg_p"><code>p</code></a>,<a class="intrnllnk" href="#namevaluepairarguments"><code>Name, Value</code></a>)</code></span>FSRinvmdr with optional arguments.</p></div>								</div>							</div>							<div class="clear">							</div>						</div><div class="ref_sect" itemprop="content"><div class="examples"><h2 id="Examples">Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="example_1" class="example_module expandableContent"><div id="Example_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>FSRinvmdr with all default options.</li></span></a></span></h3><div class="collapse"><p>
     Example of finding the confidence level of MDRenv, where MDRenv is
     the matrix of 99 per cent confidence envelopes based on 1000
     observations and 5 explanatory variables.
     MDinv is a matrix which in the second column contains
     all values equal to 0.99<div class="programlisting"><div class="codeinput"><pre class="matlab-code">
    p=5;
    MDRenv=FSRenvmdr(1000,p,'prob',0.99);
    MDRinv=FSRinvmdr(MDRenv,p);      </pre></div></div></p></div></div><div id="example_2" class="example_module expandableContent"><div id="Example_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> FSRinvmdr with optional arguments.</li></span></a></span></h3><div class="collapse"><p>
     Example of finding confidence level of mdr for untransformed wool
     data.
     In the example, the values of mdr are plotted and then transformed 
     into observed confidence levels.
     The output is plotted in normal coordinates.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">

    load('wool.txt','wool');
    y=wool(:,4);
    X=wool(:,1:3);
    % The line below shows the plot of mdr
    [out]=FSR(y,X,'nsamp',0,'plots',1);
    MDRinv=FSRinvmdr(out.mdr,size(X,2)+1,'plots',1);</pre></div></div><pre class="codeoutput">Total estimated time to complete LMS:  0.18 seconds 
------------------------------
Warning: Number of subsets without full rank equal to 16.3305%
-------------------------
Signal detection loop
Tentative signal in central part of the search: step m=17 because
rmin(17,27)&gt;99.999%
-------------------
Signal validation exceedance of upper envelopes
Validated signal
-------------------------------
Start resuperimposing envelopes from step m=16
Superimposition stopped because r_{min}(17,19)&gt;99% envelope
$r_{min}(17,19)&gt;99$\% envelope
Subsample of 18 units is homogeneous
----------------------------
Final output
Number of units declared as outliers=9
Summary of the exceedances
           1          99         999        9999       99999
           1           3           3           3           2
</pre><img vspace="5" hspace="5" src="images\FSRinvmdr_01.png" alt=""> <img vspace="5" hspace="5" src="images\FSRinvmdr_02.png" alt=""> <img vspace="5" hspace="5" src="images\FSRinvmdr_03.png" alt=""> </p></div></div></div><p> </p><h3 id="ExtraExamples" class="bottom_ruled">Related Examples</h3><div id="ExtraExample_1" class="example_module expandableContent"><div id="ExtraExample_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Resuperimposing envelopes.</li></span></a></span></h3><div class="collapse"><p>
     Comparison of resuperimposing envelopes using mdr coordinates and normal
     coordinates again on wool data.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">
    load('wool.txt','wool');
    y=wool(:,4);
    X=wool(:,1:3);
    % The line below shows the plot of mdr
    [out]=FSR(y,X,'nsamp',0,'plots',2);

    n0=16:19;
    quantplo=[0.01 0.5 0.99 0.999 0.9999 0.99999];
    ninv=norminv(quantplo);
    lwdenv=2;
    ij=0;
    supn0=max(n0);

    for jn0=n0;
        ij=ij+1;
        MDRinv = FSRinvmdr(out.mdr,4,'n',jn0);
        % Resuperimposed envelope in normal coordinates
        subplot(2,2,ij)
        plot(MDRinv(:,1),norminv(MDRinv(:,2)),'LineWidth',2)
        xlim([0 supn0])
        v=axis;
        line(v(1:2)',[ninv;ninv],'color','g','LineWidth',lwdenv,'LineStyle','--','Tag','env');
        text(v(1)*ones(length(quantplo),1),ninv',strcat(num2str(100*quantplo'),'%'));
        % line(MDRinv(:,1),norminv(MDRinv(:,2)),'LineWidth',2)
        title(['Resuperimposed envelope n=' num2str(jn0)]);
    end</pre></div></div></p></div></div><div id="ExtraExample_2" class="example_module expandableContent"><div id="ExtraExample_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Example with Hospital Data.</li></span></a></span></h3><div class="collapse"><p>
     Comparison of resuperimposing envelopes using mdr coordinates and normal
     coordinates at particular steps.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">
    load('hospital.txt');
    y=hospital(:,5);
    X=hospital(:,1:4);
    % exploratory analysis through the yXplot
    out=FSR(y,X,'nsamp',20000,'plots',2,'lms',0);

    n0=[54 58 62 63];
    quantplo=[0.01 0.5 0.99 0.999 0.9999 0.99999];
    ninv=norminv(quantplo);
    lwdenv=2;
    supn0=max(n0);

    figure;
    ij=0;
    for jn0=n0;
        ij=ij+1;
        [MDRinv] = FSRinvmdr(out.mdr,5,'n',jn0);
        % Plot for each step of the fwd search the values of mdr translated in
        % Plot for each step of the fwd search the values of mdr translated in
        % terms of normal quantiles
        subplot(2,2,ij)
        plot(MDRinv(:,1),norminv(MDRinv(:,2)),'LineWidth',2)
        xlim([0 supn0])
        v=axis;
        line(v(1:2)',[ninv;ninv],'color','g','LineWidth',lwdenv,'LineStyle','--','Tag','env');
        text(v(1)*ones(length(quantplo),1),ninv',strcat(num2str(100*quantplo'),'%'));
        line(MDRinv(:,1),norminv(MDRinv(:,2)),'LineWidth',2)
        title(['Resuperimposed envelope n=' num2str(jn0)]);
    end
</pre></div></div></p></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="Inputs">Input Arguments</h2><div class="expandableContent"><div class="arguments"><div class="input_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"> <div id="inputarg_mdr" class="clearfix"> </div> <h3 id="input_argument_mdr" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>mdr</code> &#8212; Minimum deletion residuals </span>  </a><span class="example_desc">Matrix</span></span></h3> <div class="collapse"> <p><p>n-m0 x 2 matrix containing:</p> <p> 
          1st col = fwd search index;</p><p> 
          2nd col = minimum deletion residual .</p></p> <p class="datatypelist"><strong> Data Types: </strong><code>single| double</code></p> </div> </div><div class="expandableContent"> <div id="inputarg_p" class="clearfix"> </div> <h3 id="input_argument_p" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>p</code> &#8212; Number of explanatory variables </span>  </a><span class="example_desc">Scalar</span></span></h3> <div class="collapse"> <p>Number of explanatory variables of the underlying dataset
           (including the intercept if present)</p> <p class="datatypelist"><strong> Data Types: </strong><code>single| double</code></p> </div> </div><div id="namevaluepairarguments" class="clearfix"></div><h3 id="NameValuePairs" class="bottom_ruled">Name-Value Pair Arguments</h3><div class="namevaluecontainer"><p>Specify optional comma-separated pairs of <code>Name,Value</code> arguments. <code>Name</code> is the argument name and <code>Value</code> is the corresponding value. <code>Name</code> must appear  inside single quotes (<code>' '</code>).  You can specify several name and value pair arguments in any order as <code>  Name1,Value1,...,NameN,ValueN</code>.</p>  <span class="example_desc"><strong>Example:</strong><code><code> 'n',10
</code>,<code> 'plots',1 
</code></code></span></div><div class="expandableContent"><div id="inputarg_n" class="clearfix"></div><h3 id="input_argument_namevalue_n" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>n</code> &#8212;size of the sample</span></a><span class="example_desc">scalar</span></span></h3><div class="collapse">	<p>If it is not specified
               it is set equal to mdr(end,1)+1
               </p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'n',10
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_plots" class="clearfix"></div><h3 id="input_argument_namevalue_plots" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>plots</code> &#8212;Plot on the screen</span></a><span class="example_desc">scalar | structure</span></span></h3><div class="collapse">	<p><p>It specify whether it is necessary to
               plot in normal coordinates the value of mdr
               If plots = 1, a plot which shows the
               confidence level of mdr in each step is shown on the
               screen.</p> <p>
               Remark. three horizontal lines associated respectively with
               values  0.01 0.5 and 0.99  are added to the plot
               If plots is a structure the user can specify the following options
                   conflev = vector containing horizontal lines associated
                       with confidence levels
                   conflevlab = scalar if it is equal 1 labels associated with
                       horizontal lines are shown on the screen
                   xlim = minimum and maximum on the x axis
                   ylim = minimum and maximum on the y axis
                   LineWidth = Line width of the trajectory of mdr in
                   normal coordinates
                   LineStyle = Line style of the
                   trajectory of mle of transformation parameters
                   LineWidthEnv = Line width of the horizontal lines
                   Tag = tag of the plot (default is pl_mdrinv)
                   FontSize = font size of the text labels which identify
                   the trajectories
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'plots',1 
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="OutputArgs" >Output Arguments</h2><div class="expandableContent"><div class="arguments"><div class="output_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"><div id="outputarg_MDRinv" class="clearfix"></div><h3 id="output_argument_MDRinv" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>MDRinv</code> &#8212;Confidence levels.</span></a><span class="example_desc"><code> </code>Matrix</span></span></h3><div class="collapse"><p><p> Matrix with n-m0 rows (same rows
               of input matrix mdr) and 3 columns:</p> <p> 
               1st col = fwd search index from m0 to n-1.</p> <p> 
               2nd col = confidence level of each value of mdr.</p><p> 
               3rd col = confidence level in normal coordinates: 50 conf
               level becomes norminv(0.50)=0; 99 conf level becomes norminv(0.99)=2.33.</p></p></div></div></div></div></div></div><div class="ref_sect" itemprop="content"><div class="bibliography"><h2 id="References">References</h2> <div><p>Atkinson, A.C. and Riani, M. (2006). Distribution theory and
   simulations for tests of outliers in regression. Journal of
   Computational and Graphical Statistics, Vol. 15, pp. 460-476</p></div><div><p>Riani, M. and Atkinson, A.C. (2007). Fast calibrations of the forward
   search for testing multiple outliers in regression, Advances in Data
   Analysis and Classification, Vol. 1, pp. 123-141.</p></div></div></div><div class="ref_sect"><h2 id="SeeAlso">See Also</h2><p><span itemprop="seealso"><a href="FSRenvmdr.html" itemprop="url"><span itemprop="name"><code>FSRenvmdr</code></span></a></span> | <span itemprop="seealso"><a href="LXS.html" itemprop="url"><span itemprop="name"><code>LXS</code></span></a></span> | <span itemprop="seealso"><a href="FSREDA.html" itemprop="url"><span itemprop="name"><code>FSREDA</code></span></a></span></div><i>This page has been automatically generated by our routine <a href="publishFS.html">publishFS</a></i></div></section></div></div></div></div><div id="div001"></div></body></html>