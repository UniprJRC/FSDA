<!DOCTYPE HTML> <html itemscope="" xmlns="http://www.w3.org/1999/xhtml"><head><title>logmvnpdfFS</title><meta content="refpage" name="chunktype"><meta content="function:logmvnpdfFS" itemprop="refentity" name="refentity"><link href="includesFS/bootstrap.min.css" rel="stylesheet" type="text/css"><meta content="text/javascript" http-equiv="Content-Script-Type"><meta content="fcn" itemprop="pagetype" name="toctype"><meta content="ref/function" itemprop="infotype" name="infotype" /><meta content="logmvnpdfFS produces log of Multivariate normal probability density function (pdf)." itemprop="description" name="description" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" /><script type="text/x-mathjax-config">MathJax.Hub.Config({extensions: ["tex2jax.js"],jax: ["input/TeX","output/HTML-CSS"],menuSettings: {zoom: "Double-Click", zscale: "300"},tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},MathMenu: {showRenderer: false},"HTML-CSS": {availableFonts: ["TeX"],preferredFont: "TeX",imageFont: null}});</script><script type="text/javascript" src="includesFS/Mathjax/MathJax.js"></script><script src="includesFS/matlab-highlighter.min.js"></script><link href="includesFS/matlab-highlighter.css" rel="stylesheet" type="text/css"><script type="text/javascript" src="includesFS/jquery-latest.js"></script><script>$(document).ready(function(){      $("#divtop").load("includesFS/top.html");      $("#divbottom").load("includesFS/bottom.html");});</script><script src="includesFS/jquery-latest.js" type="text/javascript"></script><link href="includesFS/site6.css?201505100807" rel="stylesheet" type="text/css"><link href="includesFS/site6_lg.css?201505100807" media="screen and (min-width: 1200px)" rel="stylesheet"><link href="includesFS/site6_md.css?201505100807" media="screen and (min-width: 992px) and (max-width: 1199px)" rel="stylesheet"><link href="includesFS/site6_sm+xs.css?201505100807" media="screen and (max-width: 991px)" rel="stylesheet"><link href="includesFS/site6_sm.css?201505100807" media="screen and (min-width: 768px) and (max-width: 991px)" rel="stylesheet"><link href="includesFS/site6_xs.css?201505100807" media="screen and (max-width: 767px)" rel="stylesheet"><link href="includesFS/site6_offcanvas.css?201505100807" rel="stylesheet" type="text/css"><script src="includesFS/l10n.js" type="text/javascript"></script><script src="includesFS/SHAREDdocscripts.js"></script><script src="includesFS/PRODUCTdocscripts.js"></script><script src="includesFS/mw.toc.js" type="text/javascript"></script><script src="includesFS/mw.imagescaling.js" type="text/javascript"></script><script src="includesFS/mw.imageanimation.js" type="text/javascript"></script><script src="includesFS/jquery.highlight.js"></script><script src="includesFS/bootstrap.min.js" type="text/javascript"></script><script src="includesFS/global.js"></script><script src="includesFS/bottom.js" type="text/javascript"></script><script src="includesFS/suggest.js" type="text/javascript"></script><script src="includesFS/underscore-min.js"></script><link href="includesFS/reset.css" rel="stylesheet" type="text/css"><link href="includesFS/960.css" rel="stylesheet" type="text/css"><link href="includesFS/doc_center.css" rel="stylesheet" type="text/css"><link href="includesFS/doc_center_installed.css" rel="stylesheet" type="text/css"><link href="includesFS/doc_center.css" rel="stylesheet" type="text/css"><link href="includesFS/doc_center_installed.css" rel="stylesheet" type="text/css"><link href="includes/product/css/doc_center_print.css" media="print" rel="stylesheet" type="text/css"></head><body  onload="highlightMATLABCode();" id="responsive_offcanvas">  <div id="doc_header_spacer" class="header"></div><div class="sticky_header_container includes_subnav"><div class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-xs-12 col-sm-6 col-sm-push-6 col-md-5 col-md-push-7" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2017a" data-language="en" action="../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="sr-only">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"><div class="input-group-btn"><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search pull-right icon_32 visible-xs" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="col-sm-6 col-sm-pull-6 col-md-7 col-md-pull-5" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../documentation-center.html">Documentation</a></h1></div></div></div><div class="visible-xs" id="search_actuator"><button class="btn icon-search btn_search pull-right icon_16" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div><!--END.CLASS row--> </div><!--END.CLASS container-fluid--> </div><!--END.CLASS section_header level_3--><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_actuator" data-toggle="offcanvas" data-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="sr-only">Toggle navigation</span><span class="icon-menu icon_24"></span></button><span class="offcanvas_actuator_label"></span><span class="offcanvas_actuator_close"></span> </div><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-md-12 hidden-xs hidden-sm"></div></div></div></div></div></div></div><!--END.CLASS sticky_header_container--><div class="row-offcanvas row-offcanvas-left"><div id="sidebar" class="sidebar-offcanvas" role="navigation"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" xmlns:atict="http://www.arbortext.com/namespace/atict"><li itemprop="breadcrumb" itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb"> <a href="../documentation-center.html" itemprop="url"> <span itemprop="title">All Products</span></a></li></ul><ul class="nav_disambiguation" xmlns:atict="http://www.arbortext.com/namespace/atict"><li class="product"><a href="index.html">Flexible Statistics and Data Analysis (FSDA)</a><div class="dropdown"> <span id="dropdownMenu1" class="icon-arrow-down icon_16" data-toggle="dropdown"> </span><ul aria-labelledby="dropdownMenu1" class="dropdown-menu dropdown-menu-right" role="menu"><li role="presentation"> <a href="examples.html" role="menuitem" tabindex="-1">Examples</a></li><li role="presentation"> <a href="function-alpha.html" role="menuitem" tabindex="-1"> Functions and Other Reference</a></li><li role="presentation"> <a href="release-notes.html" role="menuitem" tabindex="-1"> Release Notes</a></li><li role="presentation"> <a href="tutorials.html" role="menuitem" tabindex="-1"> Tutorials</a></li></ul></div></li></ul><ul xmlns:atict="http://www.arbortext.com/namespace/atict" class="nav_disambiguation"> <li><a href="index.html">Flexible Statistics and Data Analysis Toolbox</a> </li> <li><a href="function-cate.html" itemprop="url">Functions</a></li></ul><!-- --><ul class="nav_scrollspy nav" xmlns:atict="http://www.arbortext.com/namespace/atict">  <li class="nav_scrollspy_function"> <a href="#responsive_offcanvas">logmvnpdfFS</a></li> <li id="SSPY810-refentry" class="nav_scrollspy_title">On this page</li><li><a class="intrnllnk" href="#syntax">Syntax</a></li><li><a class="intrnllnk" href="#Description">Description</a></li><li><a class="intrnllnk" href="#Examples">Examples</a><ul><li><a class="intrnllnk" href="#Example_1">Comparison with mvnpdf.</a></li><li><a class="intrnllnk" href="#Example_2">Remark: Options X0, eyed, n, and d must be used together.</a></li><li><a class="intrnllnk" href="#Example_3"></a></li><li><a class="intrnllnk" href="#Example_4"></a></li><li><a class="intrnllnk" href="#Example_5"></a></li><li><a class="intrnllnk" href="#Example_6">Example of the use of option msg.</a></li></ul></li><li><a class="intrnllnk" href="#ExtraExamples">Extra Examples</a><ul><li><a class="intrnllnk" href="#ExtraExample_1">TIME COMPARISON USING TIC TOC.</a></li><li><a class="intrnllnk" href="#ExtraExample_2">TIME COMPARISON USING TIMEIT FUNCTION.</a></li></ul></li><li><a class="intrnllnk" href="#Inputs">Input Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_X">X</a></li><li><a class="intrnllnk" href="#input_argument_Mu">Mu</a></li><li><a class="intrnllnk" href="#input_argument_Sigma">Sigma</a></li><li><a class="intrnllnk" href="#input_argument_X0">X0</a></li><li><a class="intrnllnk" href="#input_argument_eyed">eyed</a></li><li><a class="intrnllnk" href="#input_argument_n">n</a></li><li><a class="intrnllnk" href="#input_argument_d">d</a></li><li><a class="intrnllnk" href="#input_argument_msg">msg</a></li></ul></li><li><a class="intrnllnk" href="#OutputArgs">Output Arguments</a><ul><li><a class="intrnllnk" href="#output_argument_y">y</a></li></ul></li><li><a class="intrnllnk" href="#References">References</a></li><li><a class="intrnllnk" href="#SeeAlso">See Also</a></li></ul></nav><script src="includesFS/offcanvas.js"></script></div><div id="divtop"></div><div class="site_container site_toc_closed"><div class="page_container"><div class="content_frame"><div id="content_container" class="content_container"><section id="doc_center_content"><div class="function_ref"><div itemprop="content"><h1 itemprop="title">logmvnpdfFS</h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose">logmvnpdfFS produces log of Multivariate normal probability density function (pdf)</p><div class="switch"><a id="expandAllPage" href="javascript:void(0);">expand all in page</a></div></div></div></div><div class="ref_sect"><h2 id="syntax">Syntax</h2><div class="syntax_signature"><div class="syntax_signature_module"><ul><li><code class="synopsis">y=logmvnpdfFS(X, Mu, Sigma)</code><span class="syntax_example"><a class="intrnllnk" href="logmvnpdfFS.html#Example_1">example</a></span></li><li><code class="synopsis">y=logmvnpdfFS(X, Mu, Sigma, X0)</code><span class="syntax_example"><a class="intrnllnk" href="logmvnpdfFS.html#Example_2">example</a></span></li><li><code class="synopsis">y=logmvnpdfFS(X, Mu, Sigma, X0, eyed)</code><span class="syntax_example"><a class="intrnllnk" href="logmvnpdfFS.html#Example_3">example</a></span></li><li><code class="synopsis">y=logmvnpdfFS(X, Mu, Sigma, X0, eyed, n)</code><span class="syntax_example"><a class="intrnllnk" href="logmvnpdfFS.html#Example_4">example</a></span></li><li><code class="synopsis">y=logmvnpdfFS(X, Mu, Sigma, X0, eyed, n, d)</code><span class="syntax_example"><a class="intrnllnk" href="logmvnpdfFS.html#Example_5">example</a></span></li><li><code class="synopsis">y=logmvnpdfFS(X, Mu, Sigma, X0, eyed, n, d, msg)</code><span class="syntax_example"><a class="intrnllnk" href="logmvnpdfFS.html#Example_6">example</a></span></li></ul></div></div></div>	<div class="ref_sect" itemprop="content">							<h2 id="Description">Description</h2>							<div class="descriptions">								<div class="description_module"><p><p>This function is a much faster version than (log of) Matlab function
 mvnpdf.  If this function is called without optional arguments than it
 uses matlab function bsxfun to compute
 the deviations form the means and no mex function.</p> <p>
 If this function is called with the four optional input
 arguments X0, eyed, n and d a mex function based on C code is directly used.</p><p> 
 Additional details follow: in order to compute the kernel of the quadratic form
 at the exponent logmvnpdfFS creates an identity of size length(Mu) and
 similarly needs to compute length(Mu). These two quantites can be
 precalculated and supplied as input parameters. If logmvnpdfFS has to be
 called thousands of times (as it happens for example in each iteration
 of all procedures of cluster analysis based mixtures of multivariate
 gaussian distributions). The same argument above applies to scalars n
 and d which are directly passed to the compiled mex function</p></p><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="logmvnpdfFS.html#Example_1">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_y"><code>y</code></a>=logmvnpdfFS(<a class="intrnllnk" href="#inputarg_X"><code>X</code></a>,<a class="intrnllnk" href="#inputarg_Mu"><code>Mu</code></a>,<a class="intrnllnk" href="#inputarg_Sigma"><code> Sigma</code></a>)</code></span>Comparison with mvnpdf.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="logmvnpdfFS.html#Example_2">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_y"><code>y</code></a>=logmvnpdfFS(<a class="intrnllnk" href="#inputarg_X"><code>X</code></a>,<a class="intrnllnk" href="#inputarg_Mu"><code>Mu</code></a>,<a class="intrnllnk" href="#inputarg_Sigma"><code>Sigma</code></a>,<a class="intrnllnk" href="#inputarg_X0"><code> X0</code></a>)</code></span>Remark: Options X0, eyed, n, and d must be used together.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="logmvnpdfFS.html#Example_3">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_y"><code>y</code></a>=logmvnpdfFS(<a class="intrnllnk" href="#inputarg_X"><code>X</code></a>,<a class="intrnllnk" href="#inputarg_Mu"><code>Mu</code></a>,<a class="intrnllnk" href="#inputarg_Sigma"><code>Sigma</code></a>,<a class="intrnllnk" href="#inputarg_X0"><code>X0</code></a>,<a class="intrnllnk" href="#inputarg_eyed"><code> eyed</code></a>)</code></span></p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="logmvnpdfFS.html#Example_4">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_y"><code>y</code></a>=logmvnpdfFS(<a class="intrnllnk" href="#inputarg_X"><code>X</code></a>,<a class="intrnllnk" href="#inputarg_Mu"><code>Mu</code></a>,<a class="intrnllnk" href="#inputarg_Sigma"><code>Sigma</code></a>,<a class="intrnllnk" href="#inputarg_X0"><code>X0</code></a>,<a class="intrnllnk" href="#inputarg_eyed"><code>eyed</code></a>,<a class="intrnllnk" href="#inputarg_n"><code> n</code></a>)</code></span></p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="logmvnpdfFS.html#Example_5">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_y"><code>y</code></a>=logmvnpdfFS(<a class="intrnllnk" href="#inputarg_X"><code>X</code></a>,<a class="intrnllnk" href="#inputarg_Mu"><code>Mu</code></a>,<a class="intrnllnk" href="#inputarg_Sigma"><code>Sigma</code></a>,<a class="intrnllnk" href="#inputarg_X0"><code>X0</code></a>,<a class="intrnllnk" href="#inputarg_eyed"><code>eyed</code></a>,<a class="intrnllnk" href="#inputarg_n"><code>n</code></a>,<a class="intrnllnk" href="#inputarg_d"><code> d</code></a>)</code></span></p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="logmvnpdfFS.html#Example_6">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_y"><code>y</code></a>=logmvnpdfFS(<a class="intrnllnk" href="#inputarg_X"><code>X</code></a>,<a class="intrnllnk" href="#inputarg_Mu"><code>Mu</code></a>,<a class="intrnllnk" href="#inputarg_Sigma"><code>Sigma</code></a>,<a class="intrnllnk" href="#inputarg_X0"><code>X0</code></a>,<a class="intrnllnk" href="#inputarg_eyed"><code>eyed</code></a>,<a class="intrnllnk" href="#inputarg_n"><code>n</code></a>,<a class="intrnllnk" href="#inputarg_d"><code>d</code></a>,<a class="intrnllnk" href="#inputarg_msg"><code> msg</code></a>)</code></span>Example of the use of option msg.</p></div>								</div>							</div>							<div class="clear">							</div>						</div><div class="ref_sect" itemprop="content"><div class="examples"><h2 id="Examples">Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="example_1" class="example_module expandableContent"><div id="Example_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>Comparison with mvnpdf.</li></span></a></span></h3><div class="collapse"><p>
      In this example we check the agreement of the results with MATLAB
      function mvnpdf.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">
     n=20000;
     v=2;
     X=randn(n,v);
     mu = [1 -1]; Sigma = [.9 .4; .4 .3];
     y = logmvnpdfFS(X, mu, Sigma);
     y1=log(mvnpdf(X,mu,Sigma));
     max(abs(y-y1))
     % 2.842e-14</pre></div></div></p></div></div><div id="example_2" class="example_module expandableContent"><div id="Example_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>Remark: Options X0, eyed, n, and d must be used together.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">
   % Remark: Options X0, eyed, n, and d must be used together.</pre></div></div></p></div></div><div id="example_3" class="example_module expandableContent"><div id="Example_3"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li></li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code"></pre></div></div></p></div></div><div id="example_4" class="example_module expandableContent"><div id="Example_4"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li></li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code"></pre></div></div></p></div></div><div id="example_5" class="example_module expandableContent"><div id="Example_5"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li></li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code"></pre></div></div></p></div></div><div id="example_6" class="example_module expandableContent"><div id="Example_6"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>Example of the use of option msg.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">
    msg=0;
    X0=X;
    eyed=eye(v);
    y = logmvnpdfFS(X,mu,Sigma,X0,eyed,n,v,msg);
    %  enables to control the display of the error message on the cov matrix
</pre></div></div></p></div></div></div><p> </p><h3 id="ExtraExamples" class="bottom_ruled">Related Examples</h3><div id="ExtraExample_1" class="example_module expandableContent"><div id="ExtraExample_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> TIME COMPARISON USING TIC TOC.</li></span></a></span></h3><div class="collapse"><p>
     In the examples below we compare the speed of the different solutions
     logmvnpdfFS with mex function and logmvnpdfFS without mex function

     In this code computation time is based on tic toc combined with a series
     of replications

     nn = sample size
     vv = number of variables<div class="programlisting"><div class="codeinput"><pre class="matlab-code">
    nn=[100 200 500 1000 5000 10000 50000 100000];
    vv=[2 5 10 20];

    % rep =number of replications
    rep = 1000;

    ttMat=nan(length(nn) , length(vv));
    ttFSwithMex=ttMat;
    ttFSnoMex=ttMat;


    Mat=0; tMat=0;
    FSwithmex=0; tFSwithMex=0;
    FSnoMex=0; tFSnoMex=0;


    in = 1; iv=1;
    for n = nn
        for v = vv

            X0 = zeros(n,v);
            eyed=eye(v);

            for i=1:rep

                X = randn(n,v);
                Mu = randn(1,v);
                Sigma=cov(X);

                %  Matlab function mvnpdf, (black line in plot)
                Mat = tic;
                y0 = mvnpdf(X, Mu, Sigma);
                y0=log(y0);
                tMat = tMat + toc(Mat);

                % logmvnpdfFS using mex file for mean deviations, (blue line in plot)
                FSwithmex = tic;
                yD = logmvnpdfFS(X, Mu, Sigma,X0,eyed,n,v);
                tFSwithMex = tFSwithMex + toc(FSwithmex);

                % logmvnpdfFS and no mex file for mean deviations. (red line in plot)
                FSnoMex = tic;
                yI = logmvnpdfFS(X, Mu, Sigma);
                tFSnoMex = tFSnoMex + toc(FSnoMex);


                if (sum(sum(abs(y0-yD))))&gt;10^-6  || (sum(sum(abs(y0-yI)))) &gt;10^-6
                   error('FSDA:logmvnpdfFS:ShouldBeEq','Difference in results: stop');
                end

            end

            ttMat(in,iv) = tMat;
            ttFSwithMex(in,iv) = tFSwithMex;
            ttFSnoMex(in,iv) = tFSnoMex;

            Mat=0; tMat=0;
            FSwithmex=0; tFSwithMex=0;
            FSnoMex=0; tFSnoMex=0;


            disp(['n=' num2str(n) ' -- v=' num2str(v)]);
            iv = iv+1;

        end
        in = in+1;
        iv = 1;
    end


    % Plotting part
    a=ver;
    a=a.Release;
    aa=1;
    bb=8;

    for ij=1:length(vv);
        subplot(length(vv)/2,2,ij)
        hold('on')
        plot(nn(aa:bb)',ttMat(aa:bb,ij),'k');
        plot(nn(aa:bb)',ttFSwithMex(aa:bb,ij),'b')
        plot(nn(aa:bb)',ttFSnoMex(aa:bb,ij),'r');

        if ij==1
            title(['v (number of variables)=' num2str(vv(ij)) ' version' a])
        else
            title(['v=' num2str(vv(ij))])
        end
        ylabel('Seconds')
        xlabel('Number of observations')
        if ij==4
            legend('mvnpdf','FS+mex','FS','location','NorthWest')
        end
    end

    hold off;</pre></div></div><pre class="codeoutput">n=100 -- v=2
n=100 -- v=5
n=100 -- v=10
n=100 -- v=20
n=200 -- v=2
n=200 -- v=5
n=200 -- v=10
n=200 -- v=20
n=500 -- v=2
n=500 -- v=5
n=500 -- v=10
n=500 -- v=20
n=1000 -- v=2
n=1000 -- v=5
n=1000 -- v=10
n=1000 -- v=20
n=5000 -- v=2
n=5000 -- v=5
n=5000 -- v=10
n=5000 -- v=20
n=10000 -- v=2
n=10000 -- v=5
n=10000 -- v=10
n=10000 -- v=20
n=50000 -- v=2
n=50000 -- v=5
n=50000 -- v=10
n=50000 -- v=20
n=100000 -- v=2
n=100000 -- v=5
n=100000 -- v=10
n=100000 -- v=20
</pre><img vspace="5" hspace="5" src="images\logmvnpdfFS_01.png" alt=""> </p></div></div><div id="ExtraExample_2" class="example_module expandableContent"><div id="ExtraExample_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> TIME COMPARISON USING TIMEIT FUNCTION.</li></span></a></span></h3><div class="collapse"><p>
     Remark: timeit function is present from  MATLAB 2013b
<div class="programlisting"><div class="codeinput"><pre class="matlab-code">
    if verLessThan('matlab', '8.2.0')
        warning('FSDA:logmvnpdfFS:MatlabTooOld','This example needs routine timeit which has been introduced in Matlab 2013b')
        warning('FSDA:logmvnpdfFS:MatlabTooOld','You have a version of Matlab which is &lt; 2013b and you cannot run this example')
    else
        % nn = sample size
        % vv = number of variables
        nn=[100 200 500 1000 5000 10000 50000 100000];
        vv=[2 5 10 20];

        ttMat=nan(length(nn) , length(vv));
        ttFSwithMex=ttMat;
        ttFSnoMex=ttMat;

        in = 1; iv=1;
        for n = nn
            for v = vv

                X0 = zeros(n,v);
                eyed=eye(v);


                X = randn(n,v);
                Mu = randn(1,v);
                Sigma=cov(X);

                %  Matlab function mvnpdf
                yMat = @() log(mvnpdf(X, Mu, Sigma));
                tMat = timeit(yMat);


                % logmvnpdfFS using mex file for mean deviations.
                yFSwithMex = @() logmvnpdfFS(X, Mu, Sigma,X0,eyed,n,v);
                tFSwithMex = timeit(yFSwithMex);

                % logmvnpdfFS and no mex file for mean deviations.
                yFSnoMex = @() logmvnpdfFS(X, Mu, Sigma);
                tFSnoMex = timeit(yFSnoMex);

                ttMat(in,iv) = tMat;
                ttFSwithMex(in,iv) = tFSwithMex;
                ttFSnoMex(in,iv) = tFSnoMex;

                disp(['n=' num2str(n) ' -- v=' num2str(v)]);
                iv = iv+1;

            end
            in = in+1;
            iv = 1;
        end


        % Plotting part
        a=ver;
        a=a.Release;
        aa=1;
        bb=length(nn);

        for ij=1:length(vv);
            subplot(length(vv)/2,2,ij)
            hold('on')
            plot(nn(aa:bb)',ttMat(aa:bb,ij),'k');
            plot(nn(aa:bb)',ttFSwithMex(aa:bb,ij),'b')
            plot(nn(aa:bb)',ttFSnoMex(aa:bb,ij),'r');

            if ij==1
                title(['v (number of variables) =' num2str(vv(ij)) ' version' a])
            else
                title(['v=' num2str(vv(ij))])
            end
            xlabel('Number of observations')
            ylabel('Seconds')

            if ij==4
                legend('mvnpdf','FS+mex','FS','location','NorthWest')
            end

        end

        hold off;
    end</pre></div></div><pre class="codeoutput">n=100 -- v=2
n=100 -- v=5
n=100 -- v=10
n=100 -- v=20
n=200 -- v=2
n=200 -- v=5
n=200 -- v=10
n=200 -- v=20
n=500 -- v=2
n=500 -- v=5
n=500 -- v=10
n=500 -- v=20
n=1000 -- v=2
n=1000 -- v=5
n=1000 -- v=10
n=1000 -- v=20
n=5000 -- v=2
n=5000 -- v=5
n=5000 -- v=10
n=5000 -- v=20
n=10000 -- v=2
n=10000 -- v=5
n=10000 -- v=10
n=10000 -- v=20
n=50000 -- v=2
n=50000 -- v=5
n=50000 -- v=10
n=50000 -- v=20
n=100000 -- v=2
n=100000 -- v=5
n=100000 -- v=10
n=100000 -- v=20
</pre><img vspace="5" hspace="5" src="images\logmvnpdfFS_02.png" alt=""> </p></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="Inputs">Input Arguments</h2><div class="expandableContent"><div class="arguments"><div class="input_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"> <div id="inputarg_X" class="clearfix"> </div> <h3 id="input_argument_X" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>X</code> &#8212; Input data. </span>  </a><span class="example_desc">Scalar, Vector or matrix.</span></span></h3> <div class="collapse"> <p><p>n x d data matrix; n observations and d variables. Rows of
               Y represent observations, and columns represent variables or coordinates.</p> <p>
               The (log of the) probability density of the multivariate
               normal distribution will be evaluated at each row of the
               n-by-d matrix Y
               </p></p> <p class="datatypelist"><strong> Data Types: </strong><code>single|double</code></p> </div> </div><div class="expandableContent"> <div id="inputarg_Mu" class="clearfix"> </div> <h3 id="input_argument_Mu" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>Mu</code> &#8212; mean mu of the multivariate normal distribution. </span>  </a><span class="example_desc">1-by-d vector.</span></span></h3> <div class="collapse"> <p></p> <p class="datatypelist"><strong> Data Types: </strong><code>single|double</code></p> </div> </div><div class="expandableContent"> <div id="inputarg_Sigma" class="clearfix"> </div> <h3 id="input_argument_Sigma" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>Sigma</code> &#8212; covariance matrix of the multivariate normal distribution. </span>  </a><span class="example_desc">d-by-d matrix.</span></span></h3> <div class="collapse"> <p></p> <p class="datatypelist"><strong> Data Types: </strong><code>single|double</code></p> </div> </div><div id="optionalarguments" class="clearfix"></div><h3 id="namevaluepairs" class="bottom_ruled">Optional Arguments</h3><div class="expandableContent"> <div id="inputarg_X0" class="clearfix"> </div> <h3 id="input_argument_X0" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>X0</code> &#8212; matrix of the same size of X which passes to C function a container. </span>  </a><span class="example_desc">Note that options X0, eyed, n, and d must be supplied
               together.</span></span></h3> <div class="collapse"> <p></p>	<p class="description_valueexample">       <strong>Example: </strong><code>'X0',X
</code></p> <p class="datatypelist"><strong> Data Types: </strong><code>single|double</code></p> </div> </div><div class="expandableContent"> <div id="inputarg_eyed" class="clearfix"> </div> <h3 id="input_argument_eyed" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>eyed</code> &#8212; identity matrix of size length(Mu) wchich passes to C function a container. </span>  </a><span class="example_desc">Note that options X0, eyed, n, and d must be supplied
               together.</span></span></h3> <div class="collapse"> <p></p>	<p class="description_valueexample">       <strong>Example: </strong><code>'eyed',eye(v)
</code></p> <p class="datatypelist"><strong> Data Types: </strong><code>single|double</code></p> </div> </div><div class="expandableContent"> <div id="inputarg_n" class="clearfix"> </div> <h3 id="input_argument_n" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>n</code> &#8212; scalar which passes to C function size(X,1). </span>  </a><span class="example_desc">Note that options X0, eyed, n, and d must be supplied
               together.</span></span></h3> <div class="collapse"> <p></p>	<p class="description_valueexample">       <strong>Example: </strong><code>'eyed',eye(v)
</code></p> <p class="datatypelist"><strong> Data Types: </strong><code>single|double</code></p> </div> </div><div class="expandableContent"> <div id="inputarg_d" class="clearfix"> </div> <h3 id="input_argument_d" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>d</code> &#8212; scalar which passes to C function length(Mu). </span>  </a><span class="example_desc">Note that options X0, eyed, n, and d must be supplied
               together.</span></span></h3> <div class="collapse"> <p></p>	<p class="description_valueexample">       <strong>Example: </strong><code>'eyed',eye(v)
</code></p> <p class="datatypelist"><strong> Data Types: </strong><code>single|double</code></p> </div> </div><div class="expandableContent"> <div id="inputarg_msg" class="clearfix"> </div> <h3 id="input_argument_msg" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>msg</code> &#8212; Level of output to display. </span>  </a><span class="example_desc">Scalar.</span></span></h3> <div class="collapse"> <p><p>Scalar which controls whether to display or not messages
               on the screen. If msg==1 (default) messages are displayed
               on the screen when cholesky of Sigma is impossibile 
               else no message is displayed on the screen. When Clolesky
               of Sigma is impossible -Inf output is returned.</p> <p>
                 </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code>'msg',1
</code></p> <p class="datatypelist"><strong> Data Types: </strong><code>single | double</code></p> </div> </div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="OutputArgs" >Output Arguments</h2><div class="expandableContent"><div class="arguments"><div class="output_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"><div id="outputarg_y" class="clearfix"></div><h3 id="output_argument_y" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>y</code> &#8212;log-density of the multivariate normal.</span></a><span class="example_desc"><code> </code>Vector</span></span></h3><div class="collapse"><p> Vector with length
               equal to n which returns the log-density of the multivariate normal
               distribution with mean Mu and covariance Sigma, evaluated at each row
               of X.</p></div></div></div></div></div></div><div class="ref_sect" itemprop="content"><div class="bibliography"><h2 id="References">References</h2> </div></div><div class="ref_sect"><h2 id="SeeAlso">See Also</h2><p><span itemprop="seealso"><a href="matlab:web(fullfile(docroot,'stats/mvnpdf.html'))" itemprop="url"><span itemprop="name"><code>mvnpdf</code></span></a></span></div><i>This page has been automatically generated by our routine <a href="publishFS.html">publishFS</a></i></div></section></div></div></div></div><div id="divbottom"></div></body></html>